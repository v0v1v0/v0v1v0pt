<div class="container">

<table style="width: 100%;"><tr>
<td>g_forest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create a forest plot from an <code>rtable</code>
</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt="[Stable]"></a>
</p>


<h3>Usage</h3>

<pre><code class="language-R">g_forest(
  tbl,
  col_x = attr(tbl, "col_x"),
  col_ci = attr(tbl, "col_ci"),
  vline = 1,
  forest_header = attr(tbl, "forest_header"),
  xlim = c(0.1, 10),
  logx = TRUE,
  x_at = c(0.1, 1, 10),
  width_row_names = lifecycle::deprecated(),
  width_columns = NULL,
  width_forest = lifecycle::deprecated(),
  lbl_col_padding = 0,
  rel_width_forest = 0.25,
  font_size = 12,
  col_symbol_size = attr(tbl, "col_symbol_size"),
  col = getOption("ggplot2.discrete.colour")[1],
  ggtheme = NULL,
  as_list = FALSE,
  gp = lifecycle::deprecated(),
  draw = lifecycle::deprecated(),
  newpage = lifecycle::deprecated()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tbl</code></td>
<td>
<p>(<code>VTableTree</code>)<br><code>rtables</code> table with at least one column with a single value and one column with 2
values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_x</code></td>
<td>
<p>(<code>integer(1)</code> or <code>NULL</code>)<br> column index with estimator. By default tries to get this from
<code>tbl</code> attribute <code>col_x</code>, otherwise needs to be manually specified. If <code>NULL</code>, points will be excluded
from forest plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_ci</code></td>
<td>
<p>(<code>integer(1)</code> or <code>NULL</code>)<br> column index with confidence intervals. By default tries to get this from
<code>tbl</code> attribute <code>col_ci</code>, otherwise needs to be manually specified. If <code>NULL</code>, lines will be excluded
from forest plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vline</code></td>
<td>
<p>(<code>numeric(1)</code> or <code>NULL</code>)<br> x coordinate for vertical line, if <code>NULL</code> then the line is omitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>forest_header</code></td>
<td>
<p>(<code>character(2)</code>)<br> text displayed to the left and right of <code>vline</code>, respectively.
If <code>vline = NULL</code> then <code>forest_header</code> is not printed. By default tries to get this from <code>tbl</code> attribute
<code>forest_header</code>. If <code>NULL</code>, defaults will be extracted from the table if possible, and set to
<code>"Comparison\nBetter"</code> and <code>"Treatment\nBetter"</code> if not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>(<code>numeric(2)</code>)<br> limits for x axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logx</code></td>
<td>
<p>(<code>flag</code>)<br> show the x-values on logarithm scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_at</code></td>
<td>
<p>(<code>numeric</code>)<br> x-tick locations, if <code>NULL</code>, <code>x_at</code> is set to <code>vline</code> and both <code>xlim</code> values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width_row_names</code></td>
<td>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt="[Deprecated]"></a> Please use the <code>lbl_col_padding</code> argument instead.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width_columns</code></td>
<td>
<p>(<code>numeric</code>)<br> a vector of column widths. Each element's position in
<code>colwidths</code> corresponds to the column of <code>tbl</code> in the same position. If <code>NULL</code>, column widths are calculated
according to maximum number of characters per column.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width_forest</code></td>
<td>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt="[Deprecated]"></a> Please use the <code>rel_width_forest</code> argument instead.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lbl_col_padding</code></td>
<td>
<p>(<code>numeric</code>)<br> additional padding to use when calculating spacing between
the first (label) column and the second column of <code>tbl</code>. If <code>colwidths</code> is specified,
the width of the first column becomes <code>colwidths[1] + lbl_col_padding</code>. Defaults to 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rel_width_forest</code></td>
<td>
<p>(<code>proportion</code>)<br> proportion of total width to allocate to the forest plot. Relative
width of table is then <code>1 - rel_width_forest</code>. If <code>as_list = TRUE</code>, this parameter is ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>font_size</code></td>
<td>
<p>(<code>numeric(1)</code>)<br> font size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_symbol_size</code></td>
<td>
<p>(<code>numeric</code> or <code>NULL</code>)<br> column index from <code>tbl</code> containing data to be used
to determine relative size for estimator plot symbol. Typically, the symbol size is proportional
to the sample size used to calculate the estimator. If <code>NULL</code>, the same symbol size is used for all subgroups.
By default tries to get this from <code>tbl</code> attribute <code>col_symbol_size</code>, otherwise needs to be manually specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>(<code>character</code>)<br> color(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ggtheme</code></td>
<td>
<p>(<code>theme</code>)<br> a graphical theme as provided by <code>ggplot2</code> to control styling of the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>as_list</code></td>
<td>
<p>(<code>flag</code>)<br> whether the two <code>ggplot</code> objects should be returned as a list. If <code>TRUE</code>, a named list
with two elements, <code>table</code> and <code>plot</code>, will be returned. If <code>FALSE</code> (default) the table and forest plot are
printed side-by-side via <code>cowplot::plot_grid()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gp</code></td>
<td>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt="[Deprecated]"></a> <code>g_forest</code> is now generated as a <code>ggplot</code> object. This argument
is no longer used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>draw</code></td>
<td>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt="[Deprecated]"></a> <code>g_forest</code> is now generated as a <code>ggplot</code> object. This argument
is no longer used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newpage</code></td>
<td>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt="[Deprecated]"></a> <code>g_forest</code> is now generated as a <code>ggplot</code> object. This argument
is no longer used.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given a <code>rtables::rtable()</code> object with at least one column with a single value and one column with 2
values, converts table to a <code>ggplot2::ggplot()</code> object and generates an accompanying forest plot. The
table and forest plot are printed side-by-side.
</p>


<h3>Value</h3>

<p><code>ggplot</code> forest plot and table.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(dplyr)
library(forcats)
library(nestcolor)

adrs &lt;- tern_ex_adrs
n_records &lt;- 20
adrs_labels &lt;- formatters::var_labels(adrs, fill = TRUE)
adrs &lt;- adrs %&gt;%
  filter(PARAMCD == "BESRSPI") %&gt;%
  filter(ARM %in% c("A: Drug X", "B: Placebo")) %&gt;%
  slice(seq_len(n_records)) %&gt;%
  droplevels() %&gt;%
  mutate(
    # Reorder levels of factor to make the placebo group the reference arm.
    ARM = fct_relevel(ARM, "B: Placebo"),
    rsp = AVALC == "CR"
  )
formatters::var_labels(adrs) &lt;- c(adrs_labels, "Response")
df &lt;- extract_rsp_subgroups(
  variables = list(rsp = "rsp", arm = "ARM", subgroups = c("SEX", "STRATA2")),
  data = adrs
)
# Full commonly used response table.

tbl &lt;- basic_table() %&gt;%
  tabulate_rsp_subgroups(df)
g_forest(tbl)

# Odds ratio only table.

tbl_or &lt;- basic_table() %&gt;%
  tabulate_rsp_subgroups(df, vars = c("n_tot", "or", "ci"))
g_forest(
  tbl_or,
  forest_header = c("Comparison\nBetter", "Treatment\nBetter")
)

# Survival forest plot example.
adtte &lt;- tern_ex_adtte
# Save variable labels before data processing steps.
adtte_labels &lt;- formatters::var_labels(adtte, fill = TRUE)
adtte_f &lt;- adtte %&gt;%
  filter(
    PARAMCD == "OS",
    ARM %in% c("B: Placebo", "A: Drug X"),
    SEX %in% c("M", "F")
  ) %&gt;%
  mutate(
    # Reorder levels of ARM to display reference arm before treatment arm.
    ARM = droplevels(fct_relevel(ARM, "B: Placebo")),
    SEX = droplevels(SEX),
    AVALU = as.character(AVALU),
    is_event = CNSR == 0
  )
labels &lt;- list(
  "ARM" = adtte_labels["ARM"],
  "SEX" = adtte_labels["SEX"],
  "AVALU" = adtte_labels["AVALU"],
  "is_event" = "Event Flag"
)
formatters::var_labels(adtte_f)[names(labels)] &lt;- as.character(labels)
df &lt;- extract_survival_subgroups(
  variables = list(
    tte = "AVAL",
    is_event = "is_event",
    arm = "ARM", subgroups = c("SEX", "BMRKR2")
  ),
  data = adtte_f
)
table_hr &lt;- basic_table() %&gt;%
  tabulate_survival_subgroups(df, time_unit = adtte_f$AVALU[1])
g_forest(table_hr)

# Works with any `rtable`.
tbl &lt;- rtable(
  header = c("E", "CI", "N"),
  rrow("", 1, c(.8, 1.2), 200),
  rrow("", 1.2, c(1.1, 1.4), 50)
)
g_forest(
  tbl = tbl,
  col_x = 1,
  col_ci = 2,
  xlim = c(0.5, 2),
  x_at = c(0.5, 1, 2),
  col_symbol_size = 3
)

tbl &lt;- rtable(
  header = rheader(
    rrow("", rcell("A", colspan = 2)),
    rrow("", "c1", "c2")
  ),
  rrow("row 1", 1, c(.8, 1.2)),
  rrow("row 2", 1.2, c(1.1, 1.4))
)
g_forest(
  tbl = tbl,
  col_x = 1,
  col_ci = 2,
  xlim = c(0.5, 2),
  x_at = c(0.5, 1, 2),
  vline = 1,
  forest_header = c("Hello", "World")
)

</code></pre>


</div>