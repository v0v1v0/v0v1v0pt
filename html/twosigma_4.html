<div class="container">

<table style="width: 100%;"><tr>
<td>simulate_zero_inflated_nb_random_effect_data</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulated zero-inflated negative binomial data with random effects</h2>

<h3>Description</h3>

<p>Simulated zero-inflated negative binomial data with random effects
</p>


<h3>Usage</h3>

<pre><code class="language-R">simulate_zero_inflated_nb_random_effect_data(
  ncellsper,
  X,
  Z,
  alpha,
  beta,
  phi,
  sigma.a,
  sigma.b,
  id.levels = NULL,
  sim.seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ncellsper</code></td>
<td>
<p>Vector giving the number of cells per individual.  Length of the vector is taken as the number of individuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Covariate matrix (without intercept) for the (conditional) mean model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>Covariate matrix (without intercept) for the zero-inflation model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Column vector of true parameters from the zero-inflation model. Number of rows must match number of columns in Z.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>Column vector of true parameters from the (conditional) mean model. Number of rows must match number of columns in X.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>Overdispersion parameter for the negative binomial distribution (see details for more about parameterization).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma.a</code></td>
<td>
<p>Standard deviation for the zero-inflation model random intercept.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma.b</code></td>
<td>
<p>Standard deviation for the (conditional) mean random intercept.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id.levels</code></td>
<td>
<p>Individual-level IDs. If NULL set as 1,2,... up to the number of individuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sim.seed</code></td>
<td>
<p>Random seed to be used. If NULL one will be randomly chosen.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Y Simulated counts
</p>
<p>X Covariate matrix (without intercept) for the (conditional) mean model.
</p>
<p>Z Covariate matrix (without intercept) for the zero-inflation model.
</p>
<p>a Random effects for the zero-inflation model.
</p>
<p>b Random effects for the (conditional) mean model.
</p>
<p>alpha Column vector of true parameters from the zero-inflation model. Number of rows must match number of columns in Z.
</p>
<p>beta Column vector of true parameters from the (conditional) mean model. Number of rows must match number of columns in X.
</p>
<p>phi Overdispersion parameter for the negative binomial distribution (see details for more about parameterization).
</p>
<p>sigma.a Standard deviation for the zero-inflation model random intercept.
</p>
<p>sigma.b Standard deviation for the (conditional) mean random intercept.
</p>
<p>nind Number of individuals.
</p>
<p>ncellsper Vector giving the number of cells per individual.
</p>
<p>id.levels Individual-level IDs.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Set Parameters to Simulate Some Data

nind&lt;-10;ncellsper&lt;-rep(50,nind)
sigma.a&lt;-.5;sigma.b&lt;-.5;phi&lt;-.1
alpha&lt;-c(1,0,-.5,-2);beta&lt;-c(2,0,-.1,.6)
beta2&lt;-c(2,1,-.1,.6)
id.levels&lt;-1:nind;nind&lt;-length(id.levels)
id&lt;-rep(id.levels,times=ncellsper)
sim.seed&lt;-1234

# Simulate individual level covariates

t2d_sim&lt;-rep(rbinom(nind,1,p=.4),times=ncellsper)
cdr_sim&lt;-rbeta(sum(ncellsper),3,6)
age_sim&lt;-rep(sample(c(20:60),size=nind,replace = TRUE),times=ncellsper)

# Construct design matrices

Z&lt;-cbind(scale(t2d_sim),scale(age_sim),scale(cdr_sim))
colnames(Z)&lt;-c("t2d_sim","age_sim","cdr_sim")
X&lt;-cbind(scale(t2d_sim),scale(age_sim),scale(cdr_sim))
colnames(X)&lt;-c("t2d_sim","age_sim","cdr_sim")

# Simulate Data

sim_dat&lt;-matrix(nrow=2,ncol=sum(ncellsper))
for(i in 1:nrow(sim_dat)){
   sim_dat[i,]&lt;-simulate_zero_inflated_nb_random_effect_data(ncellsper,X,Z,alpha,beta2
   ,phi,sigma.a,sigma.b,id.levels=NULL)$Y
}
rownames(sim_dat)&lt;-paste("Gene",1:2)
</code></pre>


</div>