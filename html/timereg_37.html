<div class="container">

<table style="width: 100%;"><tr>
<td>cum.residuals</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Model validation based on cumulative residuals</h2>

<h3>Description</h3>

<p>Computes cumulative residuals and approximative p-values based on resampling
techniques.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cum.residuals(
  object,
  data = parent.frame(),
  modelmatrix = 0,
  cum.resid = 1,
  n.sim = 500,
  weighted.test = 0,
  max.point.func = 50,
  weights = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object of class 'aalen', 'timecox', 'cox.aalen' where the
residuals are returned ('residuals=1')</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data frame based on which residuals are computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modelmatrix</code></td>
<td>
<p>specifies a grouping of the data that is used for
cumulating residuals. Must have same size as data and be ordered in the same
way.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cum.resid</code></td>
<td>
<p>to compute residuals versus each of the continuous
covariates in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.sim</code></td>
<td>
<p>number of simulations in resampling.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weighted.test</code></td>
<td>
<p>to compute a variance weighted version of the
test-processes used for testing constant effects of covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.point.func</code></td>
<td>
<p>limits the amount of computations, only considers a
max of 50 points on the covariate scales.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>weights for sum of martingale residuals, now for cum.resid=1.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>returns an object of type "cum.residuals" with the following
arguments: </p>
<table>
<tr style="vertical-align: top;">
<td><code>cum</code></td>
<td>
<p>cumulative residuals versus time for the groups
specified by modelmatrix. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.cum</code></td>
<td>
<p>the martingale based pointwise
variance estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robvar.cum</code></td>
<td>
<p>robust pointwise variances estimates
of cumulatives.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs.testBeq0</code></td>
<td>
<p>observed absolute value of supremum of
cumulative components scaled with the variance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval.testBeq0</code></td>
<td>
<p>p-value covariate effects based on supremum test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sim.testBeq0</code></td>
<td>
<p>resampled supremum value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.band</code></td>
<td>
<p>resampling
based constant to construct robust 95% uniform confidence bands for
cumulative residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs.test</code></td>
<td>
<p>absolute value of supremum of
observed test-process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval.test</code></td>
<td>
<p>p-value for supremum test
statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sim.test</code></td>
<td>
<p>resampled absolute value of supremum cumulative
residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>proc.cumz</code></td>
<td>
<p>observed cumulative residuals versus all
continuous covariates of model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sim.test.proccumz</code></td>
<td>
<p>list of 50 random
realizations of test-processes under model for all continuous covariates.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Thomas Scheike
</p>


<h3>References</h3>

<p>Martinussen and Scheike, Dynamic Regression Models for Survival
Data, Springer (2006).
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(sTRACE)
# Fits Aalen model and returns residuals
fit&lt;-aalen(Surv(time,status==9)~age+sex+diabetes+chf+vf,
           data=sTRACE,max.time=7,n.sim=0,residuals=1)

# constructs and simulates cumulative residuals versus age groups
fit.mg&lt;-cum.residuals(fit,data=sTRACE,n.sim=100,
modelmatrix=model.matrix(~-1+factor(cut(age,4)),sTRACE))

par(mfrow=c(1,4))
# cumulative residuals with confidence intervals
plot(fit.mg);
# cumulative residuals versus processes under model
plot(fit.mg,score=1); 
summary(fit.mg)

# cumulative residuals vs. covariates Lin, Wei, Ying style 
fit.mg&lt;-cum.residuals(fit,data=sTRACE,cum.resid=1,n.sim=100)

par(mfrow=c(2,4))
plot(fit.mg,score=2)
summary(fit.mg)

</code></pre>


</div>