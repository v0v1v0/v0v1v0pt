<div class="container">

<table style="width: 100%;"><tr>
<td>calcSigma</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate Variance-Covariance Matrix for MSM Parameters (calcSigma)</h2>

<h3>Description</h3>

<p>An internal function called by the <code>tmleMSM</code> function to calculate the variance-covariance matrix of the 
parameter estimates based on the influence curve of the specified MSM.</p>


<h3>Usage</h3>

<pre><code class="language-R">calcSigma(hAV, gAVW, Y, Q, mAV, covar.MSM, covar.MSMA0, covar.MSMA1, I.V, 
     Delta, ub, id, family)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>hAV</code></td>
<td>
<p>values used in numerator of weights applied to the estimation procedure</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gAVW</code></td>
<td>
<p><code class="reqn">P(A=a | V,W,T)*P(Delta=1 | A,V,W,T)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>continuous or binary outcome variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q</code></td>
<td>
<p>estimated <code class="reqn">P(Y | A, V, W, T, Delta=1)</code>, typically targeted values <code>Q*</code> are passed in</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mAV</code></td>
<td>
<p>predicted values for <code class="reqn">EY1</code> from the MSM using the targeted estimates for <code class="reqn">psi</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covar.MSM</code></td>
<td>
<p>covariate values used as predictors for the MSM when <code>A=a</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covar.MSMA0</code></td>
<td>
<p>covariate values used as predictors for the MSM when <code>A=0</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covar.MSMA1</code></td>
<td>
<p>covariate values used as predictors for the MSM when <code>A=1</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>I.V</code></td>
<td>
<p>indicator that observation is in stratum of interest</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Delta</code></td>
<td>
<p>indicator of missing outcome. <code>1</code> - observed, <code>0</code> - missing</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ub</code></td>
<td>
<p>upper bound on weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>subject identifier</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>‘gaussian’ for continuous outcomes, ‘binomial’ for binary outcomes</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table><tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>influence-curve based variance-covariance matrix. See Rosenblum&amp;vanderLaan2010 for details.</p>
</td>
</tr></table>
<h3>Author(s)</h3>

<p>Susan Gruber</p>


<h3>See Also</h3>

<p><code>tmle</code>,
<code>estimateQ</code>,
<code>estimateG</code>,
<code>tmleMSM</code>
</p>


</div>