<div class="container">

<table style="width: 100%;"><tr>
<td>depmeasures</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Estimate dependence measures
</h2>

<h3>Description</h3>

<p>Appropriate marginal transforms are done before the fit using standard procedures, before the dependence model is fitted to the data. Then the posterior distribution of a measure of dependence is derived. <code>thetafit</code> gives posterior samples for the extremal index <code class="reqn">\theta(x,m)</code> and <code>chifit</code> does the same for the coefficient of extremal dependence <code class="reqn">\chi_m(x)</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">thetafit(ts, lapl = FALSE, nlag = 1,
      R = 1000, S = 500,
      u.mar = 0, u.dep,
      probs = seq(u.dep, 0.9999, length.out = 30),
      method.mar = c("mle", "mom","pwm"), method = c("prop", "MCi"),
      silent = FALSE,
      fit = TRUE, prev.fit=bayesfit(), par = bayesparams(),
      submodel = c("fom", "none"), levels=c(.025,.975))

chifit(ts, lapl = FALSE, nlag = 1,
      R = 1000, S = 500,
      u.mar = 0, u.dep,
      probs = seq(u.dep, 0.9999, length.out = 30),
      method.mar = c("mle", "mom","pwm"), method = c("prop", "MCi"),
      silent = FALSE,
      fit = TRUE, prev.fit=bayesfit(), par = bayesparams(),
      submodel = c("fom", "none"), levels=c(.025,.975))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ts</code></td>
<td>

<p>a vector, the time series for which to estimate the extremal index <code class="reqn">\theta(x,m)</code> or the coefficient of extremal dependence <code class="reqn">\chi_m(x)</code>, with <code class="reqn">x</code> a probability level and <code class="reqn">m</code> a run-length (see details).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lapl</code></td>
<td>

<p>logical; <code>TRUE</code> indicates that <code>ts</code> has a marginal Laplace distribution. If <code>FALSE</code> (default), <code>method.mar</code> is used to transform the marginal distribution of <code>ts</code> to Laplace.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlag</code></td>
<td>

<p>the run-length; an integer larger or equal to 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>

<p>the number of samples per MCMC iteration drawn from the sampled posterior distributions; used for the estimation of the dependence measure.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>

<p>the number of posterior distributions sampled to be used for the estimation of the dependence measure.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u.mar</code></td>
<td>

<p>probability; threshold used for marginal transformation if <code>lapl</code> is <code>FALSE</code>. Not used otherwise.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u.dep</code></td>
<td>

<p>probability; threshold used for the extremal dependence model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probs</code></td>
<td>

<p>vector of probabilities; the values of <code class="reqn">x</code> for which to evaluate <code class="reqn">\theta(x,m)</code> or <code class="reqn">\chi_m(x)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method.mar</code></td>
<td>

<p>a character string defining the method used to estimate the marginal GPD; either <code>"mle"</code> for maximum likelihood of <code>"mom"</code> for method of moments or <code>"pwm"</code> for probability weighted moments methods. Defaults to <code>"mle"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>a character string defining the method used to estimate the dependence measure; either <code>"prop"</code> for proportions or <code>"MCi"</code> for Monte Carlo integration (see details).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>

<p>logical (<code>FALSE</code>); verbosity.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>

<p>logical; <code>TRUE</code> means that the dependence model must be fitted and the values in <code>par</code> are used. Otherwise the result from a previous call to <code>depfit</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prev.fit</code></td>
<td>

<p>an object of class 'bayesfit'. Needed if <code>fit</code> is FALSE. Typically returned by a previous call to <code>depfit</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>

<p>an object of class '<code>bayesparams</code>' to be used for the fit of dependence model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>submodel</code></td>
<td>

<p>a character string, either <code>"fom"</code> for <em>first order Markov</em> or <code>"none"</code> for no specification.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>levels</code></td>
<td>

<p>vector of probabilites; the quantiles of the posterior distribution of the extremal measure to be computed.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The sub-asymptotic extremal index is defined as
</p>
<p style="text-align: center;"><code class="reqn">\theta(x,m) = Pr(X_1 &lt; x,\ldots,X_m &lt; x | X_0 &gt; x),</code>
</p>

<p>whose limit as <code class="reqn">x</code> and <code class="reqn">m</code> go to <code class="reqn">\infty</code>appropriately is the extremal index <code class="reqn">\theta</code>. The extremal index can be interpreted as the inverse of the asymptotic mean cluster size (see <code>thetaruns)</code>.
</p>
<p>The sub-asymptotic coefficient of extremal dependence is
</p>
<p style="text-align: center;"><code class="reqn">\chi_m(x) = Pr(X_m &gt; x | X_0 &gt; x),</code>
</p>

<p>whose limit <code class="reqn">\chi</code> defines asymptotic dependence (<code class="reqn">\chi &gt; 0</code>) or asymptotic independence (<code class="reqn">\chi = 0</code>).
</p>
<p>Both types of extremal dependence measures can be estimated either using a
</p>
<p>* proportion method (<code>method == "prop"</code>), sampling from the conditional probability given <code class="reqn">X_0 &gt; x</code> and counting the proportion of sampled points falling in the region of interest, or
</p>
<p>* Monte Carlo integration (<code>method == "MCi"</code>), sampling replicates from the marginal exponential tail distribution and evaluating the conditional tail distribution in these replicates, then taking their mean as an approximation of the integral.
</p>
<p><code>submodel == "fom"</code> imposes a first order Markov structure to the model, namely a geometrical decrease in <code class="reqn">\alpha</code> and a constant <code class="reqn">\beta</code> across lags, i.e. <code class="reqn">\alpha_j = \alpha^j</code> and <code class="reqn">\beta_j = \beta</code>, <code class="reqn">j=1,\ldots,m</code>.
</p>


<h3>Value</h3>

<p>An object of class 'depmeasure', containing a subset of:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>bayesfit </code></td>
<td>
<p>An object of class 'bayesfit'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta </code></td>
<td>
<p>An array with dimensions <code>m</code> <code class="reqn">\times</code> <code>length(probs)</code> <code class="reqn">\times</code> (2+<code>length(levels)</code>), with the last dimension listing the posterior mean and median, and the <code>level</code> posterior quantiles</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distr </code></td>
<td>
<p>An array with dimensions <code>m</code> <code class="reqn">\times</code> <code>length(probs)</code> <code class="reqn">\times</code> <code>S</code>; posterior samples of <code>theta</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chi </code></td>
<td>
<p>An array with dimensions <code>m</code> <code class="reqn">\times</code> <code>length(probs)</code> <code class="reqn">\times</code> (2+<code>length(levels)</code>), with the last dimension listing the posterior mean and median, and the <code>level</code> posterior quantiles</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probs </code></td>
<td>
<p><code>probs</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>levels </code></td>
<td>
<p><code>probs</code> transformed to original scale of <code>ts</code></p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>depfit</code>, <code>theta2fit</code>, <code>thetaruns</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## generate data from an AR(1)
## with Gaussian marginal distribution
n   &lt;- 10000
dep &lt;- 0.5
ar    &lt;- numeric(n)
ar[1] &lt;- rnorm(1)
for(i in 2:n)
  ar[i] &lt;- rnorm(1, mean=dep*ar[i-1], sd=1-dep^2)
plot(ar, type="l")
plot(density(ar))
grid &lt;- seq(-3,3,0.01)
lines(grid, dnorm(grid), col="blue")

## rescale the margin (focus on dependence)
ar &lt;- qlapl(pnorm(ar))

## fit the data
params &lt;- bayesparams()
params$maxit &lt;- 100 # bigger numbers would be
params$burn  &lt;- 10  # more sensible...
params$thin  &lt;- 4
theta &lt;- thetafit(ts=ar, R=500, S=100, u.mar=0.95, u.dep=0.98,
                  probs = c(0.98, 0.999), par=params)
## or, same thing in two steps to control fit output before computing theta:
fit &lt;- depfit(ts=ar, u.mar=0.95, u.dep=0.98, par=params)
plot(fit)
theta &lt;- thetafit(ts=ar, R=500, S=100, u.mar=0.95, u.dep=0.98,
                  probs = c(0.98, 0.999), fit=FALSE, prev.fit=fit)
</code></pre>


</div>