<div class="container">

<table style="width: 100%;"><tr>
<td>TSSRESTREND</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Time Series Segmentation of Residual Trends (MAIN FUNCTION)</h2>

<h3>Description</h3>

<p>Time Series Segmented Residual Trend (TSS.RESTREND) methodology.Takes in a complete monthly
time series of a VI and its corrosponding precipitation (and temperature). It then looks looks
for breakpoints using the BFAST function. The significance of the breakpoin in the residuals
and the VPR is assessed using a Chow test, then, the total time series change is calculated.
</p>


<h3>Usage</h3>

<pre><code class="language-R">TSSRESTREND(
  CTSR.VI,
  ACP.table = FALSE,
  ACT.table = NULL,
  CTSR.RF = FALSE,
  CTSR.TM = NULL,
  anu.VI = FALSE,
  acu.RF = FALSE,
  acu.TM = NULL,
  VI.index = FALSE,
  rf.b4 = FALSE,
  rf.af = FALSE,
  sig = 0.05,
  season = "none",
  exclude = 0,
  allow.negative = FALSE,
  allowneg.retest = FALSE,
  h = 0.15,
  retnonsig = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>CTSR.VI</code></td>
<td>
<p>Complete Monthly Time Series of Vegetation Index values.
An object of class <code>'ts'</code> object without NA's.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ACP.table</code></td>
<td>
<p>A table of every combination of offset period and accumulation period.for precipitation
ACP.table can be calculated using the <code>climate.accumulator</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ACT.table</code></td>
<td>
<p>A table of every combination of offset period and accumulation period.for temperature
ACP.table can be calculated using the <code>climate.accumulator</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CTSR.RF</code></td>
<td>
<p>Complete Time Series of Rainfall. An object of class 'ts' object without NA's
and be the same length and cover the same time range as CTSR.VI.
If ACP.table is provided, CTSR.RF will be automitaclly calculated using the
<code>ACP.calculator</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CTSR.TM</code></td>
<td>
<p>Complete Time Series of temperature. An object of class 'ts' object without NA's
and be the same length and cover the same time range as CTSR.VI.  Default (CTSR.TM=NULL).
If ACT.table is provided, CTSR.RF will be automitaclly calculated using the
<code>ACP.calculator</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>anu.VI</code></td>
<td>
<p>The annual (Growing season) max VI. Must be a object of class <code>'ts'</code> without NA's.
if anu.VI=FALSE, it will be calculated from the CTSR.VI using <code>AnMaxVI</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>acu.RF</code></td>
<td>
<p>The optimal accumulated rainfall for anu.VI. Must be a object of class <code>'ts'</code> without
NA's and be of equal length and temporal range to anu.VI. if anu.RF=FALSE, it will be
calculated from ACP.table usingthe <code>AnnualClim.Cal</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>acu.TM</code></td>
<td>
<p>The optimal accumulated rainfall for anu.TM. Must be a object of class <code>'ts'</code> without
NA's and be of equal length and temporal range to anu.TM. if anu.TM=FALSE, it will be
calculated from ACT.table usingthe <code>AnnualClim.Cal</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VI.index</code></td>
<td>
<p>the index of the CTSR.VI ts that the anu.VI values occur at. Must be the same length
as anu.VI. NOTE. R indexs from 1 rather than 0.
if VI.index=FALSE, it will be calculated from the CTSR.VI using <code>AnMaxVI</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rf.b4</code></td>
<td>
<p>If a breakpoint in the VPR is detected this is the optimial accumulated rainfall before
the breakpoint. must be the same length as the anu.VI. If ACP.table is provided it will
be generated using <code>AnnualClim.Cal</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rf.af</code></td>
<td>
<p>If a breakpoint in the VPR is detected this is the optimial accumulated rainfall after
the breakpoint. must be the same length as the anu.VI. If ACP.table is provided it will
be generated using <code>AnnualClim.Cal</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig</code></td>
<td>
<p>Significance of all the functions. defualt sig=0.05</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>season</code></td>
<td>
<p>See <code>bfast</code>. This season value only applies to bfast done using the CTS
VPR. if a non VPR adjusted BFAST is performed.a harmonic season is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclude</code></td>
<td>
<p>A numberic vector containg months excluded from breakpoint detection.  This was included to
allow sensor transitions to be masked.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allow.negative</code></td>
<td>
<p>If true, will not preference positive slope in either CTSR or VI calculations. default=FALSE is set
because negative associations between rainfall and vegetation in water limited ecosystems is unexpected
If temperature data is included then this paramter is forced to TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allowneg.retest</code></td>
<td>
<p>default=FALSE
If temperature data is provided but found to not be significant then a retest is performed.
This paramter is to allow negative on re-test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>See <code>bfast</code>, The.minimal segment size between potentially detected breaks in the trend model
given as fraction relative to the sample size (i.e. the minimal number of observations in each segment
divided by the total length of the timeseries. Default h = 0.15.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>retnonsig</code></td>
<td>
<p>Bool. New in v0.3.0. Allows TSSRESTREND to return change estimates of values that filed the sig component in the residual analysis.
defualt FALSE will give the same result as eralier versions.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>'TSSRESTREND'</code> is a list with the following elements:
</p>

<dl>
<dt><b><em>summary</em></b></dt>
<dd>

<dl>
<dt>Method</dt>
<dd>
<p>The method used to determine total change. (<em>RESTREND</em> see <code>RESTREND</code>,
<em>segmented.RESTREND</em> see <code>seg.RESTREND</code>, <em>segmented.VPR</em> see
<code>seg.VPR</code>)</p>
</dd>
<dt>Total.Change</dt>
<dd>
<p>The total significant change. Residual.Change + VPR.HeightChange. </p>
</dd>
<dt>Residual.Change</dt>
<dd>
<p>The change in the VPR Residuals over the time period</p>
</dd>
<dt>VPR.HeightChange</dt>
<dd>
<p>The change in VI at mean rainfall for a "ts" with a significant
breakpoint in the VPR</p>
</dd>
<dt>model.p</dt>
<dd>
<p>p value of the regression model fitted to the VPR. See <code>lm</code></p>
</dd>
<dt>residual.p</dt>
<dd>
<p>p value of the regression model fitted to the VPR Residuals. See <code>lm</code></p>
</dd>
<dt>VPRbreak.p</dt>
<dd>
<p>the p value associated with the break height. See <code>lm</code></p>
</dd>
<dt>bp.year</dt>
<dd>
<p>The Year of the most significant breakpoint</p>
</dd>
</dl>
</dd>
<dt><b><em>ts.data</em></b></dt>
<dd>
<p>The Time series used in analysis. See Arguments for description
</p>

<ul>
<li>
<p> CTSR.VI
</p>
</li>
<li>
<p> CTSR.RF
</p>
</li>
<li>
<p> anu.VI
</p>
</li>
<li>
<p> VI.index
</p>
</li>
<li>
<p> acu.RF
</p>
</li>
<li>
<p> StdVar.RF see <code>seg.VPR</code>)</p>
</li>
</ul>
</dd>
<dt><b><em>ols.summary</em></b></dt>
<dd>

<dl>
<dt>chow.summary</dt>
<dd>
<p>summary of the most significant breakpoint. </p>
</dd>
<dt>chow.ind</dt>
<dd>
<p>Summary of every detected breakpoint</p>
</dd>
<dt>OLS.table</dt>
<dd>
<p>A matrix containing the coefficents for the CTS.fit, VPR.fit, RESTREND.fit and segVPR.fit</p>
</dd>
</dl>
</dd>
<dt><b><em>TSSRmodels</em></b></dt>
<dd>
<p>models of class "lm" <code>lm</code> and class "bfast" <code>bfast</code> generated.</p>
</dd>
</dl>
<h3>Note</h3>

<p>if ACP.table = FALSE, CTSR.RF and acu.RF must be provided as well as
rf.b4 and rf.af for <code>'ts'</code> with a breakpoint in the VPR.
</p>


<h3>Author(s)</h3>

<p>Arden Burrell, arden.burrell@unsw.edu.au
</p>


<h3>See Also</h3>


<ul>
<li> <p><code>plot.TSSRESTREND</code>
</p>
</li>
<li> <p><code>print.TSSRESTREND</code>
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
#To get the latest version of the package (Still in development)
install.packages("devtools")
library("devtools")
install_github("ArdenB/TSSRESTREND", subdir="TSS.RESTREND")
library(TSS.RESTREND)
#Find the path of the rabbitRF.csv dataset, read it in and turn it into a time series
rf.path&lt;- system.file("extdata", "rabbitRF.csv", package = "TSS.RESTREND", mustWork = TRUE)
in.RF &lt;- read.csv(rf.path)
rf.data &lt;- ts(in.RF, end=c(2013,12), frequency = 12)

#Find the path of the rabbitVI.csv dataset and read it in
vi.path &lt;- system.file("extdata", "rabbitVI.csv", package = "TSS.RESTREND", mustWork = TRUE)
in.VI &lt;- read.csv(vi.path)
CTSR.VI &lt;- ts(in.VI, start=c(1982, 1), end=c(2013,12), frequency = 12)

#Define the max accumuulation period
max.acp &lt;- 12
#Define the max offset period
max.osp &lt;- 4
#Create a table of every possible precipitation value given the max.acp and max.osp
ACP.table &lt;- climate.accumulator(CTSR.VI, rf.data, max.acp, max.osp)
results &lt;- TSSRESTREND(CTSR.VI, ACP.table)
print(results)
plot(results, verbose=TRUE)

## End(Not run)

</code></pre>


</div>