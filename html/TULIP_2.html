<div class="container">

<table style="width: 100%;"><tr>
<td>adjvec</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Adjust vector for covariates.
</h2>

<h3>Description</h3>

<p>Adjusts vector with respect to covariates. Vector depends on the covariates through a linear regression model. The function returns the coefficients of covariates in regression and adjusted predictor matrix for further classifier modeling. It estimates coefficients based on training data, and then adjusts training tensor. When testing data is provided, the function will automatically adjust testing data by learned coefficients as well.
</p>


<h3>Usage</h3>

<pre><code class="language-R">adjvec(x, z, y, testx = NULL, testz = NULL, is.centered = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Input matrix of dimension <code class="reqn">N\times p</code>, where <code class="reqn">N</code> is the number of observations and <code class="reqn">p</code> is the number of variables. Each row is an observation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>Input covariate matrix of dimension <code class="reqn">N \times q</code>, where <code class="reqn">q&lt;N</code>. Each row of <code>z</code> is an observation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Class label vector of dimention <code class="reqn">N\times 1</code>. For <code>K</code> class problems, <code>y</code> takes values in <code class="reqn">\{1,\cdots,\code{K}\}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>testx</code></td>
<td>
<p>Input testing matrix. Each row is a test case. When <code>testx</code> is not provided, the function will only adjust training data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>testz</code></td>
<td>
<p>Input testing covariate matrix with each row being an observation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>is.centered</code></td>
<td>
<p>Indicates whether the input vector and covariates have already been centered by their within class mean or not. If <code>is.centered</code> is FALSE, the function <code>adjvec</code> will center data by class. If <code>is.centered</code> is TRUE, the function will skip the centering step.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Similar as CATCH model, assume the linear relationship between vector predictors and covariates as
</p>
<p style="text-align: center;"><code class="reqn">\mathbf{X}=\boldsymbol{\mu}_k+\boldsymbol{\alpha}\times\mathbf{Z}+\mathbf{E},</code>
</p>
<p> where <code class="reqn">\mathbf{X}</code> is a <code class="reqn">N\times p</code> matrix and <code class="reqn">\boldsymbol{\alpha}</code> is the matrix of estimated coefficient of covariates.
The function removes the effects of covariates on response variable through vector and obtain <code class="reqn">\mathbf{X}-\boldsymbol{\alpha}\times\mathbf{Z}</code> as adjusted predictors to fit MSDA and DSDA model.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>The estimated coefficients of covariates to plug in classifier. <code>gamma</code> is similar as the <code class="reqn">\boldsymbol{\gamma}_k</code> defined function <code>catch</code> of dimension <code class="reqn">q\times (K-1)</code>, where <code>q</code> is the size of covariates and <code>K</code> is the number of classes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xres</code></td>
<td>
<p>Adjusted training predictor matrix <code class="reqn">\mathbf{X}-\boldsymbol{\alpha}\times\mathbf{Z}</code> after adjusting for covariates. The effect of the covariate is removed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>testxres</code></td>
<td>
<p>Adjusted testing predictor matrix <code class="reqn">\mathbf{X}-\boldsymbol{\alpha}\times\mathbf{Z}</code> after adjusting for covariates. The effect of the covariate is removed.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Yuqing Pan, Qing Mai, Xin Zhang
</p>


<h3>References</h3>

<p>Pan, Y., Mai, Q., and Zhang, X. (2018), "Covariate-Adjusted Tensor Classification in High-Dimensions." Journal of the American Statistical Association, <em>accepted</em>.
</p>


<h3>See Also</h3>

<p><code>adjten</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">n &lt;- 50
p &lt;- 200
k &lt;- 2
q &lt;- 2
x &lt;- matrix(rnorm(n*p), n, p)
z &lt;- matrix(rnorm(n*q), n, q)
x[1:20, ] &lt;- x[1:20, ] + 2
z[1:20, ] &lt;- z[1:20, ] + 0.5
y &lt;- c(rep(1, 20), rep(2, 30))
obj &lt;- adjvec(x, z, y)
</code></pre>


</div>