<div class="container">

<table style="width: 100%;"><tr>
<td>negbintol.int</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Negative Binomial Tolerance Intervals</h2>

<h3>Description</h3>

<p>Provides 1-sided or 2-sided tolerance intervals for negative binomial random variables. From a statistical quality control perspective, these limits use the number of failures that occur to reach <code>n</code> successes to bound the number of failures for a specified amount of future successes (<code>m</code>). 
</p>


<h3>Usage</h3>

<pre><code class="language-R">negbintol.int(x, n, m = NULL, alpha = 0.05, P = 0.99, 
              side = 1, method = c("LS", "WU", "CB", 
              "CS", "SC", "LR", "SP", "CC"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The total number of failures that occur from a sample of size <code>n</code>.  Can be a vector of length <code>n</code>, in which case the sum of <code>x</code> is computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The target number of successes (sometimes called size) for each trial.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>The target number of successes in a future lot for which the tolerance limits will be calculated. If <code>m = NULL</code>, then the tolerance limits will be constructed assuming <code>n</code> for the target number of future successes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The level chosen such that <code>1-alpha</code> is the confidence level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>The proportion of the defective (or acceptable) units in future samples of size <code>m</code> 
to be covered by this tolerance interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>side</code></td>
<td>
<p>Whether a 1-sided or 2-sided tolerance interval is required (determined by <code>side = 1</code> or <code>side = 2</code>,
respectively).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The method for calculating the lower and upper confidence bounds, which are used in the calculation
of the tolerance bounds.  The default method is <code>"LS"</code>, which is the large-sample method based on the MLE.  <code>"WU"</code> is a Wald-type interval based on the UMVUE of the negative binomial proportion. <code>"CB"</code> is the Casella-Berger exact method.  <code>"CS"</code> is a method based on chi-square percentiles.  <code>"SC"</code> is the score method.  <code>"LR"</code> is a likelihood ratio-based method.  <code>"SP"</code> is a method using a saddlepoint approximation for the confidence intervals.  <code>"CC"</code> gives a continuity-corrected version of the large-sample method and is appropriate when <code>n</code> is large.  More information on these methods can be found in the "References".</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function takes the approach for Poisson and binomial random variables developed in Hahn and Chandra (1981) and applies it to the negative binomial case.
</p>


<h3>Value</h3>

<p><code>negbintol.int</code> returns a data frame with items:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The specified significance level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>The proportion of defective (or acceptable) units in future samples of size <code>m</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi.hat</code></td>
<td>
<p>The probability of success in each trial, calculated by <code>n/(n+x)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>1-sided.lower</code></td>
<td>
<p>The 1-sided lower tolerance bound.  This is given only if <code>side = 1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>1-sided.upper</code></td>
<td>
<p>The 1-sided upper tolerance bound.  This is given only if <code>side = 1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>2-sided.lower</code></td>
<td>
<p>The 2-sided lower tolerance bound.  This is given only if <code>side = 2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>2-sided.upper</code></td>
<td>
<p>The 2-sided upper tolerance bound.  This is given only if <code>side = 2</code>.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Recall that the geometric distribution is the negative binomial distribution where the size is 1. Therefore, the case when <code>n = m = 1</code> will provide tolerance limits for a geometric distribution.
</p>


<h3>References</h3>

<p>Casella, G. and Berger, R. L. (1990), <em>Statistical Inference</em>, Duxbury Press.
</p>
<p>Hahn, G. J. and Chandra, R. (1981), Tolerance Intervals for Poisson and Binomial Variables,
<em>Journal of Quality Technology</em>, <b>13</b>, 100–110.
</p>
<p>Tian, M., Tang, M. L., Ng, H. K. T., and Chan, P. S. (2009), A Comparative Study of Confidence Intervals for Negative Binomial Proportions,
<em>Journal of Statistical Computation and Simulation</em>, <b>79</b>, 241–249.
</p>
<p>Young, D. S. (2014), A Procedure for Approximate Negative Binomial Tolerance Intervals, <em>Journal of Statistical Computation and Simulation</em>, <b>84</b>, 438–450.
</p>


<h3>See Also</h3>

<p><code>NegBinomial</code>, <code>umatol.int</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"> 
## Comparison of 95%/99% 1-sided tolerance limits with
## 50 failures before 10 successes are reached.

negbintol.int(x = 50, n = 10, side = 1, method = "LS")
negbintol.int(x = 50, n = 10, side = 1, method = "WU")
negbintol.int(x = 50, n = 10, side = 1, method = "CB")
negbintol.int(x = 50, n = 10, side = 1, method = "CS")
negbintol.int(x = 50, n = 10, side = 1, method = "SC")
negbintol.int(x = 50, n = 10, side = 1, method = "LR")
negbintol.int(x = 50, n = 10, side = 1, method = "SP")
negbintol.int(x = 50, n = 10, side = 1, method = "CC")

## 95%/99% 1-sided tolerance limits and 2-sided tolerance 
## interval for the same setting above, but when we are 
## interested in a future experiment that requires 20 successes 
## be reached for each trial.

negbintol.int(x = 50, n = 10, m = 20, side = 1)
negbintol.int(x = 50, n = 10, m = 20, side = 2)
</code></pre>


</div>