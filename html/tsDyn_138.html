<div class="container">

<table style="width: 100%;"><tr>
<td>setarTest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Test of linearity against threshold (SETAR)</h2>

<h3>Description</h3>

<p>Test of linearity against threshold of Hansen (1999) with bootstrap
distribution
</p>


<h3>Usage</h3>

<pre><code class="language-R">setarTest(
  x,
  m,
  thDelay = 0,
  trim = 0.1,
  include = c("const", "trend", "none", "both"),
  nboot = 10,
  test = c("1vs", "2vs3"),
  hpc = c("none", "foreach"),
  boot.scheme = c("resample", "resample_block", "wild1", "wild2", "check"),
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>time series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m, thDelay</code></td>
<td>
<p>lag and 'time delay' for the threshold variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trim</code></td>
<td>
<p>trimming parameter indicating the minimal percentage of
observations in each regime</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include</code></td>
<td>
<p>Type of deterministic regressors to include: none, a constant, a trend, or constant and trend (<code>both</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nboot</code></td>
<td>
<p>number of bootstrap replications</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>whether to test AR against SETAR, or SETAR(1 reg) against SETAR(2 reg)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hpc</code></td>
<td>
<p>Possibility to run the bootstrap on parallel core. See details in</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot.scheme</code></td>
<td>
<p>Type of resampling scheme to use for the residuals. See <code>resample_vec</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Seed used in the bootstrap resampling
<code>TVECM.HStest</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Estimation of the first threshold parameter is made with CLS, a conditional
search with one iteration is made for the second threshold. The Ftest
comparing the residual sum of squares (SSR) of each model is computed.
</p>
<p style="text-align: center;"><code class="reqn"> F_{ij}=T( (S_{i}-S_{j})/S_{j} )</code>
</p>

<p>where <code class="reqn">S_{i}</code> is the SSR of the model with i regimes (and so i-1
thresholds).
</p>
<p>Three test are available. The both first can be seen as linearity test,
whereas the third can be seen as a specification test: once the 1vs2 or/and
1vs3 rejected the linearity and henceforth accepted the presence of a
threshold, is a model with one or two thresholds preferable?
</p>
<p>Test <b>1vs</b>2: Linear AR versus 1 threshold TAR
</p>
<p>Test <b>1vs</b>3: Linear AR versus 2 thresholds TAR
</p>
<p>Test <b>2vs3</b>: 1 threshold TAR versus 2 thresholds TAR
</p>
<p>The two first tests are computed together and available with test="1vs". The
third test is available with test="2vs3".
</p>
<p>The homoskedastic bootstrap distribution is based on resampling the
residuals from H0 model (ar for test 1vs, and setar(1) for test 2vs3),
estimating the threshold parameter and then computing the Ftest, so it
involves many computations and is pretty slow.
</p>


<h3>Value</h3>

<p>A object of class "Hansen99Test" containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>SSRs</code></td>
<td>
<p>The residual Sum of squares of model AR, 1 threshold TAR and 2
thresholds TAR</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ftests</code></td>
<td>
<p>The Ftest statistic for the test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PvalBoot</code></td>
<td>
<p>The bootstrap p-values for the test selected</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CriticalValBoot</code></td>
<td>
<p>The critical values for the test selected</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ftestboot</code></td>
<td>
<p>All the F-test computed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>firstBests, secBests</code></td>
<td>
<p>The
thresholds for the original series, obtained from search for 1 thresh
(<code>firstBests</code>) and conditional search for 2 thresh (secBests)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nboot,m</code></td>
<td>
<p>The number of bootstrap replications (<code>nboot</code>), the
lags used (<code>m</code>)</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Matthieu Stigler
</p>


<h3>References</h3>

<p>Hansen (1999) Testing for linearity, Journal of Economic
Surveys, Volume 13, Number 5, December 1999 , pp. 551-576(26) available at:
<a href="http://www.ssc.wisc.edu/~bhansen/papers/cv.htm">http://www.ssc.wisc.edu/~bhansen/papers/cv.htm</a>
</p>


<h3>See Also</h3>

<p><code>TVAR.LRtest</code> for the multivariate version.
<code>SETAR</code> for estimation of the model.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
#Data used by Hansen
sun &lt;- (sqrt(sunspot.year + 1) - 1) * 2

#Test 1vs2 and 1vs3
#setarTest(sun, m=11, thDelay=0:1, nboot=5,trim=0.1, test="1vs")
</code></pre>


</div>