<div class="container">

<table style="width: 100%;"><tr>
<td>thresTH2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Population-based threshold calculation (two-state setting)
</h2>

<h3>Description</h3>

<p>This function estimates the theoretical optimum threshold for the specific distribution parameters, decision costs and disease prevalence in a two-state setting.
</p>


<h3>Usage</h3>

<pre><code class="language-R">thresTH2(dist1, dist2, par1.1, par1.2, par2.1, par2.2, rho,
  costs = matrix(c(0, 0, 1, (1 - rho)/rho), 2, 2, byrow = TRUE), 
  R=NULL, q1 = 0.05, q2 = 0.95, tol = 10^(-8))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dist1</code></td>
<td>

<p>distribution to be assumed for the healthy population. See <b>Details</b>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist2</code></td>
<td>

<p>distribution to be assumed for the diseased population. See <b>Details</b>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par1.1</code></td>
<td>

<p>first parameter of the distribution chosen for the healthy population.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par1.2</code></td>
<td>

<p>second parameter of the distribution chosen for the healthy population.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par2.1</code></td>
<td>

<p>first parameter of the distribution chosen for the diseased population.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par2.2</code></td>
<td>

<p>second parameter of the distribution chosen for the diseased population.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>

<p>disease prevalence.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>costs</code></td>
<td>

<p>cost matrix. Costs should be entered as a 2x2 matrix, where the first row corresponds to the true positive and true negative costs and the second row to the false positive and false negative costs. Default cost values are a combination of costs that yields R=1, which is equivalent to the Youden index method (for details about this concept, see <b>References</b>). It must be set to <code>NULL</code> if the user prefers to set <code>R</code> (see next argument).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>

<p>if the cost matrix <code>costs</code> is not set, R desired (the algorithm will choose a suitable combination of costs that leads to <code>R</code>). Default, <code>NULL</code> (which leads to R=1 using the default <code>costs</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q1</code></td>
<td>

<p>probability of the left distribution in order to determine a low quantile. Default, 0.05.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q2</code></td>
<td>

<p>probability of the right distribution in order to determine a high quantile. Default, 0.95.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>

<p>tolerance to be used in function <code>uniroot</code>. Default, 10^(-8).
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Parameters <code>dist1</code> and <code>dist2</code> can be chosen between the following 2-parameter distributions: <code>"beta"</code>, <code>"cauchy"</code>, <code>"chisq"</code> (chi-squared), <code>"gamma"</code>, <code>"lnorm"</code> (lognormal), <code>"logis"</code> (logistic), <code>"norm"</code> (normal) and <code>"weibull"</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>thresTH2</code>, which is a list with five components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>thres </code></td>
<td>
<p>threshold estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prev </code></td>
<td>
<p>disease prevalence provided by the user.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>costs </code></td>
<td>
<p>cost matrix provided by the user.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R </code></td>
<td>
<p>R term, the product of the non-disease odds and the cost ratio (for further details about this concept, see <b>References</b>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method </code></td>
<td>
<p>method used in the estimation. For an object of class <code>thresTH2</code> it is always equal to <code>"theoretical"</code> (meaning that the population-based method has been used).</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>It is assumed that <code>dist1</code> is the distribution with lower values. If not, <code>dist1</code> and <code>dist2</code> (and the corresponding parameters) are exchanged.
</p>


<h3>References</h3>

<p>Skaltsa K, Jover L, Carrasco JL. (2010). Estimation of the diagnostic threshold accounting for decision costs and sampling uncertainty. Biometrical Journal 52(5):676-697.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># example 1
dist1 &lt;- "norm"
dist2 &lt;- "norm"
par1.1 &lt;- 0
par1.2 &lt;- 1
par2.1 &lt;- 2
par2.2 &lt;- 1
rho &lt;- 0.1

thresTH2(dist1, dist2, par1.1, par1.2, par2.1, par2.2, rho)


# example 2
dist1 &lt;- "norm"
dist2 &lt;- "lnorm"
par1.1 &lt;- 0
par1.2 &lt;- 1
par2.1 &lt;- 1
par2.2 &lt;- 0.5
rho &lt;- 0.3

thresTH2(dist1, dist2, par1.1, par1.2, par2.1, par2.2, rho)
</code></pre>


</div>