<div class="container">

<table style="width: 100%;"><tr>
<td>anorm_cd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Array normal conditional distributions.</h2>

<h3>Description</h3>

<p>Conditional mean and variance of a subarray.
</p>


<h3>Usage</h3>

<pre><code class="language-R">anorm_cd(Y, M, S, saidx)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>A real valued array.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>Mean of <code>Y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>List of mode-specific covariance matrices of <code>Y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>saidx</code></td>
<td>
<p>List of indices for indexing sub-array for which the conditional
mean and variance should be computed. For example, <code>said_x = list(1:2,
1:2, 1:2)</code> will compute the conditional means and variances for the <code class="reqn">2</code>
by <code class="reqn">2</code> by <code class="reqn">2</code> sub-array Y[1:2, 1:2, 1:2]. This is conditional on
every other element in <code>Y</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function calculates the conditional mean and variance in the array
normal model. Let <code class="reqn">Y</code> be array normal and let <code class="reqn">Y_a</code> be a subarray of
<code class="reqn">Y</code>. Then this function will calculate the conditional means and
variances of <code class="reqn">Y_a</code>, conditional on every other element in <code class="reqn">Y</code>.
</p>


<h3>Author(s)</h3>

<p>Peter Hoff.
</p>


<h3>References</h3>

<p>Hoff, P. D. (2011).
<a href="http://doi.org/10.1214/11-BA606">Separable covariance arrays via the
Tucker product, with applications to multivariate relational data</a>.
<em>Bayesian Analysis</em>, 6(2), 179-196.
</p>


<h3>Examples</h3>

<pre><code class="language-R">p &lt;- c(4, 4, 4)
Y &lt;- array(stats::rnorm(prod(p)), dim = p)
saidx &lt;- list(1:2, 1:2, 1:2)
true_cov &lt;- tensr::start_ident(p)
true_mean &lt;- array(0, dim = p)
cond_params &lt;- anorm_cd(Y = Y, M = true_mean, S = true_cov, saidx = saidx)

## Since data are independent standard normals, conditional mean is 0 and
##    conditional covariance matrices are identities.
cond_params$Mab
cond_params$Sab
</code></pre>


</div>