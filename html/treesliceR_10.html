<div class="container">

<table style="width: 100%;"><tr>
<td>CpR_sensitivity</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Runs a sensitivity analysis for rates of accumulation of a given phylogenetic index</h2>

<h3>Description</h3>

<p>This function allows the evaluation of the sensitivity of the estimated rates of accumulation of a given phylogenetic index (e.g., <code>CpD()</code>, <code>CpE()</code>, <code>CpB()</code>, <code>CpB_RW()</code>) to the number of slices inputted by the user.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CpR_sensitivity(tree, vec, mat, adj, rate, samp, comp, method, criterion, ncor)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>phylo. An ultrametric phylogenetic tree in the "phylo" format.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vec</code></td>
<td>
<p>numeric vector. A numeric vector containing a series of numbers of slices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mat</code></td>
<td>
<p>matrix. A presence/absence matrix containing all studied species and sites.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adj</code></td>
<td>
<p>matrix. A square adjacency matrix containing the presence/absence information of all sites and their spatially adjacent ones.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate</code></td>
<td>
<p>character string. The desired cumulative phylogenetic rate to be assessed, which can be the phylogenetic diversity (CpD), phylogenetic endemism (CpE), phylogenetic B-diversity (CpB), or phylogenetic B-diversity range-weighted (CpB_RW). Default is NULL, but must be filled with "CpD", "CPE", "CpB_RW", or "CpB".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samp</code></td>
<td>
<p>numeric. The number of assemblages, or sites, to be sampled to make the sensitivity analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>comp</code></td>
<td>
<p>character string. The component of beta-diversity that the user wants to calculate the CpB. It can be either "sorensen", turnover" or "nestedness". This argument works only when "rate = CpB". Default is "sorensen".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>character string. The method for calculating the CpB-rate. It can be either "pairwise" or "multisite". This argument works only when the argument "rate" is set to run for "CpB" or "CpB_RW". Default is "multisite".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion</code></td>
<td>
<p>character string. The method for cutting the tree. It can be either "my" (million years) or "PD" (accumulated phylogenetic diversity). Default is "my".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncor</code></td>
<td>
<p>numeric. A value indicating the number of cores the user wants to parallelize. Default is 0.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><b>Parallelization</b>
</p>
<p>Users are advised to check the number of available cores within their machines before running parallel programming.
</p>
<p><b>Plotting</b>
</p>
<p>For plotting the sensitivity analysis output users can use <code>CpR_sensitivity_plot()</code>.
</p>


<h3>Value</h3>

<p>This function returns a data frame containing the sensitivity analysis for a given rate of accumulation of a phylogenetic index. This outputted data frame contains, for each row or assemblage, a column with the rate value assessed for each inputted number of slices.
</p>


<h3>Author(s)</h3>

<p>Matheus Lima de Araujo <a href="mailto:matheusaraujolima@live.com">matheusaraujolima@live.com</a>
</p>


<h3>References</h3>

<p>See the tutorial on how to use this function on our <a href="https://araujomat.github.io/treesliceR/articles/Passeriformes-diversification.html">website</a>.
</p>


<h3>See Also</h3>

<p>Other cumulative phylogenetic index rate analysis: <code>CpD()</code>, <code>CpE()</code>, <code>CpB()</code>, <code>CpB_RW()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Generate a random tree
tree &lt;- ape::rcoal(20)

# Create a presence-absence matrix
mat &lt;- matrix(sample(c(1,0), 20*10, replace = TRUE), ncol = 20, nrow = 10)
colnames(mat) &lt;- tree$tip.label

# Calculate the CpD for 100 tree slices
CpD(tree, n = 100, mat = mat)

# Create a vector of number of slices
vec &lt;- c(25, 50, 75, 100, 125, 150)

# Calculate the sensitivity of the CpD
CpR_sensitivity(tree, vec, mat, rate = "CpD", samp = 5)

</code></pre>


</div>