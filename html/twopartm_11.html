<div class="container">

<table style="width: 100%;"><tr>
<td>plot-methods</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Method for Function <code>plot</code> for Two-part Model Objects in Package <span class="pkg">twopartm</span>
</h2>

<h3>Description</h3>

<p>The <code>plot</code> method for <code>twopartm-class</code> that provides plot diagnostics for a fitted two-part regression model object of class <code>twopartm</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'twopartm,missing'
plot(x, y, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>twopartm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>not used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments passed to <code>plot.lm</code> in the default setup.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>plot</code> method for <code>twopartm-class</code> returns the residual plot for the full two-part model, and also six plots for each part's glm model. Six plots are: a plot of residuals against fitted values, a Scale-Location plot of sqrt(| residuals |) against fitted values, a Normal Q-Q plot, a plot of Cook's distances versus row labels, a plot of residuals against leverages, and a plot of Cook's distances against leverage/(1-leverage). By default, the first three plots and the fifth one of each part's model are provided. The plots for each part's model could be selected by argument <code>which</code> of function <code>plot.lm</code> for glm model object.
</p>


<h3>Value</h3>

<p>Returns residual plot for the full two-part model, and plot diagnostics for each part's model from an object <code>twopartm</code>.
</p>


<h3>Author(s)</h3>

<p>Yajie Duan, Birol Emir, Griffith Bell and Javier Cabrera</p>


<h3>References</h3>

<p>Belotti, F., Deb, P., Manning, W.G. and Norton, E.C. (2015). twopm: Two-part models.
<em>The Stata Journal</em>, 15(1), pp.3-20.
</p>
<p>Belsley, D. A., Kuh, E. and Welsch, R. E. (1980). <em>Regression Diagnostics</em>. New York: Wiley.
</p>
<p>Cook, R. D. and Weisberg, S. (1982). <em>Residuals and Influence in Regression</em>. London: Chapman and Hall.
</p>


<h3>See Also</h3>

<p><code>twopartm-class</code>, <code>glm</code>,<code>plot.lm</code>, <code>tpm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
##data about health expenditures, i.e., non-negative continuous response
data(meps,package = "twopartm")


##fit two-part model with the same regressors in both parts, with logistic
##regression model for the first part, and glm with Gamma family with log
##link for the second-part model
tpmodel = tpm(exp_tot~female+age, data = meps,link_part1 = "logit",
family_part2 = Gamma(link = "log"))

tpmodel

##summary information
summary(tpmodel)

##plots for two-part model
plot(tpmodel)

</code></pre>


</div>