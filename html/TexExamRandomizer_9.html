<div class="container">

<table style="width: 100%;"><tr>
<td>ConstructAnswerSheet</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>ConstructAnswerSheet</h2>

<h3>Description</h3>

<p>Constructs an answer sheet given a document as generated by <code>StructureDocument</code> by finding in the items the correct and wrong tags and describing where it found them.
</p>
<p>Note that you must provide the document part only, <code>StructureDocument</code> gives back a <code>$preamble</code> and <code>$document</code>.
</p>
<p>If <code>wrongTag</code> is left <code>NULL</code>, the answer sheet only shows information of the correct answers.
</p>
<p>This answer sheet provides information for what answers are correct or incorrect, as well as their position within the original document, before any shuffling was done. (It uses the names of the document to decide whether the document was shuffled or not, since subsetting a list removes all attributes except for the names, this is the "safest" way to do it)
</p>
<p>The intent of this function is to make it easy to find the answers for a randomized version of an exam.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ConstructAnswerSheet(Document, correctTag, wrongTag = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Document</code></td>
<td>
<p>Document, as defined in <code>StructureDocument</code>. Remember however that the function <code>StructureDocument</code> returns the document and the preamble together in a list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correctTag</code></td>
<td>
<p>Tag to identify the correct items.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wrongTag</code></td>
<td>
<p>Tag that identifies the wrong items.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The tags are just command of the type "<code>\Tag</code>" that must be found somewhere that is not commented out inside the last item at the end of the tree structure. Usually you will want to use the tags that already identify the document items for this.
</p>
<p>(For example, in the exam class, the tags <code>\choice</code> and <code>\CorrectChoice</code> could be used naturally, without having to introduce extra commands in the document)
</p>


<h3>Value</h3>

<p>Data Frame. With the following columns
</p>

<dl>
<dt>index</dt>
<dd>
<p>Just an index running from 1 to <code class="reqn">n</code>, where <code class="reqn">n</code> is the numbe of rows</p>
</dd>
<dt>For each layer of depth in the document:</dt>
<dd>
<p>Four columns,
</p>

<dl>
<dt><code>&lt;name of section&gt;_original</code></dt>
<dd>
<p>Contains an integer identifying the numbering of this section in the original layer, as identified by the naming convention</p>
</dd>
<dt><code>&lt;name of section command&gt;_original</code></dt>
<dd>
<p>Contains an integer identifying the numbering of this item in the original section, as identified by the naming convention</p>
</dd>
<dt><code>&lt;name of section&gt;</code></dt>
<dd>
<p>Contains an integer identifying the numbering of this section in the current layer, as identified by the ordering of the  document inputted on this function</p>
</dd>
<dt><code>&lt;name of section command&gt;</code></dt>
<dd>
<p>Contains an integer identifying the numbering of this item in the current section, as identified by the ordering of the  document inputted on this function</p>
</dd>
</dl>
</dd>
<dt>For the last layer of depth</dt>
<dd>
<p>5 columns if the wrongTag is not NULL, 4 columns otherwise,
</p>

<dl>
<dt><code>&lt;name of section&gt;_original</code></dt>
<dd>
<p>Contains an integer identifying the numbering of this section in the original layer, as identified by the naming convention</p>
</dd>
<dt><code>&lt;name of section command&gt;_original</code></dt>
<dd>
<p>Contains an integer identifying the numbering of this item in the original section, as identified by the naming convention</p>
</dd>
<dt><code>&lt;name of section&gt;</code></dt>
<dd>
<p>Contains an integer identifying the numbering of this section in the current layer, as identified by the ordering of the  document inputted on this function</p>
</dd>
<dt><code>&lt;correctTag&gt;</code></dt>
<dd>
<p>Contains an integer identifying the numbering of this item in the current section, , as identified by the ordering of the  document inputted on this function
</p>
<p>If the <code>correctTag</code> wasn't found in this item, it will show <code>NA</code> instead. (This will only happen if <code>wrongTag</code> is not <code>NULL</code>, since otherwise this elements are omitted)</p>
</dd>
<dt><code>&lt;wrongTag&gt;</code></dt>
<dd>
<p>Contains an integer identifying the numbering of this item in the current section, as identified by the ordering of the  document inputted on this function
</p>
<p>If the <code>wrongTag</code> wasn't found in this item, it will show <code>NA</code> instead. (This will only happen if <code>wrongTag</code> is not <code>NULL</code>, since otherwise this elements are omitted)</p>
</dd>
</dl>
</dd>
</dl>
<h3>See Also</h3>

<p><code>FindExamAnswers</code> for the exact underlying messy algorithm that controls how the table is created.
</p>
<p>Other Extracting information: 
<code>CountNumberOfSections()</code>,
<code>FindExamAnswers()</code>,
<code>GenerateShortAnswerSheet()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
ConstructAnswerSheet(
    TexExamRandomizer::testdoc$document,
    "CorrectChoice",
    "choice"
)
</code></pre>


</div>