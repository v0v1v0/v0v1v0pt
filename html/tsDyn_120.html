<div class="container">

<table style="width: 100%;"><tr>
<td>rank.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Test of the cointegrating rank</h2>

<h3>Description</h3>

<p>Maximum-likelihood test of the cointegrating rank.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rank.test(vecm, type = c("eigen", "trace"), r_null, cval = 0.05)

## S3 method for class 'rank.test'
print(x, ...)

## S3 method for class 'rank.test'
summary(object, digits = max(1, getOption("digits") - 3), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>vecm</code></td>
<td>
<p>‘VECM’ object computed with the function
<code>VECM</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Type of test, either 'trace' or 'eigenvalue'. See details below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r_null</code></td>
<td>
<p>Rank to test specifically.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cval</code></td>
<td>
<p>Critical value level for the automatic test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The output from <code>rank.test</code> for the print method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Unused.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>The output from <code>rank.test</code> for the summary method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>The number of digits to use in <code>format.pval</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function computes the two maximum-likelihood tests for the cointegration
rank from Johansen (1996). Tests are: </p>
 <dl>
<dt>trace</dt>
<dd>
<p>Test the
hypothesis of rank ‘h’ against rank ‘K’, i.e. against the
alternative that the system is stationary.</p>
</dd> <dt>eigenvalue</dt>
<dd>
<p>Test the
hypothesis of rank ‘h’ against rank ‘h+1’.</p>
</dd> </dl>
<p>The test works for five specifications of the deterministic terms as in
Doornik et al (1998), to be specified in the previous call to
<code>VECM</code>: </p>
 <dl>
<dt>H_ql</dt>
<dd>
<p>Unrestricted constant and trend:
use <code>include="both"</code> </p>
</dd> <dt>H_l</dt>
<dd>
<p>Unrestricted constant and restricted
trend: use <code>include="const"</code></p>
</dd>
</dl>
<p> and <code>LRinclude="trend"</code>
</p>
<dl>
<dt>H_lc</dt>
<dd>
<p>Unrestricted constant and no trend: use <code>include="const"</code></p>
</dd>
<dt>H_c</dt>
<dd>
<p>Restricted constant and no trend: use <code>LRinclude="const"</code></p>
</dd>
<dt>H_z</dt>
<dd>
<p>No constant nor trend: use <code>include="none"</code></p>
</dd> </dl>
<p>Two testing procedures can be used: </p>
 <dl>
<dt>Specific test</dt>
<dd>
<p>By
specifying a value for ‘r_null’. The ‘pval’ value returned
gives the speciifc p-value.</p>
</dd> <dt>Automatic test</dt>
<dd>
<p>If not value is specified
for ‘r_null’, the function makes a simple automatic test: returns the
rank (slot ‘r’) of the first test not rejected (level specified by arg
<code>cval</code>) as recommend i.a. in Doornik et al (1998, p. 544).</p>
</dd> </dl>
<p>A full table with both test statistics ad their respective p-values is given
in the summary method.
</p>
<p>P-values are obtained from the gamma approximation from Doornik (1998, 1999).
Small sample values adjusted for the sample site are also available in the
summary method.  Note that the ‘effective sample size’ for the these
values is different from output in gretl for example.
</p>


<h3>Value</h3>

<p>An object of class ‘rank.test’, with ‘print’ and
‘summary methods’.
</p>


<h3>Comparison with urca</h3>

<p>While <code>ca.jo</code> in package
<span class="pkg">urca</span> and <code>rank.test</code> both implement Johansen tests, there are a
few differences:
</p>
 <ul>
<li> <p><code>rank.test</code> gives p-values, while <code>ca.jo</code> gives
only critical values.  </p>
</li>
<li> <p><code>rank.test</code> allows for five different
specifications of deterministic terms (see above), <code>ca.jo</code> for only
three.  </p>
</li>
<li> <p><code>ca.jo</code> allows for seasonal and exogenous regressors,
which is not available in <code>rank.test</code>.  </p>
</li>
<li>
<p> The lag is specified
differently: <code>K</code> from <code>ca.jo</code> corresponds to <code>lag</code>+1 in
<code>rank.test</code>.  </p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Matthieu Stigler
</p>


<h3>References</h3>

<p>- Doornik, J. A. (1998) Approximations to the Asymptotic
Distributions of Cointegration Tests, Journal of Economic Surveys, 12, 573-93
</p>
<p>- Doornik, J. A. (1999) Erratum [Approximations to the Asymptotic
Distribution of Cointegration Tests], Journal of Economic Surveys, 13, i
</p>
<p>- Doornik, Hendry and Nielsen (1998) Inference in Cointegrating Models: UK M1
Revisited, Journal of Economic Surveys, 12, 533-72
</p>
<p>- Johansen, S. (1996) Likelihood-based inference in cointegrated Vector
Autoregressive Models, Oxford University Press
</p>


<h3>See Also</h3>

<p><code>VECM</code> for estimating a VECM. <code>rank.select</code>
to estimate the rank based on information criteria.
</p>
<p><code>ca.jo</code> in package <span class="pkg">urca</span> for another implementation of
Johansen cointegration test (see section ‘Comparison with urca’ for
more infos).
</p>


<h3>Examples</h3>

<pre><code class="language-R">

data(barry)

## estimate the VECM with Johansen! 
ve &lt;- VECM(barry, lag=1, estim="ML")

## specific test:
ve_test_spec &lt;- rank.test(ve, r_null=1)
ve_test_spec_tr &lt;- rank.test(ve, r_null=1, type="trace")

ve_test_spec
ve_test_spec_tr

## No specific test: automatic method
ve_test_unspec &lt;- rank.test(ve)
ve_test_unspec_tr &lt;- rank.test(ve, type="trace")

ve_test_unspec
ve_test_unspec_tr

## summary method: output will be same for all types/test procedure:
summary(ve_test_unspec_tr)

## The function works for many specification of the VECM(), try:
rank.test(VECM(barry, lag=3, estim="ML"))
rank.test(VECM(barry, lag=3, include="both",estim="ML"))
rank.test(VECM(barry, lag=3, LRinclude="const",estim="ML"))

## Note that the tests are simple likelihood ratio, and hence can be obtained also manually:
-2*(logLik(ve, r=1)-logLik(ve, r=2)) # eigen test, 1 against 2
-2*(logLik(ve, r=1)-logLik(ve, r=3)) # eigen test, 1 against 3

</code></pre>


</div>