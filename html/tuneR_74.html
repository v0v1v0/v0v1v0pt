<div class="container">

<table style="width: 100%;"><tr>
<td>periodogram-methods</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Periodogram (Spectral Density) Estimation on Wave objects</h2>

<h3>Description</h3>

<p>This function estimates one or more periodograms (spectral densities) 
of the time series contained in an object of class <code>Wave</code> or <code>WaveMC</code> (or directly in a Wave file)
using a window running through the time series (possibly with overlapping).
It returns an object of class <code>Wspec</code>.</p>


<h3>Usage</h3>

<pre><code class="language-R">periodogram(object, ...)
## S4 method for signature 'WaveGeneral'
periodogram(object, width = length(object), overlap = 0,
    starts = NULL, ends = NULL, taper = 0, normalize = TRUE, 
    frqRange = c(-Inf, Inf), ...)
## S4 method for signature 'character'
periodogram(object, width, overlap = 0, from = 1, to = Inf, 
    units = c("samples", "seconds", "minutes", "hours"), 
    downsample = NA, channel = c("left", "right"), pieces = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of class <code>Wave</code>, <code>WaveMC</code>, or a character string pointing to a Wave file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>A window of width ‘<code>width</code>’ running through the time series selects the samples 
from which the periodograms are to be calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overlap</code></td>
<td>
<p>The window can be applied by each overlapping <code>overlap</code> samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>starts</code></td>
<td>
<p>Start number (in samples) for a window.
If not given, this value is derived from argument <code>ends</code>,
or will be derived <code>width</code> and <code>overlap</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ends</code></td>
<td>
<p>End number (in samples) for a window.
If not given, this value is derived from argument <code>starts</code>,
or will be derived from <code>width</code> and <code>overlap</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taper</code></td>
<td>
<p>proportion of data to taper. See <code>spec.pgram</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalize</code></td>
<td>
<p>Logical; if <code>TRUE</code> (default), two steps will be applied:
(i) the input signal will be normalized to amplitude <code>max(abs(amplitude)) == 1</code>,
(ii) the resulting <code>spec</code> values will be normalized to sum up to one for each periodogram.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frqRange</code></td>
<td>
<p>Numeric vector of two elements indicating minimum and maximum of the frequency range 
that is to be stored in the resulting object. This is useful to reduce memory consumption.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>from</code></td>
<td>
<p>Where to start reading in the Wave file, in <code>units</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>to</code></td>
<td>
<p>Where to stop reading in the Wave file, in <code>units</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>units</code></td>
<td>
<p>Units in which <code>from</code> and <code>to</code> is given, the default is “samples”,
but can be set to time intervals such as “seconds”, see the Usage Section above.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>downsample</code></td>
<td>
<p>Sampling rate the object is to be downsampled to.
If <code>NA</code>, the default, no changes are applied. Otherwise <code>downsample</code> must be in <code>[2000, 192000]</code>; 
typical values are 11025, 22050, and 44100 for CD quality. See also <code>downsample</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>channel</code></td>
<td>
<p>Character, indicating whether the “left” or “right” channel should be extracted 
(see <code>mono</code> for details) - stereo processing is not yet implemented.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pieces</code></td>
<td>
<p>The Wave file will be read in in <code>pieces</code> steps in order to reduce the amount 
of required memory.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed to the underlying function <code>spec.pgram</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>Wspec</code> is returned containing the following slots.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>freq</code></td>
<td>
<p>Vector of frequencies at which the spectral density is estimated. 
See <code>spectrum</code> for details. (1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spec</code></td>
<td>
<p>List of vectors or matrices of the <code>spec</code> values returned by <code>spec.pgram</code>
at frequencies corresponding to <code>freq</code>.
Each element of the list corresponds to one periodogram estimated from samples of the window
beginning at <code>start</code> of the <code>Wave</code> or <code>WaveMC</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel</code></td>
<td>
<p>The kernel argument, or the kernel constructed from spans returned by <code>spec.pgram</code>. (1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>The distribution of the spectral density estimate can be approximated by a chi square distribution with 
<code>df</code> degrees of freedom. (1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taper</code></td>
<td>
<p>The value of the <code>taper</code> argument. (1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>The value of the <code>width</code> argument. (1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overlap</code></td>
<td>
<p>The value of the <code>overlap</code> argument. (1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalize</code></td>
<td>
<p>The value of the <code>normalize</code> argument. (1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>starts</code></td>
<td>
<p>If the argument <code>starts</code> was given in the call, its value.
If the argument <code>ends</code> was given in the call, ‘<code>ends - width</code>’.
If neither <code>starts</code> nor <code>ends</code> was given, the start points of all periodograms.
In the latter case the start points are calculated from the arguments <code>width</code> and <code>overlap</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stereo</code></td>
<td>
<p>Always <code>FALSE</code> (for back compatibility). (1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samp.rate</code></td>
<td>
<p>Sampling rate of the underlying <code>Wave</code> or <code>WaveMC</code> <code>object</code>. (1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variance</code></td>
<td>
<p>The variance of samples in each window, corresponding to amplitude / loudness of sound.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>energy</code></td>
<td>
<p>The “energy” <code class="reqn">E</code>, also an indicator for the amplitude / loudness of sound:
</p>
<p style="text-align: center;"><code class="reqn">E(x_I) := 20 * log_{10} \sum_{j\in I}|x_j|,</code>
</p>

<p>where <code class="reqn">I</code> indicates the interval <code class="reqn">I:=</code> <code>start[i]:end[i]</code> for all 
<code class="reqn">i:=1,\dots,</code> <code>length(starts)</code>.
</p>
</td>
</tr>
</table>
<p>Those slots marked with “(1)” contain the information once, 
because it is unique for all periodograms of estimated by the function call.
</p>


<h3>Note</h3>

<p>Support for processing more than one channel of <code>Wave</code> or <code>WaveMC</code> objects has not yet been implemented.
</p>


<h3>Author(s)</h3>

<p>Uwe Ligges <a href="mailto:ligges@statistik.tu-dortmund.de">ligges@statistik.tu-dortmund.de</a></p>


<h3>See Also</h3>


<ul>
<li>
<p> for the resulting objects' class: <code>Wspec</code>,
</p>
</li>
<li>
<p> for plotting: <code>plot-Wspec</code>,  
</p>
</li>
<li>
<p> for the underlying periodogram calculations: <code>spec.pgram</code>,
</p>
</li>
<li>
<p> for the input data class: Wave-class, <code>Wave</code>, WaveMC-class, <code>WaveMC</code>.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R"># constructing a Wave object (1 sec.) containing sinus sound with 440Hz:
Wobj &lt;- sine(440)
Wobj

# Calculate periodograms in windows of 4096 samples each - without
#   any overlap - resulting in an Wspec object that is printed:
Wspecobj &lt;- periodogram(Wobj, width = 4096)
Wspecobj

# Plot the first periodogram from Wspecobj:
plot(Wspecobj)
# Plot the third one and choose a reasonable xlim:
plot(Wspecobj, which = 3, xlim = c(0, 1000))
# Mark frequency that has been generated before:
abline(v = 440, col="red")
# plot the spectrogram
image(Wspecobj, ylim=c(0, 2000))

# same again with normalize = FALSE and with logarithmic y-axis plotted:
Wspecobj2 &lt;- periodogram(Wobj, width = 4096, normalize = FALSE)
Wspecobj2

plot(Wspecobj2, which = 3, xlim = c(0, 1000), log="y")
abline(v = 440, col="red")
image(Wspecobj2, ylim=c(0, 2000), log="z")


FF(Wspecobj)              # all ~ 440 Hertz
noteFromFF(FF(Wspecobj))  # all diapason a
</code></pre>


</div>