<div class="container">

<table style="width: 100%;"><tr>
<td>anovatol.int</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Tolerance Intervals for ANOVA</h2>

<h3>Description</h3>

<p>Tolerance intervals for each factor level in a balanced (or nearly-balanced) ANOVA.
</p>


<h3>Usage</h3>

<pre><code class="language-R">anovatol.int(lm.out, data, alpha = 0.05, P = 0.99, side = 1,
             method = c("HE", "HE2", "WBE", "ELL", "KM", 
             "EXACT", "OCT"), m = 50)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>lm.out</code></td>
<td>
<p>An object of class <code>lm</code> (i.e., the results from the linear model fitting routine such that
the <code>anova</code> function can act upon).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame consisting of the data fitted in <code>lm.out</code>.  Note that <code>data</code> must have one
column for each main effect (i.e., factor) that is analyzed in <code>lm.out</code> and that these columns must be of
class <code>factor</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The level chosen such that <code>1-alpha</code> is the confidence level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>The proportion of the population to be covered by this tolerance interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>side</code></td>
<td>
<p>Whether a 1-sided or 2-sided tolerance interval is required (determined by <code>side = 1</code> or <code>side = 2</code>,
respectively).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The method for calculating the k-factors.  The k-factor for the 1-sided tolerance intervals
is performed exactly and thus is the same for the chosen method.  <code>"HE"</code> is the
Howe method and is often viewed as being extremely accurate, even for small sample sizes. <code>"HE2"</code> is a second method due to Howe, which performs similarly to the Weissberg-Beatty method, but is computationally simpler.  <code>"WBE"</code> is the 
Weissberg-Beatty method (also called the Wald-Wolfowitz method), which performs similarly to the first Howe method for larger sample sizes. <code>"ELL"</code> is
the Ellison correction to the Weissberg-Beatty method when <code>f</code> is appreciably larger than <code>n^2</code>. A warning
message is displayed if <code>f</code> is not larger than <code>n^2</code>. <code>"KM"</code> is the Krishnamoorthy-Mathew approximation to the exact solution, which works well for larger sample sizes. <code>"EXACT"</code> computes the 
k-factor exactly by finding the integral solution to the problem via the <code>integrate</code> function.  Note the computation time of this method is largely determined by <code>m</code>. <code>"OCT"</code> is the Owen approach 
to compute the k-factor when controlling the tails so that there is not more than (1-P)/2  of the data in each tail of the distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>The maximum number of subintervals to be used in the <code>integrate</code> function.  This is necessary only for <code>method = "EXACT"</code> and <code>method = "OCT"</code>.  The larger
the number, the more accurate the solution.  Too low of a value can result in an error. A large value can also cause the function to be slow for <code>method = "EXACT"</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>anovatol.int</code> returns a list where each element is a data frame corresponding to each main effect (i.e.,
factor) tested in the ANOVA and the rows of each data frame are the levels of that factor.  The columns of each data
frame report the following:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>
<p>The mean for that factor level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The effective sample size for that factor level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>The k-factor for constructing the respective factor level's tolerance interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>1-sided.lower</code></td>
<td>
<p>The 1-sided lower tolerance bound.  This is given only if <code>side = 1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>1-sided.upper</code></td>
<td>
<p>The 1-sided upper tolerance bound.  This is given only if <code>side = 1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>2-sided.lower</code></td>
<td>
<p>The 2-sided lower tolerance bound.  This is given only if <code>side = 2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>2-sided.upper</code></td>
<td>
<p>The 2-sided upper tolerance bound.  This is given only if <code>side = 2</code>.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Howe, W. G. (1969), Two-Sided Tolerance Limits for Normal Populations - Some Improvements, <em>Journal of the
American Statistical Association</em>, <b>64</b>, 610–620.
</p>
<p>Weissberg, A. and Beatty, G. (1969), Tables of Tolerance Limit Factors for Normal Distributions, <em>Technometrics</em>,
<b>2</b>, 483–500.
</p>


<h3>See Also</h3>

<p><code>K.factor</code>, <code>normtol.int</code>, <code>lm</code>, <code>anova</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"> 
## 90%/95% 2-sided tolerance intervals for a 2-way ANOVA 
## using the "warpbreaks" data.

attach(warpbreaks)

lm.out &lt;- lm(breaks ~ wool + tension)
out &lt;- anovatol.int(lm.out, data = warpbreaks, alpha = 0.10,
                    P = 0.95, side = 2, method = "HE")
out

plottol(out, x = warpbreaks)
</code></pre>


</div>