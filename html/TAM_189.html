<div class="container">

<table style="width: 100%;"><tr>
<td>tam.latreg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Latent Regression Model
</h2>

<h3>Description</h3>

<p>This function fits a latent regression model <code class="reqn">\bold{\theta}=\bold{Y}
\bold{\beta} + \bold{\varepsilon}</code>.
Only the individual likelihood evaluated at a
<code class="reqn">\bold{\theta}</code> grid is needed as the input. Like in
<code>tam.mml</code> a multivariate normal distribution is posed
on the residual distribution. Plausible values can be drawn by subsequent
application of <code>tam.pv</code> (see Example 1).
</p>


<h3>Usage</h3>

<pre><code class="language-R">tam.latreg(like, theta=NULL, Y=NULL, group=NULL, formulaY=NULL, dataY=NULL,
   beta.fixed=FALSE, beta.inits=NULL, variance.fixed=NULL,
   variance.inits=NULL, est.variance=TRUE, pweights=NULL, pid=NULL,
   userfct.variance=NULL, variance.Npars=NULL, verbose=TRUE, control=list())

## S3 method for class 'tam.latreg'
summary(object,file=NULL,...)

## S3 method for class 'tam.latreg'
print(x,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>like</code></td>
<td>

<p>Individual likelihood. This can be typically extracted from fitted
item response models by making use of <code>IRT.likelihood</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>

<p>Used <code class="reqn">\bold{\theta}</code> grid in the fitted IRT model. If <code>like</code>
is generated by the <code>IRT.likelihood</code> function, then <code>theta</code>
is automatically extracted as an attribute.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>

<p>A matrix of covariates in latent regression. Note that the
intercept is automatically included as the first predictor.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>

<p>An optional vector of group identifiers
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formulaY</code></td>
<td>

<p>An <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> formula for latent regression. Transformations of predictors
in <code class="reqn">Y</code> (included in <code>dataY</code>) can be easily specified,
e. g. <code>female*race</code> or <code>I(age^2)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataY</code></td>
<td>

<p>An optional data frame with possible covariates <code class="reqn">Y</code> in latent regression.
This data frame will be used if an <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> formula in <code>formulaY</code>
is specified.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.fixed</code></td>
<td>

<p>A matrix with three columns for fixing regression coefficients.
1st column: Index of <code class="reqn">Y</code> value, 2nd column: dimension,
3rd column: fixed <code class="reqn">\beta</code> value. <br>
If no constraints should be imposed on <code class="reqn">\beta</code>, then
set <code>beta.fixed=FALSE</code> (see Example 2, Model <code>2_4</code>)
which is the default.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.inits</code></td>
<td>

<p>A matrix (same format as in <code>beta.fixed</code>)
with initial <code class="reqn">\beta</code> values
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variance.fixed</code></td>
<td>

<p>An optional matrix with three columns for fixing
entries in covariance matrix:
1st column: dimension 1, 2nd column: dimension 2,
3rd column: fixed value
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variance.inits</code></td>
<td>

<p>Initial covariance matrix in estimation. All matrix entries have to be
specified and this matrix is NOT in the same format like
<code>variance.inits</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est.variance</code></td>
<td>

<p>Should the covariance matrix be estimated? This argument
applies to estimated item slopes in <code>tam.mml.2pl</code>.
The default is <code>FALSE</code> which means that latent
variables (in the first group) are standardized in 2PL estimation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pweights</code></td>
<td>

<p>An optional vector of person weights
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pid</code></td>
<td>

<p>An optional vector of person identifiers
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>userfct.variance</code></td>
<td>
<p>Optional user customized function for variance specification
(See Simulated Example 17).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variance.Npars</code></td>
<td>
<p>Number of estimated parameters of variance matrix
if a <code>userfct.variance</code> is provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>Optional logical indicating whether iteration should be displayed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>

<p>List of control parameters, see <code>tam.mml</code> fro details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>Object of class <code>tam.latreg</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>

<p>A file name in which the summary output will be written
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Object of class <code>tam.latreg</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Further arguments to be passed
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Subset of values of <code>tam.mml</code>. In addition,
means (<code>M_post</code>) and standard deviations (<code>SD_post</code>) are computed.
</p>


<h3>See Also</h3>

<p>See also <code>tam.pv</code> for plausible value imputation.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
#############################################################################
# EXAMPLE 1: Unidimensional latent regression model with fitted IRT model in
#            the sirt package
#############################################################################

library(sirt)
data(data.pisaRead, package="sirt")
dat &lt;- data.pisaRead$data

items &lt;- grep("R4", colnames(dat), value=TRUE )    # select test items from data
# define testlets
testlets &lt;- substring( items, 1, 4 )
itemcluster &lt;- match( testlets, unique(testlets) )
# fit Rasch copula model (only few iterations)
mod &lt;- sirt::rasch.copula2( dat[,items], itemcluster=itemcluster, mmliter=5)
# extract individual likelihood
like1 &lt;- IRT.likelihood( mod )
# fit latent regression model in TAM
Y &lt;- dat[, c("migra", "hisei", "female") ]
mod2 &lt;- TAM::tam.latreg( like1, theta=attr(like1, "theta"), Y=Y, pid=dat$idstud )
summary(mod2)
# plausible value imputation
pv2 &lt;- TAM::tam.pv( mod2 )
# create list of imputed datasets
Y &lt;- dat[, c("idstud", "idschool", "female", "hisei", "migra") ]
pvnames &lt;- c("PVREAD")
datlist &lt;- TAM::tampv2datalist( pv2, pvnames=pvnames, Y=Y, Y.pid="idstud")

#--- fit some models
library(mice)
library(miceadds)
# convert data list into a mice object
mids1 &lt;- miceadds::datalist2mids( datlist )
# perform an ANOVA
mod3a &lt;- with( mids1, stats::lm(PVREAD ~ hisei*migra) )
summary( pool( mod3a ))
mod3b &lt;- miceadds::mi.anova( mids1, "PVREAD ~ hisei*migra" )

#############################################################################
# EXAMPLE 2: data.pisaRead - fitted IRT model in mirt package
#############################################################################

library(sirt)
library(mirt)

data(data.pisaRead, package="sirt")
dat &lt;- data.pisaRead$data

# define dataset with item responses
items &lt;- grep("R4", colnames(dat), value=TRUE )
resp &lt;- dat[,items]
# define dataset with covariates
X &lt;- dat[, c("female","hisei","migra") ]

# fit 2PL model in mirt
mod &lt;- mirt::mirt( resp, 1, itemtype="2PL", verbose=TRUE)
print(mod)
# extract coefficients
sirt::mirt.wrapper.coef(mod)

# extract likelihood
like &lt;- IRT.likelihood(mod)
str(like)

# fit latent regression model in TAM
mod2 &lt;- TAM::tam.latreg( like, Y=X, pid=dat$idstud )
summary(mod2)
# plausible value imputation
pv2 &lt;- TAM::tam.pv( mod2, samp.regr=TRUE, nplausible=5 )
# create list of imputed datasets
X &lt;- dat[, c("idstud", "idschool", "female", "hisei", "migra") ]
pvnames &lt;- c("PVREAD")
datlist &lt;- TAM::tampv2datalist( pv2, pvnames=pvnames, Y=X, Y.pid="idstud")
str(datlist)

# regression using semTools package
library(semTools)
lavmodel &lt;- "
   PVREAD ~ hisei + female
           "
mod1a &lt;- semTools::sem.mi( lavmodel, datlist)
summary(mod1a, standardized=TRUE, rsquare=TRUE)

#############################################################################
# EXAMPLE 3: data.Students - fitted confirmatory factor analysis in lavaan
#############################################################################

library(CDM)
library(sirt)
library(lavaan)

data(data.Students, package="CDM")
dat &lt;- data.Students
vars &lt;- scan(what="character", nlines=1)
   urban female sc1 sc2 sc3 sc4 mj1 mj2 mj3 mj4
dat &lt;- dat[, vars]
dat &lt;- na.omit(dat)

# fit confirmatory factor analysis in lavaan
lavmodel &lt;- "
   SC=~ sc1__sc4
   SC ~~ 1*SC
   MJ=~ mj1__mj4
   MJ ~~ 1*MJ
   SC ~~ MJ
        "
# process lavaan syntax
res &lt;- TAM::lavaanify.IRT( lavmodel, dat )
# fit lavaan CFA model
mod1 &lt;- lavaan::cfa( res$lavaan.syntax, dat, std.lv=TRUE)
summary(mod1, standardized=TRUE, fit.measures=TRUE )
# extract likelihood
like1 &lt;- TAM::IRTLikelihood.cfa( dat, mod1 )
str(like1)
# fit latent regression model in TAM
X &lt;- dat[, c("urban","female") ]
mod2 &lt;- TAM::tam.latreg( like1, Y=X  )
summary(mod2)
# plausible value imputation
pv2 &lt;- TAM::tam.pv( mod2, samp.regr=TRUE, normal.approx=TRUE )
# create list of imputed datasets
Y &lt;- dat[, c("urban", "female" ) ]
pvnames &lt;- c("PVSC", "PVMJ")
datlist &lt;- TAM::tampv2datalist( pv2, pvnames=pvnames, Y=Y )
str(datlist)

## End(Not run)
</code></pre>


</div>