<div class="container">

<table style="width: 100%;"><tr>
<td>predict.tramME</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Predict method for tramME objects</h2>

<h3>Description</h3>

<p>Evaluates the _conditional_ distribution implied by a tramME model, given by a
set of covariates and random effects on a selected scale.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'tramME'
predict(
  object,
  newdata = model.frame(object),
  ranef = NULL,
  fix_smooth = TRUE,
  type = c("lp", "trafo", "distribution", "logdistribution", "survivor", "logsurvivor",
    "density", "logdensity", "hazard", "loghazard", "cumhazard", "logcumhazard", "odds",
    "logodds", "quantile"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A <code>tramME</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>an optional data frame of observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ranef</code></td>
<td>
<p>Random effects it can be a <code>ranef.tramME</code> object, a named list,
an unnamed list, <code>NULL</code> or the word "zero". See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fix_smooth</code></td>
<td>
<p>If <code>FALSE</code>, the random effects coefficients of the smooth
terms are refitted to <code>newdata</code>. It's probably not what you want to do.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>The scale on which the predictions are evaluated:
</p>

<ul>
<li>
<p> lp: Linear predictor (Xb + Zg). For more information, see Details.
</p>
</li>
<li>
<p> trafo: The prediction evaluated on the scale of the
transformation function.
</p>
</li>
<li>
<p> (log)distribution: The prediction evaluated on the scale of the
conditional (log-)CDF.
</p>
</li>
<li>
<p> (log)survivor: The prediction evaluated on the scale of the
(conditional) (log-)survivor function.
</p>
</li>
<li>
<p> (log)density: The prediction evaluated on the scale of
the conditional (log-)PDF.
</p>
</li>
<li>
<p> (log)hazard: The prediction evaluated on the (log-)hazard scale.
</p>
</li>
<li>
<p> (log)cumhazard: The prediction evaluated on the (log-)cumulative
hazard scale.
</p>
</li>
<li>
<p> (log)odds: The prediction evaluated on the (log-)odds scale.
</p>
</li>
<li>
<p> quantile: Return the quantiles of the conditional outcome distribution
corresponding to <code>newdata</code>. For more information, see Details.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments, passed to <code>predict.mlt</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When <code>newdata</code> contains values of the response variable, prediction is only
done for those values. In this case, if random effects vector (<code>ranef</code>) is not
supplied by the user, the function predicts the random effects from the model
using <code>newdata</code>.
</p>
<p>When no response values are supplied in <code>newdata</code>, the prediction is done
on a grid of values for each line of the dataset (see <code>predict.mlt</code>
for information on how to control the setup of this grid).
In this case, the user has to specify the vector of random effects to avoid ambiguities.
</p>
<p>The linear predictor (<code>type = "lp"</code>) equals to the shift terms plus the random
effects terms _without the baseline transfromation function_.
</p>
<p>The linear predictor (<code>type = "lp"</code>) and the conditional quantile function
(<code>type = "quantile"</code>) are special in that they do not return results evaluated
on a grid, even when the response variable in <code>newdata</code> is missing. The probabilities
for the evaluation of the quantile function can be supplied with the <code>prob</code> argument
of <code>predict.mlt</code>.
</p>
<p>In the case of <code>type = "quantile"</code>, when the some of the requested conditonal
quantiles fall outside of the support of the response distribution
(specified when the model was set up), the inversion of the CDF cannot be done exactly
and <code>tramME</code> returns censored values.
</p>
<p><code>ranef</code> can be different objects based on what we want to calculate and
what the other inputs are. If <code>ranef</code> is a <code>ranef.tramME</code>, we assume
that it contains the full set of random effects, but not the penalized coefficients
of the smooth terms. In this case <code>fix_smooth</code> must be <code>TRUE</code>. If
<code>ranef</code> is a named vector, we are fixing the supplied random effects (and
penalized coefficients) and predict the rest from <code>newdata</code> (<code>fix_smooth</code>
may also be used in this case). In this case, the random effects are identified
with the same naming convention as in <code>object$param$gamma</code>.
</p>
<p>If <code>ranef</code> is an unnamed vector, the function expects the
full set of necessary random effects (with or without penalized coefficients, depending
on <code>fix_smooth</code>). If <code>ranef = NULL</code> (the default), all random effects and
optionally penalized parameters (although this is not recommended) are predicted from
<code>newdata</code>. Finally, if <code>ranef</code> is equal to "zero", a vector of zeros with the
right size is used.
</p>


<h3>Value</h3>

<p>A numeric vector/matrix of the predicted values (depending on the inputs)
or a <code>response</code> object, when the some of the requested conditonal quantiles
fall outside of the support of the response distribution specified when the model
was set up (only can occur with <code>type = "quantile"</code>).
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("sleepstudy", package = "lme4")
fit &lt;- BoxCoxME(Reaction ~ Days + (Days | Subject), data = sleepstudy)
predict(fit, type = "trafo") ## evaluate on the transformation function scale
nd &lt;- sleepstudy
nd$Reaction &lt;- NULL
pr &lt;- predict(fit, newdata = nd, ranef = ranef(fit), type = "distribution",
              K = 100)
</code></pre>


</div>