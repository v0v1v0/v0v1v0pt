<div class="container">

<table style="width: 100%;"><tr>
<td>MenvU_sim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate matrices <code class="reqn">M</code> and <code class="reqn">U</code>
</h2>

<h3>Description</h3>

<p>This function generates the matrices <code class="reqn">M</code> and <code class="reqn">U</code> with envelope structure.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MenvU_sim(
  p,
  u,
  Omega = NULL,
  Omega0 = NULL,
  Phi = NULL,
  jitter = FALSE,
  wishart = FALSE,
  n = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Dimension of <code class="reqn">p</code>-by-<code class="reqn">p</code> matrix <code class="reqn">M</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>The envelope dimension. An integer between 0 and <code class="reqn">p</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Omega</code></td>
<td>
<p>The positive definite matrix <code class="reqn">\Omega</code> in <code class="reqn">M=\Gamma\Omega\Gamma^T+\Gamma_0\Omega_0\Gamma_0^T</code>. The default is <code class="reqn">\Omega=AA^T</code> where the elements in <code class="reqn">A</code> are generated from Uniform(0,1) distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Omega0</code></td>
<td>
<p>The positive definite matrix <code class="reqn">\Omega_0</code> in <code class="reqn">M=\Gamma\Omega\Gamma^T+\Gamma_0\Omega_0\Gamma_0^T</code>. The default is <code class="reqn">\Omega_0=AA^T</code> where the elements in <code class="reqn">A</code> are generated from Uniform(0,1) distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Phi</code></td>
<td>
<p>The positive definite matrix <code class="reqn">\Phi</code> in <code class="reqn">U=\Gamma\Phi\Gamma^T</code>. The default is <code class="reqn">\Phi=AA^T</code> where the elements in <code class="reqn">A</code> are generated from Uniform(0,1) distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jitter</code></td>
<td>
<p>Logical or numeric. If it is numeric, the diagonal matrix <code>diag(jitter, nrow(M), ncol(M))</code> is added to matrix <code class="reqn">M</code> to ensure the positive definiteness of <code class="reqn">M</code>. If it is <code>TRUE</code>, then it is set as <code>1e-5</code> and the jitter is added. If it is <code>FALSE</code> (default), no jitter is added.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wishart</code></td>
<td>
<p>Logical. If it is <code>TRUE</code>, the sample estimator from Wishart distribution <code class="reqn">W_p(M/n, n)</code> and <code class="reqn">W_p(U/n, n)</code> are generated as the output matrices <code>M</code> and <code>U</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The sample size. If <code>wishart</code> is <code>FALSE</code>, then <code>n</code> is ignored.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The matrices <code class="reqn">M</code> and <code class="reqn">U</code> are in forms of
</p>
<p style="text-align: center;"><code class="reqn">M = \Gamma \Omega \Gamma^T + \Gamma_0\Omega_0\Gamma_0^T, U = \Gamma \Phi \Gamma^T.</code>
</p>

<p>The envelope basis <code class="reqn">\Gamma</code> is randomly generated from the Uniform (0, 1) distribution elementwise and then transformed to a semi-orthogonal matrix. <code class="reqn">\Gamma_0</code> is the orthogonal completion of <code class="reqn">\Gamma</code>.
</p>
<p>In some cases, to guarantee that <code class="reqn">M</code> is positive definite which is required by the definition of envelope, a <code>jitter</code> should be added to <code class="reqn">M</code>.
</p>
<p>If <code>wishart</code> is <code>TRUE</code>, after the matrices <code class="reqn">M</code> and <code class="reqn">U</code> are generated, the samples from Wishart distribution <code class="reqn">W_p(M/n, n)</code> and <code class="reqn">W_p(U/n, n)</code> are output as matrices <code class="reqn">M</code> and <code class="reqn">U</code>. If so, <code>n</code> is required.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>The <code class="reqn">p</code>-by-<code class="reqn">p</code> matrix <code>M</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>U</code></td>
<td>
<p>The <code class="reqn">p</code>-by-<code class="reqn">p</code> matrix <code>U</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gamma</code></td>
<td>
<p>The <code class="reqn">p</code>-by-<code class="reqn">u</code> envelope basis.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Cook, R.D. and Zhang, X., 2018. Fast envelope algorithms. Statistica Sinica, 28(3), pp.1179-1197.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data1 &lt;- MenvU_sim(p = 20, u = 5)
M1 &lt;- data1$M
U1 &lt;- data1$U

# Sample version from Wishart distribution
data2 &lt;- MenvU_sim(p = 20, u = 5, wishart = TRUE, n = 200)
M2 &lt;- data2$M
U2 &lt;- data2$U

</code></pre>


</div>