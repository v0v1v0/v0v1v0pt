<div class="container">

<table style="width: 100%;"><tr>
<td>PikSTPPS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Inclusion Probabilities in Stratified Proportional to Size Sampling Designs</h2>

<h3>Description</h3>

<p>For a given sample size, in each stratum, this function returns a vector of first order
inclusion probabilities for an stratified sampling design proportional to an auxiliary variable.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PikSTPPS(S, x, nh)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>Vector identifying the membership to the strata of each unit in the population.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Vector of auxiliary information for each unit in the population.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nh</code></td>
<td>
<p>The vector defningn the sample size in each stratum.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>is not always less than unity. A sequential algorithm must be used in order to ensure that for 
every unit in the population the inclusion probability gives a proper value; i.e. less or equal
to unity.
</p>


<h3>Value</h3>

<p>A vector of inclusion probablilities in a stratified finite population.
</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas &lt;hagutierrezro at gmail.com&gt;
</p>


<h3>References</h3>

<p>Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>. Editorial Universidad Santo Tomas
Sarndal, C-E. and Swensson, B. and Wretman, J. (2003), <em>Model Assisted Survey Sampling</em>. Springer.
</p>


<h3>See Also</h3>

<p><code>PikHol, PikPPS, S.STpiPS</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">############
## Example 1
############
# Vector U contains the label of a population of size N=5
U &lt;- c("Yves", "Ken", "Erik", "Sharon", "Leslie")
# The auxiliary information
x &lt;- c(52, 60, 75, 100, 50)
# Vector Strata contains an indicator variable of stratum membership
Strata &lt;- c("A", "A", "A", "B", "B")
# The sample size in each stratum
nh &lt;- c(2,2)
# The vector of inclusion probablities for a stratified piPS sample 
# without replacement of size two within each stratum
Pik &lt;- PikSTPPS(Strata, x, nh)
Pik

# Some checks
sum(Pik)
sum(nh)

############
## Example 2
############
# Uses the Lucy data to compute the vector of inclusion probablities 
# for a stratified random sample according to a piPS design in each stratum

data(Lucy)
attach(Lucy)
# Level is the stratifying variable
summary(Level)

# Defines the size of each stratum
N1&lt;-summary(Level)[[1]]
N2&lt;-summary(Level)[[2]]
N3&lt;-summary(Level)[[3]]
N1;N2;N3

# Defines the sample size at each stratum
n1&lt;-70
n2&lt;-100
n3&lt;-200
nh&lt;-c(n1,n2,n3)
nh

# Computes the inclusion probabilities for the stratified population
S &lt;- Level
x &lt;- Employees
Pik &lt;- PikSTPPS(S, x, nh)

# Some checks
sum(Pik)
sum(nh)
</code></pre>


</div>