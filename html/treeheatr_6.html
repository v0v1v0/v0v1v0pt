<div class="container">

<table style="width: 100%;"><tr>
<td>draw_heat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Draws the heatmap.</h2>

<h3>Description</h3>

<p>Draws the heatmap to be placed below the decision tree.
</p>


<h3>Usage</h3>

<pre><code class="language-R">draw_heat(
  dat,
  fit,
  feat_types = NULL,
  target_cols = NULL,
  target_lab_disp = fit$target_lab,
  trans_type = c("percentize", "normalize", "scale", "none"),
  clust_feats = TRUE,
  feats = NULL,
  show_all_feats = FALSE,
  p_thres = 0.05,
  cont_legend = FALSE,
  cate_legend = FALSE,
  cont_cols = ggplot2::scale_fill_viridis_c,
  cate_cols = ggplot2::scale_fill_viridis_d,
  panel_space = 0.001,
  target_space = 0.05,
  target_pos = "top"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>Dataframe with samples from original dataset ordered according to
the clustering within each leaf node.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>party object, e.g., as output from partykit::ctree()</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>feat_types</code></td>
<td>
<p>Named vector indicating the type of each features,
e.g., c(sex = 'factor', age = 'numeric').
If feature types are not supplied, infer from column type.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target_cols</code></td>
<td>
<p>Character vectors representing the hex values of different
level colors for targets, defaults to viridis option B.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target_lab_disp</code></td>
<td>
<p>Character string for displaying the label of target label.
If not provided, use 'target_lab'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trans_type</code></td>
<td>
<p>Character string of 'normalize', 'scale' or 'none'.
If 'scale', subtract the mean and divide by the standard deviation.
If 'normalize', i.e., max-min normalize, subtract the min and divide by the max.
If 'none', no transformation is applied.
More information on what transformation to choose can be acquired here:
https://cran.rstudio.com/package=heatmaply/vignettes/heatmaply.html#data-transformation-scaling-normalize-and-percentize</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clust_feats</code></td>
<td>
<p>Logical. If TRUE, performs cluster on the features.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>feats</code></td>
<td>
<p>Character vector of feature names to be displayed in the heatmap.
If NULL, display features of which P values are less than 'p_thres'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_all_feats</code></td>
<td>
<p>Logical. If TRUE, show all features regardless of 'p_thres'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_thres</code></td>
<td>
<p>Numeric value indicating the p-value threshold of feature importance.
Feature with p-values computed from the decision tree below this value
will be displayed on the heatmap.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cont_legend</code></td>
<td>
<p>Function determining the options for legend of continuous variables,
defaults to FALSE. If TRUE, use 'guide_colorbar(barwidth = 10, barheight = 0.5, title = NULL)'.
Any other ['guides()'](https://ggplot2.tidyverse.org/reference/guides.html) functions
would also work.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cate_legend</code></td>
<td>
<p>Function determining the options for legend of categorical variables,
defaults to FALSE. If TRUE, use 'guide_legend(title = NULL)'.
Any other ['guides()'](https://ggplot2.tidyverse.org/reference/guides.html) functions
would also work.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cont_cols</code></td>
<td>
<p>Function determining color scale for continuous variable,
defaults to 'scale_fill_viridis_c(guide = cont_legend)'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cate_cols</code></td>
<td>
<p>Function determining color scale for nominal categorical variable,
defaults to 'scale_fill_viridis_d(begin = 0.3, end = 0.9)'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>panel_space</code></td>
<td>
<p>Spacing between facets relative to viewport,
recommended to range from 0.001 to 0.01.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target_space</code></td>
<td>
<p>Numeric value indicating spacing between
the target label and the rest of the features</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target_pos</code></td>
<td>
<p>Character string specifying the position of the target label
on heatmap, can be 'top', 'bottom' or 'none'.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A ggplot2 grob object of the heatmap.
</p>


<h3>Examples</h3>

<pre><code class="language-R">x &lt;- compute_tree(penguins, target_lab = 'species')
draw_heat(x$dat, x$fit)


</code></pre>


</div>