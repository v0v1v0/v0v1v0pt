<div class="container">

<table style="width: 100%;"><tr>
<td>tmt_rm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimation (CML) ot the Rasch model with or without multistage designs.</h2>

<h3>Description</h3>

<p>The <code>tmt_rm</code> function estimates the Rasch model. If the data are collected based on a multistage design (see Zwitser and Maris, 2015) the specific multistage design <code>mstdesign</code> has to be submitted.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tmt_rm(
  dat,
  mstdesign = NULL,
  weights = NULL,
  start = NULL,
  sum0 = TRUE,
  se = TRUE,
  optimization = "nlminb",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>a matrix of dichotomous (0/1) data or a list of the function <code>tmt_designsim</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mstdesign</code></td>
<td>
<p>Model for the multistage design, if CML estimation without multistage designs is required, than leave the default value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>is optional for the weights of cases</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>Vector of start values. If no vector is provided, the start values will be automatic generated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sum0</code></td>
<td>
<p>logical: If the item parameters should be normed to 'sum = 0' as recommended by Glas (2016, p. 208). Otherwise sum0=FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>logical: should the standard error should be estimated?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimization</code></td>
<td>
<p>character: Per default 'nlminb' is used but 'optim' is also supported.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional further arguments for optim and nlminb use control = list() with arguments.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>According to Glas (1988) &lt;doi:10.3102/10769986013001045&gt; CML estimation of item parameters is biased if the data is collected in multistage designs and this design is not considered. Zwitser and Maris (2015) &lt;doi:10.1007/s11336-013-9369-6&gt; propose to use an additional design matrix to fragment the elementary symmetric function. Their approach is implemented in this package. MST designs with a probabilistic instead of a deterministic routing rule (see, e.g. Chen, Yamamoto, &amp; von Davier, 2014 &lt;doi:10.1201/b16858&gt;) are not estimated with this method, therefore the proposed solouting is again modified by Steinfeld and Robitzsch (2021) &lt;doi:10.31234/osf.io/ew27f&gt; which is also integrated into this package.
</p>


<h3>Value</h3>

<p>List with following entries
</p>
<table>
<tr style="vertical-align: top;">
<td><code>betapar</code></td>
<td>
<p>Estimated item difficulty parameters (if sum0=FALSE, than the first item is set to 0)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.beta</code></td>
<td>
<p>Standard errors of the estimated item parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>Conditional log-likelihood of the model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>Number of estimated parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Number of Persons</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>I</code></td>
<td>
<p>Number of items</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data_orig</code></td>
<td>
<p>Submitted data frame with item responses</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Used data frame with item responses</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>desmat</code></td>
<td>
<p>Design matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence</code></td>
<td>
<p>Convergence criterion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterations</code></td>
<td>
<p>Number of iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hessian</code></td>
<td>
<p>Hessian-Matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Used model ((mst) for Rasch model with multistage design)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>Submitted arguments for the function (matched call)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>designelements</code></td>
<td>
<p>If the multistage version is requested, the preprocessed design is returned, otherwise NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mstdesign</code></td>
<td>
<p>If the multistage version is requested, the submitted design is returned, otherwise NULL</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jan Steinfeld
</p>


<h3>References</h3>


<ul>
<li>
<p> Baker, F. B., &amp; Harwell, M. R. (1996). Computing elementary symmetric functions and their derivatives:
A didactic. <em>Applied Psychological Measurement, 20</em>(2), 169-192.
</p>
</li>
<li>
<p> Baker, F. B., &amp; Kim, S. H. (2004). <em>Item response theory: Parameter estimation techniques</em>. CRC Press.
</p>
</li>
<li>
<p> Chen, H., Yamamoto, K., &amp; von Davier, M. (2014). Controlling multistage testing exposure rates in international large-scale assessments. 
In A. Yan, A. A. von Davier, &amp; C. Lewis (Eds.), <em>Computerized Multistage Testing: Theory and Applications</em> (pp. 391-409). 
New York: CRC Press. https://doi.org/10.1201/b16858
</p>
</li>
<li>
<p> Fischer, G. H., &amp; Molenaar, I. W. (Eds.). (2012). <em>Rasch models: Foundations, recent developments, and applications</em>. 
Springer Science &amp; Business Media.
</p>
</li>
<li>
<p> Formann, A. K. (1986). A note on the computation of the second-order derivatives of the elementary symmetric 
functions in the Rasch model. <em>Psychometrika, 51</em>(2), 335-339.
</p>
</li>
<li>
<p> Glas, C.A.W. (1988). The Rasch model and multistage testing. <em>Journal of Educational Statistics, 13</em>(1), 45-52.
</p>
</li>
<li>
<p> Glas, C.A.W. (2016). Maximum-Likelihood Estimation. In van der Linden, W.J. (Ed.), <em>Handbook of Item Response Theory: Volume two: Statistical tools.</em> (pp. 197 - 236). New York: CRC Press.
</p>
</li>
<li>
<p> Rasch, G. (1960). <em>Probabalistic models for some intelligence and attainment tests.</em> Danmarks
paedagogiske institut.
</p>
</li>
<li>
<p> Steinfeld, J., &amp; Robitzsch, A. (accepted). Conditional maximum likelihood estimation in probability-based multistage designs. 
<em>Behaviormetrika, xx</em>(x), xxx-xxx. 
</p>
</li>
<li>
<p> Steinfeld, J., Robitzsch, A. (2023). Estimating item parameters in multistage designs with the tmt package in R. 
<em>Quantitative and Computational Methods in Behavioral Science, 3</em>, e10087. https://doi.org/10.5964/qcmb.10087
</p>
</li>
<li>
<p> Steinfeld, J., &amp; Robitzsch, A. (2021). Item parameter estimation in multistage designs: A comparison of different estimation approaches for the Rasch model. 
<em>Psych, 3</em>(3), 279-307. https://doi.org/10.3390/psych3030022
</p>
</li>
<li>
<p> Verhelst, N.D., Glas, C.A.W., &amp; van der Sluis, A. (1984). Estimation Problems in the Rasch-Model:
The Basic Symmetric Functions. <em>Computational Statistics Quarterly, 1</em>(3), 245-262.
</p>
</li>
<li>
<p> Zwitser, R. J., &amp; Maris, G. (2015). Conditional statistical inference with multistage testing designs.
<em>Psychometrika, 80</em>(1), 65-84.
</p>
</li>
</ul>
<h3>See Also</h3>

<p>tmt_lrtest
</p>


<h3>Examples</h3>

<pre><code class="language-R"># example for tmt_rm
#############################################################################
# Example-1 simple Rasch model 
#############################################################################
dat &lt;- tmt:::sim.rm(theta = 100, b = 10, seed = 1111)
dat.rm &lt;- tmt_rm(dat = dat)
summary(dat.rm)

#############################################################################
# Example-1 for multistage-design
#############################################################################
mstdesign &lt;- "
  M1 =~ c(i1, i2, i3, i4, i5)
  M2 =~ c(i6, i7, i8, i9, i10)
  M3 =~ c(i11, i12, i13, i14, i15)

  # define path
  p1 := M2(0,2) + M1
  p2 := M2(3,5) + M3
"

items &lt;- seq(-1,1,length.out = 15)
names(items) &lt;- paste0("i",1:15)
persons = 1000

dat &lt;- tmt_sim(mstdesign = mstdesign, 
  items = items, persons = persons)
dat.rm &lt;- tmt_rm(dat = dat, mstdesign = mstdesign)
summary(dat.rm)

## Not run: 
  ############################################################################
  # Example-2 simple Rasch model 
  ############################################################################
  dat &lt;- tmt:::sim.rm(theta = 100, b = 10, seed = 1111)
  dat.rm &lt;- tmt_rm(dat = dat)
  summary(dat.rm)

  ############################################################################
  # Example-2 for multistage-design
  ############################################################################
  # also using 'paste' is possible
  mstdesign &lt;- "
    M1 =~ paste0('i',1:5)
    M2 =~ paste0('i',6:10)
    M3 =~ paste0('i',11:15)
    M4 =~ paste0('i',16:20)
    M5 =~ paste0('i',21:25)
    M6 =~ paste0('i',26:30)

    # define path
    p1 := M4(0,2) + M2(0,2) + M1
    p2 := M4(0,2) + M2(3,5) + M3
    p3 := M4(3,5) + M5(0,2) + M3
    p4 := M4(3,5) + M5(3,5) + M6
  "
  items &lt;- seq(-1,1,length.out = 30)
  names(items) &lt;- paste0("i",1:30)
  persons = 1000
  dat &lt;- tmt_sim(mstdesign = mstdesign, 
    items = items, persons = persons)
  dat.rm &lt;- tmt_rm(dat = dat, mstdesign = mstdesign)
  summary(dat.rm)

    ############################################################################
  # Example-3 for cumulative multistage-design
  ############################################################################
  # also using 'paste' is possible
  mstdesign &lt;- "
    M1  =~ paste0('i',21:30)
    M2  =~ paste0('i',11:20)
    M3  =~ paste0('i', 1:10)
    M4  =~ paste0('i',31:40)
    M5  =~ paste0('i',41:50)
    M6  =~ paste0('i',51:60)
    
    # define path
    p1 := M1(0, 5) += M2( 0,10) += M3
    p2 := M1(0, 5) += M2(11,15) += M4
    p3 := M1(6,10) += M5( 6,15) += M4
    p4 := M1(6,10) += M5(16,20) += M6
    "
  items &lt;- seq(-1,1,length.out = 60)
  names(items) &lt;- paste0("i",1:60)
  persons = 1000
  dat &lt;- tmt_sim(mstdesign = mstdesign, 
    items = items, persons = persons)
  dat.rm &lt;- tmt_rm(dat = dat, mstdesign = mstdesign)
  summary(dat.rm)


## End(Not run)
</code></pre>


</div>