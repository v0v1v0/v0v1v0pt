<div class="container">

<table style="width: 100%;"><tr>
<td>astro</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculations for position of the sun and moon</h2>

<h3>Description</h3>

<p>This set of functions provides simple position calculations for the sun and moon,
taken from Pascal routines published in Montenbruck and Pfleger (1994, Dunlop).
</p>
<p>These are completely independent from the (specifically optimized) solar elevation
calculations available via [elevation and solar].
</p>


<h3>Usage</h3>

<pre><code class="language-R">astro(lon, lat, astro.calc)

EQUHOR(DEC, TAU, PHI)

FRAC(x)

LMST(MJDay, LAMBDA)

lunar(time)

mini.sun(time)

MJD(date)

POLAR(X, Y, Z)
</code></pre>


<h3>Arguments</h3>


<table>
<tr style="vertical-align: top;">
<td><code>lon</code></td>
<td>
<p>vector of <code>lon</code>gitudes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lat</code></td>
<td>
<p>vector of <code>lat</code>itudes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>astro.calc</code></td>
<td>
<p>list object containing <code>RA</code> right ascension </p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>DEC</code></td>
<td>
<p>declination</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TAU</code></td>
<td>
<p><code>TAU</code>  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PHI</code></td>
<td>
 <p><code>PHI</code>  </p>
</td>
</tr>
</table>
<table><tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>number</p>
</td>
</tr></table>
<table>
<tr style="vertical-align: top;">
<td><code>MJDay</code></td>
<td>
<p> modified julian day </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LAMBDA</code></td>
<td>
<p><code>LAMBDA</code> </p>
</td>
</tr>
</table>
<table><tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p> vector of date-times in POSIXct format </p>
</td>
</tr></table>
<table><tr style="vertical-align: top;">
<td><code>date</code></td>
<td>
<p> vector of date-times in POSIXct format </p>
</td>
</tr></table>
<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p> x-coordinate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p> y-coordinate </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p> z-coordinate </p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>astro</code> returns a list object with the components of the moon or sun's
position,
</p>
<table>
<tr style="vertical-align: top;">
<td><code>r </code></td>
<td>
<p>rho component </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta </code></td>
<td>
<p>theta component - elevation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>phi component - azimuth</p>
</td>
</tr>
</table>
<h3>Warning </h3>

<p>Some of this could be faster (particularly the use of LMST in "astro" is not precalculated)
</p>


<h3>Note</h3>

<p>Thanks to Nick.Ellis@csiro.au for pointing out a mistake pre-0.0-27
</p>


<h3>Author(s)</h3>

<p>Michael D. Sumner</p>


<h3>References</h3>

<pre>@BOOK{,
  title = {Astronomy on the Personal Computer},
  publisher = {Springer-Verlag, Berlin},
  year = {1994},
  author = {Oliver Montenbruck and Thomas Pfleger},
  edition = {2  (translated from German by Storm Dunlop)},
}</pre>

<h3>See Also</h3>

<p> See Also <code>elevation</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
## the moon
tm &lt;- Sys.time() + seq(by = 3600, length = 100)
moon &lt;- lunar(tm)
rtp &lt;- astro(147, -42, moon)
op &lt;- par(mfrow = c(2,1))
plot(tm, rtp$theta, main = "lunar elevation, Hobart")
plot(tm, rtp$phi, main = "lunar azimuth, Hobart")
par(op)

## the sun
tm &lt;- Sys.time() + seq(by = 3600, length = 100)
sun &lt;- mini.sun(tm)
rtp &lt;- astro(147, -42, sun)
op &lt;- par(mfrow = c(2,1))
plot(tm, rtp$theta, main = "solar elevation, Hobart")
plot(tm, rtp$phi, main = "solar azimuth, Hobart")
par(op)
  elev.gmt &lt;- mkElevationSeg(1, tm)
  plot(tm, rtp$theta, main = "solar elevation mini.sun versus NOAA")
  lines(tm, elev.gmt(1, 147, -42))

</code></pre>


</div>