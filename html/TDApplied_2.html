<div class="container">

<table style="width: 100%;"><tr>
<td>analyze_representatives</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Analyze the data point memberships of multiple representative (co)cycles.</h2>

<h3>Description</h3>

<p>Multiple distance matrices with corresponding data points can contain the same topological features. 
Therefore we may wish to compare many representative (co)cycles across distance matrices to decide if their topological features are the same.
The 'analyze_representatives' function returns a matrix of binary datapoint memberships in an input list of representatives across distance matrices.
Optionally this matrix can be plotted as a heatmap with columns as data points and rows (i.e. representatives) reordered by similarity, and the 
contributions (i.e. percentage membership) of each point in the representatives can also be returned. The heatmap has
dark red squares representing membership - location [i,j] is dark red if data point j is in representative i.
</p>


<h3>Usage</h3>

<pre><code class="language-R">analyze_representatives(
  diagrams,
  dim,
  num_points,
  plot_heatmap = TRUE,
  return_contributions = FALSE,
  boxed_reps = NULL,
  d = NULL,
  lwd = NULL,
  title = NULL,
  return_clust = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>diagrams</code></td>
<td>
<p>a list of persistence diagrams, either the output of persistent homology calculations like ripsDiag/<code>calculate_homology</code>/<code>PyH</code>, <code>diagram_to_df</code> or <code>bootstrap_persistence_thresholds</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dim</code></td>
<td>
<p>the integer homological dimension of representatives to consider.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_points</code></td>
<td>
<p>the integer number of data points in all the original datasets (from which the diagrams were calculated).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_heatmap</code></td>
<td>
<p>a boolean representing if a heatmap of data point membership similarity of the representatives should be plotted, default 'TRUE'. A dendrogram of hierarchical clustering is plotted, and rows (representatives) are sorted according to this clustering.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return_contributions</code></td>
<td>
<p>a boolean indicating whether or not to return the membership contributions (i.e. percentages) of the data points (1:'num_points') across all the representatives, default 'FALSE'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boxed_reps</code></td>
<td>
<p>a data frame specifying specific rows of the output heatmap which should have a box drawn around them (for highlighting), default NULL. See the details section for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>either NULL (default) or a "dist" object representing a distance matrix for the representatives, which must have the same number of rows and columns as cycles in the dimension 'dim'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>a positive number width for the lines of drawn boxes, if boxed_reps is not null.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>a character string title for the plotted heatmap, default NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return_clust</code></td>
<td>
<p>a boolean determining whether or not to return the result of the 'stats::hclust()' call when a heatmap is plotted, default 'FALSE'.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The clustering dendrogram can be used to determine if there are any similar groups of representatives (i.e.
shared topological features across datasets) and if so how many. The row labels of the heatmap are of the form
'DX[Y]', meaning the Yth representative of diagram X, and the column labels are the data point numbers.
If diagrams are the output of the <code>bootstrap_persistence_thresholds</code>
function, then the subsetted_representatives (if present) will be analyzed. Therefore, a column label like 'DX[Y]' in the 
plotted heatmap would mean the Yth representative of diagram X. If certain representatives should be highlighted (by drawing a box around its row)
in the heatmap, a dataframe ‘boxed_reps' can be supplied with two integer columns - ’diagram' and 'rep'. For example, if we wish to draw a box for DX[Y] then we
add the row (diagram = X,rep = Y) to 'boxed_reps'. If 'd' is supplied then it will be used to cluster the representatives, based on the distances in 'd'.
</p>


<h3>Value</h3>

<p>either a matrix of data point contributions to the representatives, or a list with elements "memberships" (the matrix) and some combination of elements "contributions" (a vector of membership percentages for each data point across representatives) and "clust" (the results of 'stats::hclust()' on the membership matrix).
</p>


<h3>Author(s)</h3>

<p>Shael Brown - <a href="mailto:shaelebrown@gmail.com">shaelebrown@gmail.com</a>
</p>


</div>