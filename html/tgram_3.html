<div class="container">

<table style="width: 100%;"><tr>
<td>tgram</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Compute Tracheidograms
</h2>

<h3>Description</h3>

<p>Function to compute tracheidograms from microscopic measurements.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tgram(traq, val50 = 50, xlim = NULL, ylim = NULL, mw = 1, plotit = TRUE)

## S3 method for class 'tgram'
plot(x, xlim = NULL, ylim = NULL, colores = c("red", "green"),
      leyenda = c("lumen", "double wall"), lwd = 2,
      add = FALSE,traq.0 = TRUE, bg.legend = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>traq</code></td>
<td>

<p>microscopic light profile. A vector with the light measurements or a <code>data.frame</code> or <code>matrix</code> with two columns. In this case, the first column contains pixel order (i.e. position along the x axis) and the second one contains the light (i.e. "y") lectures.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>val50</code></td>
<td>

<p>"y-value" at wich measurements should be made.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mw</code></td>
<td>

<p>integer. Width of the rolling window to smooth the original data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotit</code></td>
<td>

<p>logical. should the original data and the computed tracheidogram be drawn?
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>

<p>extent of the x-axis. A vector of length 2. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>

<p>extent of the y-axis. A vector of length 2. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>an object of class tgram, resulting from <code>tgram</code> function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colores</code></td>
<td>

<p>a vector of length 2, with the colors to draw the lumen and wall measurements, respectively. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leyenda</code></td>
<td>

<p>a vector of length 2 with the legend to appear in the plot. By default leyenda =c("lumen","double wall").
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>

<p>width of the lines in the legend. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>

<p>logical. If TRUE, add to a current plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>traq.0</code></td>
<td>

<p>logical. If TRUE, draw the original measurements.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bg.legend</code></td>
<td>

<p>background color for the legend.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>additional graphical parameters.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The purpouse of this fucntion is obtaining cell anatomical data from microscopic light measurements (see DeSoto et al. for details of data adquisition). The microscopic lectures are first smoothed with a rolling window (using function <code>rollmean</code> of package <code>zoo</code>, using the selected width <code>mw</code>. Then, the smoothed curve is "cut" at the  treshold value <code>val50</code> and the distances among the intersection points are computed. This provides an ordered sequence of  lumen diameters (LD) and double wall thikness (DWT) measurements. From this sequence some other anatomical measurements are computed. Radial cell wall thickness is computed as <em> CWT[t] = 1/2 * (DWT[t]/2 + DWT[t+1]/2) </em>. Tracheid diameter is computed as <em> TD[t] = DWT[t]/2 + LD[t] + DWT[t+1]/2</em>.
</p>


<h3>Value</h3>

<p>tgram returns an object of class <em>tgram</em>, bassically a list with 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>traq </code></td>
<td>
<p>original data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>traq0 </code></td>
<td>
<p>if <code>traq</code> was a 2 column matrix, then <code>traq0</code> returns the same object. If <code>traq</code> was a vector,  <code>traq0</code> returns a two column matrix (first column with pixel position and second with ligh lectures).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cut.points </code></td>
<td>
<p>two column matrix with the coordinates of the intersection of <em>y = val50</em> and the smoothed curve.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>what </code></td>
<td>
<p>vector indicating if the computed distances are of lumen (1) or double wall (2) .</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distances </code></td>
<td>
<p>ordered sequence of the computed distances (both of lumen and double wall).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LD </code></td>
<td>
<p>ordered sequence of lumen diameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DWT </code></td>
<td>
<p>ordered sequence of double wall thickness. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mw </code></td>
<td>
<p>width of the rolling window employed to smooth the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CWT </code></td>
<td>
<p>ordered sequence of radial cell wall thikness'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TD </code></td>
<td>
<p>ordered sequence of tracheid diameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LD_CWT_ratio </code></td>
<td>
<p>ordered sequence of LD/CWT ratio.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Marcelino de la Cruz Rot and Lucia DeSoto
</p>


<h3>References</h3>

<p>DeSoto, L., De la Cruz, M. &amp; Fonti, P. 2011. Intra-annual pattern of tracheid size in the Mediterranean Juniperus thurifera as indicator for seasonal water stress. <em>Canadian Journal of Forest Research</em>  41: 1280-1294.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(traq.profile)

plot(tgram(traq.profile, mw=10),leyenda=c("lumen","double wall"),
        xlab="distance pixel", ylab="grey value",ylim=c(0,250),
        bg.legend="white")



</code></pre>


</div>