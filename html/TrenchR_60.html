<div class="container">

<table style="width: 100%;"><tr>
<td>soil_temperature</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate Soil Temperature using ODEs</h2>

<h3>Description</h3>

<p>This function is called to calculate soil temperature (C) as in Beckman et al. (1973). This function calls <code>soil_temperature_function</code>, which uses ODEs to calculate a soil profile using equations from deVries (1963)
</p>


<h3>Usage</h3>

<pre><code class="language-R">soil_temperature(
  z_r.intervals = 12,
  z_r,
  z,
  T_a,
  u,
  Tsoil0,
  z0,
  SSA,
  TimeIn,
  S,
  water_content = 0.2,
  air_pressure,
  rho_so = 1620,
  shade = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>z_r.intervals</code></td>
<td>
<p><code>numeric</code> the number of intervals in the soil profile to calculate, defaults to 12.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z_r</code></td>
<td>
<p><code>numeric</code> reference height (m).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p><code>numeric</code> interval of the soil profile to return (1 to <code>z_r.intervals</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T_a</code></td>
<td>
<p><code>numeric</code> vector of air temperature (degrees C), Note: missing values will be linearly interpolated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p><code>numeric</code> vector of wind speeds (m s<sup>-1</sup>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tsoil0</code></td>
<td>
<p><code>numeric</code> initial soil temperature (degrees C).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z0</code></td>
<td>
<p><code>numeric</code> surface roughness (m).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SSA</code></td>
<td>
<p><code>numeric</code> solar absorptivity of soil surface as a fraction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TimeIn</code></td>
<td>
<p><code>numeric</code> vector of time periods for the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p><code>numeric</code> vector of solar radiation (W m<sup>-2</sup>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>water_content</code></td>
<td>
<p><code>numeric</code> percent water content (percent).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>air_pressure</code></td>
<td>
<p><code>numeric</code> air pressure (kPa).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho_so</code></td>
<td>
<p><code>numeric</code> particle density of soil.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shade</code></td>
<td>
<p><code>logical</code> whether or not soil temperature should be calculated in the shade.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>numeric</code> soil temperature (C).
</p>


<h3>Author(s)</h3>

<p>Joseph Grigg
</p>


<h3>References</h3>

<p>Beckman WA, Mitchell JW, Porter WP (1973).
“Thermal Model for Prediction of a Desert Iguana's Daily and Seasonal Behavior.”
<em>Journal of Heat Transfer</em>, <b>95</b>(2), 257-262.
doi: <a href="https://doi.org/10.1115/1.3450037">10.1115/1.3450037</a>.<br><br> deVries DA (1963).
“Thermal Properties of Soils.”
In <em>Physics of Plant Environment</em>.
North Holland Publishing Company.
doi: <a href="https://doi.org/10.1002/qj.49709038628">10.1002/qj.49709038628</a>.
</p>


<h3>See Also</h3>

<p>Other soil temperature functions: 
<code>soil_conductivity()</code>,
<code>soil_specific_heat()</code>,
<code>soil_temperature_equation()</code>,
<code>soil_temperature_function()</code>,
<code>soil_temperature_integrand()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  set.seed(123)
  temp_vector       &lt;- runif(48, min = -10, max = 10)
  wind_speed_vector &lt;- runif(48, min = 0, max = 0.4)
  time_vector       &lt;- rep(1:24, 2)
  solrad_vector     &lt;- rep(c(rep(0, 6), 
                             seq(10, 700, length.out = 6), 
                             seq(700, 10, length.out = 6), 
                             rep(0, 6)),
                           2)

  soil_temperature(z_r.intervals = 12, 
                   z_r           = 1.5, 
                   z             = 2, 
                   T_a           = temp_vector, 
                   u             = wind_speed_vector, 
                   Tsoil0        = 20, 
                   z0            = 0.02, 
                   SSA           = 0.7, 
                   TimeIn        = time_vector, 
                   S             = solrad_vector, 
                   water_content = 0.2, 
                   air_pressure  = 85, 
                   rho_so        = 1620, 
                   shade         = FALSE)

</code></pre>


</div>