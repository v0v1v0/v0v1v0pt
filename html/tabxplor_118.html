<div class="container">

<table style="width: 100%;"><tr>
<td>tab_ci</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Add confidence intervals to a <code>tab</code>
</h2>

<h3>Description</h3>

<p>Add confidence intervals to a <code>tab</code>
</p>


<h3>Usage</h3>

<pre><code class="language-R">tab_ci(
  tabs,
  ci = "auto",
  comp = NULL,
  conf_level = 0.95,
  color = "no",
  visible = FALSE,
  method_cell = "wilson",
  method_diff = "ac"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tabs</code></td>
<td>
<p>A <code>tibble</code> of class <code>tab</code> made with <code>tab_plain</code> or
<code>tab_many</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>
<p>The type of ci to calculate. Set to "cell" to calculate absolute confidence
intervals. Set to "diff" to calculate the confidence intervals of the difference
between a cell and the relative total cell (or the reference cell,
when <code>ref</code> is not <code>"tot"</code> in <code>tab_plain</code> or <code>tab_num</code>).
By default, "diff" ci are calculated for means and row and col percentages,
"cell" ci for frequencies ("all", "all_tabs"). By default, with <code>ci = "cell"</code>,
the result is printed in the <code style="white-space: pre;">⁠[inf;sup]⁠</code> form. Set
<code>options("tabxplor.ci_print" = "moe")</code> to print <code>pct +- moe</code> instead.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>comp</code></td>
<td>
<p>Comparison level. When <code>tab_vars</code> are present, should the
contributions to variance be calculated for each subtable/group (by default,
<code>comp = "tab"</code>) ? Should they be calculated for the whole table
(<code>comp = "all"</code>) ?
<code>comp</code> must be set once and for all the first time you use <code>tab_plain</code>,
<code>tab_num</code> or <code>tab_chi2</code> with rows, or <code>tab_ci</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf_level</code></td>
<td>
<p>The confidence level, as a single numeric between 0 and 1.
Default to 0.95 (95%).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color</code></td>
<td>
<p>The type of colors to print, as a single string.
</p>

<ul>
<li> <p><code>"no"</code>: by default, no colors are printed
</p>
</li>
<li> <p><code>"diff_ci"</code>: color pct and means based on cells differences from totals
or first cells, removing coloring when the confidence interval of this difference
is higher than the difference itself
</p>
</li>
<li> <p><code>"after_ci"</code>: idem, but cut off the confidence interval from the
difference
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>visible</code></td>
<td>
<p>By default confidence intervals are calculated and used to set colors,
but not printed. Set to <code>TRUE</code> to print them in the result.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method_cell</code></td>
<td>
<p>Character string specifying which method to use with percentages
for <code>ci = "cell"</code>. This can be one out of:
"wald", "wilson", "wilsoncc", "agresti-coull", "jeffreys", "modified wilson",
"modified jeffreys", "clopper-pearson", "arcsine", "logit", "witting", "pratt",
"midp", "lik" and "blaker". Defaults to "wilson".
See <code>BinomCI</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method_diff</code></td>
<td>
<p>Character string specifying which method to use with percentages
for <code>ci = "diff"</code>. This can be one out of: "wald", "waldcc", "ac", "score",
"scorecc", "mn", "mee", "blj", "ha", "hal", "jp". Defaults to "ac", Wald interval with
the adjustment according to Agresti, Caffo for difference in proportions and
independent samples. See <code>BinomDiffCI</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>tibble</code> of class <code>tab</code>, colored based on differences (from
totals/first cells) and confidence intervals.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># A typical workflow with tabxplor step-by-step functions :

data &lt;- dplyr::starwars %&gt;%
  tab_prepare(sex, hair_color, gender, other_if_less_than = 5,
              na_drop_all = sex)

data %&gt;%
  tab_plain(sex, hair_color, gender, tot = c("row", "col"),
    pct = "row", comp = "all") %&gt;%
    tab_ci("diff", color = "after_ci")
  
</code></pre>


</div>