<div class="container">

<table style="width: 100%;"><tr>
<td>thresTH3</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Population-based threshold calculation (three-state setting)
</h2>

<h3>Description</h3>

<p>This function estimates the theoretical optimum thresholds for the specific distribution parameters, decision costs and prevalences in a three-state setting.
</p>


<h3>Usage</h3>

<pre><code class="language-R">thresTH3(dist1, dist2, dist3, par1.1, par1.2,
  par2.1, par2.2, par3.1, par3.2, rho,
  costs = matrix(c(0, 1, 1, rho[1]/rho[2], 0, rho[3]/rho[2], 1, 1, 0),
  3, 3, byrow = TRUE), q1=0.05, q2=0.5, q3=0.95, tol = 10^(-8))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dist1</code></td>
<td>

<p>distribution to be assumed for the first population. See <b>Details</b>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist2</code></td>
<td>

<p>distribution to be assumed for the second population. See <b>Details</b>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist3</code></td>
<td>

<p>distribution to be assumed for the third population. See <b>Details</b>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par1.1</code></td>
<td>

<p>first parameter of the first distribution.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par1.2</code></td>
<td>

<p>second parameter of the first distribution.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par2.1</code></td>
<td>

<p>first parameter of the second distribution.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par2.2</code></td>
<td>

<p>second parameter of the second distribution.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par3.1</code></td>
<td>

<p>first parameter of the third distribution.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par3.2</code></td>
<td>

<p>second parameter of the third distribution.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>

<p>3-dimensional vector of prevalences.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>costs</code></td>
<td>

<p>cost matrix. Costs should be entered as a 3x3 matrix, where the first row corresponds to the costs associated with the classification of subjects in state 1 (C11, C12 and C13), second row corresponds to the costs associated with the classification of subjects in state 2 (C21, C22 and C23) and the third row corresponds to the costs associated with classification of subjects in state 3 (C31, C32, C33), where Cij is the cost of classifying an individual of class i as class j. Default cost values are a combination of costs that leads to the same thresholds as the Youden index method (see <b>References</b> for details).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q1</code></td>
<td>

<p>probability of the distribution taking lower values in order to determine a low quantile. Default, 0.05. See <b>Details</b>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q2</code></td>
<td>

<p>probability of the middle distribution in order to determine a medium quantile. Default, 0.5. See <b>Details</b>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q3</code></td>
<td>

<p>probability of the the distribution taking higher values in order to determine a high quantile. Default, 0.95. See <b>Details</b>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>

<p>tolerance to be used in function <code>uniroot</code>. Default, 10^(-8).
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Parameters <code>dist1</code>, <code>dist2</code> and <code>dist3</code> can be chosen between the following 2-parameter distributions: <code>"beta"</code>, <code>"cauchy"</code>, <code>"chisq"</code> (chi-squared), <code>"gamma"</code>, <code>"lnorm"</code> (lognormal), <code>"logis"</code> (logistic), <code>"norm"</code> (normal) and <code>"weibull"</code>.
</p>
<p>Parameters <code>q1</code>, <code>q2</code> and <code>q3</code> are used to determine two intervals where the <code>uniroot</code> function should look for the two threshold estimates. Thus, the first threshold is expected to be found between <code>quantile-1(q1)</code> and <code>quantile-2(q2)</code> and the second one, between <code>quantile-2(q2)</code> and <code>quantile-3(q3)</code>, being <code>quantile-i()</code> the quantile function for the i-th distribution, i=1,2,3.
</p>


<h3>Value</h3>

<p>An object of class <code>thresTH3</code>, which is a list with five components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>thres1 </code></td>
<td>
<p>first threshold estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thres2 </code></td>
<td>
<p>second threshold estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prev </code></td>
<td>
<p>prevalences provided by the user.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>costs </code></td>
<td>
<p>cost matrix provided by the user.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method </code></td>
<td>
<p>method used in the estimation. For an object of class <code>thresTH3</code> it is always equal to <code>"theoretical"</code> (meaning that the population-based method has been used).</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>It is assumed that <code>dist1</code> is the distribution with lower values and <code>dist3</code> is the one taking higher values. If that is not the case, <code>dist1</code>, <code>dist2</code> and <code>dist3</code> (and the corresponding parameters) are re-ordered as needed.
</p>


<h3>References</h3>

<p>Skaltsa K, Jover L, Fuster D, Carrasco JL. (2012). Optimum threshold estimation based on cost function in a multistate diagnostic setting. Statistics in Medicine, 31:1098-1109.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># example 1
dist &lt;- "norm"
par1.1 &lt;- 0
par1.2 &lt;- 1
par2.1 &lt;- 2
par2.2 &lt;- 1
par3.1 &lt;- 4
par3.2 &lt;- 1
rho &lt;- c(1/3, 1/3, 1/3)

thresTH3(dist, dist, dist,
  par2.1, par2.2, par1.1, par1.2,
  par3.1, par3.2, rho)
  
  
# example 2
dist1 &lt;- "norm"
dist2 &lt;- "lnorm"
dist3 &lt;- "lnorm"
par1.1 &lt;- 0
par1.2 &lt;- 1
par2.1 &lt;- 1
par2.2 &lt;- 0.5
par3.1 &lt;- 2
par3.2 &lt;- 0.5
rho &lt;- rep(1/3, 3)

thresTH3(dist1, dist2, dist3, par1.1, par1.2, par2.1, par2.2, par3.1, par3.2, rho)
</code></pre>


</div>