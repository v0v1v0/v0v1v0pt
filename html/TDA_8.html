<div class="container">

<table style="width: 100%;"><tr>
<td>bootstrapBand</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Bootstrap Confidence Band
</h2>

<h3>Description</h3>

<p>The function <code>bootstrapBand</code> computes a uniform symmetric confidence band around a function of the data <code>X</code>, evaluated on a <code>Grid</code>, using the bootstrap algorithm. See Details and References.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bootstrapBand(
    X, FUN, Grid, B = 30, alpha = 0.05, parallel = FALSE,
    printProgress = FALSE, weight = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>an <code class="reqn">n</code> by <code class="reqn">d</code> matrix of coordinates of points used by the function <code>FUN</code>, where <code class="reqn">n</code> is the number of points and <code class="reqn">d</code> is the dimension.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FUN</code></td>
<td>

<p>a function whose inputs are an <code class="reqn">n</code> by <code class="reqn">d</code> matrix of coordinates <code>X</code>, an <code class="reqn">m</code> by <code class="reqn">d</code> matrix of coordinates <code>Grid</code> and returns a numeric vector of length <code class="reqn">m</code>. For example see <code>distFct</code>, <code>kde</code>, and <code>dtm</code>  which compute the distance function, the kernel density estimator and the distance to measure over a grid of points, using the input <code>X</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Grid</code></td>
<td>

<p>an <code class="reqn">m</code> by <code class="reqn">d</code> matrix of coordinates, where <code class="reqn">m</code> is the number of points in the grid, at which <code>FUN</code> is evaluated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>

<p>the number of bootstrap iterations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p><code>bootstrapBand</code> returns a (<code>1-alpha</code>) confidence band. The default value is <code>0.05</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>

<p>logical: if <code>TRUE</code> the bootstrap iterations are parallelized, using the library <code>parallel</code>. The default value is <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>printProgress</code></td>
<td>

<p>if <code>TRUE</code>, a progress bar is printed. The default value is <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>

<p>either NULL, a number, or a vector of length <code class="reqn">n</code>. If it is NULL, weight is not used. If it is a number, then same weight is applied to each points of <code>X</code>. If it is a vector, <code>weight</code> represents weights of each points of <code>X</code>. The default value is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>additional parameters for the function <code>FUN</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>First, the input function <code>FUN</code> is evaluated on the <code>Grid</code> using the original data <code>X</code>. Then, for <code>B</code> times, the bootstrap algorithm subsamples <code>n</code> points of <code>X</code> (with replacement), evaluates the function <code>FUN</code> on the <code>Grid</code> using the subsample, and computes the <code class="reqn">\ell_\infty</code> distance between the original function and the bootstrapped one. The result is a sequence of <code>B</code> values. The (<code>1-alpha</code>) confidence band is constructed by taking the (<code>1-alpha</code>) quantile of these values.
</p>


<h3>Value</h3>

<p>The function <code>bootstrapBand</code> returns a list with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>

<p>number: (<code>1-alpha</code>) quantile of the values computed by the bootstrap algorithm. It corresponds to half of the width of the unfiorm confidence band; that is, <code>width</code> is the distance of the upper and lower limits of the band from the function evaluated using the original dataset <code>X</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fun</code></td>
<td>

<p>a numeric vector of length <code class="reqn">m</code>, storing the values of the input function <code>FUN</code>, evaluated on the <code>Grid</code> using the original data <code>X</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>band</code></td>
<td>

<p>an <code class="reqn">m</code> by 2 matrix that stores the values of the lower limit of the confidence band (first column) and upper limit of the confidence band (second column), evaluated over the <code>Grid</code>.
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jisu Kim and Fabrizio Lecci
</p>


<h3>References</h3>

<p>Wasserman L (2004). "All of statistics: a concise course in statistical inference." Springer.
</p>
<p>Fasy BT, Lecci F, Rinaldo A, Wasserman L, Balakrishnan S, Singh A (2013). "Statistical Inference For Persistent Homology: Confidence Sets for Persistence Diagrams." (arXiv:1303.7117). Annals of Statistics.
</p>
<p>Chazal F, Fasy BT, Lecci F, Michel B, Rinaldo A, Wasserman L (2014). "Robust Topological Inference: Distance-To-a-Measure and Kernel Distance." Technical Report. 
</p>


<h3>See Also</h3>

<p><code>kde</code>, <code>dtm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Generate data from mixture of 2 normals.
n &lt;- 2000
X &lt;- c(rnorm(n / 2), rnorm(n / 2, mean = 3, sd = 1.2))

# Construct a grid of points over which we evaluate the function
by &lt;- 0.02
Grid &lt;- seq(-3, 6, by = by)

## bandwidth for kernel density estimator
h &lt;- 0.3
## Bootstrap confidence band
band &lt;- bootstrapBand(X, kde, Grid, B = 80, parallel = FALSE, alpha = 0.05,
                      h = h)

plot(Grid, band[["fun"]], type = "l", lwd = 2,
     ylim = c(0, max(band[["band"]])), main = "kde with 0.95 confidence band")
lines(Grid, pmax(band[["band"]][, 1], 0), col = 2, lwd = 2)
lines(Grid, band[["band"]][, 2], col = 2, lwd = 2)
</code></pre>


</div>