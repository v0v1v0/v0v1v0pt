<div class="container">

<table style="width: 100%;"><tr>
<td>rag</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Retrieval-augmented Generation (RAG)</h2>

<h3>Description</h3>

<p>Performs retrieval-augmented generation {llama-index}
</p>
<p>Currently limited to the TinyLLAMA model
</p>


<h3>Usage</h3>

<pre><code class="language-R">rag(
  text = NULL,
  path = NULL,
  transformer = c("LLAMA-2", "Mistral-7B", "OpenChat-3.5", "Orca-2", "Phi-2",
    "TinyLLAMA"),
  prompt = "You are an expert at extracting themes across many texts",
  query,
  response_mode = c("accumulate", "compact", "no_text", "refine", "simple_summarize",
    "tree_summarize"),
  similarity_top_k = 5,
  device = c("auto", "cpu", "cuda"),
  keep_in_env = TRUE,
  envir = 1,
  progress = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>text</code></td>
<td>
<p>Character vector or list.
Text in a vector or list data format.
<code>path</code> will override input into <code>text</code>
Defaults to <code>NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>path</code></td>
<td>
<p>Character.
Path to .pdfs stored locally on your computer.
Defaults to <code>NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transformer</code></td>
<td>
<p>Character.
Large language model to use for RAG.
Available models include:
</p>

<dl>
<dt>"LLAMA-2"</dt>
<dd>
<p>The largest model available (13B parameters) but also the most challenging to get up and running for Mac and Windows. Linux operating systems run smooth. The challenge comes with installing the {llama-cpp-python} module. Currently, we do not provide support for Mac and Windows users</p>
</dd>
<dt>"Mistral-7B"</dt>
<dd>
<p>Mistral's 7B parameter model that serves as a high quality but more computationally expensive (more time consuming)</p>
</dd>
<dt>"Orca-2"</dt>
<dd>
<p>More documentation soon...</p>
</dd>
<dt>"Phi-2"</dt>
<dd>
<p>More documentation soon...</p>
</dd>
<dt>"TinyLLAMA"</dt>
<dd>
<p>Default. A smaller, 1B parameter version of LLAMA-2 that offers fast inference with reasonable quality</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prompt</code></td>
<td>
<p>Character (length = 1).
Prompt to feed into TinyLLAMA.
Defaults to <code>"You are an expert at extracting emotional themes across many texts"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>query</code></td>
<td>
<p>Character.
The query you'd like to know from the documents.
Defaults to <code>prompt</code> if not provided</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>response_mode</code></td>
<td>
<p>Character (length = 1).
Different responses generated from the model.
See documentation <a href="https://docs.llamaindex.ai/en/stable/module_guides/deploying/query_engine/response_modes.html">here</a>
</p>
<p>Defaults to <code>"tree_summarize"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>similarity_top_k</code></td>
<td>
<p>Numeric (length = 1).
Retrieves most representative texts given the <code>query</code>.
Larger values will provide a more comprehensive response but at
the cost of computational efficiency; small values will provide
a more focused response at the cost of comprehensiveness.
Defaults to <code>5</code>.
</p>
<p>Values will vary based on number of texts but some suggested values might be:
</p>

<dl>
<dt>40-60</dt>
<dd>
<p>Comprehensive search across all texts</p>
</dd>
<dt>20-40</dt>
<dd>
<p>Exploratory with good trade-off between comprehensive and speed</p>
</dd>
<dt>5-15</dt>
<dd>
<p>Focused search that should give generally good results</p>
</dd>
</dl>
<p>These values depend on the number and quality of texts. Adjust as necessary</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>device</code></td>
<td>
<p>Character.
Whether to use CPU or GPU for inference.
Defaults to <code>"auto"</code> which will use
GPU over CPU (if CUDA-capable GPU is setup).
Set to <code>"cpu"</code> to perform over CPU</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep_in_env</code></td>
<td>
<p>Boolean (length = 1).
Whether the classifier should be kept in your global environment.
Defaults to <code>TRUE</code>.
By keeping the classifier in your environment, you can skip
re-loading the classifier every time you run this function.
<code>TRUE</code> is recommended</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>envir</code></td>
<td>
<p>Numeric (length = 1).
Environment for the classifier to be saved for repeated use.
Defaults to the global environment</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress</code></td>
<td>
<p>Boolean (length = 1).
Whether progress should be displayed.
Defaults to <code>TRUE</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns response from TinyLLAMA
</p>


<h3>Author(s)</h3>

<p>Alexander P. Christensen &lt;alexpaulchristensen@gmail.com&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load data
data(neo_ipip_extraversion)

# Example text
text &lt;- neo_ipip_extraversion$friendliness[1:5]

## Not run: 
rag(
 text = text,
 query = "What themes are prevalent across the text?",
 response_mode = "tree_summarize",
 similarity_top_k = 5
)
## End(Not run)

</code></pre>


</div>