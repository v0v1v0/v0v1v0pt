<div class="container">

<table style="width: 100%;"><tr>
<td>tidyheatmap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create heatmap from tidy data</h2>

<h3>Description</h3>

<p>A tidyverse-style interface to the powerful heatmap package
<a href="https://github.com/raivokolde/pheatmap">pheatmap</a>.
It enables the convenient generation of complex heatmaps from tidy data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tidyheatmap(
  df,
  rows,
  columns,
  values,
  colors = NA,
  color_legend_n = 15,
  color_legend_min = NA,
  color_legend_max = NA,
  color_na = "#DDDDDD",
  annotation_row = NULL,
  annotation_col = NULL,
  gaps_row = NULL,
  gaps_col = NULL,
  show_selected_row_labels = NULL,
  show_selected_col_labels = NULL,
  filename = NA,
  scale = "none",
  fontsize = 7,
  cellwidth = NA,
  cellheight = NA,
  cluster_rows = FALSE,
  cluster_cols = FALSE,
  border_color = NA,
  kmeans_k = NA,
  clustering_distance_rows = "euclidean",
  clustering_distance_cols = "euclidean",
  clustering_method = "complete",
  clustering_callback = function(x, ...) {
     return(x)
 },
  cutree_rows = NA,
  cutree_cols = NA,
  treeheight_row = ifelse((class(cluster_rows) == "hclust") || cluster_rows, 50, 0),
  treeheight_col = ifelse((class(cluster_cols) == "hclust") || cluster_cols, 50, 0),
  legend = TRUE,
  legend_breaks = NA,
  legend_labels = NA,
  annotation_colors = NA,
  annotation_legend = TRUE,
  annotation_names_row = TRUE,
  annotation_names_col = TRUE,
  drop_levels = TRUE,
  show_rownames = TRUE,
  show_colnames = TRUE,
  main = NA,
  fontsize_row = fontsize,
  fontsize_col = fontsize,
  angle_col = c("270", "0", "45", "90", "315"),
  display_numbers = FALSE,
  number_format = "%.2f",
  number_color = "grey30",
  fontsize_number = 0.8 * fontsize,
  width = NA,
  height = NA,
  silent = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>A tidy dataframe in long format.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rows, columns</code></td>
<td>
<p>Column in the dataframe to use for heatmap <code>rows</code> and
<code>columns</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>values</code></td>
<td>
<p>Column in the dataframe containing the values to be color coded
in the heatmap cells.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colors</code></td>
<td>
<p>Vector of colors used for the color legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color_legend_n</code></td>
<td>
<p>Number of colors in the color legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color_legend_min, color_legend_max</code></td>
<td>
<p>Min and max value of the color legend.
Values smaller then the <code>color_legend_min</code> will have the lowest color,
<code>values</code> bigger than the <code>color_legend_max</code> will get the highest color.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color_na</code></td>
<td>
<p>Color to use for <code>NAs</code> in <code>values</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>annotation_row, annotation_col</code></td>
<td>
<p>Column(s) in the dataframe to use for
<code>row</code> and <code>column</code> annotation.
To use multiple columns for annotation combine then by <code>c(column1, column2)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gaps_row, gaps_col</code></td>
<td>
<p>Column in the dataframe to use for use for <code>row</code> and
<code>column</code> gaps.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_selected_row_labels, show_selected_col_labels</code></td>
<td>
<p>Only display a
subset of selected labels for <code>rows</code> and <code>columns</code>.
Provide selected labels as <code>c("label1", "label2")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filename</code></td>
<td>
<p>file path where to save the picture. Filetype is decided by 
the extension in the path. Currently following formats are supported: png, pdf, tiff,
bmp, jpeg. Even if the plot does not fit into the plotting window, the file size is 
calculated so that the plot would fit there, unless specified otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>character indicating if the values should be centered and scaled in 
either the row direction or the column direction, or none. Corresponding values are 
<code>"row"</code>, <code>"column"</code> and <code>"none"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fontsize</code></td>
<td>
<p>base fontsize for the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cellwidth</code></td>
<td>
<p>individual cell width in points. If left as NA, then the values 
depend on the size of plotting window.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cellheight</code></td>
<td>
<p>individual cell height in points. If left as NA, 
then the values depend on the size of plotting window.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster_rows</code></td>
<td>
<p>boolean values determining if rows should be clustered or <code>hclust</code> object,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster_cols</code></td>
<td>
<p>boolean values determining if columns should be clustered or <code>hclust</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>border_color</code></td>
<td>
<p>color of cell borders on heatmap, use NA if no border should be 
drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kmeans_k</code></td>
<td>
<p>the number of kmeans clusters to make, if we want to aggregate the 
rows before drawing heatmap. If NA then the rows are not aggregated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clustering_distance_rows</code></td>
<td>
<p>distance measure used in clustering rows. Possible 
values are <code>"correlation"</code> for Pearson correlation and all the distances 
supported by <code>dist</code>, such as <code>"euclidean"</code>, etc. If the value is none 
of the above it is assumed that a distance matrix is provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clustering_distance_cols</code></td>
<td>
<p>distance measure used in clustering columns. Possible 
values the same as for clustering_distance_rows.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clustering_method</code></td>
<td>
<p>clustering method used. Accepts the same values as 
<code>hclust</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clustering_callback</code></td>
<td>
<p>callback function to modify the clustering. Is 
called with two parameters: original <code>hclust</code> object and the matrix 
used for clustering. Must return a <code>hclust</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutree_rows</code></td>
<td>
<p>number of clusters the rows are divided into, based on the
hierarchical clustering (using cutree), if rows are not clustered, the 
argument is ignored</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutree_cols</code></td>
<td>
<p>similar to <code>cutree_rows</code>, but for columns</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>treeheight_row</code></td>
<td>
<p>the height of a tree for rows, if these are clustered. 
Default value 50 points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>treeheight_col</code></td>
<td>
<p>the height of a tree for columns, if these are clustered. 
Default value 50 points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>
<p>logical to determine if legend should be drawn or not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend_breaks</code></td>
<td>
<p>vector of breakpoints for the legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend_labels</code></td>
<td>
<p>vector of labels for the <code>legend_breaks</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>annotation_colors</code></td>
<td>
<p>list for specifying annotation_row and 
annotation_col track colors manually. It is  possible to define the colors 
for only some of the features. Check examples for  details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>annotation_legend</code></td>
<td>
<p>boolean value showing if the legend for annotation 
tracks should be drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>annotation_names_row</code></td>
<td>
<p>boolean value showing if the names for row annotation 
tracks should be drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>annotation_names_col</code></td>
<td>
<p>boolean value showing if the names for column annotation 
tracks should be drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drop_levels</code></td>
<td>
<p>logical to determine if unused levels are also shown in 
the legend</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_rownames</code></td>
<td>
<p>boolean specifying if column names are be shown.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_colnames</code></td>
<td>
<p>boolean specifying if column names are be shown.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>the title of the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fontsize_row</code></td>
<td>
<p>fontsize for rownames (Default: fontsize)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fontsize_col</code></td>
<td>
<p>fontsize for colnames (Default: fontsize)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>angle_col</code></td>
<td>
<p>angle of the column labels, right now one can choose only from few 
predefined options (0, 45, 90, 270 and 315)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>display_numbers</code></td>
<td>
<p>logical determining if the numeric values are also printed to 
the cells. If this is a matrix (with same dimensions as original matrix), the contents
of the matrix are shown instead of original values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>number_format</code></td>
<td>
<p>format strings (C printf style) of the numbers shown in cells. 
For example "<code>%.2f</code>" shows 2 decimal places and "<code>%.1e</code>" shows exponential 
notation (see more in <code>sprintf</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>number_color</code></td>
<td>
<p>color of the text</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fontsize_number</code></td>
<td>
<p>fontsize of the numbers displayed in cells</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>manual option for determining the output file width in inches.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>height</code></td>
<td>
<p>manual option for determining the output file height in inches.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>do not draw the plot (useful when using the gtable output)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Invisibly a <code>pheatmap</code> object that is a list with components
</p>

<ul>
<li> <p><code>tree_row</code> the clustering of rows as <code>hclust</code> object
</p>
</li>
<li> <p><code>tree_col</code> the clustering of columns as <code>hclust</code> object
</p>
</li>
<li> <p><code>kmeans</code> the kmeans clustering of rows if parameter <code>kmeans_k</code> was specified
</p>
</li>
<li> <p><code>gtable</code> a <code>gtable</code> object containing the heatmap, can be used for combining
the heatmap with other plots
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R"># Basic example
tidyheatmap(data_exprs,
            rows = external_gene_name,
            columns = sample,
            values = expression,
            scale = "row"
)

# Change number of colors in color lengend
tidyheatmap(data_exprs,
            rows = external_gene_name,
            columns = sample,
            values = expression,
            scale = "row",
            color_legend_n = 5
)

# Change color in color legend
tidyheatmap(data_exprs,
            rows = external_gene_name,
            columns = sample,
            values = expression,
            scale = "row",
            colors = c("#145afc","#ffffff","#ee4445")
)

# Add row and column annotation
tidyheatmap(data_exprs,
            rows = external_gene_name,
            columns = sample,
            values = expression,
            scale = "row",
            annotation_col = c(sample_type, condition, group),
            annotation_row = c(is_immune_gene, direction)
)

# Add gaps between rows and columns
tidyheatmap(data_exprs,
            rows = external_gene_name,
            columns = sample,
            values = expression,
            scale = "row",
            annotation_col = c(sample_type, condition, group),
            annotation_row = c(is_immune_gene, direction),
            gaps_row = direction,
            gaps_col = group
)

</code></pre>


</div>