<div class="container">

<table style="width: 100%;"><tr>
<td>trait_multivariate_bootstrap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bootstrap traits</h2>

<h3>Description</h3>

<p>Function for nonparametric bootstrap resampling to
calculate community
weighted trait correlations, other bivariate or multivariate statistics
</p>


<h3>Usage</h3>

<pre><code class="language-R">trait_multivariate_bootstrap(
  filled_traits,
  nrep = 100,
  sample_size = 200,
  raw = FALSE,
  id = "ID",
  fun
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>filled_traits</code></td>
<td>
<p>output from the trait_fill function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrep</code></td>
<td>
<p>number of bootstrap replicates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample_size</code></td>
<td>
<p>bootstrap size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>raw</code></td>
<td>
<p>logical; argument to extract the raw data of the trait
distributions.
The default is <code>raw = FALSE</code>.
If <code>raw = TRUE</code>, <code>nrep</code> is restricted to 1 to avoid memory issues.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>column name of unique identifiers of each leaf</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fun</code></td>
<td>
<p>bivariate or multivariate function to apply</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The observed and filled leaves are re-sampled in proportion to
their weights, e.g. the abundance of a species or the biomass.
Values across all individuals in a community are
resampled <code>sample_size</code> times to incorporate the full
spectrum of trait variation, generating <code>nrep</code> trait distributions.
The function <code>fun</code> is applied to the trait distribution at the finest level
of the filled trait hierarchy.
</p>
<p>Note that due to the flexibility of this function,
the output CAN NOT be summarized using
<code>trait_summarise_boot_moments</code>.
</p>


<h3>Value</h3>

<p>a tibble with columns for the elements of the scale_hierarchy,
and a list column result which includes the output of <code>fun</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">require(dplyr)
require(tidyr)
require(ggplot2)
require(purrr)

data(community)
data(trait)

filled_traits &lt;- trait_fill(
  comm = community |&gt;
    filter(
      PlotID %in% c("A", "B"),
      Site == 1
    ),
  traits = trait,
  scale_hierarchy = c("Site", "PlotID"),
  taxon_col = "Taxon", value_col = "Value",
  trait_col = "Trait", abundance_col = "Cover",
  complete_only = TRUE, leaf_id = "ID"
)

# Note that more replicates and a greater sample size are advisable
# Here we set them low to make the example run quickly
boot_traits &lt;- trait_multivariate_bootstrap(filled_traits,
  fun = cor,
  nrep = 10,
  sample_size = 100
)

boot_traits_long &lt;- boot_traits |&gt;
  mutate(correlations = map(result, ~ cor_to_df(.x))) |&gt;
  select(-result) |&gt;
  unnest(correlations)

boot_traits_long |&gt;
  ggplot(aes(x = paste(row, "v", col), y = value)) +
  geom_violin() +
  facet_grid(Site ~ PlotID) +
  coord_flip() +
  labs(y = "Correlation", x = "")
</code></pre>


</div>