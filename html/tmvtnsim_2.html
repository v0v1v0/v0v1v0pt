<div class="container">

<table style="width: 100%;"><tr>
<td>rtmvnorm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Random Generation for Truncated Multivariate Normal</h2>

<h3>Description</h3>

<p>Draws from truncated multivariate normal distribution subject to 
linear inequality constraints represented by a matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rtmvnorm(
  mean,
  sigma,
  blc = NULL,
  lower,
  upper,
  init = NULL,
  burn = 10,
  n = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>
<p><code>n x p</code> matrix of means. The number of rows is the number 
of observations. The number of columns is the dimension of the problem.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p><code>p x p</code> covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>blc</code></td>
<td>
<p><code>m x p</code> matrix of coefficients for linear inequality 
constraints. If <code>NULL</code>, the <code>p x p</code> identity matrix will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p><code>n x m</code> or <code>1 x m</code> matrix of lower bounds for 
truncation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p><code>n x m</code> or <code>1 x m</code> matrix of upper bounds for 
truncation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p><code>n x p</code> or <code>1 x p</code> matrix of initial values. 
If <code>NULL</code>, default initial values will be generated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn</code></td>
<td>
<p>number of burn-in iterations. Defaults to 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of random samples when <code>mean</code> is a vector.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns an <code>n x p</code> matrix of random numbers following the 
specified truncated multivariate normal distribution.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Example 1: full rank blc
d = 3;
rho = 0.9;
sigma = matrix(0, d, d);
sigma = rho^abs(row(sigma) - col(sigma));
blc = diag(1,d);
n = 1000;
mean = matrix(rep(1:d,n), nrow=n, ncol=d, byrow=TRUE);
set.seed(1203)
result = rtmvnorm(mean, sigma, blc, -1, 1, burn=50)
apply(result, 2, summary)

# Example 2: use the alternative form of input
set.seed(1203)
result = rtmvnorm(mean=1:d, sigma, blc, -1, 1, burn=50, n=1000)
apply(result, 2, summary)

# Example 3: non-full rank blc
d = 3;
rho = 0.5;
sigma = matrix(0, d, d);
sigma = rho^abs(row(sigma) - col(sigma));
blc = matrix(c(1,1,1,0,1,0,1,0,1), ncol=d);
n = 100;
mean = matrix(rep(1:d,n), nrow=n, ncol=d, byrow=TRUE);
set.seed(1228)
result = rtmvnorm(mean, sigma, blc, -1, 1, burn=10)
apply(result, 2, summary)

# Example 4: non-full rank blc, alternative form of input
set.seed(1228)
result = rtmvnorm(mean=1:d, sigma, blc, -1, 1, burn=10, n=100)
apply(result, 2, summary) 

# Example 5: means, lower, or upper bounds differ across samples
d = 3;
rho = 0.5;
sigma = matrix(0, d, d);
sigma = rho^abs(row(sigma) - col(sigma));
blc = matrix(c(1,0,1,1,1,0), ncol=d, byrow=TRUE)
n = 100;
set.seed(3084)
mean = matrix(runif(n*d), nrow=n, ncol=d);
result = rtmvnorm(mean, sigma, blc, -1, 1, burn=50)
apply(result, 2, summary)

</code></pre>


</div>