<div class="container">

<table style="width: 100%;"><tr>
<td>tcplfit2_core</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Concentration-response curve fitting</h2>

<h3>Description</h3>

<p>Concentration response curve fitting using the methods from BMDExpress
</p>


<h3>Usage</h3>

<pre><code class="language-R">tcplfit2_core(
  conc,
  resp,
  cutoff,
  force.fit = FALSE,
  bidirectional = TRUE,
  verbose = FALSE,
  do.plot = FALSE,
  fitmodels = c("cnst", "hill", "gnls", "poly1", "poly2", "pow", "exp2", "exp3", "exp4",
    "exp5"),
  poly2.biphasic = TRUE,
  errfun = "dt4",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>conc</code></td>
<td>
<p>Vector of concentrations (NOT in log units).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resp</code></td>
<td>
<p>Vector of responses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>
<p>Desired cutoff. If no absolute responses &gt; cutoff and
force.fit = FALSE, will only fit constant model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>force.fit</code></td>
<td>
<p>If force.fit = TRUE, will fit all models regardless of cutoff.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bidirectional</code></td>
<td>
<p>If bidirectional = FALSE, will only give positive fits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>If verbose = TRUE, will print optimization details and aics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do.plot</code></td>
<td>
<p>If do.plot = TRUE, will generate a plot comparing model curves.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitmodels</code></td>
<td>
<p>Vector of model names to try fitting. Missing models still
return a skeleton output filled with NAs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>poly2.biphasic</code></td>
<td>
<p>If poly2.biphasic = TRUE, allows for biphasic polynomial 2
model fits (i.e. both monotonic and non-monotonic). (Defaults to TRUE.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>errfun</code></td>
<td>
<p>Which error distribution to assume for each point, defaults to
"dt4". "dt4" is the original 4 degrees of freedom t-distribution. Another
supported distribution is "dnorm", the normal distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other fitting parameters (deprecated).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>All models are equal to 0 at 0 concentration (zero background).
To add more models in the future, write a fit____ function, and add the model
name to the fitmodels and modelnames vectors.
</p>


<h3>Value</h3>

<p>List of N(models) elements, one for each of the models run (up to 10),
followed by a element "modelnames", which is a vector of model names so
other functions can easily cycle through the output, and then the last element
"errfun", which indicates what distribution was used for error. For a full list, see the
documentation for the individual fitting method functions. For each model there
is a sublist with elements including:
</p>

<ul>
<li>
<p> success - was the model successfully fit
</p>
</li>
<li>
<p> aic - the AIC value
</p>
</li>
<li>
<p> cov - success of the the covariance matrix calculation
</p>
</li>
<li>
<p> rme - root mean error of the data around the curve
</p>
</li>
<li>
<p> modl - vector of model values at the given concentrations
</p>
</li>
<li>
<p> tp - the top of the curve fit
</p>
</li>
<li>
<p> ga - the AC50 or Hill paramters
</p>
</li>
<li>
<p> er - the error term
</p>
</li>
<li>
<p> ... other paramters specific to the model (see the documentation for the specific models)
</p>
</li>
<li>
<p> tp_sd, ga_sd, p_sd, etc., the values of the standard deviations of the paramters for the models
</p>
</li>
<li>
<p> er_sd - standard deviation of the error term
</p>
</li>
<li>
<p> pars - the names of the parameters
</p>
</li>
<li>
<p> sds - the names of the standard deviations of the paramters
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">conc &lt;- c(.03, .1, .3, 1, 3, 10, 30, 100)
resp &lt;- c(0, .1, 0, .2, .6, .9, 1.1, 1)
output &lt;- tcplfit2_core(conc, resp, .8,
  fitmodels = c("cnst", "hill"), verbose = TRUE,
  do.plot = TRUE
)
</code></pre>


</div>