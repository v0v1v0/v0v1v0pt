<div class="container">

<table style="width: 100%;"><tr>
<td>fmri_post_hoc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>post-hoc process for p values</h2>

<h3>Description</h3>

<p>This function is used to conduct the post-hoc process (i.e. FDR correction and spatial clustering) for a 3-dimensional p-value array.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fmri_post_hoc(
  p_val_3d,
  fdr_corr = NULL,
  spatial_cluster.thr = NULL,
  spatial_cluster.size = NULL,
  show_comparison = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p_val_3d</code></td>
<td>
<p>an array which contains the p-values as the result of fMRI statistical tests.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fdr_corr</code></td>
<td>
<p>The default is NULL. Input 'fdr' to conduct FDR correction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spatial_cluster.thr</code></td>
<td>
<p>The default is NULL. Together with spatial_cluster.size are used to filter contiguous clusters of locations in a 3D array that are below some threshold and with some minimum size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spatial_cluster.size</code></td>
<td>
<p>The default is NULL. The size of spatial cluster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_comparison</code></td>
<td>
<p>The default is FALSE. If TRUE, the output would display the comparison between raw and processed p-values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>One can specify breaks etc. to modify the comparison histogram in ggplot2.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>fmri_post_hoc</code> would help do the FDR correction and spatial clustering for a 3d p-value array. The FDR correction controls for a low proportion of false positives, while the spatial clustering part help filter out all sparse p-values that are not in specified clusters.
</p>


<h3>Value</h3>

<p>3D p-values after FDR correction or spatial clustering
</p>


<h3>Author(s)</h3>

<p>SOCR team &lt;<a href="http://socr.umich.edu/people/">http://socr.umich.edu/people/</a>&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R"># sample 3D p value provided by the package
dim(phase2_pval)

# do the FDR correction
pval_fdr = fmri_post_hoc(phase2_pval, 
                         fdr_corr = 'fdr',
                         spatial_cluster.thr = NULL,
                         spatial_cluster.size = NULL, 
                         show_comparison = FALSE)

# do the spatial clustering
pval_posthoc = fmri_post_hoc(pval_fdr,
                             fdr_corr = NULL,
                             spatial_cluster.thr = 0.05,
                             spatial_cluster.size = 5, 
                             show_comparison = FALSE)

</code></pre>


</div>