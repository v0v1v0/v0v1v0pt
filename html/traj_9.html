<div class="container">

<table style="width: 100%;"><tr>
<td>Step3Clusters</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Classify the Longitudinal Data Based on the Selected Measures.</h2>

<h3>Description</h3>

<p>Classifies the trajectories by applying the k-means clustering
algorithm to the measures selected by <code>Step2Selection</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Step3Clusters(
  trajSelection,
  algorithm = "k-medoids",
  metric = "euclidean",
  nstart = 200,
  iter.max = 100,
  nclusters = NULL,
  criterion = "Calinski-Harabasz",
  K.max = min(15, nrow(trajSelection$selection) - 1),
  boot = FALSE,
  R = 100,
  B = 500
)

## S3 method for class 'trajClusters'
print(x, ...)

## S3 method for class 'trajClusters'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>trajSelection</code></td>
<td>
<p>object of class <code>trajSelection</code> as returned by
<code>Step2Selection</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>algorithm</code></td>
<td>
<p>either <code>"k-medoids"</code> or <code>"k-means"</code>. Determines the clustering algorithm to use. Defaults to <code>"k-medoids"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metric</code></td>
<td>
<p>to be passed to the <code>metric</code> argument of
<code>pam</code> if <code>"k-medoids"</code> is the chosen <code>algorithm</code>. Defaults to <code>"euclidean"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nstart</code></td>
<td>
<p>to be passed to the <code>nstart</code> argument of
<code>kmeans</code> if <code>"k-means"</code> is the chosen <code>algorithm</code>. Defaults to <code>200</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter.max</code></td>
<td>
<p>to be passed to the <code>iter.max</code> argument of
<code>kmeans</code> if <code>"k-means"</code> is the chosen <code>algorithm</code>. Defaults to <code>100</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nclusters</code></td>
<td>
<p>either <code>NULL</code> or the desired number of clusters. If <code>NULL</code>, the
number of clusters is determined using the criterion chosen in <code>criterion</code>. Defaults to <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion</code></td>
<td>
<p>criterion to determine the optimal number of clusters if <code>nclusters</code> is <code>NULL</code>. Either <code>"GAP"</code> or <code>"Calinski-Harabasz"</code>. Defaults to <code>"Calinski-Harabasz"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K.max</code></td>
<td>
<p>maximum number of clusters to be considered if <code>nclusters</code> is set to <code>NULL</code>. Defaults to <code>15</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot</code></td>
<td>
<p>logical. If <code>TRUE</code>, and if <code>"Calinski-Harabasz"</code> is the chosen <code>criterion</code>, the optimal number of clusters will be the first mode of sampling distribution of the optimal number of clusters obtained by bootstrap. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>the number of bootstrap replicate if <code>boot</code> is set to <code>TRUE</code>. Defaults to <code>100</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>to be passed to the <code>B</code> argument of
<code>clusGap</code> if <code>"GAP"</code> is the chosen <code>criterion</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>object of class <code>trajClusters</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>object of class <code>trajClusters</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>"GAP"</code> is the chosen <code>criterion</code> for determining the optimal number of clusters, the method described by Tibshirani et al. is implemented by the <code>clusGap</code> function.
</p>
<p>Instead, if <code>"Calinski-Harabasz"</code> is the chosen <code>criterion</code>, the Calinski-Harabasz index is computed for each possible number of clusters between 2 and <code>K.max</code> and the optimal number of clusters is the maximizer of the Calinski-Harabasz index. Moreover, if <code>boot</code> is set to <code>TRUE</code>, then, following the guidelines suggested by Mesidor et al., a sampling distribution of the optimal number of clusters is obtained by bootstrap and the optimal number of clusters is chosen to be the (first) mode of this sampling distribution.
</p>


<h3>Value</h3>

<p>An object of class <code>trajClusters</code>; a list containing the result
of the clustering, as well as a curated form of the arguments.
</p>


<h3>References</h3>

<p>Miceline Mésidor, Caroline Sirois, Marc Simard, Denis Talbot, A Bootstrap Approach for Evaluating Uncertainty in the Number of Groups Identified by Latent Class Growth Models, American Journal of Epidemiology, Volume 192, Issue 11, November 2023, Pages 1896–1903, https://doi.org/10.1093/aje/kwad148
</p>
<p>Tibshirani, R., Walther, G. and Hastie, T. (2001). Estimating the number of data clusters via the Gap statistic. Journal of the Royal Statistical Society B, 63, 411–423.
</p>
<p>Tibshirani, R., Walther, G. and Hastie, T. (2000). Estimating the number of clusters in a dataset via the Gap statistic. Technical Report. Stanford.
</p>


<h3>See Also</h3>

<p><code>Step2Selection</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data("trajdata")
trajdata.noGrp &lt;- trajdata[, -which(colnames(trajdata) == "Group")] #remove the Group column

m = Step1Measures(trajdata.noGrp, ID = TRUE, measures = 1:18)
s = Step2Selection(m)

s$RC$loadings

s2 = Step2Selection(m, select = c(10, 12, 8, 4))

c3.part &lt;- Step3Clusters(s2, nclusters = 3)$partition
c4.part &lt;- Step3Clusters(s2, nclusters = 4)$partition
c5.part &lt;- Step3Clusters(s2, nclusters = 5)$partition


## End(Not run)

</code></pre>


</div>