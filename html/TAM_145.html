<div class="container">

<table style="width: 100%;"><tr>
<td>tam.wle</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Weighted Likelihood Estimation and Maximum Likelihood Estimation of
Person Parameters
</h2>

<h3>Description</h3>

<p>Compute the weighted likelihood estimator (Warm, 1989)
for objects of classes <code>tam</code>, <code>tam.mml</code> and <code>tam.jml</code>,
respectively.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tam.wle(tamobj, ...)

tam.mml.wle( tamobj, score.resp=NULL, WLE=TRUE, adj=.3, Msteps=20,
       convM=.0001, progress=TRUE,    output.prob=FALSE )

tam.mml.wle2(tamobj, score.resp=NULL, WLE=TRUE, adj=0.3, Msteps=20, convM=1e-04,
        progress=TRUE, output.prob=FALSE, pid=NULL, theta_init=NULL )

tam_jml_wle(tamobj, resp, resp.ind, A, B, nstud, nitems, maxK, convM,
    PersonScores, theta, xsi, Msteps, WLE=FALSE, theta.fixed=NULL, progress=FALSE,
    output.prob=TRUE, damp=0, version=2)

## S3 method for class 'tam.wle'
summary(object, file=NULL, digits=3, ...)

## S3 method for class 'tam.wle'
print(x, digits=3, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tamobj</code></td>
<td>

<p>An object generated by <code>tam.mml</code> or <code>tam.jml</code>. The object can also
be a list containing (at least the) inputs <code>AXsi</code>, <code>B</code> and
<code>resp</code> and therefore allows WLE estimation without fitting models
in <span class="pkg">TAM</span>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>score.resp</code></td>
<td>
<p>An optional data frame for which WLEs or MLEs
should be calculated. In case of the default <code>NULL</code>,
<code>resp</code> from <code>tamobj</code> (i.e. <code>tamobj$resp</code>) is chosen.
Note that items in <code>score.resp</code> must be the same (and in the
same order) as in <code>tamobj$resp</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>WLE</code></td>
<td>

<p>A logical indicating whether the weighted likelihood estimate
(WLE, <code>WLE=TRUE</code>) or the maximum likelihood estimate (MLE, <code>WLE=FALSE</code>)
should be used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adj</code></td>
<td>

<p>Adjustment in MLE estimation for extreme scores (i.e. all or none
items were correctly solved). This argument is not used if
<code>WLE=TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Msteps</code></td>
<td>

<p>Maximum number of iterations
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convM</code></td>
<td>

<p>Convergence criterion
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress</code></td>
<td>
<p>Logical indicating whether progress should be displayed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output.prob</code></td>
<td>
<p>Logical indicating whether evaluated probabilities should
be included in the list of outputs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pid</code></td>
<td>
<p>Optional vector of person identifiers</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta_init</code></td>
<td>
<p>Initial theta values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resp</code></td>
<td>
<p>Data frame with item responses (only for <code>tam.jml.WLE</code>)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resp.ind</code></td>
<td>
<p>Data frame with response indicators (only for <code>tam.jml.WLE</code>)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>Design matrix <code class="reqn">A</code> (applies only to <code>tam.jml.WLE</code>)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>Design matrix <code class="reqn">B</code> (applies only to <code>tam.jml.WLE</code>)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nstud</code></td>
<td>
<p>Number of persons (applies only to <code>tam.jml.WLE</code>)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nitems</code></td>
<td>
<p>Number of items (applies only to <code>tam.jml.WLE</code>)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxK</code></td>
<td>
<p>Maximum item score (applies only to <code>tam.jml.WLE</code>)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PersonScores</code></td>
<td>
<p>A vector containing the sufficient statistics for the
person parameters (applies only to <code>tam.jml.WLE</code>)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>Initial <code class="reqn">\theta</code> estimate (applies only to <code>tam.jml.WLE</code>)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xsi</code></td>
<td>
<p>Parameter vector <code class="reqn">\xi</code> (applies only to <code>tam.jml.WLE</code>)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta.fixed</code></td>
<td>
<p>Matrix for fixed person parameters <code class="reqn">\theta</code>. The first
column includes the index whereas the second column includes
the fixed value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>damp</code></td>
<td>
<p>Numeric value between 0 and 1 indicating amount of dampening
increments in <code class="reqn">\theta</code> estimates during iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>version</code></td>
<td>
<p>Integer with possible values 2 or 3. In case of missing item responses,
<code>version=3</code> will typically be more efficient.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>Object of class <code>tam.wle</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Object of class <code>tam.wle</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>Optional file name in which the object summary should be written.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>Number of digits for rounding</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>For <code>tam.wle.mml</code> and <code>tam.wle.mml2</code>, it is a data frame with following
columns:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>pid</code></td>
<td>
<p>Person identifier</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PersonScores</code></td>
<td>
<p>Score of each person</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PersonMax</code></td>
<td>
<p>Maximum score of each person</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>Weighted likelihood estimate (WLE) or MLE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>error</code></td>
<td>
<p>Standard error of the WLE or MLE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>WLE.rel</code></td>
<td>
<p>WLE reliability (same value for all persons)</p>
</td>
</tr>
</table>
<p><br></p>
<p>For <code>tam.jml.WLE</code>, it is a list with following entries:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>Weighted likelihood estimate (WLE) or MLE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>errorWLE</code></td>
<td>
<p>Standard error of the WLE or MLE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meanChangeWLE</code></td>
<td>
<p>Mean change between updated and previous ability
estimates from last iteration</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Penfield, R. D., &amp; Bergeron, J. M. (2005). Applying a weighted maximum
likelihood latent trait estimator to the generalized partial credit model.
<em>Applied Psychological Measurement, 29</em>, 218-233.
</p>
<p>Warm, T. A. (1989). Weighted likelihood estimation of ability in item
response theory. <em>Psychometrika, 54</em>, 427-450.
<a href="https://doi.org/10.1007/BF02294627">doi:10.1007/BF02294627</a>
</p>


<h3>See Also</h3>

<p>See the <code>PP::PP_gpcm</code> function
in the <span class="pkg">PP</span> package for more person
parameter estimators for the partial credit model (Penfield &amp; Bergeron, 2005).
</p>
<p>See the S3 method <code>IRT.factor.scores.tam</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#############################################################################
# EXAMPLE 1: 1PL model, data.sim.rasch
#############################################################################

data(data.sim.rasch)
# estimate Rasch model
mod1 &lt;- TAM::tam.mml(resp=data.sim.rasch)
# WLE estimation
wle1 &lt;- TAM::tam.wle( mod1 )
  ## WLE Reliability=0.894

print(wle1)
summary(wle1)

# scoring for a different dataset containing same items (first 10 persons in sim.rasch)
wle2 &lt;- TAM::tam.wle( mod1, score.resp=data.sim.rasch[1:10,])

#--- WLE estimation without using a TAM object

#* create an input list
input &lt;- list( resp=data.sim.rasch, AXsi=mod1$AXsi, B=mod1$B )
#* estimation
wle2b &lt;- TAM::tam.mml.wle2( input )

## Not run: 
#############################################################################
# EXAMPLE 2: 3-dimensional Rasch model | data.read from sirt package
#############################################################################

data(data.read, package="sirt")
# define Q-matrix
Q &lt;- matrix(0,12,3)
Q[ cbind( 1:12, rep(1:3,each=4) ) ] &lt;- 1
# redefine data: create some missings for first three cases
resp &lt;- data.read
resp[1:2, 5:12] &lt;- NA
resp[3,1:4] &lt;- NA
  ##   &gt; head(resp)
  ##      A1 A2 A3 A4 B1 B2 B3 B4 C1 C2 C3 C4
  ##   2   1  1  1  1 NA NA NA NA NA NA NA NA
  ##   22  1  1  0  0 NA NA NA NA NA NA NA NA
  ##   23 NA NA NA NA  1  0  1  1  1  1  1  1
  ##   41  1  1  1  1  1  1  1  1  1  1  1  1
  ##   43  1  0  0  1  0  0  1  1  1  0  1  0
  ##   63  1  1  0  0  1  0  1  1  1  1  1  1

# estimate 3-dimensional Rasch model
mod &lt;- TAM::tam.mml( resp=resp, Q=Q, control=list(snodes=1000,maxiter=50) )
summary(mod)

# WLE estimates
wmod &lt;- TAM::tam.wle(mod, Msteps=3)
summary(wmod)
  ##   head(round(wmod,2))
  ##      pid N.items PersonScores.Dim01 PersonScores.Dim02 PersonScores.Dim03
  ##   2    1       4                3.7                0.3                0.3
  ##   22   2       4                2.0                0.3                0.3
  ##   23   3       8                0.3                3.0                3.7
  ##   41   4      12                3.7                3.7                3.7
  ##   43   5      12                2.0                2.0                2.0
  ##   63   6      12                2.0                3.0                3.7
  ##      PersonMax.Dim01 PersonMax.Dim02 PersonMax.Dim03 theta.Dim01 theta.Dim02
  ##   2              4.0             0.6             0.6        1.06          NA
  ##   22             4.0             0.6             0.6       -0.96          NA
  ##   23             0.6             4.0             4.0          NA       -0.07
  ##   41             4.0             4.0             4.0        1.06        0.82
  ##   43             4.0             4.0             4.0       -0.96       -1.11
  ##   63             4.0             4.0             4.0       -0.96       -0.07
  ##      theta.Dim03 error.Dim01 error.Dim02 error.Dim03 WLE.rel.Dim01
  ##   2           NA        1.50          NA          NA          -0.1
  ##   22          NA        1.11          NA          NA          -0.1
  ##   23        0.25          NA        1.17        1.92          -0.1
  ##   41        0.25        1.50        1.48        1.92          -0.1
  ##   43       -1.93        1.11        1.10        1.14          -0.1

# (1) Note that estimated WLE reliabilities are not trustworthy in this example.
# (2) If cases do not possess any observations on dimensions, then WLEs
#     and their corresponding standard errors are set to NA.

#############################################################################
# EXAMPLE 3: Partial credit model | Comparison WLEs with PP package
#############################################################################

library(PP)
data(data.gpcm)
dat &lt;- data.gpcm
I &lt;- ncol(dat)

#****************************************
#*** Model 1: Partial Credit Model

# estimation in TAM
mod1 &lt;- TAM::tam.mml( dat )
summary(mod1)

#-- WLE estimation in TAM
tamw1 &lt;- TAM::tam.wle( mod1 )

#-- WLE estimation with PP package
# convert AXsi parameters into thres parameters for PP
AXsi0 &lt;- - mod1$AXsi[,-1]
b &lt;- AXsi0
K &lt;- ncol(AXsi0)
for (cc in 2:K){
    b[,cc] &lt;- AXsi0[,cc] - AXsi0[,cc-1]
}
# WLE estimation in PP
ppw1 &lt;- PP::PP_gpcm( respm=as.matrix(dat),  thres=t(b), slopes=rep(1,I) )

#-- compare results
dfr &lt;- cbind( tamw1[, c("theta","error") ], ppw1$resPP)
head( round(dfr,3))
  ##      theta error resPP.estimate resPP.SE nsteps
  ##   1 -1.006 0.973         -1.006    0.973      8
  ##   2 -0.122 0.904         -0.122    0.904      8
  ##   3  0.640 0.836          0.640    0.836      8
  ##   4  0.640 0.836          0.640    0.836      8
  ##   5  0.640 0.836          0.640    0.836      8
  ##   6 -1.941 1.106         -1.941    1.106      8
plot( dfr$resPP.estimate, dfr$theta, pch=16, xlab="PP", ylab="TAM")
lines( c(-10,10), c(-10,10) )

#****************************************
#*** Model 2: Generalized partial Credit Model

# estimation in TAM
mod2 &lt;- TAM::tam.mml.2pl( dat, irtmodel="GPCM" )
summary(mod2)

#-- WLE estimation in TAM
tamw2 &lt;- TAM::tam.wle( mod2 )

#-- WLE estimation in PP
# convert AXsi parameters into thres and slopes parameters for PP
AXsi0 &lt;- - mod2$AXsi[,-1]
slopes &lt;- mod2$B[,2,1]
K &lt;- ncol(AXsi0)
slopesM &lt;- matrix( slopes, I, ncol=K )
AXsi0 &lt;- AXsi0 / slopesM
b &lt;- AXsi0
for (cc in 2:K){
    b[,cc] &lt;- AXsi0[,cc] - AXsi0[,cc-1]
}
# estimation in PP
ppw2 &lt;- PP::PP_gpcm( respm=as.matrix(dat),  thres=t(b), slopes=slopes )

#-- compare results
dfr &lt;- cbind( tamw2[, c("theta","error") ], ppw2$resPP)
head( round(dfr,3))
  ##      theta error resPP.estimate resPP.SE nsteps
  ##   1 -0.476 0.971         -0.476    0.971     13
  ##   2 -0.090 0.973         -0.090    0.973     13
  ##   3  0.311 0.960          0.311    0.960     13
  ##   4  0.311 0.960          0.311    0.960     13
  ##   5  1.749 0.813          1.749    0.813     13
  ##   6 -1.513 1.032         -1.513    1.032     13

## End(Not run)
</code></pre>


</div>