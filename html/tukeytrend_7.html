<div class="container">

<table style="width: 100%;"><tr>
<td>tukeytrendformula</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Fit multiple marginal models with differently re-scaled dose variable.
</h2>

<h3>Description</h3>

<p>Wrapper function to fit a given model after different rescalings of a single dose variable. The fitted models are combined into a list that is suitable as input to the multiple marginal model function of package multcomp, mmm.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tukeytrendformula(formula, data, model = "lm", dose,
scaling = c("ari", "ord", "log", "arilog", "treat", "treatHL"),
ctype = NULL, ddf = c("residual", "KR", "PB"), d0shift = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>

<p>formula object suitable for the model function specified in <code>model</code>, the left hand side of the formual should contain at least one (numeric) variable, that is to be re-scaled in the model fits
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>data.frame containing the variables of interest
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>

<p>character string, naming the function for model fitting, currently <code>"lm"</code>, c<code>"glm"</code>, <code>"lmer"</code>, <code>"lme"</code> are supported
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dose</code></td>
<td>

<p>A single character string, naming a numeric variable in the models formula. This variable is rescaled acc. to the options in <code>scaling</code> and the model in <code>fit</code> is then refitted
with the rescaled <code>dose</code> variable.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaling</code></td>
<td>

<p>A vector of character strings, naming the options for rescaling the variable specified in <code>dose</code>: <code>"ari"</code>: no rescaling, <code>"ord"</code>: ranks of dose levels, <code>"log"</code>: log-transformed dose levels, <code>"arilog"</code>: log-transformned dose levels, with interpolated dose score for 0, <code>"high.vs.low"</code>: dose coerced to a factor, and only highest and lowest dose level retained, all others set NA, <code>"treat"</code>: dose coerced to a factor, all levels retained with the option to apply multiple contrast tests to the treatment levels
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ctype</code></td>
<td>

<p>optional character string naming a contrast type for multiple comparisons between dose levels, when <code>scaling="treat"</code>. Options are <code>"Dunnett"</code>, <code>"William"</code> etc., see <code>?contrMat</code> in package <code>multcomp</code>. Argument <code>ctype</code> is ignored if <code>scaling</code> does not involve option <code>"treat"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ddf</code></td>
<td>

<p>single character string, defining the option for the degree of freedom in inference after model fitting. By default, <code>"residual"</code> degrees of freedom will be used for all models. <code>"KR"</code>: For models of class <code>"lmerMod"</code> (fitted by <code>"lmer"</code> from package <code>"lme4"</code>), Kenward-Roger degrees of freedom can be computed (based on methods from package <code>"pbkrtest"</code>); <code>"PB"</code>: For models of class <code>"lme"</code> (fitted by <code>"lme"</code> from package <code>"nlme"</code>), containment degrees of freedom as defined by Pinheiro and Bates can be extracted.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d0shift</code></td>
<td>

<p>an optional factor, that is multiplied with the interpolated dose score for <code>dose = 0</code> in option <code>scaling="arilog"</code>; ignored in all other options for rescaling
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>arguments passed to the model fitting function named in <code>model</code>
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with elements
</p>
<table>
<tr style="vertical-align: top;">
<td><code>mmm</code></td>
<td>
<p>a list of fitted models, after rescaling the <code>dose</code> variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mlf</code></td>
<td>
<p>a list of matrices defining a linear functions of model parameters for each model in <code>mmm</code>, defining the parameter of interest for inference in function <code>mlf</code> and <code>glht</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>a vector of degrees of freedom, one for each model in <code>mmm</code></p>
</td>
</tr>
</table>
<p>and information of the model type and call of the initial model
</p>


<h3>Author(s)</h3>

<p>Frank Schaarschmidt and Christian Ritz (providing internal functions to interface objects of class <code>"lmerMod"</code> and <code>"lme"</code>)
</p>


<h3>References</h3>

<p>Tukey JW, Ciminera JL, Heyse JF (1985). Testing the statistical certainty of a response to increasing doses of a drug. Biometrics 41(1), 295-301.
</p>
<p>Pipper CB, Ritz C, Bisgaard H (2012). A versatile methode for confirmatory evaluation of the effects of a covariate in multiple models. JRSSC - Applied Statistics 61, 315-326.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(litter, package="multcomp")

# compare

dl &lt;- litter
dl$dosen &lt;- as.numeric(as.character(dl$dose))

ttlitter &lt;- tukeytrendformula(weight ~ dosen + number, data=dl, model="lm", dose="dosen", 
 scaling=c("ari", "ord", "log", "treat"), ctype="Dunnett")

summary(asglht(ttlitter))

</code></pre>


</div>