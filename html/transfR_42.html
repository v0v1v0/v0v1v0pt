<div class="container">

<table style="width: 100%;"><tr>
<td>weightr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Weights of donor catchments</h2>

<h3>Description</h3>

<p>Estimate the weighting applied at each time step and to each gauged catchment (donors) for the calculation
of the average net rainfall of an ungauged catchment
</p>


<h3>Usage</h3>

<pre><code class="language-R">weightr(Rn, distances, ndonors = 5, donors, power = 1, flexible_donor = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Rn</code></td>
<td>
<p>net rainfall matrix of donor catchments (rows for time index, and columns for donors index)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distances</code></td>
<td>
<p>vector of the distances to each donor catchment (see hdist)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndonors</code></td>
<td>
<p>maximum number of donor catchments to use</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>donors</code></td>
<td>
<p>vector of catchments id from which donors are selected. If empty, the <code>ndonors</code> closest
catchments are used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>exponent applied in the inverse distance weighting function (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flexible_donor</code></td>
<td>
<p>boolean indicating if the donor catchments can change during the simulation period
according to the availability of discharge observations (see details)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function returns a matrix of weights for each time steps (rows) and each gauged catchments
(columns) for the calculation of the average net rainfall of an ungauged catchment (see mixr).
The weights <code class="reqn">\lambda</code> are estimated by an inverse distance weighting function (de Lavenne et al. 2016):
</p>
<p style="text-align: center;"><code class="reqn">\lambda_i=\frac{1}{d_i^p}</code>
</p>

<p style="text-align: center;"><code class="reqn">\Sigma_{i=1}^{ndonors}\lambda_i=1</code>
</p>

<p>where <code class="reqn">d</code> is the <code>distances</code> argument and <code class="reqn">p</code> is the <code>power</code> argument. The weights are rescaled
so the sum is equal to 1.
</p>
<p>Two strategies to handle missing data in the <code>Rn</code> matrix are possible.
If <code>flexible_donor</code> is TRUE, donors catchments are redefined at each time steps, and are chosen among
the ones that are effectively gauged at this given time step. This aims to keep a constant number of donor
catchments throughout the simulation period.
If <code>flexible_donor</code> is FALSE, the donor catchments are chosen once within all the gauged catchments,
regardless of missing data and remain the same throughout the entire simulation period. This stability of
donor catchments might however leads to a reduced number of donors (below <code>ndonors</code>) during periods
of missing data.
</p>


<h3>Value</h3>

<p>A matrix with the same dimensions as <code>Rn</code>.
</p>


<h3>References</h3>

<p>de Lavenne A, Skøien JO, Cudennec C, Curie F, Moatar F (2016).
“Transferring measured discharge time series: Large-scale comparison of Top-kriging to geomorphology-based inverse modeling.”
<em>Water Resources Research</em>, <b>52</b>(7), 5555–5576.
<a href="https://doi.org/10.1002/2016WR018716">doi:10.1002/2016WR018716</a>.
</p>


<h3>See Also</h3>

<p>hdist, mixr
</p>


</div>