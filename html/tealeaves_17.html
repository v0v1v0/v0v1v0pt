<div class="container">

<table style="width: 100%;"><tr>
<td>.get_Tv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate virtual temperature</h2>

<h3>Description</h3>

<p>Calculate virtual temperature
</p>


<h3>Usage</h3>

<pre><code class="language-R">.get_Tv(Temp, p, P, epsilon, unitless)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Temp</code></td>
<td>
<p>Temperature in Kelvin</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>water vapour pressure in kPa</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>Atmospheric pressure in kPa</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>ratio of water to air molar masses (unitless)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unitless</code></td>
<td>
<p>Logical. Should function use parameters with <code>units</code>? The function is faster when FALSE, but input must be in correct units or else results will be incorrect without any warning.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p style="text-align: center;"><code class="reqn">T_\mathrm{v} = T / [1 - (1 - \epsilon) (p / P)]</code>
</p>

<p>Eq. 2.35 in Monteith &amp; Unsworth (2013) <br><br></p>

<table>
<tr>
<td style="text-align: left;">
<em>Symbol</em> </td>
<td style="text-align: left;"> <em>R</em> </td>
<td style="text-align: left;"> <em>Description</em> </td>
<td style="text-align: left;"> <em>Units</em> </td>
<td style="text-align: left;"> <em>Default</em>
</td>
</tr>
<tr>
<td style="text-align: left;">
<code class="reqn">\epsilon</code> </td>
<td style="text-align: left;"> <code>epsilon</code> </td>
<td style="text-align: left;"> ratio of water to air molar masses </td>
<td style="text-align: left;"> unitless </td>
<td style="text-align: left;"> 0.622 </td>
</tr>
<tr>
<td style="text-align: left;">
<code class="reqn">p</code> </td>
<td style="text-align: left;"> <code>p</code> </td>
<td style="text-align: left;"> water vapour pressure </td>
<td style="text-align: left;"> kPa </td>
<td style="text-align: left;"> calculated</td>
</tr>
<tr>
<td style="text-align: left;">
<code class="reqn">P</code> </td>
<td style="text-align: left;"> <code>P</code> </td>
<td style="text-align: left;"> atmospheric pressure </td>
<td style="text-align: left;"> kPa </td>
<td style="text-align: left;"> 101.3246
</td>
</tr>
</table>
<h3>Value</h3>

<p>Value in K of class <code>units</code>
</p>


<h3>References</h3>

<p>Monteith JL, Unsworth MH. 2013. Principles of Environmental Physics. 4th edition. Academic Press, London.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(tealeaves)

cs &lt;- make_constants()
ep &lt;- make_enviropar()
lp &lt;- make_leafpar()

T_leaf &lt;- set_units(298.15, K)
p &lt;- ep$RH * tealeaves:::.get_ps(T_leaf, ep$P, FALSE)
tealeaves:::.get_Tv(T_leaf, p, ep$P, cs$epsilon, FALSE)

</code></pre>


</div>