<div class="container">

<table style="width: 100%;"><tr>
<td>summarize_num_patients</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Count number of patients</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt="[Stable]"></a>
</p>
<p>The analyze function <code>analyze_num_patients()</code> creates a layout element to count total numbers of unique or
non-unique patients. The primary analysis variable <code>vars</code> is used to uniquely identify patients.
</p>
<p>The <code>count_by</code> variable can be used to identify non-unique patients such that the number of patients with a unique
combination of values in <code>vars</code> and <code>count_by</code> will be returned instead as the <code>nonunique</code> statistic. The <code>required</code>
variable can be used to specify a variable required to be non-missing for the record to be included in the counts.
</p>
<p>The summarize function <code>summarize_num_patients()</code> performs the same function as <code>analyze_num_patients()</code> except it
creates content rows, not data rows, to summarize the current table row/column context and operates on the level of
the latest row split or the root of the table if no row splits have occurred.
</p>


<h3>Usage</h3>

<pre><code class="language-R">analyze_num_patients(
  lyt,
  vars,
  required = NULL,
  count_by = NULL,
  unique_count_suffix = TRUE,
  na_str = default_na_str(),
  nested = TRUE,
  .stats = NULL,
  .formats = NULL,
  .labels = c(unique = "Number of patients with at least one event", nonunique =
    "Number of events"),
  show_labels = c("default", "visible", "hidden"),
  .indent_mods = 0L,
  riskdiff = FALSE,
  ...
)

summarize_num_patients(
  lyt,
  var,
  required = NULL,
  count_by = NULL,
  unique_count_suffix = TRUE,
  na_str = default_na_str(),
  .stats = NULL,
  .formats = NULL,
  .labels = c(unique = "Number of patients with at least one event", nonunique =
    "Number of events"),
  .indent_mods = 0L,
  riskdiff = FALSE,
  ...
)

s_num_patients(
  x,
  labelstr,
  .N_col,
  count_by = NULL,
  unique_count_suffix = TRUE
)

s_num_patients_content(
  df,
  labelstr = "",
  .N_col,
  .var,
  required = NULL,
  count_by = NULL,
  unique_count_suffix = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>lyt</code></td>
<td>
<p>(<code>PreDataTableLayouts</code>)<br> layout that analyses will be added to.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vars</code></td>
<td>
<p>(<code>character</code>)<br> variable names for the primary analysis variable to be iterated over.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>required</code></td>
<td>
<p>(<code>character</code> or <code>NULL</code>)<br> name of a variable that is required to be non-missing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>count_by</code></td>
<td>
<p>(<code>character</code> or <code>NULL</code>)<br> name of a variable to be combined with <code>vars</code> when counting
<code>nonunique</code> records.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unique_count_suffix</code></td>
<td>
<p>(<code>flag</code>)<br> whether the <code>"(n)"</code> suffix should be added to <code>unique_count</code> labels.
Defaults to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na_str</code></td>
<td>
<p>(<code>string</code>)<br> string used to replace all <code>NA</code> or empty values in the output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nested</code></td>
<td>
<p>(<code>flag</code>)<br> whether this layout instruction should be applied within the existing layout structure _if
possible (<code>TRUE</code>, the default) or as a new top-level element (<code>FALSE</code>). Ignored if it would nest a split.
underneath analyses, which is not allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.stats</code></td>
<td>
<p>(<code>character</code>)<br> statistics to select for the table. Run <code>get_stats("summarize_num_patients")</code>
to see available statistics for this function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.formats</code></td>
<td>
<p>(named <code>character</code> or <code>list</code>)<br> formats for the statistics. See Details in <code>analyze_vars</code> for more
information on the <code>"auto"</code> setting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.labels</code></td>
<td>
<p>(named <code>character</code>)<br> labels for the statistics (without indent).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_labels</code></td>
<td>
<p>(<code>string</code>)<br> label visibility: one of "default", "visible" and "hidden".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.indent_mods</code></td>
<td>
<p>(named <code>integer</code>)<br> indent modifiers for the labels. Defaults to 0, which corresponds to the
unmodified default behavior. Can be negative.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>riskdiff</code></td>
<td>
<p>(<code>flag</code>)<br> whether a risk difference column is present. When set to <code>TRUE</code>, <code>add_riskdiff()</code> must be
used as <code>split_fun</code> in the prior column split of the table layout, specifying which columns should be compared.
See <code>stat_propdiff_ci()</code> for details on risk difference calculation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments for the lower level functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>(<code>character</code> or <code>factor</code>)<br> vector of patient IDs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labelstr</code></td>
<td>
<p>(<code>string</code>)<br> label of the level of the parent split currently being summarized
(must be present as second argument in Content Row Functions). See <code>rtables::summarize_row_groups()</code>
for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.N_col</code></td>
<td>
<p>(<code>integer(1)</code>)<br> column-wise N (column count) for the full column being analyzed that is typically
passed by <code>rtables</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>(<code>data.frame</code>)<br> data set containing all analysis variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.var, var</code></td>
<td>
<p>(<code>string</code>)<br> single variable name that is passed by <code>rtables</code> when requested
by a statistics function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In general, functions that starts with <code style="white-space: pre;">⁠analyze*⁠</code> are expected to
work like <code>rtables::analyze()</code>, while functions that starts with <code style="white-space: pre;">⁠summarize*⁠</code>
are based upon <code>rtables::summarize_row_groups()</code>. The latter provides a
value for each dividing split in the row and column space, but, being it
bound to the fundamental splits, it is repeated by design in every page
when pagination is involved.
</p>


<h3>Value</h3>


<ul><li> <p><code>analyze_num_patients()</code> returns a layout object suitable for passing to further layouting functions,
or to <code>rtables::build_table()</code>. Adding this function to an <code>rtable</code> layout will add formatted rows containing
the statistics from <code>s_num_patients_content()</code> to the table layout.
</p>
</li></ul>
<ul><li> <p><code>summarize_num_patients()</code> returns a layout object suitable for passing to further layouting functions,
or to <code>rtables::build_table()</code>. Adding this function to an <code>rtable</code> layout will add formatted rows containing
the statistics from <code>s_num_patients_content()</code> to the table layout.
</p>
</li></ul>
<ul><li> <p><code>s_num_patients()</code> returns a named <code>list</code> of 3 statistics:
</p>

<ul>
<li> <p><code>unique</code>: Vector of counts and percentages.
</p>
</li>
<li> <p><code>nonunique</code>: Vector of counts.
</p>
</li>
<li> <p><code>unique_count</code>: Counts.
</p>
</li>
</ul>
</li></ul>
<ul><li> <p><code>s_num_patients_content()</code> returns the same values as <code>s_num_patients()</code>.
</p>
</li></ul>
<h3>Functions</h3>


<ul>
<li> <p><code>analyze_num_patients()</code>: Layout-creating function which can take statistics function arguments
and additional format arguments. This function is a wrapper for <code>rtables::analyze()</code>.
</p>
</li>
<li> <p><code>summarize_num_patients()</code>: Layout-creating function which can take statistics function arguments
and additional format arguments. This function is a wrapper for <code>rtables::summarize_row_groups()</code>.
</p>
</li>
<li> <p><code>s_num_patients()</code>: Statistics function which counts the number of
unique patients, the corresponding percentage taken with respect to the
total number of patients, and the number of non-unique patients.
</p>
</li>
<li> <p><code>s_num_patients_content()</code>: Statistics function which counts the number of unique patients
in a column (variable), the corresponding percentage taken with respect to the total number of
patients, and the number of non-unique patients in the column.
</p>
</li>
</ul>
<h3>Note</h3>

<p>As opposed to <code>summarize_num_patients()</code>, this function does not repeat the produced rows.
</p>


<h3>Examples</h3>

<pre><code class="language-R">df &lt;- data.frame(
  USUBJID = as.character(c(1, 2, 1, 4, NA, 6, 6, 8, 9)),
  ARM = c("A", "A", "A", "A", "A", "B", "B", "B", "B"),
  AGE = c(10, 15, 10, 17, 8, 11, 11, 19, 17),
  SEX = c("M", "M", "M", "F", "F", "F", "M", "F", "M")
)

# analyze_num_patients
tbl &lt;- basic_table() %&gt;%
  split_cols_by("ARM") %&gt;%
  add_colcounts() %&gt;%
  analyze_num_patients("USUBJID", .stats = c("unique")) %&gt;%
  build_table(df)

tbl

# summarize_num_patients
tbl &lt;- basic_table() %&gt;%
  split_cols_by("ARM") %&gt;%
  split_rows_by("SEX") %&gt;%
  summarize_num_patients("USUBJID", .stats = "unique_count") %&gt;%
  build_table(df)

tbl

# Use the statistics function to count number of unique and nonunique patients.
s_num_patients(x = as.character(c(1, 1, 1, 2, 4, NA)), labelstr = "", .N_col = 6L)
s_num_patients(
  x = as.character(c(1, 1, 1, 2, 4, NA)),
  labelstr = "",
  .N_col = 6L,
  count_by = c(1, 1, 2, 1, 1, 1)
)

# Count number of unique and non-unique patients.

df &lt;- data.frame(
  USUBJID = as.character(c(1, 2, 1, 4, NA)),
  EVENT = as.character(c(10, 15, 10, 17, 8))
)
s_num_patients_content(df, .N_col = 5, .var = "USUBJID")

df_by_event &lt;- data.frame(
  USUBJID = as.character(c(1, 2, 1, 4, NA)),
  EVENT = c(10, 15, 10, 17, 8)
)
s_num_patients_content(df_by_event, .N_col = 5, .var = "USUBJID", count_by = "EVENT")

</code></pre>


</div>