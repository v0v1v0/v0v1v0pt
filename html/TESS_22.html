<div class="container">

<table style="width: 100%;"><tr>
<td>tess.sim.taxa.age</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>tess.sim.taxa.taxa.age: Simulate a reconstructed tree for a given age and number of taxa under a global, time-dependent birth-death process.</h2>

<h3>Description</h3>

<p>tess.sim.taxa.age simulates a reconstructed phylogenetic tree under a global, time-dependent birth-death process conditioned on the age of the tree and number of taxa sampled. The rates may be any positive function of time or a constant. The process starts at time 0 and goes forward in time, hence the rates and events should be interpreted in the time after the origin. Additionally, mass-extinction event can be provided and a uniform taxon sampling probability. It is possible to start either with the origin (1 species) or with the most recent common ancestor (2 species).</p>


<h3>Usage</h3>

<pre><code class="language-R">tess.sim.taxa.age(n, nTaxa, age, lambda, mu, massExtinctionTimes = c(), 
   massExtinctionSurvivalProbabilities = c(), samplingProbability = 1, 
   samplingStrategy = "uniform", MRCA = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Number of simulations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nTaxa</code></td>
<td>
<p>Number of species sampled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>age</code></td>
<td>
<p>The age of the tree, i.e. the time to simulate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>The speciation rate function or constant.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>The extinction rate function or constant.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>massExtinctionTimes</code></td>
<td>
<p>The set of mass-extinction times after the start of the process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>massExtinctionSurvivalProbabilities</code></td>
<td>
<p>The set of survival probabilities for each speciation event. The set must have the same length as the set of mass-extinction times.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samplingProbability</code></td>
<td>
<p>The probability for a species to be included in the sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samplingStrategy</code></td>
<td>
<p>The strategy how samples were obtained. Options are: uniform|diversified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MRCA</code></td>
<td>
<p>Does the process start with the most recent common ancestor?</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a tree in 'phylo' format.
</p>


<h3>Author(s)</h3>

<p>Sebastian Hoehna</p>


<h3>References</h3>

<p>S. Hoehna: Fast simulation of reconstructed phylogenies under global, time-dependent birth-death processes. 2013, Bioinformatics, 29:1367-1374 </p>


<h3>Examples</h3>

<pre><code class="language-R">
l &lt;- Vectorize(function(x) { if (x &gt; 0.5 || x &lt; 0.3) { return (1) } else { return (2) } })
e &lt;- Vectorize(function(x) { if (x &gt; 0.5 || x &lt; 0.3) { return (0.95) } else { return (0.5) } })

tess.sim.taxa.age(n=1,l,e,nTaxa=10,age=1,MRCA=TRUE)

# simulation under constant rates
tess.sim.taxa.age(n=1,2.0,1.0,nTaxa=10,age=1,MRCA=TRUE)

</code></pre>


</div>