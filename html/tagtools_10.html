<div class="container">

<table style="width: 100%;"><tr>
<td>body_axes</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate the cardinal axes of an animal</h2>

<h3>Description</h3>

<p>This function is used to generate the cardinal axes of an animal (i.e., the longitudinal, transverse, and ventro-dorsal) from accelerometer and magnetic field measurements. This functions generates an approximate orthonormal basis from each measurement of A and M by: (i) normalizing A and M to unit length, (ii) rotating the magnetometer measurement to the horizontal plane (Mh), (iii) computing the cross-product, N, of A and Mh to generate the third axis, (iv) transposing [Mh,N,A] to form the body axis basis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">body_axes(A, M, sampling_rate = NULL, fc = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>The acceleration matrix with columns [ax ay az], or a sensor data list. Acceleration can be in any consistent unit, e.g., g or $m/s^2$.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>The magnetometer signal matrix, M=[mx,my,mz], or a sensor data list, in any consistent unit (e.g., in uT or Gauss).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampling_rate</code></td>
<td>
<p>sampling rate of A and M in Hz (optional if A and M are sensor data lists)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fc</code></td>
<td>
<p>(optional) The cut-off frequency of a low-pass filter to apply to A and M before computing the axes. The filter cut-off frequency is in Hz. The filter length is 4*fs/fc. Filtering adds no group delay. If fc is not specified, no filtering  is performed.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>W, a list with entries <code>x</code>, <code>y</code>, and <code>z</code>; each is an nx3 matrix of body axes where n is the number of rows in M and A.
W$x is a nx3 matrix (or a length-3 vector if A and M have one row) containing the X or longitudinal (caudo-rostral) axes.
W$y is a nx3 matrix (or a length-3 vector if A and M have one row) containing the Y or transverse (left-right) axes.
W$z is a nx3 matrix (or a length-3 vector if A and M have one row) containing the Z or ventro-dorsal axes.
W$sampling_rate has the sampling rate of the A and M.
</p>


<h3>Note</h3>

<p>Output sampling rate is the same as the input sampling rate. Irregularly sampled data can be used, but then filtering must not be applied (<code>fc = NULL</code>).
</p>
<p>Frame: This function assumes a [north,east,up] navigation frame and a [forward,right,up] local frame. This function will only return the animal's cardinal axes if the tag was attached so that the sensor axes aligned with the animal's axes OR if the tag A and M measurements are rotated to account for the orientation of the tag on the animal. Otherwise, the axes returned by this function will be the cardinal axes of the tag, not the animal.
</p>


<h3>Examples</h3>

<pre><code class="language-R">samplematrix1 &lt;- matrix(c(7, 2, 3, 6, 4, 9), byrow = TRUE, ncol = 3)
samplematrix2 &lt;- matrix(c(6, 5, 3, 4, 8, 9), byrow = TRUE, ncol = 3)
W &lt;- body_axes(A = samplematrix1, M = samplematrix2, fc = NULL)
</code></pre>


</div>