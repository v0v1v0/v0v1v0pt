<div class="container">

<table style="width: 100%;"><tr>
<td>BetaBinomial</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The Beta-Binomial Distribution</h2>

<h3>Description</h3>

<p>Density, distribution function, quantile function, and random generation
for the beta-binomial distribution.  A variable with a beta-binomial
distribution is distributed as binomial distribution with parameters
<code>N</code> and <code>p</code>, where the probability <code>p</code> of success iteself
has a beta distribution with parameters <code>u</code> and <code>v</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dbb(x, N, u, v, log = FALSE)
pbb(q, N, u, v)
qbb(p, N, u, v)
rbb(n, N, u, v)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>vector of qauntiles</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>vector of quantiles</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>vector of probabilities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>number of trials ( a positive integer)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>first positive parameter of the beta distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>second positive parameter of the beta distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>A logical value; if true, values are returned on the log scale</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The beta-binomial distribution with parameters <code class="reqn">N</code>, <code class="reqn">u</code>, and
<code class="reqn">v</code> has density given by
</p>
<p style="text-align: center;"><code class="reqn">
    choose(N, x) * Beta(x + u, N - x + v) / Beta(u,v)
  </code>
</p>

<p>for <code class="reqn">u &gt; 0</code>, <code class="reqn">v &gt; 0</code>, a positive integer <code class="reqn">N</code>, and any
nonnegative integer <code class="reqn">x</code>. Although one can express the integral
in closed form using generalized hypergeometric functions, the
implementation of  distribution function used here simply relies on the
the cumulative sum of the density.
</p>
<p>The mean and variance of the beta-binomial distribution can be
computed explicitly as
</p>
<p style="text-align: center;"><code class="reqn">
    \mu = \frac{Nu}{u+v}
  </code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">
    \sigma^2 = \frac{Nuv(N+u+v)}{(u+v)^2 (1+u+v)}
  </code>
</p>



<h3>Value</h3>

<p><code>dbb</code> gives the density, <code>pbb</code> gives the distribution function,
<code>qbb</code> gives the quantile function, and <code>rbb</code> generates random
deviates. 
</p>


<h3>Author(s)</h3>

<p>Kevin R. Coombes &lt;krc@silicovore.com&gt;</p>


<h3>See Also</h3>

 <p><code>dbeta</code> for the beta distribution and
<code>dbinom</code> for the binomial distribution.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># set up parameters
w &lt;- 10
u &lt;- 0.3*w
v &lt;- 0.7*w
N &lt;- 12
# generate random values from the beta-binomial
x &lt;- rbb(1000, N, u, v)

# check that the empirical summary matches the theoretical one
summary(x)
qbb(c(0.25, 0.50, 0.75), N, u, v)

# check that the empirpical histogram matches te theoretical density
hist(x, breaks=seq(-0.5, N + 0.55), prob=TRUE)
lines(0:N, dbb(0:N, N, u,v), type='b')
</code></pre>


</div>