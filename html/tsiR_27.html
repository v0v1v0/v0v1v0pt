<div class="container">

<table style="width: 100%;"><tr>
<td>TSIR_LE</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>TSIR_LE</h2>

<h3>Description</h3>

<p>A function to calculate the Lyapunov Exponennt (LE) from the TSIR model
</p>


<h3>Usage</h3>

<pre><code class="language-R">TSIR_LE(time, S, I, alpha, beta, IP)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>The time vector from the data or simulated data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>The S output from the simulated or predicted TSIR model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>I</code></td>
<td>
<p>The I output from the simulated or predicted TSIR model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The homogeneity parameter from the simulated or predicted TSIR model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>The inferred contact rate, use beta = contact$beta where contact is an output from runtsir or simulatetsir</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>IP</code></td>
<td>
<p>The generation interval of the pathogen (in weeks)</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 
require(kernlab)
require(ggplot2)
require(kernlab)
London &lt;- twentymeas$London
## just analyze the biennial portion of the data
London &lt;- subset(London, time &gt; 1950)

## define the interval to be 2 weeks
IP &lt;- 2

## first estimate paramters from the London data
parms &lt;- estpars(data=London, IP=2, regtype='gaussian',family='poisson',link='log')

## look at beta and alpha estimate
plotbeta(parms)

## simulate the fitted parameters
sim &lt;- simulatetsir(data=London,parms=parms,IP=2,method='deterministic',nsim=2)

## now lets predict forward 200 years using the mean birth rate,
## starting from rough initial conditions
times &lt;- seq(1965,2165, by = 1/ (52/IP))
births &lt;- rep(mean(London$births),length(times))
S0 &lt;- parms$sbar
I0 &lt;- 1e-5*mean(London$pop)

pred &lt;- predicttsir(times=times,births=births,
                   beta=parms$contact$beta,alpha=parms$alpha,
                  S0=S0,I0=I0,
                  nsim=50,stochastic=T)

## take the last 10 years
pred &lt;- lapply(pred, function(x)  tail(x, 52/IP * 20) )

## now compute the Lyapunov Exponent for the simulate and predicted model

simLE &lt;- TSIR_LE(
time=sim$res$time,
S=sim$simS$mean,
I=sim$res$mean,
alpha=sim$alpha,
  beta=sim$contact$beta,
IP=IP
)

predLE &lt;- TSIR_LE(
time=pred$I$time,
S=pred$S$X3,
I=pred$I$X3,
alpha=parms$alpha,
beta=parms$contact$beta,
IP=IP
)

simLE$LE
predLE$LE



## End(Not run)
</code></pre>


</div>