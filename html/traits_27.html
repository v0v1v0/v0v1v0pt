<div class="container">

<table style="width: 100%;"><tr>
<td>ncbi_searcher</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Search for gene sequences available for taxa from NCBI.</h2>

<h3>Description</h3>

<p>Search for gene sequences available for taxa from NCBI.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ncbi_searcher(
  taxa = NULL,
  id = NULL,
  seqrange = "1:3000",
  getrelated = FALSE,
  fuzzy = FALSE,
  limit = 500,
  entrez_query = NULL,
  hypothetical = FALSE,
  verbose = TRUE,
  sleep = 0L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>taxa</code></td>
<td>
<p>(character) Scientific name to search for.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>(<code>character</code>) Taxonomic id to search for. Not compatible with
argument <code>taxa</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seqrange</code></td>
<td>
<p>(character) Sequence range, as e.g., <code>"1:1000"</code>. This is the range of
sequence lengths to search for. So <code>"1:1000"</code> means search for sequences from 1 to 1000
characters in length.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>getrelated</code></td>
<td>
<p>(logical) If <code>TRUE</code>, gets the longest sequences of a species
in the same genus as the one searched for. If <code>FALSE</code>, returns nothing if no match
found.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fuzzy</code></td>
<td>
<p>(logical) Whether to do fuzzy taxonomic ID search or exact
search. If <code>TRUE</code>, we use <code>xXarbitraryXx[porgn:__txid&lt;ID&gt;]</code>,
but if <code>FALSE</code>, we use <code>txid&lt;ID&gt;</code>. Default: <code>FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>limit</code></td>
<td>
<p>(<code>numeric</code>) Number of sequences to search for and return.
Max of 10,000. If you search for 6000 records, and only 5000 are found,
you will of course only get 5000 back.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>entrez_query</code></td>
<td>
<p>(<code>character</code>; length 1) An Entrez-format query to
filter results with. This is useful to search for sequences with specific
characteristics. The format is the same as the one used to seach genbank.
(<a href="https://www.ncbi.nlm.nih.gov/books/NBK3837/#EntrezHelp.Entrez_Searching_Options">https://www.ncbi.nlm.nih.gov/books/NBK3837/#EntrezHelp.Entrez_Searching_Options</a>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hypothetical</code></td>
<td>
<p>(<code>logical</code>; length 1) If <code>FALSE</code>, an attempt
will be made to not return hypothetical or predicted sequences judging from
accession number prefixs (XM and XR). This can result in less than the
<code>limit</code> being returned even if there are more sequences available,
since this filtering is done after searching NCBI.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>(logical) If <code>TRUE</code> (default), informative messages printed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sleep</code></td>
<td>
<p>(integer) number of seconds to sleep before each HTTP request.
use if running to 429 Too Many Requests errors from NCBI. default: 0
(no sleep)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>data.frame</code> of results if a single input is given. A list of
<code>data.frame</code>s if multiple inputs are given.
</p>


<h3>Authentication</h3>

<p>NCBI rate limits requests. If you set an API key you have a higher rate limit.
Set your API key like <code>Sys.setenv(ENTREZ_KEY="yourkey")</code> or you can use
<code>?rentrez::set_entrez_key</code>. set verbose curl output (<code>crul::set_verbose()</code>) to
make sure your api key is being sent in the requests
</p>


<h3>Author(s)</h3>

<p>Scott Chamberlain, Zachary Foster <a href="mailto:zacharyfoster1989@gmail.com">zacharyfoster1989@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code>ncbi_byid</code>, <code>ncbi_byname</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# A single species
out &lt;- ncbi_searcher(taxa="Umbra limi", seqrange = "1:2000")
# Get the same species information using a taxonomy id
out &lt;- ncbi_searcher(id = "75935", seqrange = "1:2000")
# If the taxon name is unique, using the taxon name and id are equivalent
all(ncbi_searcher(id = "75935") ==  ncbi_searcher(taxa="Umbra limi"))
# If the taxon name is not unique, use taxon id
#  "266948" is the uid for the butterfly genus, but there is also a genus
#  of orchids with the
#  same name
nrow(ncbi_searcher(id = "266948")) ==  nrow(ncbi_searcher(taxa="Satyrium"))
# get list of genes available, removing non-unique
unique(out$gene_desc)
# does the string 'RAG1' exist in any of the gene names
out[grep("RAG1", out$gene_desc, ignore.case=TRUE),]

# A single species without records in NCBI
out &lt;- ncbi_searcher(taxa="Sequoia wellingtonia", seqrange="1:2000",
  getrelated=TRUE)

# Many species, can run in parallel or not using plyr
species &lt;- c("Salvelinus alpinus","Ictalurus nebulosus","Carassius auratus")
out2 &lt;- ncbi_searcher(taxa=species, seqrange = "1:2000")
lapply(out2, head)
library("plyr")
out2df &lt;- ldply(out2) # make data.frame of all
unique(out2df$gene_desc) # get list of genes available, removing non-unique
out2df[grep("12S", out2df$gene_desc, ignore.case=TRUE), ]

# Using the getrelated and entrez_query options
ncbi_searcher(taxa = "Olpidiopsidales", limit = 5, getrelated = TRUE,
            entrez_query = "18S[title] AND 28S[title]")

# get refseqs
one &lt;- ncbi_searcher(taxa = "Salmonella enterica",
  entrez_query="srcdb_refseq[PROP]")
two &lt;- ncbi_searcher(taxa = "Salmonella enterica")

## End(Not run)
</code></pre>


</div>