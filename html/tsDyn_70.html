<div class="container">

<table style="width: 100%;"><tr>
<td>setar.sim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulation and bootstrap of Threshold Autoregressive model (SETAR)</h2>

<h3>Description</h3>

<p>Simulate or bootstrap a Threshold AR (SETAR)
The <code>setar.sim</code> function allows to simulate a SETAR model from scratch. 
The most important argument is the <code>B</code> argument, which should be a one row matrix, 
with first the constant/trend arguments, then the 
slope coefficients, and this for each regime (lower, middle, high). 
Other arguments such as <code>lag</code>, <code>nthresh</code> indicate the dimension of this matrix. 
As an example, a SETAR with 2 lags, 1 threshold, a constant, would have coefficient in the order:
<code>c(const_L, phi_1_L, phi_2_L, const_H, phi_1_H, phi_2_H)</code> where L is for Lower regime, H for Higher. 
</p>
<p><code>setar.boot</code> on the other side resample/bootstraps an existing setar output. 
It uses a recursive approach, reconstructing the series. 
Residuals from the original model are resampled using different bootstrap schemes, see  <code>resample_vec</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">setar.boot(
  setarObject,
  boot.scheme = c("resample", "resample_block", "wild1", "wild2", "check"),
  seed = NULL,
  ...
)

linear.boot(
  linearObject,
  boot.scheme = c("resample", "resample_block", "wild1", "wild2", "check"),
  seed = NULL,
  ...
)

setar.sim(
  B,
  n = 200,
  lag = 1,
  include = c("const", "trend", "none", "both"),
  nthresh = 1,
  Thresh,
  starting = NULL,
  innov = rnorm(n),
  ...
)

linear.sim(
  B,
  n = 200,
  lag = 1,
  include = c("const", "trend", "none", "both"),
  starting = NULL,
  innov = rnorm(n),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>setarObject</code></td>
<td>
<p>Bootstrap: the <code>setar</code> object to resample data from.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot.scheme</code></td>
<td>
<p>Bootstrap: which resampling scheme to use for the residuals. See <code>resample_vec</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Bootstrap: seed used in the resampling</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments for the unexported <code>setar.gen</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linearObject</code></td>
<td>
<p>Bootstrap: the <code>linear</code> object to resample data from.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>Simulation: vector of coefficients to simulate from.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Simulation: Number of observations to simulate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Thresh, nthresh, lag, include</code></td>
<td>
<p>Simulation: parameters for the SETAR to simulate. 
See <code>setar</code> for their description.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>starting</code></td>
<td>
<p>Simulation: Starting values (same length as lag)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>innov</code></td>
<td>
<p>Simulation: time series of innovations/residuals.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list with the simulated/bootstrapped data and the parameter matrix
used.
</p>


<h3>Author(s)</h3>

<p>Matthieu Stigler
</p>


<h3>See Also</h3>

<p><code>SETAR</code> to estimate a SETAR, <code>arima.sim</code> to
simulate an ARMA.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
##Simulation of a TAR with 1 threshold
TvarMat &lt;- c(2.9,-0.4,-0.1,-1.5, 0.2,0.3)
sim&lt;-setar.sim(B=TvarMat,lag=2, type="simul", nthresh=1, Thresh=2, starting=c(2.8,2.2))
mean(ifelse(sim&gt;2,1,0))	#approximation of values over the threshold

#check the result
selectSETAR(sim, m=2)

##Bootstrap a TAR with two threshold (three regimes)
sun &lt;- (sqrt(sunspot.year+1)-1)*2
sun_est &lt;- setar(sun, nthresh=2, m=2)
sun_est_boot &lt;- setar.boot(sun_est)
head(sun_est_boot)

##Check the bootstrap: with no resampling, is it the same series?
sun_est_boot &lt;- setar.boot(sun_est, boot.scheme = "check")
all.equal(as.numeric(sun), sun_est_boot)

</code></pre>


</div>