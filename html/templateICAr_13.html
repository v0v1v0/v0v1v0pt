<div class="container">

<table style="width: 100%;"><tr>
<td>dim_reduce</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>PCA-based Dimension Reduction and Prewhitening</h2>

<h3>Description</h3>

<p>Performs dimension reduction and prewhitening based on probabilistic PCA using
SVD. If dimensionality is not specified, it is estimated using the method
described in Minka (2008).
</p>


<h3>Usage</h3>

<pre><code class="language-R">dim_reduce(X, Q = NULL, Q_max = 100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A numeric matrix, with each column being a centered timeseries.
For fMRI data, <code>X</code> should be <code>T</code> timepoints by <code>V</code> brain
locations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q</code></td>
<td>
<p>Number of latent dimensions to estimate. If <code>NULL</code> (default),
estimated using PESEL (Sobczyka et al. 2020).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q_max</code></td>
<td>
<p>Maximal number of principal components for automatic
dimensionality selection with PESEL. Default: <code>100</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the dimension-reduced data (<code>data_reduced</code>, a
<code class="reqn">V \times Q</code> matrix), prewhitening/dimension reduction matrix (<code>H</code>,
a <code class="reqn">QxT</code> matrix) and its (pseudo-)inverse (<code>Hinv</code>, a <code class="reqn">TxQ</code>
matrix), the noise variance (<code>sigma_sq</code>), the correlation matrix of the
dimension-reduced data (<code>C_diag</code>, a <code class="reqn">QxQ</code> matrix), and the
dimensionality (<code>Q</code>).
</p>


<h3>Examples</h3>

<pre><code class="language-R">nT &lt;- 30
nV &lt;- 400
nQ &lt;- 7
X &lt;- matrix(rnorm(nV*nQ), nrow=nV) %*% diag(seq(nQ, 1)) %*% matrix(rnorm(nQ*nT), nrow=nQ) 
dim_reduce(X, Q=nQ)

</code></pre>


</div>