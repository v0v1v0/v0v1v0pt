<div class="container">

<table style="width: 100%;"><tr>
<td>get.scores</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate factor scores based on Genuine Likelihood</h2>

<h3>Description</h3>

<p>This function estimates factor scores based on genuine likelihood (Yousfi, 2019).
</p>


<h3>Usage</h3>

<pre><code class="language-R">get.scores(dat, blocks, itf, fit, alg = mvtnorm::TVPACK(), log = TRUE, mp,
  sp, serr = TRUE, sv = NULL, blocks_ul = NULL, mplus = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>A data.frame or matrix defining holding the binary coded and named
response data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>blocks</code></td>
<td>
<p>A matrix defining the blocks of the model. The number of rows
must be the number of blocks, each row represents a block and contains the
item numbers. The number of columns present the number of items per block.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>itf</code></td>
<td>
<p>A vector defining the items-to-factor relation. For example
'c(1,1,1,2,2,2)' defines six items, the first three correspond to factor 1,
the second three correspond to factor 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>The fit object. In case of Mplus, this is the path to the Mplus output file. In case of lavaan this is the lavaan Object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alg</code></td>
<td>
<p>The algorithm to use for numerical integration. See ?mvtnorm::pmvnorm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>logical. Should the log transformed results be returned. Defaults to TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mp</code></td>
<td>
<p>The means of prior distribution. Defaults to multivariate normal with means 0 and vars 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sp</code></td>
<td>
<p>The vars of prior distribution. Defaults to multivariate normal with means 0 and vars 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>serr</code></td>
<td>
<p>Logical. Should the standard errors be returned. Defaults to TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sv</code></td>
<td>
<p>Starting values. Defaults to NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>blocks_ul</code></td>
<td>
<p>Similar to 'blocks', but only with the unlinked design. Useful
for comparison with other functions based on R.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mplus</code></td>
<td>
<p>Logical. Are results read from mplus? Defaults to FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments passed by get.scores for optim.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function estimates factor scores based on the Thurstonian IRT model
and based on genuine likelihood proposed by Yousfi (2019). The function allows
for the estimation of factor scores under all block designs, limited only by 
numerical integration procedures. For items per block between 5 and 20 use 
'alg=mvtnorm::Miwa()'. Additionally, all model types can be performed with all
types of forced choice designs (full, block, partially linked block, linked
block). For an overview and review see Jansen and Schulze (2023a,2023b).
</p>
<p>The standard naming procedure ixiy, for the comparison of items x and y.
</p>


<h3>Value</h3>

<p>The result is a list with the factor scores and the standard errors per person and factor.
</p>


<h3>References</h3>

<p>Maydeu-Olivares, A., &amp; Böckenholt, U. (2005). Structural equation modeling of paired-comparison and ranking data. <em>Psychological Methods</em>, <em>10</em>(3), 285-304. <a href="https://doi.org/10.1037/1082-989X.10.3.285">doi:10.1037/1082-989X.10.3.285</a>
</p>
<p>Maydeu-Olivares, A., &amp; Brown, A. (2010). Item response modeling of paired comparison and ranking data. <em>Multivariate Behavioural Research</em>, <em>45</em>(6), 935-974. <a href="https://doi.org/10.1080/00273171.2010.531231">doi:10.1080/00273171.2010.531231</a>
</p>
<p>Jansen, M. T., &amp; Schulze, R. (2023a). <em>Linear factor analytic Thurstonian forced-choice models: Current status and issues</em>. Educational and Psychological Measurement.
</p>
<p>Jansen, M. T., &amp; Schulze, R. (2023b, in review). <em>The Thurstonian linked block design: Improving Thurstonian modeling for paired comparison and ranking data</em>. 
</p>
<p>Yousfi, S. (2019). Person Parameter Estimation for IRT Models of Forced-Choice Data: Merits and Perils of Pseudo-Likelihood Approaches. In: Wiberg, M., Molenaar, D., González, J., Böckenholt, U., Kim, JS. (eds) <em>Quantitative Psychology</em>. IMPS 2019. Springer Proceedings in Mathematics &amp; Statistics, vol 322. Springer, Cham. <a href="https://doi.org/10.1007/978-3-030-43469-4_3">doi:10.1007/978-3-030-43469-4_3</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">

# read and save data set FC
data(FC12)

# set seed and define blocks
blocks &lt;- matrix(c(5,2,1,4,7,6,3,8,10,12,9,11), ncol = 3)

# define the item-to-factor relation
itf &lt;- rep(1:3,4)

# Create and run syntax
fit &lt;- fit.lavaan(blocks, itf, 'irt', FC, estimator = 'ULSMV')

# get scores for the first two respondents
ests &lt;- get.scores(dat=as.matrix(FC)[1:2,],itf=itf, blocks=blocks,
fit = fit,mp=rep(0,max(itf)), 
sp=diag(1,max(itf)),estimator="MAP",sv=NULL, alg=mvtnorm::Miwa(),log=TRUE, mplus=FALSE)

</code></pre>


</div>