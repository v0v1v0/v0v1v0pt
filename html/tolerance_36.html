<div class="container">

<table style="width: 100%;"><tr>
<td>mvregtol.region</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multivariate (Multiple) Linear Regression Tolerance Regions</h2>

<h3>Description</h3>

<p>Determines the appropriate tolerance factor for computing multivariate (multiple) linear regression tolerance regions based on Monte Carlo simulation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mvregtol.region(mvreg, new.x = NULL, alpha = 0.05, P = 0.99, 
                B = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mvreg</code></td>
<td>
<p>A multivariate (multiple) linear regression fit, having class <code>mlm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>new.x</code></td>
<td>
<p>An optional data frame of new values for which to approximate k-factors. This must be a data frame with named columns that match those in the data frame used for the <code>mvreg</code> fitted object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The level chosen such that <code>1-alpha</code> is the confidence level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>The proportion of the population to be covered by this tolerance region.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>The number of iterations used for the Monte Carlo algorithm which determines the tolerance factor.  The number of
iterations should be at least as large as the default value of 1000.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A basic sketch of how the algorithm works is as follows:
</p>
<p>(1) Generate independent chi-square random variables and Wishart random matrices.
</p>
<p>(2) Compute the eigenvalues of the randomly generated Wishart matrices.
</p>
<p>(3) Iterate the above steps to generate a set of <code>B</code> sample values such that the <code>100(1-alpha)</code>-th percentile is an approximate tolerance factor.
</p>


<h3>Value</h3>

<p><code>mvregtol.region</code> returns a matrix where the first column is the k-factor, the next <code>q</code> columns are the estimated responses
from the least squares fit, and the final <code>m</code> columns are the predictor values.  The first <code>n</code> rows of the matrix pertain to the raw data
as specified by <code>y</code> and <code>x</code>.  If values for <code>new.x</code> are specified, then there is one additional row appended to this output for each
row in the matrix <code>new.x</code>.
</p>


<h3>Note</h3>

<p>As of tolerance version 2.0.0, the arguments to this function have changed.  This function no longer depends on inputted <code>y</code> and <code>x</code> matrices or an <code>int</code> argument.  Instead, the function requires <code>mvreg</code>, which is of class "mlm", and provides all of the necessary components for the way the output is formatted.  Also, <code>new.x</code> must now be a data frame with columns matching those from the data frame used in the <code>mvreg</code> fitted object.  
</p>


<h3>References</h3>

<p>Anderson, T. W. (2003) <em>An Introduction to Multivariate Statistical Analysis</em>, Third Edition, Wiley.
</p>
<p>Krishnamoorthy, K. and Mathew, T. (2009), <em>Statistical Tolerance Regions: Theory, Applications, and Computation</em>, Wiley.
</p>
<p>Krishnamoorthy, K. and Mondal, S. (2008), Tolerance Factors in Multiple and Multivariate Linear Regressions, 
<em>Communications in Statistics - Simulation and Computation</em>, <b>37</b>, 546â€“559.
</p>


<h3>Examples</h3>

<pre><code class="language-R"> 
## 95%/95% multivariate regression tolerance factors using
## a fertilizer data set presented in Anderson (2003, p. 374). 

grain &lt;- c(40, 17, 9, 15, 6, 12, 5, 9)
straw &lt;- c(53, 19, 10, 29, 13, 27, 19, 30)
fert &lt;- c(24, 11, 5, 12, 7, 14, 11, 18)
DF &lt;- data.frame(grain,straw,fert)
new.x &lt;- data.frame(fert = c(10, 15, 20))
mvreg &lt;- lm(cbind(grain, straw) ~ fert + I(fert^2), data = DF)

set.seed(100)
out &lt;- mvregtol.region(mvreg, new.x = new.x, alpha = 0.05,
                       P = 0.95, B = 5000)
out
</code></pre>


</div>