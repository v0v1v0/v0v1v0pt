<div class="container">

<table style="width: 100%;"><tr>
<td>PMSE</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Prediction and mean squared error.</h2>

<h3>Description</h3>

<p>Evaluate the tensor response regression (TRR) or tensor predictor regression (TPR) model through the mean squared error.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PMSE(x, y, B)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A predictor tensor, array, matrix or vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A response tensor, array, matrix or vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>An coefficient tensor tensor, array, matrix or vector.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>There are three situations:
</p>

<ul>
<li>
<p> TRR model: If <code>y</code> is an <code class="reqn">m</code>-way tensor (array), <code>x</code> should be matrix or vector and <code>B</code> should be tensor or array.
</p>
</li>
<li>
<p> TPR model: If <code>x</code> is an <code class="reqn">m</code>-way tensor (array), <code>y</code> should be matrix or vector and <code>B</code> should be tensor or array.
</p>
</li>
<li>
<p> Other: If <code>x</code> and <code>y</code> are both matrix or vector, <code>B</code> should be matrix. In this case, the prediction is calculated as <code>pred = B*X</code>.
</p>
</li>
</ul>
<p>In any cases, users are asked to ensure the dimensions of <code>x</code>, <code>y</code> and <code>B</code> match. See <code>TRRsim</code> and <code>TPRsim</code> for more details of the TRR and TPR models.
</p>
<p>Let <code class="reqn">\hat{Y}_i</code> denote each prediction, then the mean squared error is defined as <code class="reqn">1/n\sum_{i=1}^n||Y_i-\hat{Y}_i||_F^2</code>, where <code class="reqn">||\cdot||_F</code> denotes the Frobenius norm.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mse</code></td>
<td>
<p>The mean squared error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred</code></td>
<td>
<p>The predictions.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>TRRsim, TPRsim</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Dataset in TRR model
r &lt;- c(10, 10, 10)
u &lt;- c(2, 2, 2)
p &lt;- 5
n &lt;- 100
dat &lt;- TRRsim(r = r, p = p, u = u, n = n)
x &lt;- dat$x
y &lt;- dat$y

# Fit data with TRR.fit
fit_std &lt;- TRR.fit(x, y, method="standard")
result &lt;- PMSE(x, y, fit_std$coefficients)
## Dataset in TPR model
p &lt;- c(10, 10, 10)
u &lt;- c(1, 1, 1)
r &lt;- 5
n &lt;- 200
dat &lt;- TPRsim(p = p, r = r, u = u, n = n)
x &lt;- dat$x
y &lt;- dat$y

# Fit data with TPR.fit
fit_std &lt;- TPR.fit(x, y, u, method="standard")
result &lt;- PMSE(x, y, fit_std$coefficients)

</code></pre>


</div>