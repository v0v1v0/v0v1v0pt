<div class="container">

<table style="width: 100%;"><tr>
<td>tfd_poisson_log_normal_quadrature_compound</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
<code>PoissonLogNormalQuadratureCompound</code> distribution</h2>

<h3>Description</h3>

<p>The <code>PoissonLogNormalQuadratureCompound</code> is an approximation to a
Poisson-LogNormal <a href="https://en.wikipedia.org/wiki/Compound_probability_distribution">compound distribution</a>, i.e.,
</p>
<div class="sourceCode"><pre>p(k|loc, scale) = int_{R_+} dl LogNormal(l | loc, scale) Poisson(k | l)
approx= sum{ prob[d] Poisson(k | lambda(grid[d])) : d=0, ..., deg-1 }
</pre></div>


<h3>Usage</h3>

<pre><code class="language-R">tfd_poisson_log_normal_quadrature_compound(
  loc,
  scale,
  quadrature_size = 8,
  quadrature_fn = tfp$distributions$quadrature_scheme_lognormal_quantiles,
  validate_args = FALSE,
  allow_nan_stats = TRUE,
  name = "PoissonLogNormalQuadratureCompound"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>loc</code></td>
<td>
<p><code>float</code>-like (batch of) scalar <code>Tensor</code>; the location parameter of
the LogNormal prior.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p><code>float</code>-like (batch of) scalar <code>Tensor</code>; the scale parameter of
the LogNormal prior.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quadrature_size</code></td>
<td>
<p><code>integer</code> scalar representing the number of quadrature
points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quadrature_fn</code></td>
<td>
<p>Function taking <code>loc</code>, <code>scale</code>,
<code>quadrature_size</code>, <code>validate_args</code> and returning <code>tuple(grid, probs)</code>
representing the LogNormal grid and corresponding normalized weight.
Default value: <code>quadrature_scheme_lognormal_quantiles</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>validate_args</code></td>
<td>
<p>Logical, default FALSE. When TRUE distribution parameters are checked
for validity despite possibly degrading runtime performance. When FALSE invalid inputs may
silently render incorrect outputs. Default value: FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allow_nan_stats</code></td>
<td>
<p>Logical, default TRUE. When TRUE, statistics (e.g., mean, mode, variance)
use the value NaN to indicate the result is undefined. When FALSE, an exception is raised if
one or more of the statistic's batch members are undefined.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>name prefixed to Ops created by this class.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>By default, the <code>grid</code> is chosen as quantiles of the <code>LogNormal</code> distribution
parameterized by <code>loc</code>, <code>scale</code> and the <code>prob</code> vector is
<code style="white-space: pre;">⁠[1. / quadrature_size]*quadrature_size⁠</code>.
</p>
<p>In the non-approximation case, a draw from the LogNormal prior represents the
Poisson rate parameter. Unfortunately, the non-approximate distribution lacks
an analytical probability density function (pdf). Therefore the
<code>PoissonLogNormalQuadratureCompound</code> class implements an approximation based
on <a href="https://en.wikipedia.org/wiki/Numerical_integration">quadrature</a>.
Note: although the <code>PoissonLogNormalQuadratureCompound</code> is approximately the
Poisson-LogNormal compound distribution, it is itself a valid distribution.
Viz., it possesses a <code>sample</code>, <code>log_prob</code>, <code>mean</code>, <code>variance</code>, etc. which are
all mutually consistent.
</p>
<p>Mathematical Details
</p>
<p>The <code>PoissonLogNormalQuadratureCompound</code> approximates a Poisson-LogNormal
<a href="https://en.wikipedia.org/wiki/Compound_probability_distribution">compound distribution</a>.
Using variable-substitution and <a href="https://en.wikipedia.org/wiki/Numerical_integration">numerical quadrature</a> (default:
based on <code>LogNormal</code> quantiles) we can redefine the distribution to be a
parameter-less convex combination of <code>deg</code> different Poisson samples.
That is, defined over positive integers, this distribution is parameterized
by a (batch of) <code>loc</code> and <code>scale</code> scalars.
</p>
<p>The probability density function (pdf) is,
</p>
<div class="sourceCode"><pre>pdf(k | loc, scale, deg) = sum{ prob[d] Poisson(k | lambda=exp(grid[d])) : d=0, ..., deg-1 }
</pre></div>
<p>Note: <code>probs</code> returned by (optional) <code>quadrature_fn</code> are presumed to be
either a length-<code>quadrature_size</code> vector or a batch of vectors in 1-to-1
correspondence with the returned <code>grid</code>. (I.e., broadcasting is only partially supported.)
</p>


<h3>Value</h3>

<p>a distribution instance.
</p>


<h3>See Also</h3>

<p>For usage examples see e.g. <code>tfd_sample()</code>, <code>tfd_log_prob()</code>, <code>tfd_mean()</code>.
</p>
<p>Other distributions: 
<code>tfd_autoregressive()</code>,
<code>tfd_batch_reshape()</code>,
<code>tfd_bates()</code>,
<code>tfd_bernoulli()</code>,
<code>tfd_beta_binomial()</code>,
<code>tfd_beta()</code>,
<code>tfd_binomial()</code>,
<code>tfd_categorical()</code>,
<code>tfd_cauchy()</code>,
<code>tfd_chi2()</code>,
<code>tfd_chi()</code>,
<code>tfd_cholesky_lkj()</code>,
<code>tfd_continuous_bernoulli()</code>,
<code>tfd_deterministic()</code>,
<code>tfd_dirichlet_multinomial()</code>,
<code>tfd_dirichlet()</code>,
<code>tfd_empirical()</code>,
<code>tfd_exp_gamma()</code>,
<code>tfd_exp_inverse_gamma()</code>,
<code>tfd_exponential()</code>,
<code>tfd_gamma_gamma()</code>,
<code>tfd_gamma()</code>,
<code>tfd_gaussian_process_regression_model()</code>,
<code>tfd_gaussian_process()</code>,
<code>tfd_generalized_normal()</code>,
<code>tfd_geometric()</code>,
<code>tfd_gumbel()</code>,
<code>tfd_half_cauchy()</code>,
<code>tfd_half_normal()</code>,
<code>tfd_hidden_markov_model()</code>,
<code>tfd_horseshoe()</code>,
<code>tfd_independent()</code>,
<code>tfd_inverse_gamma()</code>,
<code>tfd_inverse_gaussian()</code>,
<code>tfd_johnson_s_u()</code>,
<code>tfd_joint_distribution_named_auto_batched()</code>,
<code>tfd_joint_distribution_named()</code>,
<code>tfd_joint_distribution_sequential_auto_batched()</code>,
<code>tfd_joint_distribution_sequential()</code>,
<code>tfd_kumaraswamy()</code>,
<code>tfd_laplace()</code>,
<code>tfd_linear_gaussian_state_space_model()</code>,
<code>tfd_lkj()</code>,
<code>tfd_log_logistic()</code>,
<code>tfd_log_normal()</code>,
<code>tfd_logistic()</code>,
<code>tfd_mixture_same_family()</code>,
<code>tfd_mixture()</code>,
<code>tfd_multinomial()</code>,
<code>tfd_multivariate_normal_diag_plus_low_rank()</code>,
<code>tfd_multivariate_normal_diag()</code>,
<code>tfd_multivariate_normal_full_covariance()</code>,
<code>tfd_multivariate_normal_linear_operator()</code>,
<code>tfd_multivariate_normal_tri_l()</code>,
<code>tfd_multivariate_student_t_linear_operator()</code>,
<code>tfd_negative_binomial()</code>,
<code>tfd_normal()</code>,
<code>tfd_one_hot_categorical()</code>,
<code>tfd_pareto()</code>,
<code>tfd_pixel_cnn()</code>,
<code>tfd_poisson()</code>,
<code>tfd_power_spherical()</code>,
<code>tfd_probit_bernoulli()</code>,
<code>tfd_quantized()</code>,
<code>tfd_relaxed_bernoulli()</code>,
<code>tfd_relaxed_one_hot_categorical()</code>,
<code>tfd_sample_distribution()</code>,
<code>tfd_sinh_arcsinh()</code>,
<code>tfd_skellam()</code>,
<code>tfd_spherical_uniform()</code>,
<code>tfd_student_t_process()</code>,
<code>tfd_student_t()</code>,
<code>tfd_transformed_distribution()</code>,
<code>tfd_triangular()</code>,
<code>tfd_truncated_cauchy()</code>,
<code>tfd_truncated_normal()</code>,
<code>tfd_uniform()</code>,
<code>tfd_variational_gaussian_process()</code>,
<code>tfd_vector_diffeomixture()</code>,
<code>tfd_vector_exponential_diag()</code>,
<code>tfd_vector_exponential_linear_operator()</code>,
<code>tfd_vector_laplace_diag()</code>,
<code>tfd_vector_laplace_linear_operator()</code>,
<code>tfd_vector_sinh_arcsinh_diag()</code>,
<code>tfd_von_mises_fisher()</code>,
<code>tfd_von_mises()</code>,
<code>tfd_weibull()</code>,
<code>tfd_wishart_linear_operator()</code>,
<code>tfd_wishart_tri_l()</code>,
<code>tfd_wishart()</code>,
<code>tfd_zipf()</code>
</p>


</div>