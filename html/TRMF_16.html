<div class="container">

<table style="width: 100%;"><tr>
<td>TRMF_ar</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Add an Auto-Regressive Regularization Model to a TRMF Object.</h2>

<h3>Description</h3>

<p>Creates a regularization scheme that constrains latent time-series based on auto-regressive parameters and adds it to a TRMF object.
In matrix optimization form, it adds the following term to the TRMF cost function:  <code class="reqn">R(x) = lambdaD^2||w(DX_s)||^2 + lambdaA^2||X_s||^2</code>  where <code class="reqn">X_s</code> is sub-set of the Xm matrix controlled by this model and D is a matrix that corresponds to an auto-regressive model.</p>


<h3>Usage</h3>

<pre><code class="language-R">TRMF_ar(obj,numTS = 1,AR,lambdaD=1,lambdaA=0.0001,weight=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>A TRMF object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numTS</code></td>
<td>
<p>number of latent time series in this model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambdaD</code></td>
<td>
<p>regularization parameter for temporal constraint matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambdaA</code></td>
<td>
<p>regularization parameter to apply simple L2 regularization to this time series model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>
<p>optional vector of weights to weight constraints, i.e. R(x) = lambdaD^2*||w*(D%*%X)||^2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AR</code></td>
<td>
<p>vector of autoregressive parameters. No checks are performed</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Setting AR = c(1) gives a random walk model, same as <code>TRMF_trend(..., order=1)</code>.
</p>


<h3>Value</h3>

<p>Returns an updated object of class TRMF.
</p>


<h3>Note</h3>

<p>Unlike <code>TRMF_columns()</code>, these lambdas are squared in the code.</p>


<h3>Author(s)</h3>

<p>Chad Hammerquist
</p>


<h3>References</h3>

<p>Yu, Hsiang-Fu, Nikhil Rao, and Inderjit S. Dhillon. "High-dimensional time series prediction with missing values." arXiv preprint arXiv:1509.08333 (2015).
</p>


<h3>See Also</h3>

<p><code>create_TRMF</code>, <code>TRMF_columns</code>, <code>TRMF_trend</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
# create test data
xm = matrix(rnorm(80),20,4)
fm = matrix(rnorm(40),4,10)+1
Am = xm%*%fm+rnorm(200,0,.1)

# create model
obj = create_TRMF(Am)
obj = TRMF_columns(obj,reg_type ="interval")
obj = TRMF_ar(obj,numTS=2,AR=c(0.5),lambdaD=4)
out = train(obj)
plot(out)

</code></pre>


</div>