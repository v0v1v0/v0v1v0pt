<div class="container">

<table style="width: 100%;"><tr>
<td>plot.thres2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Threshold and density plot (two-state setting)
</h2>

<h3>Description</h3>

<p>This function provides a graph including the sample densities (diseased and non-diseased populations), the threshold and its confidence interval.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'thres2'
plot(x, bw = c("nrd0", "nrd0"), ci = TRUE,
  which.boot = c("norm", "perc"), col = c(1, 2, 3),
  lty = c(1, 1, 1, 2), lwd = c(1, 1, 1),
  legend = TRUE, leg.pos = "topleft", leg.cex = 1,
  xlim = NULL, ylim = NULL,
  main = paste0("Threshold estimate ", ifelse(ci, "and CI ", ""),
  "(method ", x$T$method, ")"),
  xlab = "", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>an object of class <code>thres2</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw</code></td>
<td>

<p>vector containing the bandwith for the non-diseased sample in the first position and the bandwith for the diseased sample in the second position (to be passed to <code>density()</code>). Default, <code>c("nrd0", "nrd0")</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>

<p>should the confidence interval be plotted? Default, <code>TRUE</code>. No confidence interval will be plotted if <code>x</code> does not contain one (that is, <code>x$CI</code> is <code>NULL</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which.boot</code></td>
<td>

<p>in case <code>x</code> contains confidence intervals calculated by bootstrapping, which one should be printed? The user can choose between <code>"norm"</code> (based on normal distribution) or <code>"perc"</code> (based on percentiles). Default, <code>"norm"</code>. This argument is ignored if the confidence intervals were calculated by the delta method.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>

<p>a 3-dimensional vector containing:
</p>
<p><code>col[1]</code>: color for the density of the non-diseased sample
</p>
<p><code>col[2]</code>: color for the density of the diseased sample
</p>
<p><code>col[3]</code>: color for the threshold and its corresponding confidence interval
</p>
<p>Default, <code>c(1, 2, 3)</code>. If <code>length(col)</code> is not 3, <code>col</code> will be recycled.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty</code></td>
<td>

<p>a 4-dimensional vector containing:
</p>
<p><code>lty[1]</code>: line type for the density of the non-diseased sample
</p>
<p><code>lty[2]</code>: line type for the density of the diseased sample
</p>
<p><code>lty[3]</code>: line type for the threshold
</p>
<p><code>lty[4]</code>: line type for the confidence interval
</p>
<p>Default, <code>c(1, 1, 1, 2)</code>. If <code>length(lty)</code> is not 4, <code>lty</code> will be recycled.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>

<p>a 3-dimensional vector containing:
</p>
<p><code>lwd[1]</code>: line width for the density of the non-diseased sample
</p>
<p><code>lwd[2]</code>: line width for the density of the diseased sample
</p>
<p><code>lwd[3]</code>: line width for the threshold and its corresponding confidence interval
</p>
<p>Default, <code>c(1, 1, 1)</code>. If <code>length(lwd)</code> is not 3, <code>lwd</code> will be recycled.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>

<p>logical asking if an automatic legend should be added to the graph. Default, <code>TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leg.pos</code></td>
<td>

<p>position of the legend. Default, <code>"topleft"</code>. Ignored if <code>legend=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leg.cex</code></td>
<td>

<p>number that reescales the size of the legend. Ignored if <code>legend=FALSE</code>. Default, 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>

<p>2-dimensional vector indicating the lower and upper limits for x-axis. Default value (NULL) sets those limits automatically.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>

<p>2-dimensional vector indicating the lower and upper limits for y-axis. Default value (NULL) sets those limits automatically.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main, xlab, ...</code></td>
<td>

<p>further arguments to be passed to <code>plot()</code>.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Estimates of the density functions for both samples and vertical lines representing the threshold and its confidence limits are drawn.
</p>


<h3>References</h3>

<p>Skaltsa K, Jover L, Carrasco JL. (2010). Estimation of the diagnostic threshold accounting for decision costs and sampling uncertainty. Biometrical Journal 52(5):676-697.
</p>


<h3>See Also</h3>

<p><code>thres2</code>, <code>lines.thres2</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">n1 &lt;- 100
n2 &lt;- 100
set.seed(1234)
par1.1 &lt;- 0
par1.2 &lt;- 1
par2.1 &lt;- 2
par2.2 &lt;- 1
rho &lt;- 0.2
k1 &lt;- rnorm(n1, par1.1, par1.2) # non-diseased
k2 &lt;- rnorm(n2, par2.1, par2.2) # diseased

thres &lt;- thres2(k1, k2, rho, method="eq", ci.method="d")
plot(thres, col=c(1, 2, 4), lwd=c(2, 2, 1), leg.pos="topright")
</code></pre>


</div>