<div class="container">

<table style="width: 100%;"><tr>
<td>dataset_rejection_resample</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>A transformation that resamples a dataset to a target distribution.</h2>

<h3>Description</h3>

<p>A transformation that resamples a dataset to a target distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dataset_rejection_resample(
  dataset,
  class_func,
  target_dist,
  initial_dist = NULL,
  seed = NULL,
  name = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dataset</code></td>
<td>
<p>A <code>tf.Dataset</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>class_func</code></td>
<td>
<p>A function mapping an element of the input dataset to a
scalar <code>tf.int32</code> tensor. Values should be in <code style="white-space: pre;">⁠[0, num_classes)⁠</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target_dist</code></td>
<td>
<p>A floating point type tensor, shaped <code style="white-space: pre;">⁠[num_classes]⁠</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial_dist</code></td>
<td>
<p>(Optional.) A floating point type tensor, shaped
<code style="white-space: pre;">⁠[num_classes]⁠</code>. If not provided, the true class distribution is estimated
live in a streaming fashion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>(Optional.) Integer seed for the resampler.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>(Optional.) A name for the tf.data operation.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>tf.Dataset</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
initial_dist &lt;- c(.5, .5)
target_dist &lt;- c(.6, .4)
num_classes &lt;- length(initial_dist)
num_samples &lt;- 100000
data &lt;- sample.int(num_classes, num_samples, prob = initial_dist, replace = TRUE)
dataset &lt;- tensor_slices_dataset(data)
tally &lt;- c(0, 0)
`add&lt;-` &lt;- function (x, value) x + value
# tfautograph::autograph({
#   for(i in dataset)
#     add(tally[as.numeric(i)]) &lt;- 1
# })
dataset %&gt;%
  as_array_iterator() %&gt;%
  iterate(function(i) {
    add(tally[i]) &lt;&lt;- 1
  }, simplify = FALSE)
# The value of `tally` will be close to c(50000, 50000) as
# per the `initial_dist` distribution.
tally # c(50287, 49713)

tally &lt;- c(0, 0)
dataset %&gt;%
  dataset_rejection_resample(
    class_func = function(x) (x-1) %% 2,
    target_dist = target_dist,
    initial_dist = initial_dist
  ) %&gt;%
  as_array_iterator() %&gt;%
  iterate(function(element) {
    names(element) &lt;- c("class_id", "i")
    add(tally[element$i]) &lt;&lt;- 1
  }, simplify = FALSE)
# The value of tally will be now be close to c(75000, 50000)
# thus satisfying the target_dist distribution.
tally # c(74822, 49921)

## End(Not run)
</code></pre>


</div>