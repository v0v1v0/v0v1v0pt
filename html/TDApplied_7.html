<div class="container">

<table style="width: 100%;"><tr>
<td>diagram_kernel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate persistence Fisher kernel value between a pair of persistence diagrams.</h2>

<h3>Description</h3>

<p>Returns the persistence Fisher kernel value between a pair of persistence diagrams
in a particular homological dimension, each of which is either the output from a <code>diagram_to_df</code> 
function call or from a persistent homology calculation like ripsDiag/<code>calculate_homology</code>/<code>PyH</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">diagram_kernel(D1, D2, dim = 0, sigma = 1, t = 1, rho = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>D1</code></td>
<td>
<p>the first persistence diagram.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D2</code></td>
<td>
<p>the second persistence diagram.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dim</code></td>
<td>
<p>the non-negative integer homological dimension in which the distance is to be computed, default 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>a positive number representing the bandwidth for the Fisher information metric, default 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>a positive number representing the scale for the persistence Fisher kernel, default 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>an optional positive number representing the heuristic for Fisher information metric approximation, see <code>diagram_distance</code>. Default NULL.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The persistence Fisher kernel is calculated from the Fisher information metric according to the formula
<code class="reqn">k_{PF}(D_1,D_2) = exp(-t*d_{FIM}(D_1,D_2))</code>, resembling a radial basis kernel for standard
Euclidean spaces.
</p>


<h3>Value</h3>

<p>the numeric kernel value.
</p>


<h3>Author(s)</h3>

<p>Shael Brown - <a href="mailto:shaelebrown@gmail.com">shaelebrown@gmail.com</a>
</p>


<h3>References</h3>

<p>Le T, Yamada M (2018). "Persistence fisher kernel: a riemannian manifold kernel for persistence diagrams." <a href="https://proceedings.neurips.cc/paper/2018/file/959ab9a0695c467e7caf75431a872e5c-Paper.pdf">https://proceedings.neurips.cc/paper/2018/file/959ab9a0695c467e7caf75431a872e5c-Paper.pdf</a>.
</p>
<p>Murphy, K. "Machine learning: a probabilistic perspective", MIT press (2012).
</p>


<h3>See Also</h3>

<p><code>gram_matrix</code> for Gram (i.e. kernel) matrix calculations.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
if(require("TDAstats"))
{
  # create two diagrams
  D1 &lt;- TDAstats::calculate_homology(TDAstats::circle2d[sample(1:100,20),],
                      dim = 1,threshold = 2)
  D2 &lt;- TDAstats::calculate_homology(TDAstats::circle2d[sample(1:100,20),],
                      dim = 1,threshold = 2)

  # calculate the kernel value between D1 and D2 with sigma = 2, t = 2 in dimension 1
  diagram_kernel(D1,D2,dim = 1,sigma = 2,t = 2)
  # calculate the kernel value between D1 and D2 with sigma = 2, t = 2 in dimension 0
  diagram_kernel(D1,D2,dim = 0,sigma = 2,t = 2)
}
</code></pre>


</div>