<div class="container">

<table style="width: 100%;"><tr>
<td>linalg_multi_dot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Efficiently multiplies two or more matrices</h2>

<h3>Description</h3>

<p>Efficiently multiplies two or more matrices by reordering the multiplications so that
the fewest arithmetic operations are performed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">linalg_multi_dot(tensors)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>tensors</code></td>
<td>
<p>(<code>Sequence[Tensor]</code>): two or more tensors to multiply. The first and last
tensors may be 1D or 2D. Every other tensor must be 2D.</p>
</td>
</tr></table>
<h3>Details</h3>

<p>Supports inputs of <code>float</code>, <code>double</code>, <code>cfloat</code> and <code>cdouble</code> dtypes.
This function does not support batched inputs.
</p>
<p>Every tensor in <code>tensors</code> must be 2D, except for the first and last which
may be 1D. If the first tensor is a 1D vector of shape <code style="white-space: pre;">⁠(n,)⁠</code> it is treated as a row vector
of shape <code style="white-space: pre;">⁠(1, n)⁠</code>, similarly if the last tensor is a 1D vector of shape <code style="white-space: pre;">⁠(n,)⁠</code> it is treated
as a column vector of shape <code style="white-space: pre;">⁠(n, 1)⁠</code>.
</p>
<p>If the first and last tensors are matrices, the output will be a matrix.
However, if either is a 1D vector, then the output will be a 1D vector.
</p>


<h3>Note</h3>

<p>This function is implemented by chaining <code>torch_mm()</code> calls after
computing the optimal matrix multiplication order.
</p>
<p>The cost of multiplying two matrices with shapes <code style="white-space: pre;">⁠(a, b)⁠</code> and <code style="white-space: pre;">⁠(b, c)⁠</code> is
<code>a * b * c</code>. Given matrices <code>A</code>, <code>B</code>, <code>C</code> with shapes <code style="white-space: pre;">⁠(10, 100)⁠</code>,
<code style="white-space: pre;">⁠(100, 5)⁠</code>, <code style="white-space: pre;">⁠(5, 50)⁠</code> respectively, we can calculate the cost of different
multiplication orders as follows:
</p>

<p>Math could not be displayed. Please visit the package website.</p>

<p>In this case, multiplying <code>A</code> and <code>B</code> first followed by <code>C</code> is 10 times faster.
</p>


<h3>See Also</h3>

<p>Other linalg: 
<code>linalg_cholesky_ex()</code>,
<code>linalg_cholesky()</code>,
<code>linalg_det()</code>,
<code>linalg_eigh()</code>,
<code>linalg_eigvalsh()</code>,
<code>linalg_eigvals()</code>,
<code>linalg_eig()</code>,
<code>linalg_householder_product()</code>,
<code>linalg_inv_ex()</code>,
<code>linalg_inv()</code>,
<code>linalg_lstsq()</code>,
<code>linalg_matrix_norm()</code>,
<code>linalg_matrix_power()</code>,
<code>linalg_matrix_rank()</code>,
<code>linalg_norm()</code>,
<code>linalg_pinv()</code>,
<code>linalg_qr()</code>,
<code>linalg_slogdet()</code>,
<code>linalg_solve_triangular()</code>,
<code>linalg_solve()</code>,
<code>linalg_svdvals()</code>,
<code>linalg_svd()</code>,
<code>linalg_tensorinv()</code>,
<code>linalg_tensorsolve()</code>,
<code>linalg_vector_norm()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">if (torch_is_installed()) {

linalg_multi_dot(list(torch_tensor(c(1, 2)), torch_tensor(c(2, 3))))
}
</code></pre>


</div>