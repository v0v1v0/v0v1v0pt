<div class="container">

<table style="width: 100%;"><tr>
<td>tess.plot.singlechain.diagnostics</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>tess.plot.mcmc.diagnostics: Plotting the single chain mcmc diagnostics of a episodic diversification rate analysis with mass-extinction events.</h2>

<h3>Description</h3>

<p>tess.plot.singlechain.diagnostics plots MCMC diagnostics for the output generated by a tess.process.output(...) command. Fore more examples see the vignette.</p>


<h3>Usage</h3>

<pre><code class="language-R">tess.plot.singlechain.diagnostics(output,
                                      parameters=c("speciation rates",
                                                   "speciation shift times",
                                                   "extinction rates",
                                                   "extinction shift times",
                                                   "net-diversification rates",
                                                   "relative-extinction rates",
                                                   "mass extinction times"),
                                      diagnostics=c("ESS","geweke"),
                                      ess.crit=c(100,200),
                                      geweke.crit=0.05,
                                      correction="bonferroni",
                                      xlab="million years ago",
                                      col=NULL,
                                      xaxt="n",
                                      yaxt="s",
                                      pch=19,
                                      ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>The processed output for plotting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameters</code></td>
<td>
<p>Which parameters to diagnose. See details for a complete description.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diagnostics</code></td>
<td>
<p>Which diagnostics to use. Options are "ESS" and "geweke".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ess.crit</code></td>
<td>
<p>Two values which correspond to low ESS threshold and acceptable ESS threshold. Default values are 100 and 200.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>geweke.crit</code></td>
<td>
<p>The p-value cutoff for Geweke's diagnostic. Default is the canonical 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correction</code></td>
<td>
<p>What type of multiple-correction method to use. Options are "bonferroni" and "sidak".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>The label of the x-axis. By default, millions of years.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>Colors used for printing. Must be of same length as fig.types.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xaxt</code></td>
<td>
<p>The type of x-axis to plot. By default, no x-axis is plotted (recommended).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yaxt</code></td>
<td>
<p>The type of y-axis to plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>
<p>The type of points to draw (if points are drawn).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments delegated to plot()</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function generates visual summaries of single-chain MCMC diagnostics for the CoMET analysis in the output object.
The argument parameters specifies the aspects of the model to summarize.
Valid options are:
</p>

<ul>
<li>
<p>speciation rates: Plots the interval-specific speciation rates.
</p>
</li>
<li>
<p>speciation shift times: Plots the posterior probability of at least one speciation-rate shift for each interval.
</p>
</li>
<li>
<p>extinction rates: Plots the interval-specific extinction rates.
</p>
</li>
<li>
<p>extinction shift times: Plots the posterior probability of at least one extinction-rate shift for each interval.
</p>
</li>
<li>
<p>net-diversification ratesPlots the interval-specific net-diversification rates.
</p>
</li>
<li>
<p>relative-extinction ratesPlots the interval-specific relative-extinction rates.
</p>
</li>
<li>
<p>mass extinction times: Plots the posterior probability of at least one mass-extinction event for each interval.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Michael R. May</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load the data, compute the sampling fraction rho
data(conifers)
totalConiferSpecies &lt;- 630
sampledConiferSpecies &lt;- conifers$Nnode+1
rho &lt;- sampledConiferSpecies / totalConiferSpecies

# Run a tess analysis
tess.analysis(tree = conifers,
              initialSpeciationRate=c(1.0),
              initialExtinctionRate=c(0.5),
              empiricalHyperPriors = FALSE,
              numExpectedRateChanges = 2,
              numExpectedMassExtinctions = 2,
              samplingProbability = rho,
              MAX_ITERATIONS = 200,
              BURNIN = 100)

# Process the output
coniferOutput &lt;- tess.process.output(dir=getwd(),
                                     numExpectedRateChanges=2,
                                     numExpectedMassExtinctions=2)

# Plot the output
tess.plot.singlechain.diagnostics(coniferOutput)
</code></pre>


</div>