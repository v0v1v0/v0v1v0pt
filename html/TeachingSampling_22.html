<div class="container">

<table style="width: 100%;"><tr>
<td>HH</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The Hansen-Hurwitz Estimator</h2>

<h3>Description</h3>

<p>Computes the Hansen-Hurwitz Estimator estimator of the population total for several variables of interest</p>


<h3>Usage</h3>

<pre><code class="language-R">HH(y, pk)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Vector, matrix or data frame containing the recollected information of the variables of interest for every unit in the selected sample</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pk</code></td>
<td>
<p>A vector containing selection probabilities for each unit in the selected sample</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Hansen-Hurwitz estimator is given by
</p>
<p style="text-align: center;"><code class="reqn">\sum_{i=1}^m\frac{y_i}{p_i}</code>
</p>

<p>where <code class="reqn">y_i</code> is the value of the variables of interest for the <code class="reqn">i</code>th unit, and <code class="reqn">p_i</code> is its corresponding 
selection probability. This estimator is restricted to with replacement sampling designs.
</p>


<h3>Value</h3>

<p>The function returns a vector of total population estimates for each variable of interest, its estimated standard error and its estimated coefficient of variation.</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hagutierrezro@gmail.com">hagutierrezro@gmail.com</a></p>


<h3>References</h3>

<p>Sarndal, C-E. and Swensson, B. and Wretman, J. (1992), <em>Model Assisted Survey Sampling</em>. Springer.<br>
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas.
</p>


<h3>See Also</h3>

<p><code>HT</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">############
## Example 1
############
# Vector U contains the label of a population of size N=5
U &lt;- c("Yves", "Ken", "Erik", "Sharon", "Leslie")
# Vectors y1 and y2 give the values of the variables of interest
y1&lt;-c(32, 34, 46, 89, 35)
y2&lt;-c(1,1,1,0,0)
y3&lt;-cbind(y1,y2)
# The population size is N=5
N &lt;- length(U)
# The sample size is m=2
m &lt;- 2
# pk is the probability of selection of every single unit
pk &lt;- c(0.35, 0.225, 0.175, 0.125, 0.125)
# Selection of a random sample with replacement
sam &lt;- sample(5,2, replace=TRUE, prob=pk)
# The selected sample is
U[sam]
# The values of the variables of interest for the units in the sample
y1[sam]
y2[sam]
y3[sam,]
# The Hansen-Hurwitz estimator
HH(y1[sam],pk[sam])
HH(y2[sam],pk[sam])
HH(y3[sam,],pk[sam])


############
## Example 2
############
# Uses the Lucy data to draw a simple random sample with replacement
data(Lucy)
attach(Lucy)

N &lt;- dim(Lucy)[1]
m &lt;- 400
sam &lt;- sample(N,m,replace=TRUE)
# The vector of selection probabilities of units in the sample
pk &lt;- rep(1/N,m)
# The information about the units in the sample is stored in an object called data
data &lt;- Lucy[sam,]
attach(data)
names(data)
# The variables of interest are: Income, Employees and Taxes
# This information is stored in a data frame called estima
estima &lt;- data.frame(Income, Employees, Taxes)
HH(estima, pk)

################################################################
## Example 3 HH is unbiased for with replacement sampling designs
################################################################

# Vector U contains the label of a population of size N=5
U &lt;- c("Yves", "Ken", "Erik", "Sharon", "Leslie")
# Vector y1 and y2 are the values of the variables of interest
y&lt;-c(32, 34, 46, 89, 35)
# The population size is N=5
N &lt;- length(U)
# The sample size is m=2
m &lt;- 2
# pk is the probability of selection of every single unit
pk &lt;- c(0.35, 0.225, 0.175, 0.125, 0.125)
# p is the probability of selection of every possible sample
p &lt;- p.WR(N,m,pk)
p
sum(p)
# The sample membership matrix for random size without replacement sampling designs
Ind &lt;- nk(N,m)
Ind
# The support with the values of the elements
Qy &lt;- SupportWR(N,m, ID=y)                 
Qy
# The support with the values of the elements
Qp &lt;- SupportWR(N,m, ID=pk)                 
Qp
# The HT estimates for every single sample in the support
HH1 &lt;- HH(Qy[1,], Qp[1,])[1,]
HH2 &lt;- HH(Qy[2,], Qp[2,])[1,]
HH3 &lt;- HH(Qy[3,], Qp[3,])[1,] 
HH4 &lt;- HH(Qy[4,], Qp[4,])[1,] 
HH5 &lt;- HH(Qy[5,], Qp[5,])[1,] 
HH6 &lt;- HH(Qy[6,], Qp[6,])[1,] 
HH7 &lt;- HH(Qy[7,], Qp[7,])[1,]
HH8 &lt;- HH(Qy[8,], Qp[8,])[1,]
HH9 &lt;- HH(Qy[9,], Qp[9,])[1,]
HH10 &lt;- HH(Qy[10,], Qp[10,])[1,]
HH11 &lt;- HH(Qy[11,], Qp[11,])[1,]
HH12 &lt;- HH(Qy[12,], Qp[12,])[1,]
HH13 &lt;- HH(Qy[13,], Qp[13,])[1,]
HH14 &lt;- HH(Qy[14,], Qp[14,])[1,]
HH15 &lt;- HH(Qy[15,], Qp[15,])[1,]
# The HT estimates arranged in a vector
Est &lt;- c(HH1, HH2, HH3, HH4, HH5, HH6, HH7, HH8, HH9, HH10, HH11, HH12, HH13,
HH14, HH15)
Est
# The HT is actually desgn-unbiased
data.frame(Ind, Est, p)
sum(Est*p)
sum(y)
</code></pre>


</div>