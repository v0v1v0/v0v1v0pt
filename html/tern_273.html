<div class="container">

<table style="width: 100%;"><tr>
<td>h_step</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Helper functions for subgroup treatment effect pattern (STEP) calculations</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt="[Stable]"></a>
</p>
<p>Helper functions that are used internally for the STEP calculations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">h_step_window(x, control = control_step())

h_step_trt_effect(data, model, variables, x)

h_step_survival_formula(variables, control = control_step())

h_step_survival_est(
  formula,
  data,
  variables,
  x,
  subset = rep(TRUE, nrow(data)),
  control = control_coxph()
)

h_step_rsp_formula(variables, control = c(control_step(), control_logistic()))

h_step_rsp_est(
  formula,
  data,
  variables,
  x,
  subset = rep(TRUE, nrow(data)),
  control = control_logistic()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>(<code>numeric</code>)<br> biomarker value(s) to use (without <code>NA</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>(named <code>list</code>)<br> output from <code>control_step()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>(<code>data.frame</code>)<br> the dataset containing the variables to summarize.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>(<code>coxph</code> or <code>glm</code>)<br> the regression model object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variables</code></td>
<td>
<p>(named <code>list</code> of <code>string</code>)<br> list of additional analysis variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>(<code>formula</code>)<br> the regression model formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>(<code>logical</code>)<br> subset vector.</p>
</td>
</tr>
</table>
<h3>Value</h3>


<ul><li> <p><code>h_step_window()</code> returns a list containing the window-selection matrix <code>sel</code>
and the interval information matrix <code>interval</code>.
</p>
</li></ul>
<ul><li> <p><code>h_step_trt_effect()</code> returns a vector with elements <code>est</code> and <code>se</code>.
</p>
</li></ul>
<ul><li> <p><code>h_step_survival_formula()</code> returns a model formula.
</p>
</li></ul>
<ul><li> <p><code>h_step_survival_est()</code> returns a matrix of number of observations <code>n</code>,
<code>events</code>, log hazard ratio estimates <code>loghr</code>, standard error <code>se</code>,
and Wald confidence interval bounds <code>ci_lower</code> and <code>ci_upper</code>. One row is
included for each biomarker value in <code>x</code>.
</p>
</li></ul>
<ul><li> <p><code>h_step_rsp_formula()</code> returns a model formula.
</p>
</li></ul>
<ul><li> <p><code>h_step_rsp_est()</code> returns a matrix of number of observations <code>n</code>, log odds
ratio estimates <code>logor</code>, standard error <code>se</code>, and Wald confidence interval bounds
<code>ci_lower</code> and <code>ci_upper</code>. One row is included for each biomarker value in <code>x</code>.
</p>
</li></ul>
<h3>Functions</h3>


<ul>
<li> <p><code>h_step_window()</code>: Creates the windows for STEP, based on the control settings
provided.
</p>
</li>
<li> <p><code>h_step_trt_effect()</code>: Calculates the estimated treatment effect estimate
on the linear predictor scale and corresponding standard error from a STEP <code>model</code> fitted
on <code>data</code> given <code>variables</code> specification, for a single biomarker value <code>x</code>.
This works for both <code>coxph</code> and <code>glm</code> models, i.e. for calculating log hazard ratio or log odds
ratio estimates.
</p>
</li>
<li> <p><code>h_step_survival_formula()</code>: Builds the model formula used in survival STEP calculations.
</p>
</li>
<li> <p><code>h_step_survival_est()</code>: Estimates the model with <code>formula</code> built based on
<code>variables</code> in <code>data</code> for a given <code>subset</code> and <code>control</code> parameters for the
Cox regression.
</p>
</li>
<li> <p><code>h_step_rsp_formula()</code>: Builds the model formula used in response STEP calculations.
</p>
</li>
<li> <p><code>h_step_rsp_est()</code>: Estimates the model with <code>formula</code> built based on
<code>variables</code> in <code>data</code> for a given <code>subset</code> and <code>control</code> parameters for the
logistic regression.
</p>
</li>
</ul>
</div>