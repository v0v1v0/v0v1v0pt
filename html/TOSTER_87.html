<div class="container">

<table style="width: 100%;"><tr>
<td>twoprop_test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Test of Proportions between 2 Independent Groups</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#maturing"><img src="../help/figures/lifecycle-maturing.svg" alt="[Maturing]"></a>
</p>
<p>This is a hypothesis testing function that mimics prop.test, but focuses only on testing differences in proportions between two groups.
This function utilizes a z-test to calculate the p-values (may be inaccurate with small sample sizes).
</p>


<h3>Usage</h3>

<pre><code class="language-R">twoprop_test(
  p1,
  p2,
  n1,
  n2,
  null = NULL,
  alpha = 0.05,
  alternative = c("two.sided", "less", "greater", "equivalence", "minimal.effect"),
  effect_size = c("difference", "odds.ratio", "risk.ratio")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p1, p2</code></td>
<td>
<p>Proportions in each respective group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n1, n2</code></td>
<td>
<p>sample size in each respective group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null</code></td>
<td>
<p>a number indicating the null hypothesis of the difference in proportions between two groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>alpha level (default = 0.05)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>a character string specifying the alternative hypothesis, must be one of "two.sided" (default), "greater", "less", "equivalence" (TOST), or "minimal.effect" (TOST). You can specify just the initial letter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effect_size</code></td>
<td>
<p>the effect size estimate, and confidence intervals, to calculate. Options include the difference between both proportions ("difference"), odds ratio ("odds.ratio"), or risk ratio ("risk.ratio").</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The hypothesis test for differences in proportions can be made on the raw proportions scale, the odds ratio, or the risk ratio (details below).
This function uses the large sample size asymptotic approximations for both the p-value and confidence interval calculations.
There should be a good deal of caution when sample sizes are small.
The p-values for the differences in proportions will differ from base prop.test due to the use of the unpooled standard error (see below).
</p>


<h4>Differences in Proportions</h4>

<p>Differences in proportions test is based on the following calculation:
</p>
<p style="text-align: center;"><code class="reqn">d = p_1 - p_2</code>
</p>

<p>The standard error of <code class="reqn">d</code> is calculated as the following:
</p>
<p style="text-align: center;"><code class="reqn">se(d) = \sqrt{\frac{p_1 \cdot (1-p_1)}{n_1} + \frac{p_2 \cdot (1-p_2)}{n_2}} </code>
</p>

<p>The z-test, with <code class="reqn">d_0</code> being the null value, is then calculated as the following (standard normal distribution evaluated to calculate p-value):
</p>
<p style="text-align: center;"><code class="reqn">z = \frac{d - d_0}{se(d)}</code>
</p>

<p>The confidence interval can then be calculated as the following:
</p>
<p style="text-align: center;"><code class="reqn">d_{lower},d_{upper} = d \pm z_{\alpha} \cdot se(d)</code>
</p>




<h4>Risk Ratio</h4>

<p>The ratio between proportions test is based on the following calculation:
</p>
<p style="text-align: center;"><code class="reqn">\phi = p_1/p_2</code>
</p>

<p>The standard error of <code class="reqn">ln(\phi)</code> is calculated as the following:
</p>
<p style="text-align: center;"><code class="reqn">se(ln(\phi)) = \sqrt{\frac{1-p_1}{n_1 \cdot p_1} + \frac{1-p_2}{n_2 \cdot p_2}} </code>
</p>

<p>The z-test, with <code class="reqn">\phi_0</code> being the null value, is then calculated as the following (standard normal distribution evaluated to calculate p-value):
</p>
<p style="text-align: center;"><code class="reqn">z = \frac{ln(\phi) - ln(\phi_0)}{se(ln(\phi))}</code>
</p>

<p>The confidence interval can then be calculated as the following:
</p>
<p style="text-align: center;"><code class="reqn">\phi_{lower} = \phi \cdot e^{-z_{\alpha} \cdot se(ln(\phi))}</code>
</p>

<p style="text-align: center;"><code class="reqn">\phi_{upper} = \phi \cdot e^{z_{\alpha} \cdot se(ln(\phi))}</code>
</p>




<h4>Odds Ratio</h4>

<p>The ratio between proportions test is based on the following calculation:
(p1/q1) / (p2/q2)
</p>
<p style="text-align: center;"><code class="reqn">OR = \frac{p_1}{1-p_1} / \frac{p_2}{1-p_2}</code>
</p>

<p>The standard error of <code class="reqn">ln(OR)</code> is calculated as the following:
</p>
<p style="text-align: center;"><code class="reqn">se(ln(OR)) = \sqrt{\frac{1}{n_1 \cdot p_1 + 0.5} + \frac{1}{n_1 \cdot (1-p_1) + 0.5} + \frac{1}{n_2 \cdot p_2 + 0.5} + \frac{1}{n_2 \cdot (1-p_2) + 0.5} } </code>
</p>

<p>The z-test, with <code class="reqn">OR_0</code> being the null value, is then calculated as the following (standard normal distribution evaluated to calculate p-value):
</p>
<p style="text-align: center;"><code class="reqn">z = \frac{ln(OR) - ln(OR_0)}{se(ln(OR))}</code>
</p>

<p>The confidence interval can then be calculated as the following:
</p>
<p style="text-align: center;"><code class="reqn">OR_{lower},OR_{upper} = exp(ln(OR) \pm z_{\alpha} \cdot se(ln(OR)))</code>
</p>




<h3>Value</h3>

<p>An S3 object of the class <code>htest</code>.
</p>


<h3>References</h3>

<p>Gart, J. J., &amp; Nam, J. M. (1988). Approximate interval estimation of the ratio of binomial parameters: a review and corrections for skewness. Biometrics, 323-338.
</p>
<p>Tunes da Silva, G., Logan, B. R., &amp; Klein, J. P. (2008). Methods for Equivalence and Noninferiority Testing. Biology of Blood Marrow Transplant, 15(1 Suppl), 120-127.
</p>
<p>Yin, G. (2012). Clinical Trial Design: Bayesian and Frequentist Adaptive Methods. Hoboken, New Jersey: John Wiley &amp; Sons, Inc.
</p>


</div>