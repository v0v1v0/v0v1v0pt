<div class="container">

<table style="width: 100%;"><tr>
<td>inv_kimesurface_transform</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>inverse kimesurface transform on a function in different periodic ranges</h2>

<h3>Description</h3>

<p>This function applies the inverse kimesurface transform to convert a kimesurface-transformed function back
to get the original 1D function in [0, 2*pi] or other similar periodic time range.
</p>


<h3>Usage</h3>

<pre><code class="language-R">inv_kimesurface_transform(
  time_points,
  array_2d,
  num_length = 20,
  m = 1,
  msg = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>time_points</code></td>
<td>
<p>a sequence of points in [0, 2*pi] or other periodic range</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>array_2d</code></td>
<td>
<p>2D array, got from the kimesurface_transform</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_length</code></td>
<td>
<p>integer, interpolate f(t) to num_length samples in [0 : 2*pi] to extend the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>width of the contour path in C; too small values may lead to singularities on the negative x-axis; 
too large valued may lead to numerical instability for large positive x-axis. The default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>msg</code></td>
<td>
<p>Boolean to show/hide warnings. The default is TRUE.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list of two elements
</p>

<ul>
<li>
<p> Smooth_Reconstruction - the smoothed data computed from inverse kimesurface transform, 
with the same length of time_points
</p>
</li>
<li>
<p> Raw_Reconstruction - the original unsmoothed data computed from inverse kimesurface transform, 
with the same length of time_points
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>SOCR team &lt;<a href="http://socr.umich.edu/people/">http://socr.umich.edu/people/</a>&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R">require(reshape2)
require(ggplot2)

# drop the first row and first column because of divergence on Laplace Transform
x = seq(0, 2, length.out=50)[2:50]; y = seq(0, 2, length.out=50)[2:50];
# do kimesurface transform on sine function
z2_grid = kimesurface_transform(FUNCT = function(t) { sin(t) },
                                real_x = x, img_y = y)
                                
time_points = seq(0+0.001, 2*pi, length.out = 160)
inv_data = inv_kimesurface_transform(time_points, z2_grid)
time_Intensities_ILT_df2 &lt;- as.data.frame(cbind(Re=scale(Re(inv_data$Smooth_Reconstruction)), 
                                                Im=scale(Re(inv_data$Raw_Reconstruction)),
                                                fMRI=scale(Re(sin(time_points))),
                                                time_points=time_points))
colnames(time_Intensities_ILT_df2) = c("Smooth Reconstruction", 
                                       "Raw Reconstruction", 
                                       "Original sin()",
                                       "time_points")
df = reshape2::melt(time_Intensities_ILT_df2, id.var = "time_points")
ggplot(df, aes(x = time_points, y = value, colour = variable)) + 
       geom_line(linetype=1, lwd=3) +
       ylab("Function Intensity") + xlab("Time") +
       theme(legend.position="top")+
       labs(title= bquote("Comparison between" ~ "f(t)=sin(t)" ~ "
       and Smooth(ILT(LT(fMRI)))(t); Range [" ~ 0 ~":"~ 2*pi~"]"))

</code></pre>


</div>