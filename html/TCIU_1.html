<div class="container">

<table style="width: 100%;"><tr>
<td>fmri_2dvisual</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>visualization of the 2D brain (axial, sagittal and coronal) with the activated areas</h2>

<h3>Description</h3>

<p>a visualization method, using <code>ggplot2</code> to draw the brain 
from axial, sagittal and coronal view with activated area identified by p-values
</p>


<h3>Usage</h3>

<pre><code class="language-R">fmri_2dvisual(
  pval,
  axis_ls,
  hemody_data = NULL,
  mask,
  p_threshold = 0.05,
  legend_show = TRUE,
  method = "scale_p",
  color_pal = "YlOrRd",
  multi_pranges = TRUE,
  mask_width = 1.5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pval</code></td>
<td>
<p>a 3D array of p-values used to plot activated area of the brain</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis_ls</code></td>
<td>
<p>a list with two elements. The first element is the character of 'x', 'y', 'z'.
The second element is an integer showing a specific slice on the fixed axis identified in the first element.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hemody_data</code></td>
<td>
<p>a parameter to have the plot with/without hemodynamic contour. The default is NULL to make the plot 
without hemodynamic contour, otherwise assign a 3D array of the hemodynamic data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mask</code></td>
<td>
<p>a 3D nifti or 3D array of data to show the shell of the brain</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_threshold</code></td>
<td>
<p>NULL or a numeric value that can be selected randomly below 0.05 to 
drop all p-values above the threshold. If 'low5_percent' method is used, 
make 'p_threshold' as NULL. The default is 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend_show</code></td>
<td>
<p>a logical parameter to specify whether the final plot has legend</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a string that represents method for the plot. 
There are 3 options: 'min_max', 'scale_p' and 'low5_percent'. The default is 'scale_p'.
'min_max' is to draw plot based on the color scale of the minimum and maximum of the p value; 
'scale_p' is to draw the plot with fixed color scale for fixed range of p value; 
'low5_percent' is to draw the plot for the smallest 5 percent of p value when all the p values are not significant.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color_pal</code></td>
<td>
<p>the name of the color palettes provided by <code>RColorBrewer</code>. The default is "YlOrRd".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>multi_pranges</code></td>
<td>
<p>an option under 'scale_p' method to decide whether there are at most 9 colors 
in the legend for the ranges of p value, or at most 4 colors. 
The default is TRUE, choosing the larger number of colors for the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mask_width</code></td>
<td>
<p>a numeric value to specify the width of mask contour. The default is 1.5.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>fmri_2dvisual</code> is used to find activated part of the brain 
based on given p values from sagittal, axial and coronal view. When providing input of 
the p-values, the specific plane and index to slice on, the mask data and 
the hemodynamic data of the brain, a plot will be generated with the heat map 
for the activated parts, the black contour showing the position of the brain, 
and the blue contour representing the hemodynamic contour.
</p>


<h3>Value</h3>

<p>a plot drawn by <code>ggplot2</code>
</p>


<h3>Author(s)</h3>

<p>SOCR team &lt;<a href="http://socr.umich.edu/people/">http://socr.umich.edu/people/</a>&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R"># sample 3D data of mask provided by the package
dim(mask)
# sample 3D p value provided by the package
dim(phase2_pval)

# plot the sagittal, coronal and axial view of this p value generated from the brain fMRI data

fmri_2dvisual(phase2_pval, list('x',40), hemody_data=NULL, mask=mask, p_threshold=0.05)


</code></pre>


</div>