<div class="container">

<table style="width: 100%;"><tr>
<td>dissmfacw</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multi-factor ANOVA from a dissimilarity matrix</h2>

<h3>Description</h3>

<p>Perform a multi-factor analysis of variance from a dissimilarity matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dissmfacw(formula, data, R = 1000, gower = FALSE, squared = FALSE,
    weights = NULL)
    
gower_matrix(diss, squared=TRUE, weights=NULL)

## S3 method for class 'dissmultifactor'
print(x, pvalue.confint=0.95, digits = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A regression-like formula. The left hand side term should be a dissimilarity matrix or a <code>dist</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame from which the variables in <code>formula</code> should be taken.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>Number of permutations used to assess significance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gower</code></td>
<td>
<p>Logical: Is the dissimilarity matrix already a Gower matrix?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>squared</code></td>
<td>
<p>Logical: Should we square the provided dissimilarities?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>Optional numerical vector of case weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diss</code></td>
<td>
<p>Dissimilarity matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a <code>dissmultifactor</code> object as returned by <code>dissmfacw</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalue.confint</code></td>
<td>
<p>Real in range [0,1]. Confidence probability. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>Integer or <code>NULL</code>. Number of digits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other generic print arguments.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Function <code>dissmfacw</code> is, in some way, a generalization of <code>dissassoc</code> to account for several explanatory variables.
The function computes the part of discrepancy explained by the list of covariates specified in the <code>formula</code>.
It provides for each covariate the Type-II effect, i.e. the effect measured when removing the covariate from the full model with all variables included.
</p>
<p>(The returned F values may slightly differ from those obtained with TraMineR versions older than 1.8-9. Since 1.8-9, the within sum of squares at the denominator is divided by <code class="reqn">n-m</code> instead of <code class="reqn">n-m-1</code>, where <code class="reqn">n</code> is the sample size and <code class="reqn">m</code> the total number of predictors and/or contrasts used to represent categorical factors.)
</p>
<p>For a single factor <code>dissmfacw</code> is slower than <code>dissassoc</code>.
Moreover, the latter performs also tests for homogeneity in within-group discrepancies (equality of variances) with a generalization of Levene's and Bartlett's statistics.
</p>
<p>Part of the function is based on the Multivariate Matrix Regression with qr decomposition algorithm written in SciPy-Python by Ondrej Libiger and Matt Zapala (See <cite>Zapala and Schork</cite>, 2006, for a full reference.)  The algorithm has been adapted for Type-II effects and extended to account for case weights.
</p>
<p>Function <code>gower_matrix</code> transforms the provided dissimilarity matrix into a Gower matrix.
</p>


<h3>Value</h3>

<p>A <code>dissmultifactor</code> object with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>mfac</code></td>
<td>
<p>The part of variance explained by each variable (comparing full model to model without the specified variable) and its significance using permutation test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>Function call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perms</code></td>
<td>
<p>Permutation values as a <code>boot</code> object</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Matthias Studer (with Gilbert Ritschard for the help page)</p>


<h3>References</h3>

<p>Studer, M., G. Ritschard, A. Gabadinho and N. S. Müller (2011). Discrepancy analysis of state sequences, <em>Sociological Methods and Research</em>, Vol. 40(3), 471-510, <a href="https://doi.org/10.1177/0049124111415372">doi:10.1177/0049124111415372</a>.
</p>
<p>Studer, M., G. Ritschard, A. Gabadinho and N. S. Müller (2010)
Discrepancy analysis of complex objects using dissimilarities.
In F. Guillet, G. Ritschard, D. A. Zighed and H. Briand (Eds.),
<em>Advances in Knowledge Discovery and Management</em>,
Studies in Computational Intelligence, Volume 292, pp. 3-19. Berlin: Springer.
</p>
<p>Studer, M., G. Ritschard, A. Gabadinho and N. S. Müller (2009).
Analyse de dissimilarités par arbre d'induction. In EGC 2009,
<em>Revue des Nouvelles Technologies de l'Information</em>, Vol. E-15, pp. 7-18.
</p>
<p>Anderson, M. J. (2001). A new method for non-parametric multivariate analysis of variance.
<em>Austral Ecology</em> 26, 32-46.
</p>
<p>McArdle, B. H. and M. J. Anderson (2001). Fitting multivariate models to community data: A
comment on distance-based redundancy analysis. <em>Ecology</em> 82(1), 290-297.
</p>
<p>Zapala, M. A. and N. J. Schork (2006). Multivariate regression analysis of distance matrices for
testing associations between gene expression patterns and related variables. <em>Proceedings of
the National Academy of Sciences of the United States of America</em> 103(51), 19430-19435.
</p>


<h3>See Also</h3>

<p><code>dissvar</code> to compute a pseudo variance from dissimilarities and for a basic introduction to concepts of discrepancy analysis.
<br><code>dissassoc</code> to test association between objects represented by their dissimilarities and a covariate.
<br><code>disstree</code> for an induction tree analysis of objects characterized by a dissimilarity matrix.
<br><code>disscenter</code> to compute the distance of each object to its group center from pairwise dissimilarities.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Define the state sequence object
data(mvad)
mvad.seq &lt;- seqdef(mvad[, 17:86])
## Here, we use only first 100 sequences
mvad.seq &lt;- mvad.seq[1:100,]

## Compute dissimilarities (any dissimilarity measure can be used)
mvad.ham &lt;- seqdist(mvad.seq, method="HAM")

## And now the multi-factor analysis
print(dissmfacw(mvad.ham ~ male + Grammar + funemp +
	gcse5eq + fmpr + livboth, data=mvad[1:100,], R=10))
</code></pre>


</div>