<div class="container">

<table style="width: 100%;"><tr>
<td>tk_acf_diagnostics</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Group-wise ACF, PACF, and CCF Data Preparation</h2>

<h3>Description</h3>

<p>The <code>tk_acf_diagnostics()</code> function provides a simple interface to
detect Autocorrelation (ACF), Partial Autocorrelation (PACF), and Cross Correlation (CCF) of Lagged
Predictors in one <code>tibble</code>. This function powers the <code>plot_acf_diagnostics()</code>
visualization.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tk_acf_diagnostics(.data, .date_var, .value, .ccf_vars = NULL, .lags = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>.data</code></td>
<td>
<p>A data frame or tibble with numeric features (values) in descending
chronological order</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.date_var</code></td>
<td>
<p>A column containing either date or date-time values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.value</code></td>
<td>
<p>A numeric column with a value to have ACF and PACF calculations
performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.ccf_vars</code></td>
<td>
<p>Additional features to perform Lag Cross Correlations (CCFs)
versus the <code>.value</code>. Useful for evaluating external lagged regressors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.lags</code></td>
<td>
<p>A seqence of one or more lags to evaluate.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><strong>Simplified ACF, PACF, &amp; CCF</strong>
</p>
<p>We are often interested in all 3 of these functions. Why not get all 3 at once?
Now you can!
</p>

<ul>
<li> <p><strong>ACF</strong> - Autocorrelation between a target variable and lagged versions of itself
</p>
</li>
<li> <p><strong>PACF</strong> - Partial Autocorrelation removes the dependence of lags on
other lags highlighting key seasonalities.
</p>
</li>
<li> <p><strong>CCF</strong> - Shows how lagged predictors can be used for prediction of a target
variable.
</p>
</li>
</ul>
<p><strong>Lag Specification</strong>
</p>
<p>Lags (<code>.lags</code>) can either be specified as:
</p>

<ul>
<li>
<p> A time-based phrase indicating a duraction (e.g. <code style="white-space: pre;">⁠2 months⁠</code>)
</p>
</li>
<li>
<p> A maximum lag (e.g. <code>.lags = 28</code>)
</p>
</li>
<li>
<p> A sequence of lags (e.g. <code>.lags = 7:28</code>)
</p>
</li>
</ul>
<p><strong>Scales to Multiple Time Series with Groupes</strong>
</p>
<p>The <code>tk_acf_diagnostics()</code> works with <code>grouped_df</code>'s, meaning you can
group your time series by one or more categorical columns with <code>dplyr::group_by()</code>
and then apply <code>tk_acf_diagnostics()</code> to return group-wise lag diagnostics.
</p>
<p><strong>Special Note on Dots (...)</strong>
</p>
<p>Unlike other plotting utilities, the <code>...</code> arguments is NOT used for
group-wise analysis. Rather, it's used for processing Cross Correlations (CCFs).
</p>
<p>Use <code>dplyr::group_by()</code> for processing multiple time series groups.
</p>


<h3>Value</h3>

<p>A <code>tibble</code> or <code>data.frame</code> containing the autocorrelation, partial autocorrelation
and cross correlation data.
</p>


<h3>See Also</h3>


<ul>
<li> <p><strong>Visualizing ACF, PACF, &amp; CCF:</strong> <code>plot_acf_diagnostics()</code>
</p>
</li>
<li> <p><strong>Visualizing Seasonality:</strong> <code>plot_seasonal_diagnostics()</code>
</p>
</li>
<li> <p><strong>Visualizing Time Series:</strong> <code>plot_time_series()</code>
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">library(dplyr)

# ACF, PACF, &amp; CCF in 1 Data Frame
# - Get ACF &amp; PACF for target (adjusted)
# - Get CCF between adjusted and volume and close
FANG %&gt;%
    filter(symbol == "FB") %&gt;%
    tk_acf_diagnostics(date, adjusted,                # ACF &amp; PACF
                       .ccf_vars = c(volume, close),  # CCFs
                       .lags     = 500)

# Scale with groups using group_by()
FANG %&gt;%
    group_by(symbol) %&gt;%
    tk_acf_diagnostics(date, adjusted,
                       .ccf_vars = c(volume, close),
                       .lags     = "3 months")

# Apply Transformations
FANG %&gt;%
    group_by(symbol) %&gt;%
    tk_acf_diagnostics(
        date, diff_vec(adjusted),  # Apply differencing transformation
        .lags = 0:500
    )


</code></pre>


</div>