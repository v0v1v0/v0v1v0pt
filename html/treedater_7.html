<div class="container">

<table style="width: 100%;"><tr>
<td>parboot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate of confidence intervals using parametric bootstrap for molecular clock dating.</h2>

<h3>Description</h3>

<p>This function simulates phylogenies with branch lengths in units
of substitutions per site. Simulations are based on a fitted
treedater object which provides parameters of the molecular clock
model. The treedater method is applied to each simulated tree
providing a Monte Carlo estimate of variance in rates and dates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">parboot(td, nreps = 100, ncpu = 1, overrideTempConstraint = TRUE,
  overrideClock = NULL, overrideSearchRoot = TRUE,
  overrideSeqLength = NULL, quiet = TRUE, normalApproxTMRCA = FALSE,
  parallel_foreach = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>td</code></td>
<td>
<p>A fitted treedater object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nreps</code></td>
<td>
<p>Integer number of simulations to be carried out</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncpu</code></td>
<td>
<p>Number of threads to use for parallel computation. Recommended.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overrideTempConstraint</code></td>
<td>
<p>If TRUE (default) will not enforce positive branch lengths in simualtion replicates. Will speed up execution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overrideClock</code></td>
<td>
<p>May be 'strict' or 'additive' or 'uncorrelated' in which case will force simulations to fit the corresponding model. If ommitted, will inherit the clock model from td</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overrideSearchRoot</code></td>
<td>
<p>If TRUE, will re-use root position from input treedater tree. Otherwise may re-estimate root position in simulations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overrideSeqLength</code></td>
<td>
<p>Optional sequence length to use in simulations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>
<p>If TRUE will minimize output printed to screen</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalApproxTMRCA</code></td>
<td>
<p>If TRUE will use estimate standard deviation from simulation replicates and report confidence interval based on normal distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel_foreach</code></td>
<td>
<p>If TRUE will use the foreach package for parallelization. May work better on HPC systems.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If the original treedater fit estimated the root position, root
position will also be estimated for each simulation, so the
returned trees may have different root positions. Some replicates
may converge to a strict clock or a relaxed clock, so the
parameter estimates in each replicate may not be directly
comparable. It is possible to compute confidence intervals for the
times of particular nodes or for estimated sample times by
inspecting the output from each fitted treedater object, which is
contained in the $trees attribute.
</p>


<h3>Value</h3>

<p>A list with elements 
</p>

<ul>
<li>
<p> trees: The fitted treedater objects corresponding to each simulation
</p>
</li>
<li>
<p> meanRates: Vector of estimated rates for each simulation
</p>
</li>
<li>
<p> meanRate_CI: Confidence interval for substitution rate
</p>
</li>
<li>
<p> coef_of_variation_CI: Confidence interval for rate variation
</p>
</li>
<li>
<p> timeOfMRCA_CI: Confidence interval for time of common ancestor
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Erik M Volz &lt;erik.volz@gmail.com&gt;
</p>


<h3>See Also</h3>

<p>dater
boot
</p>


<h3>Examples</h3>

<pre><code class="language-R"># make a random tree
tre &lt;- ape::rtree(25)
# simulate sample times based on distance from root to tip:
sts &lt;- setNames( ape::node.depth.edgelength( tre )[1:ape::Ntip(tre)], tre$tip.label)
# modify edge length to represent evolutionary distance with rate 1e-3:
tre$edge.length &lt;- tre$edge.length * 1e-3
# treedater: 
td &lt;- dater( tre, sts=sts, s=1000, clock='strict', omega0=.0015 )
# parametric bootstrap: 
pb &lt;- parboot( td, nreps=25 )
# plot lineages through time
plot( pb )

</code></pre>


</div>