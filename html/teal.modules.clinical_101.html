<div class="container">

<table style="width: 100%;"><tr>
<td>tm_g_forest_rsp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>teal Module: Forest Response Plot</h2>

<h3>Description</h3>

<p>This module produces a grid-style forest plot for response data with ADaM structure.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tm_g_forest_rsp(
  label,
  dataname,
  parentname = ifelse(inherits(arm_var, "data_extract_spec"),
    teal.transform::datanames_input(arm_var), "ADSL"),
  arm_var,
  arm_ref_comp = NULL,
  paramcd,
  aval_var = teal.transform::choices_selected(teal.transform::variable_choices(dataname,
    "AVALC"), "AVALC", fixed = TRUE),
  subgroup_var,
  strata_var,
  fixed_symbol_size = TRUE,
  conf_level = teal.transform::choices_selected(c(0.95, 0.9, 0.8), 0.95, keep_order =
    TRUE),
  default_responses = c("CR", "PR", "Y", "Complete Response (CR)",
    "Partial Response (PR)"),
  plot_height = c(500L, 200L, 2000L),
  plot_width = c(1500L, 800L, 3000L),
  rel_width_forest = c(25L, 0L, 100L),
  font_size = c(15L, 1L, 30L),
  pre_output = NULL,
  post_output = NULL,
  ggplot2_args = teal.widgets::ggplot2_args()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>label</code></td>
<td>
<p>(<code>character</code>)<br> menu item label of the module in the teal app.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataname</code></td>
<td>
<p>(<code>character</code>)<br> analysis data used in teal module.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parentname</code></td>
<td>
<p>(<code>character</code>)<br> parent analysis data used in teal module, usually this refers to <code>ADSL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arm_var</code></td>
<td>
<p>(<code>teal.transform::choices_selected()</code>)<br> object with all
available choices and preselected option for variable names that can be used as <code>arm_var</code>.
It defines the grouping variable(s) in the results table.
If there are two elements selected for <code>arm_var</code>,
second variable will be nested under the first variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arm_ref_comp</code></td>
<td>
<p>(<code>list</code>) optional,<br> if specified it must be a named list with each element corresponding to
an arm variable in <code>ADSL</code> and the element must be another list (possibly
with delayed <code>teal.transform::variable_choices()</code> or delayed <code>teal.transform::value_choices()</code>
with the elements named <code>ref</code> and <code>comp</code> that the defined the default
reference and comparison arms when the arm variable is changed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>paramcd</code></td>
<td>
<p>(<code>teal.transform::choices_selected()</code>)<br> object with all
available choices and preselected option for the parameter code variable from <code>dataname</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aval_var</code></td>
<td>
<p>(<code>teal.transform::choices_selected()</code>)<br> object with
all available choices and pre-selected option for the analysis variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subgroup_var</code></td>
<td>
<p>(<code>teal.transform::choices_selected()</code>)<br> object with
all available choices and preselected option for variable names that can be used as the default subgroups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strata_var</code></td>
<td>
<p>(<code>teal.transform::choices_selected()</code>)<br> names of
the variables for stratified analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed_symbol_size</code></td>
<td>
<p>(<code>logical</code>)<br> When (<code>TRUE</code>), the same symbol size is used for plotting each estimate.
Otherwise, the symbol size will be proportional to the sample size in each each subgroup.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf_level</code></td>
<td>
<p>(<code>teal.transform::choices_selected()</code>)<br> object with
all available choices and pre-selected option for the confidence level, each within range of (0, 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>default_responses</code></td>
<td>
<p>(<code>list</code> or <code>character</code>)<br> defines
the default codes for the response variable in the module per value of <code>paramcd</code>.
A passed vector is transmitted for all <code>paramcd</code> values. A passed <code>list</code> must be named
and contain arrays, each name corresponding to a single value of <code>paramcd</code>. Each array
may contain default response values or named arrays <code>rsp</code> of default selected response
values and <code>levels</code> of default level choices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_height</code></td>
<td>
<p>(<code>numeric</code>) optional<br> vector of length three with <code>c(value, min, max)</code>. Specifies the
height of the main plot and renders a slider on the plot to interactively adjust the plot height.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_width</code></td>
<td>
<p>(<code>numeric</code>) optional<br> vector of length three with <code>c(value, min, max)</code>. Specifies the width
of the main plot and renders a slider on the plot to interactively adjust the plot width.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rel_width_forest</code></td>
<td>
<p>(<code>proportion</code>)<br> proportion of total width to allocate to the forest plot. Relative
width of table is then <code>1 - rel_width_forest</code>. If <code>as_list = TRUE</code>, this parameter is ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>font_size</code></td>
<td>
<p>(<code>numeric(1)</code>)<br> font size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pre_output</code></td>
<td>
<p>(<code>shiny.tag</code>) optional,<br> with text placed before the output to put the output into context.
For example a title.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>post_output</code></td>
<td>
<p>(<code>shiny.tag</code>) optional,<br> with text placed after the output to put the output into context.
For example the <code>shiny::helpText()</code> elements are useful.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ggplot2_args</code></td>
<td>
<p>(<code>ggplot2_args</code>) optional<br>
object created by <code>teal.widgets::ggplot2_args()</code> with settings for the module plot. For this
module, this argument will only accept <code>ggplot2_args</code> object with <code>labs</code> list of following child
elements: <code>title</code>, <code>caption</code>. No other elements would be taken into account. The argument is
merged with option <code>teal.ggplot2_args</code> and with default module arguments (hard coded in the module body).
</p>
<p>For more details, see the vignette: <code>vignette("custom-ggplot2-arguments", package = "teal.widgets")</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a <code>teal_module</code> object.
</p>


<h3>See Also</h3>

<p>The <a href="https://insightsengineering.github.io/tlg-catalog/stable/">TLG Catalog</a> where additional example
apps implementing this module can be found.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(nestcolor)
library(dplyr)

ADSL &lt;- tmc_ex_adsl
ADRS &lt;- tmc_ex_adrs %&gt;%
  mutate(AVALC = d_onco_rsp_label(AVALC) %&gt;%
    with_label("Character Result/Finding")) %&gt;%
  filter(PARAMCD != "OVRINV" | AVISIT == "FOLLOW UP")

arm_ref_comp &lt;- list(
  ARM = list(
    ref = "B: Placebo",
    comp = c("A: Drug X", "C: Combination")
  ),
  ARMCD = list(
    ref = "ARM B",
    comp = c("ARM A", "ARM C")
  )
)

app &lt;- init(
  data = cdisc_data(
    ADSL = ADSL,
    ADRS = ADRS,
    code = "
      ADSL &lt;- tmc_ex_adsl
      ADRS &lt;- tmc_ex_adrs %&gt;%
        mutate(AVALC = d_onco_rsp_label(AVALC) %&gt;%
        with_label(\"Character Result/Finding\")) %&gt;%
        filter(PARAMCD != \"OVRINV\" | AVISIT == \"FOLLOW UP\")
    "
  ),
  modules = modules(
    tm_g_forest_rsp(
      label = "Forest Response",
      dataname = "ADRS",
      arm_var = choices_selected(
        variable_choices(ADSL, c("ARM", "ARMCD")),
        "ARMCD"
      ),
      arm_ref_comp = arm_ref_comp,
      paramcd = choices_selected(
        value_choices(ADRS, "PARAMCD", "PARAM"),
        "INVET"
      ),
      subgroup_var = choices_selected(
        variable_choices(ADSL, names(ADSL)),
        c("BMRKR2", "SEX")
      ),
      strata_var = choices_selected(
        variable_choices(ADSL, c("STRATA1", "STRATA2")),
        "STRATA2"
      ),
      plot_height = c(600L, 200L, 2000L),
      default_responses = list(
        BESRSPI = list(
          rsp = c("Stable Disease (SD)", "Not Evaluable (NE)"),
          levels = c(
            "Complete Response (CR)", "Partial Response (PR)", "Stable Disease (SD)",
            "Progressive Disease (PD)", "Not Evaluable (NE)"
          )
        ),
        INVET = list(
          rsp = c("Complete Response (CR)", "Partial Response (PR)"),
          levels = c(
            "Complete Response (CR)", "Not Evaluable (NE)", "Partial Response (PR)",
            "Progressive Disease (PD)", "Stable Disease (SD)"
          )
        ),
        OVRINV = list(
          rsp = c("Progressive Disease (PD)", "Stable Disease (SD)"),
          levels = c("Progressive Disease (PD)", "Stable Disease (SD)", "Not Evaluable (NE)")
        )
      )
    )
  )
)
if (interactive()) {
  shinyApp(app$ui, app$server)
}

</code></pre>


</div>