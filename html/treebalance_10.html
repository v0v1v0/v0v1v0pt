<div class="container">

<table style="width: 100%;"><tr>
<td>colPlaLab</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculation of the Colijn-Plazzotta rank for rooted binary trees</h2>

<h3>Description</h3>

<p>This function calculates the Colijn-Plazzotta rank <code class="reqn">CP(T)</code> for a
given rooted binary tree <code class="reqn">T</code>.<br><br>
For a binary tree <code class="reqn">T</code>, the Colijn-Plazzotta rank <code class="reqn">CP(T)</code> is
recursively defined as <code class="reqn">CP(T)=1</code> if <code class="reqn">T</code> consists of only
one leaf and otherwise
</p>
<p style="text-align: center;"><code class="reqn">CP(T)=\frac{1}{2}\cdot CP(T_1)\cdot(CP(T_1)-1)+CP(T_2)+1</code>
</p>

<p>with <code class="reqn">CP(T_1) \geq CP(T_2)</code> being the ranks of the two pending
subtrees rooted at the children of the root of <code class="reqn">T</code>. This rank
of <code class="reqn">T</code> corresponds to its position in the
lexicographically sorted list of (<code class="reqn">i,j</code>): (1),(1,1),(2,1),(2,2),(3,1),...
The Colijn-Plazzotta rank of binary trees has been shown to be an imbalance index.<br><br>
For <code class="reqn">n=1</code> the function returns <code class="reqn">CP(T)=1</code> and a warning.<br><br>
Note that problems can sometimes arise even for trees with small leaf numbers due
to the limited range of computable values (ranks can reach INF quickly). <br><br>
For details on the Colijn-Plazzotta rank, see 
also Chapter 21 in "Tree balance indices: a comprehensive survey" (https://doi.org/10.1007/978-3-031-39800-1_21).
</p>


<h3>Usage</h3>

<pre><code class="language-R">colPlaLab(tree)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>A rooted binary tree in phylo format.</p>
</td>
</tr></table>
<h3>Value</h3>

<p><code>colPlaLab</code> returns the Colijn-Plazotta rank of the given tree. Since the values can get quite large, the
function returns them in big.z format (package gmp).
</p>


<h3>Author(s)</h3>

<p>Sophie Kersting, Luise Kuehn
</p>


<h3>References</h3>

<p>C. Colijn and G. Plazzotta. A Metric on Phylogenetic Tree Shapes. Systematic Biology, doi: 10.1093/sysbio/syx046.
</p>
<p>N. A. Rosenberg. On the Colijn-Plazzotta numbering scheme for unlabeled binary rooted trees. Discrete Applied Mathematics, 2021. doi: 10.1016/j.dam.2020.11.021.
</p>


<h3>Examples</h3>

<pre><code class="language-R">tree &lt;- ape::read.tree(text="((((,),),(,)),(((,),),(,)));")
colPlaLab(tree)

</code></pre>


</div>