<div class="container">

<table style="width: 100%;"><tr>
<td>excel_pivot_table</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Excel Pivot Table</h2>

<h3>Description</h3>

<p><strong>The Pivot Table</strong> is one of Excel's most powerful features, and now it's available in <code>R</code>!
A pivot table is a table of statistics that summarizes the data of a more extensive table
(such as from a database, spreadsheet, or business intelligence program).
</p>
<p>These functions are designed to help users coming from an <strong>Excel background</strong>.
Most functions replicate the behavior of Excel:
</p>

<ul>
<li>
<p> Names are similar to Excel function names
</p>
</li>
<li>
<p> Functionality replicates Excel
</p>
</li>
</ul>
<h3>Usage</h3>

<pre><code class="language-R">pivot_table(
  .data,
  .rows,
  .columns,
  .values,
  .filters = NULL,
  .sort = NULL,
  fill_na = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>.data</code></td>
<td>
<p>A <code>data.frame</code> or <code>tibble</code> that contains data to summarize with a pivot table</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.rows</code></td>
<td>
<p>Enter one or more groups to assess as expressions (e.g. <code>~ MONTH(date_column)</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.columns</code></td>
<td>
<p>Enter one or more groups to assess expressions (e.g. <code>~ YEAR(date_column)</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.values</code></td>
<td>
<p>Numeric only. Enter one or more summarization expression(s) (e.g. <code>~ SUM(value_column)</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.filters</code></td>
<td>
<p>This argument is not yet in use</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.sort</code></td>
<td>
<p>This argument is not yet in use</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fill_na</code></td>
<td>
<p>A value to replace missing values with. Default is <code>NA</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This summary might include sums, averages, or other statistics, which the pivot table groups together in a meaningful way.
</p>
<p>The key parameters are:
</p>

<ul>
<li> <p><code>.rows</code> - These are groups that will appear as row-wise headings for the summarization, You can modify these groups by applying collapsing functions (e.g. (<code>YEAR()</code>).
</p>
</li>
<li> <p><code>.columns</code> - These are groups that will appear as column headings for the summarization. You can modify these groups by applying collapsing functions (e.g. (<code>YEAR()</code>).
</p>
</li>
<li> <p><code>.values</code> - These are numeric data that are summarized using a summary function
(e.g. <code>SUM()</code>, <code>AVERAGE()</code>, <code>COUNT()</code>, <code>FIRST()</code>, <code>LAST()</code>, <code>SUM_IFS()</code>, <code>AVERAGE_IFS()</code>, <code>COUNT_IFS()</code>)
</p>
</li>
</ul>
<p><strong>R implementation details.</strong>
</p>

<ul>
<li>
<p> The <code>pivot_table()</code> function is powered by the <code>tidyverse</code>, an ecosystem of packages designed to manipulate data.
</p>
</li>
<li>
<p> All of the key parameters can be expressed using a functional form:
</p>

<ul>
<li>
<p> Rows and Column Groupings can be collapsed. Example: <code>.columns = ~ YEAR(order_date)</code>
</p>
</li>
<li>
<p> Values can be summarized provided a single value is returned. Example: <code>.values = ~ SUM_IFS(order_volume &gt;= quantile(order_volume, probs = 0.75))</code>
</p>
</li>
<li>
<p> Summarizations and Row/Column Groupings can be stacked (combined) with <code>c()</code>. Example: <code>.rows = c(~ YEAR(order_date), company)</code>
</p>
</li>
<li>
<p> Bare columns (e.g. <code>company</code>) don not need to be prefixed with the <code>~</code>.
</p>
</li>
<li> <p><strong>All grouping and summarizing functions MUST BE prefixed with <code>~</code></strong>. Example: <code>.rows = ~ YEAR(order_date)</code>
</p>
</li>
</ul>
</li>
</ul>
<h3>Value</h3>

<p>Returns a tibble that has been pivoted to summarize information by column and row groupings
</p>


<h3>Examples</h3>

<pre><code class="language-R"># PIVOT TABLE ----
# Calculate returns by year/quarter
FANG %&gt;%
    pivot_table(
        .rows       = c(symbol, ~ QUARTER(date)),
        .columns    = ~ YEAR(date),
        .values     = ~ PCT_CHANGE_FIRSTLAST(adjusted)
    )

</code></pre>


</div>