<div class="container">

<table style="width: 100%;"><tr>
<td>TEAM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Testing on an Aggregation Tree Method</h2>

<h3>Description</h3>

<p>This function performs multiple testing embedded in a hierarchical structure in order to identify local differences between two independent distributions (e.g. case and control).
</p>


<h3>Usage</h3>

<pre><code class="language-R">TEAM(x1, x2, theta0 = length(x2)/length(c(x1, x2)), K = 14,
  alpha = 0.05, L = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x1</code></td>
<td>
<p>Numeric vector of N1 control observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x2</code></td>
<td>
<p>Numeric vector of N2 case observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta0</code></td>
<td>
<p>Nominal boundary level for binomial parameter - default is N2/(N1+N2)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>log2 number of bins</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Nominal false discovery rate (FDR) level</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>Number of layers in the aggregation tree</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>List containing the discoveries (S.list) in each layer and the estimated layer-specific thresholds (c.hats)
</p>


<h3>References</h3>

<p>Pura J. Chan C. Xie J. Multiple Testing Embedded in an Aggregation Tree to Identify where Two Distributions Differ. <a href="https://arxiv.org/abs/1906.07757">https://arxiv.org/abs/1906.07757</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)
# Simulate local shift difference for each population from mixture of normals
N1 &lt;- N2 &lt;- 1e6
require(ks) #loads rnorm.mixt function
#Controls
x1 &lt;- rnorm.mixt(N1,mus=c(0.2,0.89),sigmas=c(0.04,0.01),props=c(0.97,0.03))
#Cases
x2 &lt;- rnorm.mixt(N2,mus=c(0.2,0.88),sigmas=c(0.04,0.01),props=c(0.97,0.03))
res &lt;- TEAM(x1,x2,K=14,alpha=0.05,L=3)
#Discoveries in each layer - Each element is an growing set of
#indices captured at each layer
res$S.list
#Map back final discoveries in layer 3 to corresponding regions
levels(res$dat$quant)[res$S.list[[3]]]

</code></pre>


</div>