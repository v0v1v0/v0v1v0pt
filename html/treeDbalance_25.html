<div class="container">

<table style="width: 100%;"><tr>
<td>imbalProfile</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculation of 3D imbalance profiles</h2>

<h3>Description</h3>

<p><code>imbalProfile</code> - Calculates the database for a 3D imbalance profile of  
a 3D tree in phylo3D format for any of the four node imbalance approaches: 
relative centroid distance, expanded relative centroid distance, centroid 
angle, or minimal centroid angle. It is also used as a basis to visualize the 
imbalance in a 3D plot, i.e., functions <code>plotImbalPhylo3D</code> and 
<code>addImbalPhylo3D</code>.<br>
The profile is computed with regards to the z-coordinate (height), path 
length to the root, and path length to the nearest descendant leaf of the 
nodes.<br>
The accuracy can be determined by defining the maximal section length
<code>max.seclen</code>, which means that an edge with length <code class="reqn">l</code> will be
subdivided ceiling(<code class="reqn">l</code>/<code>max.seclen</code>)-1 times into parts of equal 
length and all subdividing nodes will be analyzed for their node imbalance.
For example, an edge <code class="reqn">(p,v)</code> of length 3 with a maximal section length 
of 1 would be subdivided twice and would then be evaluated for three points
in total: for <code class="reqn">v</code> itself and for the two subdivisions at <code class="reqn">1/3</code> and 
<code class="reqn">2/3</code> of the edge length.
</p>


<h3>Usage</h3>

<pre><code class="language-R">imbalProfile(tree, imbal_type, max.seclen)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>A rooted tree in phylo3D format (no special node enumeration 
required, except that nodes are numbered from 1 to |V| = the total number of
nodes). There must be at least 2 nodes, i.e., one edge. The attributes 
'node.coord' and 'edge.weight' are strictly required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>imbal_type</code></td>
<td>
<p>Specifies which node imbalance measurement should be 
used. Available are:<br>
"A"     - centroid angle<br>
"alpha" - minimal centroid angle<br>
"M"     - expanded relative centroid distance<br>
"mu"    - relative centroid distance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.seclen</code></td>
<td>
<p>Numeric value &gt;0 that specifies the maximal section length.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>imbalProfile</code> Numeric matrix with five columns. The rows each
represent the values of a single tree node or edge subdivision. The first
column contains the z-coordinate (height), the second the root path length, 
the third the (nearest) descendant leaf path length, and the fourth the 
imbalance value. The fifth column stores the number of the corresponding 
edge.
</p>


<h3>Author(s)</h3>

<p>Sophie Kersting
</p>


<h3>Examples</h3>

<pre><code class="language-R">tree &lt;- treeDbalance::extendPhylo(treeDbalance::example3Dtrees$bean09)
imbalProfile(tree, imbal_type="mu", max.seclen=1)
</code></pre>


</div>