<div class="container">

<table style="width: 100%;"><tr>
<td>IIPUs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>US monthly industrial production from Hansen (1999)</h2>

<h3>Description</h3>

<p>This data, used as example in Hansen (1999), contains the US monthly
industrial production.
</p>


<h3>Usage</h3>

<pre><code class="language-R">IIPUs
</code></pre>


<h3>Format</h3>

<p>A monthly time series of class ts starting in January 1960 and
ending in September 1997. Note that the series ends at 1997 and not 1998 as
in the paper of Hansen, even if the data was taken from hi site and the
graph is exactly the same.
</p>


<h3>Source</h3>

<p>Hansen (1999) Testing for linearity, Journal of Economic Surveys,
Volume 13, Number 5, December 1999 , pp. 551-576(26) available at:
<a href="http://www.ssc.wisc.edu/~bhansen/papers/cv.htm">http://www.ssc.wisc.edu/~bhansen/papers/cv.htm</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(IIPUs)
end(IIPUs) #not same date as in the paper

## Figure 2 in paper (p. 555)
plot(IIPUs)

## Table 1 in paper (p. 556)
ar_1 &lt;- linear(IIPUs, m=16)
coef(summary(ar_1))[, 1:2]
deviance(ar_1)

## Table 2 in paper (p. 559)
set_1 &lt;- setar(IIPUs, m=16, thDelay=5, trim=0.1)
## tsDyn finds another threshold, with a better SSR:
getTh(set_1)
deviance(set_1)

## estimate with Hansen threshold:
set_1_han &lt;- setar(IIPUs, m=16, thDelay=5, trim=0.1, th = 0.23)
deviance(set_1_han)
set_1_CO &lt;- coef(summary(set_1_han))[, 1:2]
cbind(set_1_CO[1:17,], set_1_CO[18:34,])


## Table 4 in paper (p. 561)
set_2 &lt;- setar(IIPUs, m=16, thDelay=5, trim=0.1, nthresh =2)
getTh(set_2)
deviance(set_2)

##most of the results agree, except constant in the low regime which has opposed signs!
set_2_CO &lt;- coef(summary(set_2))[, 1:2]
cbind(set_2_CO[1:17,], set_1_CO[18:34,])

#this is obviously a error in Hansen, see:
XX&lt;-embed(IIPUs, 17)
Y&lt;-XX[,1]
X&lt;-XX[,-1]
dummyDown&lt;-ifelse(X[,6]&lt;= -2.5, 1,0)
sum(dummyDown)
M&lt;-cbind(1*dummyDown,X*dummyDown )
lm(Y~M-1)

## setar test (takes long to compute, even with small nboot)
## Not run: 
  test_1 &lt;- setarTest(IIPUs, m=16, thDelay=5, nboot=10)
  #because of the discrepency. test1vs2 does not correspond, test 1vs3 conforms
  test_1$Ftests ## compare with Table 2 (F12)  and Table 4 (F13, F23)
  summary(test_1)
  
  setarTest(IIPUs, m=16, thDelay=5, nboot=10, test="2vs3")
  #test 2vs3 is also different of the version in the article (27)

## End(Not run)

## results from the test is stored in: setarTest_IIPUs_results
data(setarTest_IIPUs_results)

## Table 5 and 6
test_1vs &lt;- setarTest_IIPUs_results$test_1
test_1vs

## Table 7
test_2vs &lt;- setarTest_IIPUs_results$test_2
test_2vs
plot(test_2vs)
</code></pre>


</div>