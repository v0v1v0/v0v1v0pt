<div class="container">

<table style="width: 100%;"><tr>
<td>DropTip</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Drop leaves from tree</h2>

<h3>Description</h3>

<p><code>DropTip()</code> removes specified leaves from a phylogenetic tree, collapsing
incident branches.
</p>


<h3>Usage</h3>

<pre><code class="language-R">DropTip(tree, tip, preorder = TRUE, check = TRUE)

## S3 method for class 'phylo'
DropTip(tree, tip, preorder = TRUE, check = TRUE)

## S3 method for class 'Splits'
DropTip(tree, tip, preorder, check = TRUE)

DropTipPhylo(tree, tip, preorder = TRUE, check = TRUE)

## S3 method for class 'multiPhylo'
DropTip(tree, tip, preorder = TRUE, check = TRUE)

## S3 method for class 'list'
DropTip(tree, tip, preorder = TRUE, check = TRUE)

## S3 method for class ''NULL''
DropTip(tree, tip, preorder = TRUE, check = TRUE)

KeepTipPreorder(tree, tip)

KeepTipPostorder(tree, tip)

KeepTip(tree, tip, preorder = TRUE, check = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>A tree of class <code>phylo</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tip</code></td>
<td>
<p>Character vector specifying labels of leaves in tree to be
dropped, or integer vector specifying the indices of leaves to be dropped.
Specifying the index of an internal node will drop all descendants of that
node.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>preorder</code></td>
<td>
<p>Logical specifying whether to Preorder <code>tree</code> before
dropping tips.  Specifying <code>FALSE</code> saves a little time, but will result in
undefined behaviour if <code>tree</code> is not in preorder.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check</code></td>
<td>
<p>Logical specifying whether to check validity of <code>tip</code>. If
<code>FALSE</code> and <code>tip</code> contains entries that do not correspond to leaves of the
tree, undefined behaviour may occur.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function differs from <code>ape::drop.tip()</code>, which roots unrooted trees,
and which can crash when trees' internal numbering follows unexpected schema.
</p>


<h3>Value</h3>

<p><code>DropTip()</code> returns a tree of class <code>phylo</code>, with the requested
leaves removed. The edges of the tree will be numbered in preorder,
but their sequence may not conform to the conventions of <code>Preorder()</code>.
</p>
<p><code>KeepTip()</code> returns <code>tree</code> with all leaves not in <code>tip</code> removed,
in preorder.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>DropTipPhylo()</code>: Direct call to <code>DropTip.phylo()</code>, to avoid overhead of
querying object's class.
</p>
</li>
<li> <p><code>KeepTipPreorder()</code>: Faster version with no checks.
Does not retain labels or edge weights.
Edges must be listed in preorder.
May crash if improper input is specified.
</p>
</li>
<li> <p><code>KeepTipPostorder()</code>: Faster version with no checks.
Does not retain labels or edge weights.
Edges must be listed in postorder.
May crash if improper input is specified.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p><a href="https://orcid.org/0000-0001-5660-1727">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>


<h3>See Also</h3>

<p>Other tree manipulation: 
<code>AddTip()</code>,
<code>CollapseNode()</code>,
<code>ConsensusWithout()</code>,
<code>EnforceOutgroup()</code>,
<code>ImposeConstraint()</code>,
<code>KeptPaths()</code>,
<code>KeptVerts()</code>,
<code>LeafLabelInterchange()</code>,
<code>MakeTreeBinary()</code>,
<code>Renumber()</code>,
<code>RenumberTips()</code>,
<code>RenumberTree()</code>,
<code>RootTree()</code>,
<code>SortTree()</code>,
<code>Subtree()</code>,
<code>TipTimedTree()</code>,
<code>TrivialTree</code>
</p>
<p>Other split manipulation functions: 
<code>Subsplit()</code>,
<code>TrivialSplits()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">tree &lt;- BalancedTree(9)
plot(tree)
plot(DropTip(tree, c("t5", "t6")))

unrooted &lt;- UnrootTree(tree)
plot(unrooted)
plot(DropTip(unrooted, 4:5))

summary(DropTip(as.Splits(tree), 4:5))
</code></pre>


</div>