<div class="container">

<table style="width: 100%;"><tr>
<td>equi_mcmc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Gibbs sampler using an invariant prior.</h2>

<h3>Description</h3>

<p><code>equi_mcmc</code> obtains posterior draws that are useful in optimal
equivariant estimation under the array normal model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">equi_mcmc(X, itermax = 1000, start_identity = FALSE, print_iter = FALSE,
  mode_rep = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A tensor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>itermax</code></td>
<td>
<p>The number of iterations in the Gibb's sampler.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start_identity</code></td>
<td>
<p>Should we start the component covariance
matrices at the identity (TRUE) or the sample covariance
matrices (FALSE)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print_iter</code></td>
<td>
<p>Should we print the iteration number at each
iteration?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode_rep</code></td>
<td>
<p>The mode that contains samples. I.e., the mode
whose component covariance matrix is the identity. If NULL then
no modes are assumed to have identity covariance.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>equi_mcmc</code> obtains posterior samples of the component
covariance matrices from the array normal model. This is with
respect to using the right Haar measure over a product group of
lower triangular matrices as the prior.
</p>
<p>This returns only the upper triangular Cholesky square root of the
inverses of the component covariance matrices. Equivalently, these
are the inverses of the lower triangular Cholesky square roots of
the component covariance matrices. This is because sampling the
inverse is faster computationally and the Bayes rules (based on
multiway Stein's loss) only depend on the inverse.
</p>


<h3>Value</h3>

<p><code>Phi_inv</code> List of posterior draws of the inverse of
the cholesky square roots of each component covariance
matrix. <code>Phi_inv[[i]][,,j]</code> provides the <code class="reqn">j</code>th sample
of the <code class="reqn">i</code>th component.
</p>
<p><code>sigma</code> Vector of posterior samples of the overall scale
paramater.
</p>


<h3>Author(s)</h3>

<p>David Gerard.
</p>


<h3>References</h3>

<p>Gerard, D., &amp; Hoff, P. (2015). Equivariant minimax
dominators of the MLE in the array normal model.
<em>Journal of Multivariate Analysis</em>, 137, 32-49.
<a href="https://doi.org/10.1016/j.jmva.2015.01.020">https://doi.org/10.1016/j.jmva.2015.01.020</a>
<a href="http://arxiv.org/pdf/1408.0424.pdf">http://arxiv.org/pdf/1408.0424.pdf</a>
</p>


<h3>See Also</h3>

<p><code>sample_right_wishart</code> and
<code>sample_sig</code> for the Gibbs
updates. <code>convert_cov</code> and
<code>get_equi_bayes</code> for getting posterior summaries
based on the output of
<code>equi_mcmc</code>. <code>multiway_takemura</code> for an
improvement on this procedure.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Generate data whose true covariance is just the identity.
p &lt;- c(2,2,2)
X &lt;- array(stats::rnorm(prod(p)),dim = p)
#Then run the Gibbs sampler.
mcmc_out &lt;- equi_mcmc(X)
plot(mcmc_out$sigma, type = 'l', lwd = 2, ylab = expression(sigma),
     xlab = 'Iteration', main = 'Trace Plot')
abline(h = 1,col = 2,lty = 2)
</code></pre>


</div>