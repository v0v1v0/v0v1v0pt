<div class="container">

<table style="width: 100%;"><tr>
<td>tam.fit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Item Infit and Outfit Statistic
</h2>

<h3>Description</h3>

<p>The item infit and outfit statistic are calculated for
objects of classes <code>tam</code>, <code>tam.mml</code> and
<code>tam.jml</code>,  respectively.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tam.fit(tamobj, ...)

tam.mml.fit(tamobj, FitMatrix=NULL, Nsimul=NULL,progress=TRUE,
   useRcpp=TRUE, seed=NA, fit.facets=TRUE)

tam.jml.fit(tamobj, trim_val=10)

## S3 method for class 'tam.fit'
summary(object, file=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tamobj</code></td>
<td>

<p>An object of class <code>tam</code>, <code>tam.mml</code> or <code>tam.jml</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FitMatrix</code></td>
<td>

<p>A fit matrix <code class="reqn">F</code> for a specific hypothesis of fit of the linear function
<code class="reqn">F \xi </code> (see Simulated Example 3 and Adams &amp; Wu 2007).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nsimul</code></td>
<td>
<p>Number of simulations used for fit calculation.
The default is 100 (less than 400 students), 40 (less than 1000 students),
15 (less than 3000 students) and 5 (more than 3000 students)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress</code></td>
<td>

<p>An optional logical indicating whether computation progress should
be displayed at console.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useRcpp</code></td>
<td>
<p>Optional logical indicating whether <span class="pkg">Rcpp</span>
or pure <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> code should be used for fit calculation.
The latter is consistent with <span class="pkg">TAM</span> (&lt;=1.1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Fixed simulation seed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.facets</code></td>
<td>
<p>An optional logical indicating whether
fit for all facet parameters should be computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trim_val</code></td>
<td>
<p>Optional trimming value. Squared standardized reaisuals
larger than <code>trim_val</code> are set to <code>trim_val</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>Object of class <code>tam.fit</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>Optional file name for summary output</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>In case of <code>tam.mml.fit</code> a data frame as entry <code>itemfit</code>
with four columns:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Outfit</code></td>
<td>
<p>Item outfit statistic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Outfit_t</code></td>
<td>
<p>The <code class="reqn">t</code> value for the outfit statistic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Outfit_p</code></td>
<td>
<p>Significance <code class="reqn">p</code> value for outfit statistic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Outfit_pholm</code></td>
<td>
<p>Significance <code class="reqn">p</code> value for outfit statistic,
adjusted for multiple testing according to the Holm procedure</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Infit</code></td>
<td>
<p>Item infit statistic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Infit_t</code></td>
<td>
<p>The <code class="reqn">t</code> value for the infit statistic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Infit_p</code></td>
<td>
<p>Significance <code class="reqn">p</code> value for infit statistic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Infit_pholm</code></td>
<td>
<p>Significance <code class="reqn">p</code> value for infit statistic,
adjusted for multiple testing according to the Holm procedure</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Adams, R. J., &amp; Wu, M. L. (2007). The mixed-coefficients multinomial logit model.
A generalized form of the Rasch model. In M. von Davier &amp; C. H. Carstensen (Eds.),
<em>Multivariate and mixture distribution Rasch models: Extensions and applications</em>
(pp. 55-76). New York: Springer.
<a href="https://doi.org/10.1007/978-0-387-49839-3_4">doi:10.1007/978-0-387-49839-3_4</a>
</p>


<h3>See Also</h3>

<p>Fit statistics can be also calculated by the function <code>msq.itemfit</code>
which avoids simulations and directly evaluates individual
posterior distributions.
</p>
<p>See <code>tam.jml.fit</code> for calculating item fit and person fit statistics
for models fitted with JML.
</p>
<p>See <code>tam.personfit</code> for computing person fit statistics.
</p>
<p>Item fit and person fit based on estimated person parameters can also be
calculated using the <code>sirt::pcm.fit</code> function
in the <b>sirt</b> package (see Example 1 and Example 2).
</p>


<h3>Examples</h3>

<pre><code class="language-R">#############################################################################
# EXAMPLE 1: Dichotomous data data.sim.rasch
#############################################################################

data(data.sim.rasch)
# estimate Rasch model
mod1 &lt;- TAM::tam.mml(resp=data.sim.rasch)
# item fit
fit1 &lt;- TAM::tam.fit( mod1 )
summary(fit1)
  ##   &gt; summary(fit1)
  ##      parameter Outfit Outfit_t Outfit_p Infit Infit_t Infit_p
  ##   1         I1  0.966   -0.409    0.171 0.996  -0.087   0.233
  ##   2         I2  1.044    0.599    0.137 1.029   0.798   0.106
  ##   3         I3  1.022    0.330    0.185 1.012   0.366   0.179
  ##   4         I4  1.047    0.720    0.118 1.054   1.650   0.025

## Not run: 

#--------
# infit and oufit based on estimated WLEs
library(sirt)

# estimate WLE
wle &lt;- TAM::tam.wle(mod1)
# extract item parameters
b1 &lt;- - mod1$AXsi[, -1 ]
# assess item fit and person fit
fit1a &lt;- sirt::pcm.fit(b=b1, theta=wle$theta, data.sim.rasch )
fit1a$item       # item fit statistic
fit1a$person     # person fit statistic

#############################################################################
# EXAMPLE 2: Partial credit model data.gpcm
#############################################################################

data( data.gpcm )
dat &lt;- data.gpcm

# estimate partial credit model in ConQuest parametrization 'item+item*step'
mod2 &lt;- TAM::tam.mml( resp=dat, irtmodel="PCM2" )
summary(mod2)
# estimate item fit
fit2 &lt;- TAM::tam.fit(mod2)
summary(fit2)

#=&gt; The first three rows of the data frame correspond to the fit statistics
#     of first three items Comfort, Work and Benefit.

#--------
# infit and oufit based on estimated WLEs
# compute WLEs
wle &lt;- TAM::tam.wle(mod2)
# extract item parameters
b1 &lt;- - mod2$AXsi[, -1 ]
# assess fit
fit1a &lt;- sirt::pcm.fit(b=b1, theta=wle$theta, dat)
fit1a$item

#############################################################################
# EXAMPLE 3: Fit statistic testing for local independence
#############################################################################

# generate data with local dependence and User-defined fit statistics
set.seed(4888)
I &lt;- 40        # 40 items
N &lt;- 1000       # 1000 persons

delta &lt;- seq(-2,2, len=I)
theta &lt;- stats::rnorm(N, 0, 1)
# simulate data
prob &lt;- stats::plogis(outer(theta, delta, "-"))
rand &lt;- matrix( stats::runif(N*I), nrow=N, ncol=I)
resp &lt;- 1*(rand &lt; prob)
colnames(resp) &lt;- paste("I", 1:I, sep="")

#induce some local dependence
for (item in c(10, 20, 30)){
 #  20
 #are made equal to the previous item
  row &lt;- round( stats::runif(0.2*N)*N + 0.5)
  resp[row, item+1] &lt;- resp[row, item]
}

#run TAM
mod1 &lt;- TAM::tam.mml(resp)

#User-defined fit design matrix
F &lt;- array(0, dim=c(dim(mod1$A)[1], dim(mod1$A)[2], 6))
F[,,1] &lt;- mod1$A[,,10] + mod1$A[,,11]
F[,,2] &lt;- mod1$A[,,12] + mod1$A[,,13]
F[,,3] &lt;- mod1$A[,,20] + mod1$A[,,21]
F[,,4] &lt;- mod1$A[,,22] + mod1$A[,,23]
F[,,5] &lt;- mod1$A[,,30] + mod1$A[,,31]
F[,,6] &lt;- mod1$A[,,32] + mod1$A[,,33]
fit &lt;- TAM::tam.fit(mod1, FitMatrix=F)
summary(fit)

#############################################################################
# EXAMPLE 4: Fit statistic testing for items with differing slopes
#############################################################################

#*** simulate data
library(sirt)
set.seed(9875)
N &lt;- 2000
I &lt;- 20
b &lt;- sample( seq( -2, 2, length=I ) )
a &lt;- rep( 1, I )
# create some misfitting items
a[c(1,3)] &lt;- c(.5, 1.5 )
# simulate data
dat &lt;- sirt::sim.raschtype( rnorm(N), b=b, fixed.a=a )
#*** estimate Rasch model
mod1 &lt;- TAM::tam.mml(resp=dat)
#*** assess item fit by infit and outfit statistic
fit1 &lt;- TAM::tam.fit( mod1 )$itemfit
round( cbind( "b"=mod1$item$AXsi_.Cat1, fit1$itemfit[,-1] )[1:7,], 3 )

#*** compute item fit statistic in mirt package
library(mirt)
library(sirt)
mod1c &lt;- mirt::mirt( dat, model=1, itemtype="Rasch", verbose=TRUE)
print(mod1c)                      # model summary
sirt::mirt.wrapper.coef(mod1c)    # estimated parameters
fit1c &lt;- mirt::itemfit(mod1c, method="EAP")    # model fit in mirt package
# compare results of TAM and mirt
dfr &lt;- cbind( "TAM"=fit1, "mirt"=fit1c[,-c(1:2)] )

# S-X2 item fit statistic (see also the output from mirt)
library(CDM)
sx2mod1 &lt;- CDM::itemfit.sx2( mod1 )
summary(sx2mod1)

# compare results of CDM and mirt
sx2comp &lt;-  cbind( sx2mod1$itemfit.stat[, c("S-X2", "p") ],
                    dfr[, c("mirt.S_X2", "mirt.p.S_X2") ] )
round(sx2comp, 3 )

## End(Not run)
</code></pre>


</div>