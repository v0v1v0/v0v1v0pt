<div class="container">

<table style="width: 100%;"><tr>
<td>plot.lfq</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plotting of length frequency data (with VBGF curves)</h2>

<h3>Description</h3>

<p>This function plots length frequency (lfq) samples sequentially
arranged in time. An object
of "lfq" class is obatined by applying the <code>lfqRestructure</code>
function. In case growth
parameters are known, von Bertalanffy growth curves can be plotted through the lfq samples.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'lfq'
plot(
  x,
  Fname = "rcounts",
  par = NULL,
  agemax = NULL,
  rel = FALSE,
  y = NA,
  curve.col = 1,
  hist.sc = 0.5,
  hist.col = c("white", "black", "orange", "darkgreen"),
  image.col = NULL,
  region.col = NULL,
  zlim = NULL,
  zlimtype = "balanced",
  date.axis = "traditional",
  date.at = seq(as.Date("1500-01-01"), as.Date("2500-01-01"), by = "months"),
  date.format = "'%y-%b",
  xlab = "",
  ylab = "Length classes",
  draw = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a list of the class "lfq" consisting of following parameters:
</p>

<ul>
<li> <p><strong>midLengths</strong> midpoints of the length classes,
</p>
</li>
<li> <p><strong>dates</strong> dates of sampling times (class Date),
</p>
</li>
<li> <p><strong>catch</strong> matrix with catches/counts per length class (row) and sampling date (column);
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Fname</code></td>
<td>
<p>indicating whether restructured ("rcounts") or original frequencies ("catch") should be
displayed (default: "rcounts")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>
<p>a list with following growth parameters (default NULL):
</p>

<ul>
<li> <p><strong>Linf</strong> asymptotic length,
</p>
</li>
<li> <p><strong>K</strong> growth coefficient,
</p>
</li>
<li> <p><strong>t_anchor</strong> time at length zero,
</p>
</li>
<li> <p><strong>C</strong> amplitude of growth oscillation (optional),
</p>
</li>
<li> <p><strong>ts</strong> summer point (optional);
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>agemax</code></td>
<td>
<p>maximum age of species; default NULL, then estimated from Linf</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rel</code></td>
<td>
<p>logical; defines if relative numbers per length class should be plotted (relative to
the sample size per sampling time, e.g. month). Default: FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>an optional second list of class "lfq" consisting of same parameters as x. This allows to plot
samples from different sources (e.g. different fleets) on top of eachother, classes and dates have to
correspond at least partially. Default is NA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>curve.col</code></td>
<td>
<p>colour of growth curves (default: 1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hist.sc</code></td>
<td>
<p>defines the scaling factor to use for maximum histogram extent (x-axis
direction). The default setting of hist.sc=0.5 will result in a maximum distance equal
to half the distance between closest sample dates (i.e. ensures no overlap and full
plotting within the plot region).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hist.col</code></td>
<td>
<p>vector of 2 values defining coloring to use on negative and positive
histogram bars (default: hist.col=c("white", "black", "orange", "darkgreen"))</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>image.col</code></td>
<td>
<p>colour of image, by default (NULL) red and blue colours
are used. To remove image coloring, set image.col=NA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>region.col</code></td>
<td>
<p>colour of plotting region. Will overwrite image.col
(default: region.col=NULL)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zlim</code></td>
<td>
<p>the minimum and maximum z values for which colors should be
plotted (default : NULL).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zlimtype</code></td>
<td>
<p>indicating if zlim should be based on the range of
the catch ("range") or based on the maximum absolute value in Fname
("balanced", default). This parameter is only considered if zlim is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>date.axis</code></td>
<td>
<p>the style of the x axis. By default the "traditional"
approach is used with years under the months. Alternatively, by using
"modern" the date is plotted in one line according to the chosen
format <code>date.format</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>date.at</code></td>
<td>
<p>the points at which tick-marks are to be drawn. Non-finite
(infinite, NaN or NA) values are omitted. By default it is
seq(as.Date("1500-01-01"), as.Date("2500-01-01"), by="months")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>date.format</code></td>
<td>
<p>format of date  (default : "%y-%b")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>label of x axis (default : "")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>label of y axis (default : "Length classes")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>draw</code></td>
<td>
<p>logical; indicating whether growth curves should be added to
lfq plot if parameters are provided (default : TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional options of the plot function</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function uses <code>lfqFitCurves</code> when growth
parameters are provided to plot growth curves, this can be turned off with
<code>draw</code> = FALSE.
</p>


<h3>References</h3>

<p>Brey, T., Soriano, M., and Pauly, D. 1988. Electronic length frequency analysis: a revised and expanded
user's guide to ELEFAN 0, 1 and 2.
</p>
<p>Pauly, D. 1981. The relationship between gill surface area and growth performance in fish:
a generalization of von Bertalanffy's theory of growth. <em>Meeresforschung</em>. 28:205-211
</p>
<p>Pauly, D. and N. David, 1981. ELEFAN I, a BASIC program for the objective extraction of
growth parameters from length-frequency data. <em>Meeresforschung</em>, 28(4):205-211
</p>
<p>Pauly, D., 1985. On improving operation and use of ELEFAN programs. Part I: Avoiding
"drift" of K towards low values. <em>ICLARM Conf. Proc.</em>, 13-14
</p>
<p>Pauly, D., 1987. A review of the ELEFAN system for analysis of length-frequency data in
fish and aquatic invertebrates. <em>ICLARM Conf. Proc.</em>, (13):7-34
</p>
<p>Pauly, D. and G. R. Morgan (Eds.), 1987. Length-based methods in fisheries research.
(No. 13). WorldFish
</p>
<p>Pauly, D. and G. Gaschuetz. 1979. A simple method for fitting oscillating length growth data, with a
program for pocket calculators. I.C.E.S. CM 1979/6:24. Demersal Fish Comittee, 26 p.
</p>
<p>Pauly, D. 1984. Fish population dynamics in tropical waters: a manual for use with programmable
calculators (Vol. 8). WorldFish.
</p>
<p>Quenouille, M. H., 1956. Notes on bias in estimation. <em>Biometrika</em>, 43:353-360
</p>
<p>Somers, I. F., 1988. On a seasonally oscillating growth function. ICLARM Fishbyte 6(1): 8-11.
</p>
<p>Sparre, P., Venema, S.C., 1998. Introduction to tropical fish stock assessment.
Part 1. Manual. <em>FAO Fisheries Technical Paper</em>, (306.1, Rev. 2): 407 p.
</p>
<p>Tukey, J., 1958. Bias and confidence in not quite large samples.
<em>Annals of Mathematical Statistics</em>, 29: 614
</p>
<p>Tukey, J., 1986. The future of processes of data analysis. In L. V. Jones (Eds.),
The Collected Works of John W. Tukey philosophy and principles of data analysis:
1965-1986 (Vol. 4, pp. 517-549). Monterey, CA, USA: Wadsworth &amp; Brooks/Cole
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(alba)
res &lt;- lfqRestructure(alba)

# simple plot or reconstructed frequencies
plot(x = res, Fname = "rcounts")

# add VBGF curves
plot(res, Fname = "rcounts", par = list(Linf = 14, K = 1.1, t_anchor = 0.3))

# add soVBGF curves, adjust hist.sc and xlim
plot(res, Fname = "catch", curve.col=4,
  par = list(Linf = 14, K = 1.1, t_anchor = 0.3, C = 0.2, ts = 0.75),
  hist.sc = 0.9,
  xlim=range(res$dates)+c(-30, 0)
)

# adjust image colors
plot(res, Fname = "rcounts", image.col = NA )
plot(res, Fname = "rcounts", image.col = rev(cm.colors(21)) )
plot(res, Fname = "rcounts", image.col = colorRampPalette(c("red","grey90","green"))(21))

# solid plot region color
plot(res, xlim=range(res$dates)+c(-60, 60),
  hist.sc=0.75, image.col="grey90") # leaves gaps
plot(res, xlim=range(res$dates)+c(-60, 60),
  hist.sc=0.75, region.col="grey90") # full coverage

# low-level plot additions
plot(res)
abline(h=4, lty=2)
mtext("Restructured frequencies (MA=5)", line=0.25, side=3)



</code></pre>


</div>