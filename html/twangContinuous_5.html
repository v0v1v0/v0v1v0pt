<div class="container">

<table style="width: 100%;"><tr>
<td>ps.cont</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Gradient boosted propensity score estimation for continuous exposures</h2>

<h3>Description</h3>

<p>'ps.cont' calculates propensity scores using gradient boosted
regression and provides diagnostics of the resulting propensity scores.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ps.cont(
  formula,
  data,
  n.trees = 10000,
  interaction.depth = 3,
  shrinkage = 0.01,
  bag.fraction = 1,
  sampw = NULL,
  print.level = 2,
  verbose = FALSE,
  stop.method = "wcor",
  treat.as.cont = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>An object of class [formula]: a symbolic
description of the propensity score model to be fit with the treatment
variable on the left side of the formula and the potential confounding
variables on the right side.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A dataset that includes the treatment as well as the
potential confounding variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.trees</code></td>
<td>
<p>Number of gbm iterations passed on to [gbm]. Default: 10000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interaction.depth</code></td>
<td>
<p>A positive integer denoting the tree depth used in
gradient boosting. Default: 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shrinkage</code></td>
<td>
<p>A numeric value between 0 and 1 denoting the learning rate.
See [gbm] for more details. Default: 0.01.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bag.fraction</code></td>
<td>
<p>A numeric value between 0 and 1 denoting the fraction of
the observations randomly selected in each iteration of the gradient
boosting algorithm to propose the next tree. See [gbm] for
more details. Default: 1.0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampw</code></td>
<td>
<p>Optional sampling weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.level</code></td>
<td>
<p>The amount of detail to print to the screen. Default: 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>If 'TRUE', lots of information will be printed to monitor the
the progress of the fitting. Default: 'FALSE'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stop.method</code></td>
<td>
<p>A method or methods of measuring and summarizing balance
across pretreatment variables. Current options are 'wcor', the weighted Pearson
correlation, summarized by using the mean across the pretreatment variables.
Default: 'wcor'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>treat.as.cont</code></td>
<td>
<p>Used as a check on whether the exposure has greater than
five levels. If it does not and treat.as.cont=FALSE, an error will be
produced. Default: FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments that are passed to ps function.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns an object of class 'ps.cont', a list containing
</p>
<p>* 'gbm.obj' The returned [gbm] object.
</p>
<p>* 'treat' The treatment variable.
</p>
<p>* 'desc' A list containing balance tables for each method selected in
'stop.methods'. Includes a component for the unweighted
analysis names “unw”. Each 'desc' component includes
a list with the following components
</p>
<p>- 'ess' The effective sample size.
</p>
<p>- 'n' The number of subjects.
</p>
<p>- 'max.wcor' The largest weighted correlation across the covariates.
</p>
<p>- 'mean.wcor' The average weighted correlation across the covariates.
</p>
<p>- 'rms.wcor' The root mean square of the absolute weighted correlations across the
covariates.
</p>
<p>- 'bal.tab' a (potentially large) table summarizing the quality of the
weights for balancing the distribution of the pretreatment covariates.
This table is best extracted using the [bal.table] method.
See the help for [bal.table] for details.
</p>
<p>- 'n.trees' The estimated optimal number of [gbm]
iterations to optimize the loss function.
</p>
<p>* 'ps.den' Denominator values for the propensity score weights.
</p>
<p>* 'ps.num' Numerator values for the propensity score weights.
</p>
<p>* 'w' The propensity score weights. If sampling weights are given then these
are incorporated into these weights.
</p>
<p>* 'datestamp' Records the date of the analysis.
</p>
<p>* 'parameters' Saves the 'ps.cont' call.
</p>
<p>* 'alerts' Text containing any warnings accumulated during the estimation.
</p>
<p>* 'iters' A sequence of iterations used in the GBM fits used by 'plot' function.
</p>
<p>* 'balance' The balance measures for the pretreatment covariates used in plotting.
</p>
<p>* 'sampw' The sampling weights as specified in the 'sampw' argument.
</p>
<p>* 'preds' Predicted values based on the propensity score model.
</p>
<p>* 'covariates' Data frame containing the covariates used in the propensity score model.
</p>
<p>* 'n.trees' Maximum number of trees considered in GBM fit.
</p>
<p>* 'data' Data as specified in the 'data' argument.
</p>


<h3>References</h3>

<p>Zhu, Y., Coffman, D. L., &amp; Ghosh, D. (2015). A boosting algorithm for
estimating generalized propensity scores with continuous treatments.
*Journal of Causal Inference*, 3(1), 25-40. doi: <a href="https://doi.org/10.1515/jci-2014-0022">10.1515/jci-2014-0022</a>
</p>


<h3>See Also</h3>

<p>[gbm], [plot.ps.cont], [bal.table], [summary.ps.cont]
</p>


<h3>Examples</h3>

<pre><code class="language-R">  ## Not run: test.mod &lt;- ps.cont(tss_0 ~ sfs8p_0 + sati_0 + sp_sm_0
          + recov_0 + subsgrps_n + treat, data=dat
## End(Not run)

</code></pre>


</div>