<div class="container">

<table style="width: 100%;"><tr>
<td>perm_test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Permutation Transformation Tests 
</h2>

<h3>Description</h3>

<p>P-values for a parameter in a linear transformation
model and corresponding confidence intervals 
obtained from by the permutation principle
</p>


<h3>Usage</h3>

<pre><code class="language-R">perm_test(object, ...)
## S3 method for class 'tram'
perm_test(object, parm = names(coef(object)), 
    statistic = c("Score", "Likelihood", "Wald"),
    alternative = c("two.sided", "less", "greater"), 
    nullvalue = 0, confint = TRUE, level = .95, 
    Taylor = FALSE, block_permutation = TRUE, maxsteps = 25, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object of class <code>tram</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parm</code></td>
<td>
<p>a vector of names of parameters to be tested.
These parameters must be present in <code>object</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>a character string specifying the statistic to be
permuted. The default <code>Score</code> is the classical permutation
test for the esiduals of a model excluding the parameter <code>parm</code>.
Only available for <code>nullvalue = 0</code>, confidence intervals are
not available. Permuting the likelihood or the model coefficients
under the nullvalue is highly expermimental as are the
corresponding confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>a character string specifying the alternative hypothesis,
must be one of <code>"two.sided"</code> (default), <code>"greater"</code> 
or <code>"less"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nullvalue</code></td>
<td>
<p>a number specifying an optional parameter used to form the
null hypothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>confint</code></td>
<td>
<p>a logical indicating whether a confidence interval should be
computed. Score confidence intervals are computed by default. A
1st order Taylor approximation to the Score statistc is used with
<code>Taylor = TRUE</code> (in case numerical inversion of the score
statistic fails, Wald-type confidence intervals relying from this approximation are
returned) . For the remaining likelihood and Wald statistics, confidence
intervals are highly experimental (and probably not worth looking
at).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>the confidence level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>block_permutation</code></td>
<td>
<p>a logical indicating wheather stratifying
variables shall be interpreted as blocks defining admissible
permutations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Taylor</code></td>
<td>
<p>a logical requesting the use of a 1st order Taylor
approximation when inverting the score statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxsteps</code></td>
<td>
<p>number of function evaluations when inverting the score statistic
for computing confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to <code>independence_test</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Permutation test for one single parameters in the linear
predictor of <code>object</code> is computed. This parameters must be present
in <code>object</code>. This is somewhat experimental and not recommended for
serious practical use (yet!).
</p>


<h3>Value</h3>

<p>An object of class <code>htest</code> or a list thereof. See <code>Coxph</code>
for an example.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
  ## Tritiated Water Diffusion Across Human Chorioamnion
  ## Hollander and Wolfe (1999, p. 110, Tab. 4.1)
  diffusion &lt;- data.frame(
      pd = c(0.80, 0.83, 1.89, 1.04, 1.45, 1.38, 1.91, 1.64, 0.73, 1.46,
             1.15, 0.88, 0.90, 0.74, 1.21),
      age = factor(rep(c("At term", "12-26 Weeks"), c(10, 5)))
  )

  ### plot the two quantile functions
  boxplot(pd ~ age, data = diffusion)

  ### the Wilcoxon rank sum test, with a confidence interval
  ### for a median shift
  wilcox.test(pd ~ age, data = diffusion, conf.int = TRUE, exact = TRUE)

  ### a corresponding parametric transformation model with a log-odds ratio
  ### difference parameter, ie a difference on the log-odds scale
  md &lt;- Colr(pd ~ age, data = diffusion)

  ### assess model fit by plotting estimated distribution fcts
  agef &lt;- sort(unique(diffusion$age))
  col &lt;- c("black", "darkred")
  plot(as.mlt(md), newdata = data.frame(age = agef),
       type = "distribution", col = col)
  legend("bottomright", col = col, lty = 1, legend = levels(agef), 
         bty = "n", pch = 19)
  ## compare with ECDFs: not too bad (but not good, either)
  npfit &lt;- with(diffusion, tapply(pd, age, ecdf))
  lines(npfit[[1]], col = col[1])
  lines(npfit[[2]], col = col[2])

  ### Wald confidence interval
  confint(md)

  ### Likelihood confidence interval
  confint(profile(md))

  ### Score confidence interval
  confint(score_test(md))
  confint(score_test(md, Taylor = TRUE))

  ### exact permutation score test
  (pt &lt;- perm_test(md, confint = TRUE, distribution = "exact"))
  (pt &lt;- perm_test(md, confint = TRUE, distribution = "exact", 
                   Taylor = TRUE))

  ### compare with probabilistic indices obtained from asht::wmwTest
  if (require("asht", warn.conflicts = FALSE)) {
      print(wt2 &lt;- wmwTest(pd ~ I(relevel(age, "At term")), 
                      data = diffusion, method = "exact.ce"))
      ### as log-odds ratios
      print(PI(prob = wt2$conf.int))
      print(PI(prob = wt2$estimate))
  }
</code></pre>


</div>