<div class="container">

<table style="width: 100%;"><tr>
<td>CpB_RW</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculates the range weighted rate of accumulation of phylogenetic B-diversity (CpB_RW) over time slices</h2>

<h3>Description</h3>

<p>This function estimates the range-weighted rates of accumulation of phylogenetic B-diversity (CpB_RW) over time for inputted assemblages.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CpB_RW(tree, n, mat, adj, method = "multisite", criterion = "my", pBO = 5, ncor = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>phylo. An ultrametric phylogenetic tree in the "phylo" format.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>numeric. A numeric value indicating the number of temporal slices (method = 1) or the time interval in million years (or phylogenetic diversity) among the tree slices (method = 2). Default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mat</code></td>
<td>
<p>matrix. A presence/absence matrix containing all studied species and sites.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adj</code></td>
<td>
<p>matrix. A square adjacency matrix containing the presence/absence information of all sites and their spatially adjacent ones.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>character string. The method for calculating the phylogenetic beta-diversity. It can be either obtained through a "pairwise" or "multisite" approach. Default is "multisite".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion</code></td>
<td>
<p>character string. The method for cutting the tree. It can be either "my" (million years) or "PD" (accumulated phylogenetic diversity). Default is "my".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pBO</code></td>
<td>
<p>numeric. A value indicating the numeric proportion to define the temporal origin at which the range-weighted phylogenetic B-diversity (PB_RW) started to accumulate in a given assemblage. Default is 5%.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncor</code></td>
<td>
<p>numeric. A value indicating the number of cores the user wants to parallelize. Default is 0.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><b>Parallelization</b>
</p>
<p>Users are advised to check the number of available cores within their machines before running parallel programming.
</p>


<h3>Value</h3>

<p>The function returns a data frame containing the assemblages' rates of cumulative range-weighted phylogenetic B-diversity (CpB_RW), their total range-weighted phylogenetic B-diversity (PB_RW), and their origin (pBO).
</p>


<h3>Author(s)</h3>

<p>Matheus Lima de Araujo <a href="mailto:matheusaraujolima@live.com">matheusaraujolima@live.com</a>
</p>


<h3>References</h3>

<p>Laffan, S. W., Rosauer, D. F., Di Virgilio, G., Miller, J. T., González-Orozco, C. E., Knerr, N., Thornhill, A. H., &amp; Mishler, B. D. (2016). Range-weighted metrics of species and phylogenetic turnover can better resolve biogeographic transition zones. Methods in Ecology and Evolution, 7(5), 580–588. https://doi.org/10.1111/2041-210x.12513
</p>


<h3>See Also</h3>

<p>Other cumulative phylogenetic index analysis: <code>CpD()</code>, <code>CpE()</code>, <code>CpB()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Generate a random tree
tree &lt;- ape::rcoal(20)

# Create a presence-absence matrix
mat &lt;- matrix(sample(c(1,0), 20*10, replace = TRUE), ncol = 20, nrow = 10)
colnames(mat) &lt;- tree$tip.label

# Create a random adjacency matrix
adj &lt;- matrix(sample(c(1,0), 10*10, replace = TRUE), ncol = 10, nrow = 10)

# Fill the diagonals with 1
diag(adj) &lt;- 1

# Calculate their CpB range weighted for 100 tree slices
CpB_RW(tree, n = 100, mat = mat, adj = adj, method = "multisite")

</code></pre>


</div>