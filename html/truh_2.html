<div class="container">

<table style="width: 100%;"><tr>
<td>truh</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>TRUH test statistic</h2>

<h3>Description</h3>

<p>TRUH test statistic for nonparametric two sample testing under heterogeneity.
</p>


<h3>Usage</h3>

<pre><code class="language-R">truh(V, U, B, fc = 1, ncores = 2, seed = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p><code class="reqn">m\times d</code> matrix where <code class="reqn">m</code> represents the sample size and
<code class="reqn">d</code> is the dimension of each sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>U</code></td>
<td>
<p>a <code class="reqn">n\times d</code> matrix where <code class="reqn">n</code> represents the sample size and
<code class="reqn">d</code> is the dimension of each sample with <code class="reqn">m\ll n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>number of bootstrap samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fc</code></td>
<td>
<p>fold change constant. The default value is 1. See equation (2.8) of the referenced paper for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>the number of computing cores available. The default value is 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>random seed for replicability. The default value is 1.</p>
</td>
</tr>
</table>
<h3>Value</h3>


<ol>
<li>
<p> teststat - TRUH test statistic.
</p>
</li>
<li>
<p> k.hat - number of clusters detected in the uninfected sample.
</p>
</li>
<li>
<p> pval - The maximum p-value across the detected clusters.
</p>
</li>
<li>
<p> pval_all - p-value for each cluster.
</p>
</li>
<li>
<p> dist.null_all - the approximate bootstrapped based null distribution.
</p>
</li>
</ol>
<h3>References</h3>

<p>Banerjee, Trambak, Bhaswar B. Bhattacharya, and Gourab Mukherjee.
"A nearest-neighbor based nonparametric test for viral remodeling in
heterogeneous single-cell proteomic data."
The Annals of Applied Statistics 14, no. 4 (2020): 1777-1805.
</p>


<h3>See Also</h3>

<p><code>nearest</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(truh)
n = 500
m = 10
d = 3
set.seed(1)
V = matrix(rnorm(m*d),nrow=m,ncol=d)
set.seed(2)
U = matrix(rnorm(n*d),nrow=n,ncol=d)
out = truh(V,U,100)

</code></pre>


</div>