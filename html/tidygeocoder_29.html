<div class="container">

<table style="width: 100%;"><tr>
<td>reverse_geo</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Reverse geocode coordinates</h2>

<h3>Description</h3>

<p>Reverse geocodes geographic coordinates (latitude and longitude) given as numeric values.
Latitude and longitude inputs are limited to possible values. Latitudes must be between -90 and 90 and
longitudes must be between -180 and 180. Invalid values will not be sent to the geocoding service.
The reverse_geocode function utilizes this function on coordinates contained in dataframes.
See example usage in <code>vignette("tidygeocoder")</code>.
</p>
<p>Refer to api_parameter_reference,
min_time_reference, and batch_limit_reference for more details on
geocoding service parameters and usage.
</p>
<p>This function uses the get_api_query, query_api, and
extract_reverse_results functions to create, execute, and parse geocoder
API queries.
</p>


<h3>Usage</h3>

<pre><code class="language-R">reverse_geo(
  lat,
  long,
  method = "osm",
  address = "address",
  limit = 1,
  full_results = FALSE,
  mode = "",
  unique_only = FALSE,
  return_coords = TRUE,
  min_time = NULL,
  progress_bar = show_progress_bar(),
  quiet = getOption("tidygeocoder.quiet", FALSE),
  api_url = NULL,
  timeout = 20,
  flatten = TRUE,
  batch_limit = NULL,
  verbose = getOption("tidygeocoder.verbose", FALSE),
  no_query = FALSE,
  custom_query = list(),
  api_options = list(),
  iq_region = "us",
  geocodio_v = 1.6,
  mapbox_permanent = FALSE,
  here_request_id = NULL,
  mapquest_open = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>lat</code></td>
<td>
<p>latitude values (input data)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>long</code></td>
<td>
<p>longitude values (input data)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the geocoding service to be used. API keys are loaded from environmental variables. Run <code>usethis::edit_r_environ()</code> to open your .Renviron file and add an API key as an environmental variable. For example, add the line <code>GEOCODIO_API_KEY="YourAPIKeyHere"</code>.
</p>

<ul>
<li> <p><code>"osm"</code>: <a href="https://nominatim.org">Nominatim</a>.
</p>
</li>
<li> <p><code>"arcgis"</code>: <a href="https://developers.arcgis.com/rest/geocode/api-reference/overview-world-geocoding-service.htm">ArcGIS</a>.
</p>
</li>
<li> <p><code>"geocodio"</code>: <a href="https://www.geocod.io/">Geocodio</a>. Geographic coverage is limited to the United States and Canada. An API key must be stored in the environmental variable "GEOCODIO_API_KEY". Batch geocoding is supported.
</p>
</li>
<li> <p><code>"iq"</code>: <a href="https://locationiq.com/">Location IQ</a>.  An API key must be stored in the environmental variable "LOCATIONIQ_API_KEY".
</p>
</li>
<li> <p><code>"google"</code>: <a href="https://developers.google.com/maps/documentation/geocoding/overview">Google</a>.  An API key must be stored in the environmental variable "GOOGLEGEOCODE_API_KEY".
</p>
</li>
<li> <p><code>"opencage"</code>: <a href="https://opencagedata.com">OpenCage</a>.  An API key must be stored in the environmental variable "OPENCAGE_KEY".
</p>
</li>
<li> <p><code>"mapbox"</code>: <a href="https://docs.mapbox.com/api/search/">Mapbox</a>.  An API key must be stored in the environmental variable "MAPBOX_API_KEY".
</p>
</li>
<li> <p><code>"here"</code>: <a href="https://developer.here.com/products/geocoding-and-search">HERE</a>.  An API key must be stored in the environmental variable "HERE_API_KEY". Batch geocoding is supported, but must be explicitly called with <code>mode = "batch"</code>.
</p>
</li>
<li> <p><code>"tomtom"</code>: <a href="https://developer.tomtom.com/search-api/search-api-documentation/geocoding">TomTom</a>.  An API key must be stored in the environmental variable "TOMTOM_API_KEY". Batch geocoding is supported.
</p>
</li>
<li> <p><code>"mapquest"</code>: <a href="https://developer.mapquest.com/documentation/geocoding-api/">MapQuest</a>.  An API key must be stored in the environmental variable "MAPQUEST_API_KEY". Batch geocoding is supported.
</p>
</li>
<li> <p><code>"bing"</code>: <a href="https://docs.microsoft.com/en-us/bingmaps/rest-services/locations/">Bing</a>.  An API key must be stored in the environmental variable "BINGMAPS_API_KEY". Batch geocoding is supported, but must be explicitly called with <code>mode = "batch"</code>.
</p>
</li>
<li> <p><code>"geoapify"</code>: <a href="https://www.geoapify.com/geocoding-api">Geoapify</a>.  An API key must be stored in the environmental variable "GEOAPIFY_KEY".
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>address</code></td>
<td>
<p>name of the address column (in the output data)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>limit</code></td>
<td>
<p>maximum number of results to return per input coordinate. For many geocoding services
the maximum value of the limit parameter is 100. Pass <code>limit = NULL</code> to use
the default <code>limit</code> value of the selected geocoding service.
For batch geocoding, limit must be set to 1 (default) if <code>return_coords = TRUE</code>.
Refer to api_parameter_reference for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>full_results</code></td>
<td>
<p>returns all available data from the geocoding service if TRUE.
If FALSE (default) then only a single address column is returned from the geocoding service.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode</code></td>
<td>
<p>set to 'batch' to force batch geocoding or 'single' to force single coordinate
geocoding (one coordinate per query). If not specified then batch geocoding will
be used if available (given method selected) when multiple coordinates are
provided; otherwise single address geocoding will be used. For the "here" and "bing" methods the
batch mode should be explicitly specified with <code>mode = 'batch'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unique_only</code></td>
<td>
<p>only return results for unique inputs if TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return_coords</code></td>
<td>
<p>return input coordinates with results if TRUE. Note that
most services return the input coordinates with <code>full_results = TRUE</code> and setting
<code>return_coords</code> to FALSE does not prevent this.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_time</code></td>
<td>
<p>minimum amount of time for a query to take (in seconds). If NULL
then min_time will be set to the default value specified in min_time_reference.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress_bar</code></td>
<td>
<p>if TRUE then a progress bar will be displayed
for single input geocoding (1 input per query). By default the progress bar
will not be shown for code executed when knitting R Markdown files or code within
an RStudio notebook chunk. Can be set permanently with <code>options(tidygeocoder.progress_bar = FALSE)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>
<p>if TRUE then console messages that are displayed by default
regarding queries will be suppressed. FALSE is default.
Can be set permanently with <code>options(tidygeocoder.quiet = TRUE)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>api_url</code></td>
<td>
<p>custom API URL. If specified, the default API URL will be overridden.
This parameter can be used to specify a local Nominatim server, for instance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timeout</code></td>
<td>
<p>query timeout (in minutes)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flatten</code></td>
<td>
<p>if TRUE (default) then any nested dataframes in results are flattened if possible.
Note that in some cases results are flattened regardless such as for Geocodio batch geocoding.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>batch_limit</code></td>
<td>
<p>limit to the number of coordinates in a batch geocoding query.
Defaults to the value in batch_limit_reference if not specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>if TRUE then detailed logs are output to the console. FALSE is default. Can be set
permanently with <code>options(tidygeocoder.verbose = TRUE)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no_query</code></td>
<td>
<p>if TRUE then no queries are sent to the geocoding service and verbose is set to TRUE.
Used for testing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>custom_query</code></td>
<td>
<p>API-specific parameters to be used, passed as a named list
(ex. <code>list(extratags = 1)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>api_options</code></td>
<td>
<p>a named list of parameters specific to individual services.
(ex. <code>list(geocodio_v = 1.6, geocodio_hipaa = TRUE)</code>). Each parameter begins
with the name of the <code>method</code> (service) it applies to. The possible parameters
are shown below with their default values.
</p>

<ul>
<li> <p><code>census_return_type</code> (default: <code>"locations"</code>): set to <code>"geographies"</code> to return
additional geography columns. Make sure to use <code>full_results = TRUE</code> if using
the "geographies" setting.
</p>
</li>
<li> <p><code>iq_region</code> (default: <code>"us"</code>): set to "eu" to use the European Union API endpoint
</p>
</li>
<li> <p><code>geocodio_v</code> (default: <code>1.6</code>): the version number of the Geocodio API to be used
</p>
</li>
<li> <p><code>geocodio_hipaa</code> (default: <code>FALSE</code>): set to <code>TRUE</code> to use the HIPAA compliant
Geocodio API endpoint
</p>
</li>
<li> <p><code>mapbox_permanent</code> (default: <code>FALSE</code>): set to <code>TRUE</code> to use the <code>mapbox.places-permanent</code>
endpoint. Note that this option should be used only if you have applied for a permanent
account. Unsuccessful requests made by an account that does not have access to the
endpoint may be billable.
</p>
</li>
<li> <p><code>mapbox_open</code> (default: <code>FALSE</code>): set to <code>TRUE</code> to use the Open Geocoding endpoint which
relies solely on OpenStreetMap data
</p>
</li>
<li> <p><code>here_request_id</code> (default: <code>NULL</code>): this parameter would return a previous HERE batch job,
identified by its RequestID. The RequestID of a batch job is displayed
when <code>verbose</code> is TRUE. Note that this option would ignore the
current <code>address</code> parameter on the request, so the <code>return_addresses</code> or <code>return_coords</code>
parameters need to be FALSE.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iq_region</code></td>
<td>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt="[Deprecated]"></a> use the <code>api_options</code> parameter instead</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>geocodio_v</code></td>
<td>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt="[Deprecated]"></a> use the <code>api_options</code> parameter instead</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mapbox_permanent</code></td>
<td>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt="[Deprecated]"></a> use the <code>api_options</code> parameter instead</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>here_request_id</code></td>
<td>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt="[Deprecated]"></a> use the <code>api_options</code> parameter instead</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mapquest_open</code></td>
<td>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt="[Deprecated]"></a> use the <code>api_options</code> parameter instead</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>tibble (dataframe)
</p>


<h3>See Also</h3>

<p>reverse_geocode api_parameter_reference min_time_reference batch_limit_reference
</p>


<h3>Examples</h3>

<pre><code class="language-R">
options(tidygeocoder.progress_bar = FALSE)

 reverse_geo(lat = 38.895865, long = -77.0307713, method = 'osm')
 
 reverse_geo(
   lat = c(38.895865, 43.6534817, 300), 
   long = c(-77.0307713, -79.3839347, 600),
   method = 'osm', full_results = TRUE
 )
 

</code></pre>


</div>