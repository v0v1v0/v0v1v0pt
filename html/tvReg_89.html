<div class="container">

<table style="width: 100%;"><tr>
<td>tvPLM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Time-Varying Coefficients Panel Data Models</h2>

<h3>Description</h3>

<p>Fits a balanced panel data model using the Time-Varying Pooled Ordinary Least 
Squares, the Time-Varying Random Effects and the Time-Varying Fixed Effects models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tvPLM(
  formula,
  z = NULL,
  ez = NULL,
  data,
  index = NULL,
  bw = NULL,
  bw.cov = NULL,
  cv.block = 0,
  method = c("pooling", "random", "within"),
  est = c("lc", "ll"),
  tkernel = c("Triweight", "Epa", "Gaussian"),
  control = tvreg.control(...),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>An object of class formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>A vector containing the smoothing variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ez</code></td>
<td>
<p>(optional) A scalar or vector with the smoothing values. If 
values are not included then the vector <code>z</code> is used instead.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>An optional data frame or matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index</code></td>
<td>
<p>Indicates the individual and time indexes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw</code></td>
<td>
<p>An opcional scalar. It represents the bandwidth in
the estimation of trend coefficients. If NULL, it is selected by cross validation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw.cov</code></td>
<td>
<p>An optional scalar. It represents the bandwidth in the "lc" nonparametric estimation of the
time-varying covariance matrix. If NULL, it is selected by cross validation for method <code>"random"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv.block</code></td>
<td>
<p>A positive scalar with the size of the block in leave one block out cross-validation.
By default 'cv.block=0' meaning leave one out cross-validation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>A character with the choice of panel model/estimation method:
If <code>method = "pooling"</code> (default) then the data is pooled estimated with time-varying OLS. 
No individual or time effects are estimated
If <code>method = "random"</code> then individual effects are considered random and independent
of the regressors.
If <code>method = "within"</code> then individual effects which might be correlated with 
the regressors are estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est</code></td>
<td>
<p>The nonparametric estimation method, one of "lc" (default) for linear constant</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tkernel</code></td>
<td>
<p>A character, either "Triweight" (default), "Epa" or "Gaussian" kernel function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>list of control parameters.  The default is constructed by
the function <code>tvreg.control</code>.  See the documentation of
<code>tvreg.control</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other parameters passed to specific methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function wraps up the kernel smoothing time-varying coefficient pooled, random effects
and fixed effects estimators. 
</p>
<p>Bandwidth selection is of great importance in kernel smoothing methodologies and it is done
automatically by cross-validation. 
</p>
<p>A panel data model consists of "neq" elements in the cross-sectional dimention and
"obs" number of time observations for each cross-section. All variables are
the same for each equation which have common coefficients.
</p>


<h3>Value</h3>

<p><code>tvPLM</code> returns a list of the class <code>tvplm</code> containing the results of model, results of the estimation
and confidence instervals if chosen.
The object of class <code>tvplm</code> have the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>An array of dimension obs x nvar x neq (obs = number of observations, nvar = number of variables
in each equation, neq = number of equations in the system) with the time-varying coefficients estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lower</code></td>
<td>
<p>If <code>level</code> non equal zero, an array of dimension obs x nvar x neq containing the confidence 
interval lower band.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Upper</code></td>
<td>
<p>If <code>level</code> non equal zero, an array of dimension obs x nvar x neq containing the confidence 
interval upper band.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted</code></td>
<td>
<p>The fitted values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>Estimation residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A list with the regressors data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A matrix with the dependent variable data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>A vector with the smoothing variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ez</code></td>
<td>
<p>A vector with the smoothing estimation values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>A vector with the individual fixed effects, if chosen.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw</code></td>
<td>
<p>Bandwidth of mean estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>totobs</code></td>
<td>
<p>Integer specifying the total number of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>neq</code></td>
<td>
<p>Integer specifying the number of cross-section observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs</code></td>
<td>
<p>Integer specifying the number of time observations per cross-section.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nvar</code></td>
<td>
<p>Number of variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Estimation method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est</code></td>
<td>
<p>Nonparemtric estimation methodology.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tkernel</code></td>
<td>
<p>Kernel type.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>Confidence interval range.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>runs</code></td>
<td>
<p>Number of bootstrap replications.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tboot</code></td>
<td>
<p>Type of bootstrap.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BOOT</code></td>
<td>
<p>List with all bootstrap replications of <code>coefficients</code>, if done.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>Initial formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>Matched call.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Casas, I., Gao, J., Peng, B. and Xie, S. (2021). Time-Varying Income Elasticities 
of Healthcare Expenditure for the OECD and Eurozone. 
<em>Journal of Applied Econometrics, 36, pp. 328-345</em>. 
</p>
<p>Sun, Y., Carrol, R.J and Li, D. (2009). Semiparametric Estimation of Fixed-Effects Panel Data 
Varying Coefficient Models. <em>Advances in Econometrics</em>, 25, pp. 101-129.
</p>


<h3>See Also</h3>

<p><code>bw</code>, <code>confint</code>, <code>plot</code>, 
<code>print</code> and <code>summary</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(OECD)
##TVPOLS estimation of the model
tvpols &lt;- tvPLM(lhe~lgdp+pop65+pop14+public, index = c("country", "year"),
 data = OECD, method ="pooling", bw = 0.3)
## Not run: 
tvfe &lt;- tvPLM(lhe~lgdp+pop65+pop14+public, index = c("country", "year"),
 data = OECD, method ="within", bw = 0.8)
tvre &lt;- tvPLM(lhe~lgdp+pop65+pop14+public, index = c("country", "year"),
 data = OECD, method ="random", bw = 0.3)

## End(Not run)
</code></pre>


</div>