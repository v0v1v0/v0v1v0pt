<div class="container">

<table style="width: 100%;"><tr>
<td>sample_draws</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sample draws from a tidy-format data frame of draws</h2>

<h3>Description</h3>

<p>Given a tidy-format data frame of draws with a column indexing each draw, subsample the data frame to a given size
based on a column indexing draws, ensuring that rows in sub-groups of a grouped data frame are sampled from the
same draws.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sample_draws(data, ndraws, draw = ".draw", seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data frame to sample from</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndraws</code></td>
<td>
<p>The number of draws to return, or <code>NULL</code> to return all draws.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>draw</code></td>
<td>
<p>The name of the column indexing the draws; default <code>".draw"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>A seed to use when subsampling draws (i.e. when <code>ndraws</code> is not <code>NULL</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>sample_draws()</code> makes it easier to sub-sample a grouped, tidy-format data frame of draws. On a grouped data frame,
the naive approach of using <code>filter</code> with the <code>.draw</code> column will give incorrect results as it will
select a different sample within each group. <code>sample_draws()</code> ensures the same sample is selected within
each group.
</p>


<h3>Author(s)</h3>

<p>Matthew Kay
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 

library(ggplot2)
library(dplyr)
library(brms)
library(modelr)

theme_set(theme_light())

m_mpg = brm(mpg ~ hp * cyl, data = mtcars,
  # 1 chain / few iterations just so example runs quickly
  # do not use in practice
  chains = 1, iter = 500)

# draw 100 fit lines from the posterior and overplot them
mtcars %&gt;%
  group_by(cyl) %&gt;%
  data_grid(hp = seq_range(hp, n = 101)) %&gt;%
  add_epred_draws(m_mpg) %&gt;%
  # NOTE: only use sample_draws here when making spaghetti plots; for
  # plotting intervals it is always best to use all draws
  sample_draws(100) %&gt;%
  ggplot(aes(x = hp, y = mpg, color = ordered(cyl))) +
  geom_line(aes(y = .epred, group = paste(cyl, .draw)), alpha = 0.25) +
  geom_point(data = mtcars)


## End(Not run)
</code></pre>


</div>