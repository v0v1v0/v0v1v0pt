<div class="container">

<table style="width: 100%;"><tr>
<td>stPredict</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute forecasts based on posterior samples</h2>

<h3>Description</h3>

<p>Predict response at new timepoints by drawing samples of the response from
the posterior predictive distribution.  Since this requires sampling 
teleconnection effects, this method can return estimates of the 
teleconnection effects as a by-product.
</p>


<h3>Usage</h3>

<pre><code class="language-R">stPredict(
  stFit,
  stData,
  stDataNew,
  burn = 1,
  prob = 0.95,
  ncores = 1,
  conf = 0.95,
  tLabs = stDataNew$tLabs,
  X = stData$X,
  Y = stData$Y,
  Z = stData$Z,
  Xnew = stDataNew$X,
  Znew = stDataNew$Z,
  coords.s = stData$coords.s,
  coords.r = stData$coords.r,
  returnAlphas = T,
  cat.probs = c(1/3, 2/3),
  returnFullAlphas = F
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>stFit</code></td>
<td>
<p>Object with class 'stFit' containing posterior parameter samples
needed to composition sample the teleconnection effects and generate 
posterior predictions. The data needed from stFit need only be manually 
entered if not using a stData object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stData</code></td>
<td>
<p>Object with class 'stData' containing data needed to fit this 
model. The data need only be manually entered if not using a stData object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stDataNew</code></td>
<td>
<p>object of class stData that includes information needed for 
making forecasts.  If response data is included, this function will 
automatically run stEval using the empirical climatology as the reference
forecast</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn</code></td>
<td>
<p>number of posterior samples to burn before drawing composition
samples</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>confidence level for approximate confidence intervals of 
teleconnection effects (only needed if returnAlphas==TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>Since the teleconnection effects and posterior predictions can 
be sampled in parallel, this parameter lets users specify the number of 
cores to use to draw teleconnection and prediction samples</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf</code></td>
<td>
<p>Parameter specifying the HPD level to compute for posterior 
predictive samples</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tLabs</code></td>
<td>
<p>Forecast timepoint labels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>[ns, p, nt] array of design matrices with local covariates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>[ns, nt] matrix with response data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>[nr, nt] matrix with remote covariates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xnew</code></td>
<td>
<p>[ns, p, nt0] array of design matrices with local covariates 
at forecast timepoints</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Znew</code></td>
<td>
<p>[nr, nt0] matrix with remote covariates at forecast timepoints</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coords.s</code></td>
<td>
<p>matrix with coordinates where responses were 
observed (lon, lat)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coords.r</code></td>
<td>
<p>matrix with coordinates where remote covariates
were observed (lon, lat)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnAlphas</code></td>
<td>
<p>TRUE to return the teleconnection effects sampled 
at knot locations.  Note that only basic summary information about the 
teleconnection effects will be returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cat.probs</code></td>
<td>
<p>vector of probabilities for also returning categorical 
predictions from the posterior prediction samples; NULL otherwise</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnFullAlphas</code></td>
<td>
<p>TRUE to return the teleconnection effects.
Note that only basic summary information about the 
teleconnection effects will be returned.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">set.seed(2018)
  
data("coprecip")
data("coprecip.fit")

coprecip.predict = stPredict(stFit = coprecip.fit, stData = coprecip, 
                             stDataNew = coprecip, burn = 90, 
                             returnFullAlphas = FALSE)
</code></pre>


</div>