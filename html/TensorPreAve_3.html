<div class="container">

<table style="width: 100%;"><tr>
<td>iter_proj</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Iterative Projection Estimator.</h2>

<h3>Description</h3>

<p>Function for Iterative Projection Direction Refinement to re-estimate the factor loading matrices.
</p>


<h3>Usage</h3>

<pre><code class="language-R">iter_proj(X, initial_direction, proj_N = 30, z = rep(1, X@num_modes - 1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A 'Tensor' object defined in package <span class="pkg">rTensor</span> with <code class="reqn">K+1</code> modes. Mode-1 should correspond to the time mode.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial_direction</code></td>
<td>
<p>Initial direction for projection, written in a list of <code class="reqn">K</code> vectors. This can be obtained from the pre-averaging procedure by using function <code>pre_est</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>proj_N</code></td>
<td>
<p>Number of iterations, should be a positive integer. Default is 30.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>(Estimated) Rank of the core tensor, written as a vector of length <code class="reqn">K</code>. Can be set as 1's when we only need to do rank estimation based on projected data. Default is 1's.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Input a tensor time series and initial estimated directions corresponding to the strongest factors, return the estimated factor loading matrices (or directions) using the Algorithm for Iterative Projection Direction Refinement.
</p>


<h3>Value</h3>

<p>A list of <code class="reqn">K</code> estimated factor loading matrices.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Example of a real data set
set.seed(10)
Q_PRE = pre_est(value_weight_tensor)
Q_PROJ = iter_proj(value_weight_tensor, initial_direction = Q_PRE)
Q_PROJ

set.seed(10)
Q_PRE = pre_est(value_weight_tensor)
Q_PROJ_2 = iter_proj(value_weight_tensor, initial_direction = Q_PRE, z = c(2,2))
Q_PROJ_2


# Example using generated data
K = 2
T = 100
d = c(40,40)
r = c(2,2)
re = c(2,2)
eta = list(c(0,0),c(0,0))
u = list(c(-2,2),c(-2,2))
set.seed(10)
Data_test = tensor_data_gen(K,T,d,r,re,eta,u)
X = Data_test$X
Q_PRE = pre_est(X)
Q_PROJ = iter_proj(X, initial_direction = Q_PRE, z = r)
Q_PROJ

</code></pre>


</div>