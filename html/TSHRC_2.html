<div class="container">

<table style="width: 100%;"><tr>
<td>twostage</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Two-stage procedure for comparing hazard rate functions</h2>

<h3>Description</h3>

<p>Two-stage procedure for comparing hazard rate functions, especially
suited for situation where hazard rate functions cross.
</p>


<h3>Usage</h3>

<pre><code class="language-R">twostage(time, delta, group, nboot, alpha = 0.05, eps = 0.1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>a vector of type <code>"numeric"</code>.  Must be nonnegative.
Failure time or censoring time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>a vector of type <code>"numeric"</code> of the same length
as <code>time</code>.  Must be zero or one.  One indicates failure,
zero indicates censored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>a vector of type <code>"numeric"</code> of the same length
as <code>time</code>.  Must be zero or one.  One indicates treatment group,
zero indicates control group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nboot</code></td>
<td>
<p>number of bootstrap samples.  Must be positive integer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>significance level, must be between zero and one.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>small number used in defining the test statistic.
Must be between zero and one.  See cited paper for discussion.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This procedure compares two hazard rate functions in two stages. In the
first stage, the conventional log-rank test is performed, which is powerful
only when the two hazard rate functions do not cross each other. When the
two hazard rate functions cross each other, positive differences and negative
differences between the two functions would be canceled out in the log-rank 
test statistic, resulting in ineffective comparison. If the log-rank test
gives a significant result, then the entire two-stage procedure stops and
we conclude that the two hazard rate functions are significantly different.
Otherwise, the stage-II test is performed, which is designed specifically 
for detecting crossing difference between the two hazard rate functions
and has the property that its test statistic is independent of the log-rank 
test statistic. The independence property is used in properly defining the 
p-value of the two-stage procedure, based on the p-values of the two 
individual tests.</p>


<h3>Value</h3>

<p>vector of P-values.  <code>"LRPV"</code>: p-value of the log-rank test,
<code>"MTPV"</code>: p-value of the suggested stage-II test,
<code>"TSPV"</code>: p-value of the two-stage test.
</p>


<h3>References</h3>

<p>Qiu, P. and Sheng, J. (2008).
A two-stage procedure for comparing hazard rate functions.
<em>Journal of the Royal Statistical Society: Series B</em>, 70:191-208.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(TSHRC)
data(rats)
attach(rats)
twostage(time, delta, group, nboot = 100)
</code></pre>


</div>