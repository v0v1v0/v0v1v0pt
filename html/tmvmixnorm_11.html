<div class="container">

<table style="width: 100%;"><tr>
<td>rtmvn</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Random number generation for truncated multivariate normal distribution subject to linear inequality constraints</h2>

<h3>Description</h3>

<p><code>rtmvn</code> simulates truncated multivariate (p-dimensional) normal distribution subject to linear inequality constraints. The constraints should be written as a matrix (<code>D</code>) with <code>lower</code> and <code>upper</code> as the lower and upper bounds for those constraints respectively. Note that <code>D</code> can be non-full rank, which generalize many traditional methods.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rtmvn(
  n,
  Mean,
  Sigma,
  D = diag(1, length(Mean)),
  lower,
  upper,
  int = NULL,
  burn = 10,
  thin = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of random samples desired (sample size).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Mean</code></td>
<td>
<p>mean vector of the underlying multivariate normal distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>positive definite covariance matrix of the underlying multivariate normal distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>matrix or vector of coefficients of linear inequality constraints.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>vector of lower bounds for truncation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>vector of upper bounds for truncation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>int</code></td>
<td>
<p>initial value vector for Gibbs sampler (satisfying truncation), if <code>NULL</code> then determine automatically.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn</code></td>
<td>
<p>burn-in iterations discarded (default as <code>10</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>
<p>thinning lag (default as <code>1</code>).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>rtmvn</code> returns a (<code>n*p</code>) matrix (or vector when <code>n=1</code>) containing random numbers which approximately follows truncated multivariate  normal distribution.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Example for full rank with strong dependence
d &lt;- 3
rho &lt;- 0.9
Sigma &lt;- matrix(0, nrow=d, ncol=d)
Sigma &lt;- rho^abs(row(Sigma) - col(Sigma))

D1 &lt;- diag(1,d) # Full rank

set.seed(1203)
ans.1 &lt;- rtmvn(n=1000, Mean=1:d, Sigma, D=D1, lower=rep(-1,d), upper=rep(1,d),
int=rep(0,d), burn=50)

apply(ans.1, 2, summary)

# Example for non-full rank
d &lt;- 3
rho &lt;- 0.5
Sigma &lt;- matrix(0, nrow=d, ncol=d)
Sigma &lt;- rho^abs(row(Sigma) - col(Sigma))

D2 &lt;- matrix(c(1,1,1,0,1,0,1,0,1),ncol=d)
qr(D2)$rank # 2

set.seed(1228)
ans.2 &lt;- rtmvn(n=100, Mean=1:d, Sigma, D=D2, lower=rep(-1,d), upper=rep(1,d), burn=10)

apply(ans.2, 2, summary)

</code></pre>


</div>