<div class="container">

<table style="width: 100%;"><tr>
<td>lt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Estimation of truncated regression models using the Left Truncated (LT) estimator
</h2>

<h3>Description</h3>

<p>Estimates linear regression models with truncated response variables (fixed truncation point), using the LT estimator (Karlsson 2006).
</p>


<h3>Usage</h3>

<pre><code class="language-R">lt(formula, data, point = 0, direction = "left", clower = "ml", const = 1, cupper = 2,
   beta = "ml", covar = FALSE, na.action, ...)
## S4 method for signature 'lt'
print(x, digits = max(3, getOption("digits") - 3), ...)
## S4 method for signature 'lt'
summary(object, level=0.95, ...)
## S4 method for signature 'summary.lt'
print(x, digits= max(3, getOption("digits") - 3), ...)
## S4 method for signature 'lt'
coef(object,...)
## S4 method for signature 'lt'
vcov(object,...)
## S4 method for signature 'lt'
residuals(object,...)
## S4 method for signature 'lt'
fitted(object,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, object</code></td>
<td>

<p>an object of class <code>"lt"</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>

<p>a symbolic description of the model to be estimated
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>an optional data frame
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>point</code></td>
<td>

<p>the value of truncation (the default is 0)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>direction</code></td>
<td>

<p>the direction of truncation, either <code>"left"</code> (the default) or <code>"right"</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clower</code></td>
<td>

<p>the lower threshold value to be used when trimming the conditional density of the errors from below. The default is <code>"ml"</code> meaning that the residual standard deviation from fitting a maximum likelihood model for truncated regression, using <code>truncreg</code>, is used. Method <code>"ols"</code> uses the estimated residual standard deviation from a linear model fitted by <code>lm</code>. It is also possible to manually supply the threshold value by setting <code>clower</code> to be equal to a number or numeric vector of length one.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>const</code></td>
<td>

<p>a number that can be used to alter the size of the lower threshold. <code>const=0.5</code> would give a lower threshold value that is half the original size. The default value is 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cupper</code></td>
<td>

<p>number indicating what upper threshold to use when trimming the conditional density of the errors from above. The number is used to multiply the lower threshold value, i.e. if <code>cupper=2</code> (the default value) the upper threshold value is two times larger than the lower threshold value.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>the method of determining the starting values of the regression coefficients (See Details for more information):
</p>

<ul>
<li>
<p> The default method is <code>"ml"</code>, meaning that the estimated regression coefficients from fitting a maximum likelihood model for truncated regression, assuming Gaussian errors, are used. The maximum likelihood model is fitted using <code>truncreg</code>. 
</p>
</li>
<li>
<p> Method <code>"ols"</code> means that the estimated regression coefficients from fitting a linear model with <code>lm</code>. 
</p>
</li>
<li>
<p> The third option is to manually provide starting values as either a vector, column matrix or row matrix. 
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covar</code></td>
<td>

<p>logical. Indicates whether or not the covariance matrix should be estimated. If <code>TRUE</code> the covariance matrix is estimated using bootstrap. The default number of replicates is 2000 but this can be adjusted (see argument <code>...</code>). However, since the bootstrap procedure is time-consuming the default is <code>covar=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>

<p>a function which indicates what should happen when the data contain <code>NA</code>s.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>

<p>the number of digits to be printed     
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>

<p>the desired level of confidence, for confidence intervals provided by <code>summary.lt</code>. A number between 0 and 1. The default value is <code>0.95</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>additional arguments. For <code>lt</code> the number of bootstrap replicates can be adjusted by setting <code>R=</code>the desired number of replicates. Also the <code>control</code> argument of <code>optim</code> can be set by <code>control=list()</code> (see Details for more information).
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Minimizes the objective function described in Karlsson (2006) wrt the vector of regression coefficients, in order to find the LT estimates. The minimization is performed by <code>optim</code> using the "Nelder–Mead" method, and a maximum number of iterations of 2000. The maximum number of iterations can be adjusted by setting <code>control=list(maxit=...)</code> (for more information see the documentation for <code>optim</code>). <br><br> It is recommended to use one of the methods for generating the starting values of the regression coefficients (see argument <code>beta</code>) rather than supplying these manually, unless one is confident that one has a good idea of what these should be. This because the starting values can have a great impact on the result of the minimization. <br><br> Note that setting <code>cupper=1</code> means that the LT estimates will coincide with the estimates from the Quadratic Mode Estimator (see function <code>qme</code>). For more detailed information see Karlsson and Lindmark (2014).
</p>


<h3>Value</h3>

<p><code>lt</code> returns an object of class <code>"lt"</code>. <br><br> The function <code>summary</code> prints a summary of the results, including two types of confidence intervals (normal approximation and percentile method). The generic accessor functions
<code>coef</code>, <code>fitted</code>, <code>residuals</code> and <code>vcov</code> extract various useful features of the value returned by <code>lt</code><br><br> An object of class <code>"lt"</code>, a list with elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients </code></td>
<td>
<p>the named vector of coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>startcoef </code></td>
<td>
<p>the starting values of the regression coefficients used by <code>optim</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cvalues </code></td>
<td>
<p>information about the thresholds used. The method and constant used and the resulting lower and upper threshold values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value </code></td>
<td>
<p>the value of the objective function corresponding to <code>coefficients</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>counts </code></td>
<td>
<p>number of iterations used by <code>optim</code>. See the documentation for <code>optim</code> for further details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence </code></td>
<td>
<p>from <code>optim</code>. An integer code. 0 indicates successful completion. Possible error codes are <br> 1  indicating that the iteration limit maxit had been reached.<br> 10  indicating degeneracy of the Nelder–Mead simplex.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>message </code></td>
<td>
<p>from <code>optim</code>. A character string giving any additional information returned by the optimizer, or <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals </code></td>
<td>
<p>the residuals of the model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values </code></td>
<td>
<p>the fitted values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df.residual </code></td>
<td>
<p>the residual degrees of freedom</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call </code></td>
<td>
<p>the matched call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariance </code></td>
<td>
<p>if <code>covar</code><code>=</code><code>TRUE</code>, the estimated covariance matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R </code></td>
<td>
<p>if <code>covar</code><code>=</code><code>TRUE</code>, the number of bootstrap replicates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bootrepl </code></td>
<td>
<p>if <code>covar</code><code>=</code><code>TRUE</code>, the bootstrap replicates</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Anita Lindmark and Maria Karlsson
</p>


<h3>References</h3>

<p>Karlsson, M. (2006) Estimators of regression parameters for truncated and censored data, <em>Metrika</em>, <b>63</b>, pp 329–341<br><br>
Karlsson, M., Lindmark, A. (2014) truncSP: An R Package for Estimation of Semi-Parametric Truncated Linear Regression Models, <em>Journal of Statistical Software</em>, <b>57(14)</b>, pp 1–19, <a href="http://www.jstatsoft.org/v57/i14/">http://www.jstatsoft.org/v57/i14/</a> <br><br></p>


<h3>See Also</h3>

<p><code>lt.fit</code>, the function that does the actual fitting <br><br><code>qme</code>, for estimation of models with truncated response variables using the QME estimator <br><br><code>stls</code>, for estimation of models with truncated response variables using the STLS estimator <br><br><code>truncreg</code> for estimating models with truncated response variables by maximum likelihood, assuming Gaussian errors
</p>


<h3>Examples</h3>

<pre><code class="language-R">##Simulate a data.frame (model with asymmetrically distributed errors)
n &lt;- 10000
x1 &lt;- runif(n,0,10)
x2 &lt;- runif(n,0,10)
x3 &lt;- runif(n,-5,5)
eps &lt;- rexp(n,0.2)- 5
y &lt;- 2-2*x1+x2+2*x3+eps
d &lt;- data.frame(y=y,x1=x1,x2=x2,x3=x3)


##Use a truncated subsample
dtrunc &lt;- subset(d, y&gt;0)

##Use lt to consistently estimate the slope parameters
lt(y~x1+x2+x3, dtrunc, point=0, direction="left", clower="ml", const=1, 
   cupper=2, beta="ml", covar=FALSE)
   
##Example using data "PM10trunc"
data(PM10trunc)

ltpm10 &lt;- lt(PM10~cars+temp+wind.speed+temp.diff+wind.dir+hour+day, 
   data=PM10trunc, point=2, control=list(maxit=2500))

summary(ltpm10)

</code></pre>


</div>