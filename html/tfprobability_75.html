<div class="container">

<table style="width: 100%;"><tr>
<td>sts_dynamic_linear_regression_state_space_model</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>State space model for a dynamic linear regression from provided covariates.</h2>

<h3>Description</h3>

<p>A state space model (SSM) posits a set of latent (unobserved) variables that
evolve over time with dynamics specified by a probabilistic transition model
<code>p(z[t+1] | z[t])</code>. At each timestep, we observe a value sampled from an
observation model conditioned on the current state, <code>p(x[t] | z[t])</code>. The
special case where both the transition and observation models are Gaussians
with mean specified as a linear function of the inputs, is known as a linear
Gaussian state space model and supports tractable exact probabilistic
calculations; see <code>tfd_linear_gaussian_state_space_model</code> for details.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sts_dynamic_linear_regression_state_space_model(
  num_timesteps,
  design_matrix,
  drift_scale,
  initial_state_prior,
  observation_noise_scale = 0,
  initial_step = 0,
  validate_args = FALSE,
  allow_nan_stats = TRUE,
  name = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>num_timesteps</code></td>
<td>
<p>Scalar <code>integer</code> <code>tensor</code>, number of timesteps to model
with this distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design_matrix</code></td>
<td>
<p>float <code>tensor</code> of shape <code>tf$concat(list(batch_shape, list(num_timesteps, num_features)))</code>.
This may also optionally be an instance of <code>tf$linalg$LinearOperator</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drift_scale</code></td>
<td>
<p>Scalar (any additional dimensions are treated as batch
dimensions) <code>float</code> <code>tensor</code> indicating the standard deviation of the
latent state transitions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial_state_prior</code></td>
<td>
<p>instance of <code>tfd_multivariate_normal</code> representing
the prior distribution on latent states.  Must have
event shape <code>list(num_features)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>observation_noise_scale</code></td>
<td>
<p>Scalar (any additional dimensions are
treated as batch dimensions) <code>float</code> <code>tensor</code> indicating the standard
deviation of the observation noise. Default value: <code>0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial_step</code></td>
<td>
<p>scalar <code>integer</code> <code>tensor</code> specifying the starting timestep.
Default value: <code>0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>validate_args</code></td>
<td>
<p><code>logical</code>. Whether to validate input
with asserts. If <code>validate_args</code> is <code>FALSE</code>, and the inputs are
invalid, correct behavior is not guaranteed. Default value: <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allow_nan_stats</code></td>
<td>
<p><code>logical</code>. If <code>FALSE</code>, raise an
exception if a statistic (e.g. mean/mode/etc...) is undefined for any
batch member. If <code>TRUE</code>, batch members with valid parameters leading to
undefined statistics will return NaN for this statistic. Default value: <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>name prefixed to ops created by this class. Default value: 'DynamicLinearRegressionStateSpaceModel'.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The dynamic linear regression model is a special case of a linear Gaussian SSM
and a generalization of typical (static) linear regression. The model
represents regression <code>weights</code> with a latent state which evolves via a
Gaussian random walk:
<code>weights[t] ~ Normal(weights[t-1], drift_scale)</code>
</p>
<p>The latent state (the weights) has dimension <code>num_features</code>, while the
parameters <code>drift_scale</code> and <code>observation_noise_scale</code> are each (a batch of)
scalars. The batch shape of this <code>Distribution</code> is the broadcast batch shape
of these parameters, the <code>initial_state_prior</code>, and the
<code>design_matrix</code>. <code>num_features</code> is determined from the last dimension of
<code>design_matrix</code> (equivalent to the number of columns in the design matrix in
linear regression).
</p>
<p>Mathematical Details
</p>
<p>The dynamic linear regression model implements a
<code>tfd_linear_gaussian_state_space_model</code> with <code>latent_size = num_features</code> and
<code>observation_size = 1</code> following the transition model:
</p>
<div class="sourceCode"><pre>transition_matrix = eye(num_features)
transition_noise ~ Normal(0, diag([drift_scale]))
</pre></div>
<p>which implements the evolution of <code>weights</code> described above. The observation
model is:
</p>
<div class="sourceCode"><pre>observation_matrix[t] = design_matrix[t]
observation_noise ~ Normal(0, observation_noise_scale)
</pre></div>


<h3>Value</h3>

<p>an instance of <code>LinearGaussianStateSpaceModel</code>.
</p>


<h3>See Also</h3>

<p>Other sts: 
<code>sts_additive_state_space_model()</code>,
<code>sts_autoregressive_state_space_model()</code>,
<code>sts_autoregressive()</code>,
<code>sts_constrained_seasonal_state_space_model()</code>,
<code>sts_dynamic_linear_regression()</code>,
<code>sts_linear_regression()</code>,
<code>sts_local_level_state_space_model()</code>,
<code>sts_local_level()</code>,
<code>sts_local_linear_trend_state_space_model()</code>,
<code>sts_local_linear_trend()</code>,
<code>sts_seasonal_state_space_model()</code>,
<code>sts_seasonal()</code>,
<code>sts_semi_local_linear_trend_state_space_model()</code>,
<code>sts_semi_local_linear_trend()</code>,
<code>sts_smooth_seasonal_state_space_model()</code>,
<code>sts_smooth_seasonal()</code>,
<code>sts_sparse_linear_regression()</code>,
<code>sts_sum()</code>
</p>


</div>