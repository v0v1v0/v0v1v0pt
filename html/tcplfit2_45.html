<div class="container">

<table style="width: 100%;"><tr>
<td>tcplObj</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Concentration Response Objective Function</h2>

<h3>Description</h3>

<p>Log-likelihood to be maximized during CR fitting.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tcplObj(p, conc, resp, fname, errfun = "dt4", err = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Vector of parameters, must be in order: a, tp, b, ga, p, la, q, er.
Does not require names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conc</code></td>
<td>
<p>Vector of concentrations in log10 units for loghill/loggnls, in
regular units otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resp</code></td>
<td>
<p>Vector of corresponding responses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fname</code></td>
<td>
<p>Name of model function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>errfun</code></td>
<td>
<p>Which error distribution to assume for each point, defaults to
"dt4". "dt4" is the original 4 degrees of freedom t-distribution. Another
supported distribution is "dnorm", the normal distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>err</code></td>
<td>
<p>An optional estimation of error for the given fit.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is a generalized version of the log-likelihood estimation
functions used in the ToxCast Pipeline (TCPL).
Hill model uses fname "loghill" and gnls uses fname "loggnls". Other model
functions have the same fname as their model name; i.e. exp2 uses "exp2", etc.
errfun = "dnorm" may be better suited to gsva pathway scores than "dt4".
Setting err could be used to fix error based on the null data noise
distribution instead of fitting the error when maximizing log-likelihood.
</p>


<h3>Value</h3>

<p>Log-likelihood.
</p>


<h3>Examples</h3>

<pre><code class="language-R">conc = c(.03,.1 , .3 , 1  , 3 , 10 , 30  , 100)
resp = c( 0 , 0 , .1 ,.2 , .5 , 1  , 1.5 , 2  )
p = c(tp = 2, ga = 3, p = 4, er = .5)
tcplObj(p,conc,resp,"exp5")

lconc = log10(conc)
tcplObj(p,lconc,resp,"loghill")
</code></pre>


</div>