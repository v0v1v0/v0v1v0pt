<div class="container">

<table style="width: 100%;"><tr>
<td>gridDiag</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Persistence Diagram of a function over a Grid
</h2>

<h3>Description</h3>

<p>The function <code>gridDiag</code> computes the Persistence Diagram of a filtration of sublevel sets (or superlevel sets) of a function evaluated over a grid of points in arbitrary dimension <code>d</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gridDiag(
    X = NULL, FUN = NULL, lim = NULL, by = NULL, FUNvalues = NULL,
    maxdimension = max(NCOL(X), length(dim(FUNvalues))) - 1,
    sublevel = TRUE, library = "GUDHI", location = FALSE,
    printProgress = FALSE, diagLimit = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>an <code class="reqn">n</code> by <code class="reqn">d</code> matrix of coordinates, used by the function <code>FUN</code>, where <code class="reqn">n</code> is the number of points stored in <code>X</code> and <code class="reqn">d</code> is the dimension of the space. NULL if this option is not used. The default value is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FUN</code></td>
<td>

<p>a function whose inputs are 1) an <code class="reqn">n</code> by <code class="reqn">d</code> matrix of coordinates <code>X</code>, 2) an <code class="reqn">m</code> by <code class="reqn">d</code> matrix of coordinates <code>Grid</code>, 3) an optional smoothing parameter, and returns a numeric vector of length <code class="reqn">m</code>. For example see <code>distFct</code>,  <code>kde</code>, and <code>dtm</code>  which compute the distance function, the kernel density estimator and the distance to measure, over a grid of points using the input <code>X</code>. Note that <code>Grid</code> is not an input of <code>gridDiag</code>, but is automatically computed by the function using <code>lim</code>, and <code>by</code>. NULL if this option is not used. The default value is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lim</code></td>
<td>

<p>a <code class="reqn">2</code> by <code class="reqn">d</code> matrix, where each column specifying the range of each dimension of the grid, over which the function <code>FUN</code> is evaluated. NULL if this option is not used. The default value is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by</code></td>
<td>

<p>either a number or a vector of length <code class="reqn">d</code> specifying space between points of the grid in each dimension. If a number is given, then same space is used in each dimension. NULL if this option is not used. The default value is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FUNvalues</code></td>
<td>

<p>an <code class="reqn">m1 * m2 * ... * md</code> array of function values over <code class="reqn">m1 * m2 * ... * md</code> grid, where <code class="reqn">mi</code> is the number of scales of grid on <code class="reqn">ith</code> dimension. NULL if this option is not used. The default value is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxdimension</code></td>
<td>

<p>a number that indicates the maximum dimension of the homological features to compute: <code>0</code> for connected components, <code>1</code> for loops, <code>2</code> for voids and so on. The default value is <code class="reqn">d - 1</code>, which is (dimension of embedding space - 1).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sublevel</code></td>
<td>

<p>a logical variable indicating if the Persistence Diagram should be computed for sublevel sets (<code>TRUE</code>) or superlevel sets (<code>FALSE</code>) of the function. The default value is <code>TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>library</code></td>
<td>

<p>a string specifying which library to compute the persistence diagram. The user can choose either the library <code>"GUDHI"</code>, <code>"Dionysus"</code>, or <code>"PHAT"</code>. The default value is <code>"GUDHI"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>location</code></td>
<td>

<p>if <code>TRUE</code> and if <code>"Dionysus"</code> or <code>"PHAT"</code> is used for computing the persistence diagram, location of birth point and death point of each homological feature is returned. Additionaly if <code>library="Dionysus"</code>, location of representative cycles of each homological feature is also returned. The default value is <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>printProgress</code></td>
<td>

<p>if <code>TRUE</code> a progress bar is printed. The default value is <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diagLimit</code></td>
<td>

<p>a number that replaces <code>Inf</code> (if <code>sublevel</code> is <code>TRUE</code>) or <code>-Inf</code> (if <code>sublevel</code> is <code>FALSE</code>) in the Death value of the most persistent connected component. The default value is <code>NULL</code> and the max/min of the function is used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>additional parameters for the function <code>FUN</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If the values of <code>X</code>, <code>FUN</code> are set, then <code>FUNvalues</code> should be <code>NULL</code>. In this case, <code>gridDiag</code> evaluates the function <code>FUN</code> over a grid. If the value of <code>FUNvalues</code> is set, then <code>X</code>, <code>FUN</code> should be <code>NULL</code>. In this case, <code>FUNvalues</code> is used as function values over the grid. If <code>location=TRUE</code>, then <code>lim</code>, and <code>by</code> should be set.
</p>
<p>Once function values are either computed or given, <code>gridDiag</code> constructs a filtration by triangulating the grid and considering the simplices determined by the values of the function of dimension up to <code>maxdimension+1</code>.
</p>


<h3>Value</h3>

<p>The function <code>gridDiag</code> returns a list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>diagram</code></td>
<td>

<p>an object of class <code>diagram</code>, a <code class="reqn">P</code> by 3 matrix, where <code class="reqn">P</code> is the number of points in the resulting persistence diagram. The first column stores the dimension of each feature (0 for components, 1 for loops, 2 for voids, etc). Second and third columns are Birth and Death of the features, in case of a filtration constructed using sublevel sets (from -Inf to Inf), or Death and Birth of features, in case of a filtration constructed using superlevel sets (from Inf to -Inf).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>birthLocation</code></td>
<td>

<p>only if <code>location=TRUE</code> and if <code>"Dionysus"</code> or <code>"PHAT"</code> is used for computing the persistence diagram: a <code class="reqn">P</code> by <code class="reqn">d</code> matrix, where <code class="reqn">P</code> is the number of points in the resulting persistence diagram. Each row represents the location of the grid point completing the simplex that gives birth to an homological feature.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deathLocation</code></td>
<td>

<p>only if <code>location=TRUE</code> and if <code>"Dionysus"</code> or <code>"PHAT"</code> is used for computing the persistence diagram: a <code class="reqn">P</code> by <code class="reqn">d</code> matrix, where <code class="reqn">P</code> is the number of points in the resulting persistence diagram. Each row represents the location of the grid point completing the simplex that kills an homological feature.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cycleLocation</code></td>
<td>

<p>only if <code>location=TRUE</code> and if <code>"Dionysus"</code> is used for computing the persistence diagram: a list of length <code class="reqn">P</code>, where <code class="reqn">P</code> is the number of points in the resulting persistence diagram. Each element is a <code class="reqn">P_i</code> by <code class="reqn">h_i +1</code> by <code class="reqn">d</code> array for <code class="reqn">h_i</code> dimensional homological feature. It represents location of <code class="reqn">h_i +1</code> vertices of <code class="reqn">P_i</code> simplices, where <code class="reqn">P_i</code> simplices constitutes the <code class="reqn">h_i</code> dimensional homological feature.
</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The user can decide to use either the C++ library <a href="https://project.inria.fr/gudhi/software/">GUDHI</a>, <a href="https://www.mrzv.org/software/dionysus/">Dionysus</a>, or <a href="https://bitbucket.org/phat-code/phat/">PHAT</a>. See references.
</p>
<p>Since dimension of simplicial complex from grid points in <code class="reqn">R^d</code> is up to <code class="reqn">d</code>, homology of dimension <code class="reqn">\ge d</code> is trivial. Hence setting <code>maxdimension</code> with values <code class="reqn">\ge d</code> is equivalent to <code>maxdimension=d-1</code>.
</p>


<h3>Author(s)</h3>

<p>Brittany T. Fasy, Jisu Kim, and Fabrizio Lecci
</p>


<h3>References</h3>

<p>Fasy B, Lecci F, Rinaldo A, Wasserman L, Balakrishnan S, Singh A (2013). "Statistical Inference For Persistent Homology." (arXiv:1303.7117). Annals of Statistics.
</p>
<p>Morozov D (2007). "Dionysus, a C++ library for computing persistent homology." <a href="https://www.mrzv.org/software/dionysus/">https://www.mrzv.org/software/dionysus/</a>
</p>
<p>Bauer U, Kerber M, Reininghaus J (2012). "PHAT, a software library for persistent homology." <a href="https://bitbucket.org/phat-code/phat/">https://bitbucket.org/phat-code/phat/</a>
</p>


<h3>See Also</h3>

<p><code>summary.diagram</code>, <code>plot.diagram</code>,
<code>distFct</code>, <code>kde</code>, <code>kernelDist</code>, <code>dtm</code>,
<code>alphaComplexDiag</code>, <code>alphaComplexDiag</code>, <code>ripsDiag</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Distance Function Diagram and Kernel Density Diagram

# input data
n &lt;- 300
XX &lt;- circleUnif(n)

## Ranges of the grid
Xlim &lt;- c(-1.8, 1.8)
Ylim &lt;- c(-1.6, 1.6)
lim &lt;- cbind(Xlim, Ylim)
by &lt;- 0.05

h &lt;- .3  #bandwidth for the function kde

#Distance Function Diagram of the sublevel sets
Diag1 &lt;- gridDiag(XX, distFct, lim = lim, by = by, sublevel = TRUE,
                  printProgress = TRUE) 

#Kernel Density Diagram of the superlevel sets
Diag2 &lt;- gridDiag(XX, kde, lim = lim, by = by, sublevel = FALSE,
    library = "Dionysus", location = TRUE, printProgress = TRUE, h = h)
#plot
par(mfrow = c(2, 2))
plot(XX, cex = 0.5, pch = 19)
title(main = "Data")
plot(Diag1[["diagram"]])
title(main = "Distance Function Diagram")
plot(Diag2[["diagram"]])
title(main = "Density Persistence Diagram")
one &lt;- which(Diag2[["diagram"]][, 1] == 1)
plot(XX, col = 2, main = "Representative loop of grid points")
for (i in seq(along = one)) {
  points(Diag2[["birthLocation"]][one[i], , drop = FALSE], pch = 15, cex = 3,
      col = i)
  points(Diag2[["deathLocation"]][one[i], , drop = FALSE], pch = 17, cex = 3,
      col = i)
  for (j in seq_len(dim(Diag2[["cycleLocation"]][[one[i]]])[1])) {
    lines(Diag2[["cycleLocation"]][[one[i]]][j, , ], pch = 19, cex = 1, col = i)
  }
}
</code></pre>


</div>