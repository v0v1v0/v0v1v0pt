<div class="container">

<table style="width: 100%;"><tr>
<td>fit_mmrm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
<code>MMRM</code> Analysis</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt="[Stable]"></a>
</p>
<p>Does the <code>MMRM</code> analysis. Multiple other functions can be called on the result to produce
tables and graphs.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit_mmrm(
  vars = list(response = "AVAL", covariates = c(), id = "USUBJID", arm = "ARM", visit =
    "AVISIT"),
  data,
  conf_level = 0.95,
  cor_struct = "unstructured",
  weights_emmeans = "proportional",
  averages_emmeans = list(),
  parallel = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>vars</code></td>
<td>
<p>(named <code>list</code> of <code>string</code> or <code>character</code>)<br> specifying the variables in the <code>MMRM</code>.
The following elements need to be included as character vectors and match corresponding columns
in <code>data</code>:
</p>

<ul>
<li> <p><code>response</code>: the response variable.
</p>
</li>
<li> <p><code>covariates</code>: the additional covariate terms (might also include interactions).
</p>
</li>
<li> <p><code>id</code>: the subject ID variable.
</p>
</li>
<li> <p><code>arm</code>: the treatment group variable (factor).
</p>
</li>
<li> <p><code>visit</code>: the visit variable (factor).
</p>
</li>
<li> <p><code>weights</code>: optional weights variable (if <code>NULL</code> or omitted then no weights will be used).
</p>
</li>
</ul>
<p>Note that the main effects and interaction of <code>arm</code> and <code>visit</code> are by default
included in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>(<code>data.frame</code>)<br> with all the variables specified in
<code>vars</code>. Records with missing values in any independent variables
will be excluded.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf_level</code></td>
<td>
<p>(<code>proportion</code>)<br> confidence level of the interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cor_struct</code></td>
<td>
<p>(<code>string</code>)<br> specifying the covariance structure, defaults to
<code>"unstructured"</code>. See the details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights_emmeans</code></td>
<td>
<p>(<code>string</code>)<br> argument from <code>emmeans::emmeans()</code>, <code>"proportional"</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>averages_emmeans</code></td>
<td>
<p>(<code>list</code>)<br> optional named list of visit levels which should be averaged
and reported along side the single visits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>(<code>flag</code>)<br> controls whether the optimizer search can use available free cores on the
machine (not default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments for <code>mmrm::mmrm()</code>, in particular <code>reml</code> and options listed in
<code>mmrm::mmrm_control()</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Multiple different degree of freedom adjustments are available via the <code>method</code> argument
for <code>mmrm::mmrm()</code>. In addition, covariance matrix adjustments are available via <code>vcov</code>.
Please see <code>mmrm::mmrm_control()</code> for details and additional useful options.
</p>
<p>For the covariance structure (<code>cor_struct</code>), the user can choose among the following options.
</p>

<ul>
<li> <p><code>unstructured</code>: Unstructured covariance matrix. This is the most flexible choice and default.
If there are <code>T</code> visits, then <code>T * (T+1) / 2</code> variance parameters are used.
</p>
</li>
<li> <p><code>toeplitz</code>: Homogeneous Toeplitz covariance matrix, which uses <code>T</code> variance parameters.
</p>
</li>
<li> <p><code style="white-space: pre;">⁠heterogeneous toeplitz⁠</code>: Heterogeneous Toeplitz covariance matrix,
which uses <code>2 * T - 1</code> variance parameters.
</p>
</li>
<li> <p><code>ante-dependence</code>: Homogeneous Ante-Dependence covariance matrix, which uses <code>T</code> variance parameters.
</p>
</li>
<li> <p><code style="white-space: pre;">⁠heterogeneous ante-dependence⁠</code>: Heterogeneous Ante-Dependence covariance matrix,
which uses <code>2 * T - 1</code> variance parameters.
</p>
</li>
<li> <p><code>auto-regressive</code>: Homogeneous Auto-Regressive (order 1) covariance matrix,
which uses 2 variance parameters.
</p>
</li>
<li> <p><code style="white-space: pre;">⁠heterogeneous auto-regressive⁠</code>: Heterogeneous Auto-Regressive (order 1) covariance matrix,
which uses <code>T + 1</code> variance parameters.
</p>
</li>
<li> <p><code style="white-space: pre;">⁠compound symmetry⁠</code>: Homogeneous Compound Symmetry covariance matrix, which uses 2
variance parameters.
</p>
</li>
<li> <p><code style="white-space: pre;">⁠heterogeneous compound symmetry⁠</code>: Heterogeneous Compound Symmetry covariance matrix, which uses
<code>T + 1</code> variance parameters.
</p>
</li>
</ul>
<h3>Value</h3>

<p>A <code>tern_mmrm</code> object which is a list with MMRM results:
</p>

<ul>
<li> <p><code>fit</code>: The <code>mmrm</code> object which was fitted to the data. Note that via <code>mmrm::component(fit, "optimizer")</code>
the finally used optimization algorithm can be obtained, which can be useful for refitting the model
later on.
</p>
</li>
<li> <p><code>cov_estimate</code>: The matrix with the covariance matrix estimate.
</p>
</li>
<li> <p><code>diagnostics</code>: A list with model diagnostic statistics (REML criterion, AIC, corrected AIC, BIC).
</p>
</li>
<li> <p><code>lsmeans</code>: This is a list with data frames <code>estimates</code> and <code>contrasts</code>.
The attributes <code>averages</code> and <code>weights</code> save the settings used
(<code>averages_emmeans</code> and <code>weights_emmeans</code>).
</p>
</li>
<li> <p><code>vars</code>: The variable list.
</p>
</li>
<li> <p><code>labels</code>: Corresponding list with variable labels extracted from <code>data</code>.
</p>
</li>
<li> <p><code>cor_struct</code>: input.
</p>
</li>
<li> <p><code>parallel</code>: input.
</p>
</li>
<li> <p><code>ref_level</code>: The reference level for the arm variable, which is always the first level.
</p>
</li>
<li> <p><code>treatment_levels</code>: The treatment levels for the arm variable.
</p>
</li>
<li> <p><code>conf_level</code>: The confidence level which was used to construct the <code>lsmeans</code> confidence intervals.
</p>
</li>
<li> <p><code>additional</code>: List with any additional inputs passed via <code>...</code>
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">library(dplyr)
library(rtables)

mmrm_results &lt;- fit_mmrm(
  vars = list(
    response = "FEV1",
    covariates = c("RACE", "SEX"),
    id = "USUBJID",
    arm = "ARMCD",
    visit = "AVISIT"
  ),
  data = mmrm_test_data,
  cor_struct = "unstructured",
  weights_emmeans = "equal",
  averages_emmeans = list(
    "VIS1+2" = c("VIS1", "VIS2")
  )
)

</code></pre>


</div>