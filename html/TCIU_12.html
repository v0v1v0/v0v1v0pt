<div class="container">

<table style="width: 100%;"><tr>
<td>fmri_stimulus_detect</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>fMRI data stimulus detection</h2>

<h3>Description</h3>

<p>This function takes a real/complex valued fMRI data and detects locations where stimulus occurs
</p>


<h3>Usage</h3>

<pre><code class="language-R">fmri_stimulus_detect(
  fmridata,
  mask = NULL,
  stimulus_idx = NULL,
  rest_idex = NULL,
  method,
  fdr_corr = NULL,
  spatial_cluster.thr = NULL,
  spatial_cluster.size = NULL,
  ons = NULL,
  dur = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fmridata</code></td>
<td>
<p>an array or a vector which contains the spatial and/or temporal record of fMRI result</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mask</code></td>
<td>
<p>a 3d array indicating the spatial location of the brain</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stimulus_idx</code></td>
<td>
<p>a vector that specifies when motion happens</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rest_idex</code></td>
<td>
<p>a vector that specifies when study participant does not move</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a string that indicates which testing method is to be used. There are 5 options: 'HotellingT2', 'Wilks-Lambda' and 'gLRT'(likelihood ratio test) for complex fMRI data and 't-test', 'wilcoxon-test' for real fMRI data. For 4D real-valued fMRI data, two more options: 'on_off_diff' and 'HRF' method can be applied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fdr_corr</code></td>
<td>
<p>a logical variable. True if FDR correction is to be applied</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spatial_cluster.thr</code></td>
<td>
<p>threshold p-value to be used for spatial clustering</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spatial_cluster.size</code></td>
<td>
<p>number of spatially connected voxels to be tested for spatial clustering</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ons</code></td>
<td>
<p>a vector with the first time points of the time periods when the fMRI data receives stimulation. The default is NULL. Need to specify when choose the method 'gLRT' or 'HRF'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dur</code></td>
<td>
<p>a vector of the time length of each stimulated period. The default is NULL. Need to specify when choose the method 'gLRT' or 'HRF'.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>fmri_stimulus_detect</code> is used to conduct motor area detection. It first takes in a real or complex valued fMRI data, and then users can choose to use various methods to find the spatial regions where motor area is located inside the brain. User can either input the 4d fMRI data and get a 3d array storing p-values or input the fMRI data with smaller dimension (e.g. fix the x,y axis) and get a vector storing p-values. Besides, one can use this function to just calculate raw p-values, and we also provide options so that users can do FDR correction and spatial clustering to get a more accurate result.
</p>


<h3>Value</h3>

<p>If input fMRI data is 4d, return a 3d array storing p-values for the 4d fMRI data. If input fMRI data is less than 4d, return a vector storing p-values for the fMRI data.
</p>


<h3>Author(s)</h3>

<p>SOCR team &lt;<a href="http://socr.umich.edu/people/">http://socr.umich.edu/people/</a>&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R">fmri_generate = fmri_simulate_func(dim_data = c(64, 64, 40), mask = mask)
fmridata = fmri_generate$fmri_data
stimulus_idx = fmri_generate$on_time
ons = fmri_generate$ons
dur = fmri_generate$dur


# p-values using t-test for 4d fMRI data
p_value1 = fmri_stimulus_detect(fmridata = fmridata, mask = mask,
                                stimulus_idx = stimulus_idx,
                                method = 't-test')
dim(fmridata)
dim(p_value1)

# p-values using t-test for 2d fMRI data
p_value2 = fmri_stimulus_detect(fmridata = fmridata[40,41,,], mask = mask,
                                stimulus_idx = stimulus_idx,
                                method = 't-test')
dim(fmridata[40,41,,])
dim(p_value2)


</code></pre>


</div>