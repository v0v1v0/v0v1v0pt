<div class="container">

<table style="width: 100%;"><tr>
<td>trans_m</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Regression Analysis of Right-censored Data using Semiparametric
Transformation Models.</h2>

<h3>Description</h3>

<p>This function is used to conduct the regression analysis of
right-censored data using semiparametric transformation models. It
calculates the estimators, standard errors and p values. A plot of estimated
baseline cumulative hazard function and confidence intervals can be
produced.
</p>


<h3>Usage</h3>

<pre><code class="language-R">trans_m(
  X,
  delta,
  Y,
  plot.Lamb = TRUE,
  alpha = seq(0.1, 1.1, by = 0.1),
  trsmodel = TRUE,
  EM_itmax = 250,
  show_res = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>design matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>censoring indicator. If <code class="reqn">Y_i</code> is censored, <code>delta</code>=0. If
not, <code>delta</code>=1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>observed event times</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.Lamb</code></td>
<td>
<p>If TRUE, plot the estimated baseline cumulative hazard
function and confidence intervals. The default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>parameter in transformation function. Generally, <code class="reqn">\alpha</code> can
not be observed in medical applications. In that situation, <code>alpha</code>
indicates the scale of choosing <code class="reqn">\alpha</code>. The default is
<code class="reqn">(0.1,0.2,...,1.1)</code>. If <code class="reqn">\alpha</code> is known, <code>alpha</code> indicates
the true value of <code class="reqn">\alpha</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trsmodel</code></td>
<td>
<p>logical value indicating whether to implement transformation
models. The default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EM_itmax</code></td>
<td>
<p>maximum iteration of EM algorithm. Defaults to 250.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_res</code></td>
<td>
<p>show results after <code>trans_m</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code class="reqn">\alpha</code> is unknown, we firse set <code class="reqn">\alpha=</code><code>alpha</code>.
Then, for each <code class="reqn">\alpha</code>, we estimate the parameters and record the value
of observed log-likelihood function. The <code class="reqn">\alpha</code> that maximizes the
observed log-likelihood function and the corresponding <code class="reqn">\hat\beta</code> and
<code class="reqn">\hat\Lambda(\cdot)</code> are chosen as the best estimators. Nonparametric
maximum likelihood estimators are developed for the regression parameters
and cumulative intensity functions of these models based on censored data.
</p>


<h3>Value</h3>

<p>a list containing </p>

<table>
<tr>
<td style="text-align: left;"> <code>beta.est </code> </td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: left;">
 estimators of <code class="reqn">\beta</code> </td>
</tr>
<tr>
<td style="text-align: left;"> <code>SE.beta </code> </td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: left;"> standard errors
 of the estimated <code class="reqn">\beta</code> </td>
</tr>
<tr>
<td style="text-align: left;"> <code>SE.Ydot</code> </td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: left;"> standard errors
 of the estimated <code class="reqn">\Lambda(Y')</code> </td>
</tr>
<tr>
<td style="text-align: left;"> <code>Ydot</code> </td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: left;"> vector of
 sorted event times with duplicate values removed   </td>
</tr>
<tr>
<td style="text-align: left;"> <code>Lamb.est</code>
 </td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: left;"> estimated baseline cumulative hazard  </td>
</tr>
<tr>
<td style="text-align: left;"> <code>lamb.est</code>
 </td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: left;"> estimated jump sizes of baseline cumulative hazard function </td>
</tr>
<tr>
<td style="text-align: left;">
 <code>choose.alpha </code> </td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: left;"> the chosen <code class="reqn">\alpha</code> </td>
</tr>
<tr>
<td style="text-align: left;">
 <code>Lamb.upper</code> </td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: left;"> upper confidence limits for the estimated
 baseline cumulative hazard function </td>
</tr>
<tr>
<td style="text-align: left;"> <code>Lamb.lower</code> </td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: left;"> lower
 confidence limits for the estimated baseline cumulative hazard function </td>
</tr>
<tr>
<td style="text-align: left;">
 <code>p.beta</code> </td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: left;"> P values of estimated <code class="reqn">\beta</code> </td>
</tr>
<tr>
<td style="text-align: left;">
 <code>p.Lamb</code> </td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: left;"> P values of estimated baseline cumulative hazard
 </td>
</tr>
<tr>
<td style="text-align: left;"> p.beta </td>
</tr>
</table>
<h3>References</h3>

<p>Cheng, S.C., Wei, L.J., and Ying, Z. (1995). Analysis of
transformation models with censored data. Biometrika 82, 835-845.
</p>
<p>Zeng, D. and Lin, D.Y. (2007). Maximum likelihood estimation in
semiparametric regression models with censored data. J. R. Statist. Soc. B
69, 507-564.
</p>
<p>Abramowitz, M., and Stegun, I.A. (1972). Handbook of Mathematical Functions
(9th ed.). Dover Publications, New York.
</p>
<p>Evans, M. and Swartz, T. (2000). Approximating Integrals via Monte Carlo and
Deterministic Methods. Oxford University Press.
</p>
<p>Liu, Q. and Pierce, D.A. (1994). A note on Gauss-Hermite quadrature.
Biometrika 81, 624-629.
</p>
<p>Louis, T. (1982). Finding the Observed Information Matrix when Using the EM
Algorithm. Journal of the Royal Statistical Society. Series B
(Methodological), 44(2), 226-233.
</p>


<h3>See Also</h3>

<p><code>EM_est</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"> gen_data = generate_data(200, 1, 0.5, c(-0.5,1))
 delta = gen_data$delta
 Y = gen_data$Y
 X = gen_data$X
 res.trans = trans_m(X, delta,  Y, plot.Lamb = TRUE, show_res = FALSE)


</code></pre>


</div>