<div class="container">

<table style="width: 100%;"><tr>
<td>ReadCharacters</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Read phylogenetic characters from file</h2>

<h3>Description</h3>

<p>Parse a Nexus (Maddison et al. 1997) or
TNT (Goloboff et al. 2008) file, reading character states and
names.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ReadCharacters(filepath, character_num = NULL, encoding = "UTF8")

ReadTntCharacters(
  filepath,
  character_num = NULL,
  type = NULL,
  encoding = "UTF8"
)

ReadNotes(filepath, encoding = "UTF8")

ReadAsPhyDat(...)

ReadTntAsPhyDat(...)

PhyDat(dataset)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>filepath</code></td>
<td>
<p>character string specifying location of file, or a
connection to the file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>character_num</code></td>
<td>
<p>Index of character(s) to return.
<code>NULL</code>, the default, returns all characters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>encoding</code></td>
<td>
<p>Character encoding of input file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Character vector specifying categories of data to extract from
file. Setting <code>type = c("num", "dna")</code> will return only characters
following a <code style="white-space: pre;">⁠&amp;[num]⁠</code> or <code style="white-space: pre;">⁠&amp;[dna]⁠</code> tag in a TNT input file, listing <code>num</code>
character blocks before <code>dna</code> characters.
Leave as <code>NULL</code> (the default) to return all characters in their original
sequence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Parameters to pass to <code style="white-space: pre;">⁠Read[Tnt]Characters()⁠</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataset</code></td>
<td>
<p>list of taxa and characters, in the format produced by
<code>read.nexus.data()</code>:
a list of sequences each made of a single character vector,
and named with the taxon name.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Tested with matrices downloaded from <a href="https://morphobank.org">MorphoBank</a>
(O’Leary and Kaufman 2011), but should also work more widely; please
<a href="https://github.com/ms609/TreeTools/issues/new?title=Error+parsing+Nexus+file&amp;body=%3C!--Tell+me+more+and+attach+your+file...--%3E">report</a>
incompletely or incorrectly parsed files.
</p>
<p>Matrices must contain only continuous or only discrete characters;
maximum one matrix per file.  Continuous characters will be read as strings
(i.e. base type "character").
</p>
<p>The encoding of an input file will be automatically determined by R.
Errors pertaining to an <code style="white-space: pre;">⁠invalid multibyte string⁠</code> or
<code style="white-space: pre;">⁠string invalid at that locale⁠</code> indicate that R has failed to detect
the appropriate encoding.  Either
<a href="https://support.posit.co/hc/en-us/articles/200532197-Character-Encoding-in-the-RStudio-IDE">re-save the file</a>
in a supported encoding (<code>UTF-8</code> is a good choice) or
specify the file encoding (which you can find by, for example, opening in
<a href="https://notepad-plus-plus.org/downloads/">Notepad++</a> and identifying
the highlighted option in the "Encoding" menu) following the example below.
</p>


<h3>Value</h3>

<p><code>ReadCharacters()</code> and <code>ReadTNTCharacters()</code> return a matrix whose
row names correspond to tip labels, and
column names correspond to character labels, with the
attribute <code>state.labels</code> listing the state labels for each character; or
a list of length one containing a character string explaining why the
function call was unsuccessful.
</p>
<p><code>ReadAsPhyDat()</code> and <code>ReadTntAsPhyDat()</code> return a <code>phyDat</code> object.
</p>
<p><code>ReadNotes()</code> returns a list in which each entry corresponds to a
single character, and itself contains a list of with two elements:
</p>

<ol>
<li>
<p> A single character object listing any notes associated with the character
</p>
</li>
<li>
<p> A named character vector listing the notes associated with each taxon
for that character, named with the names of each note-bearing taxon.
</p>
</li>
</ol>
<h3>Functions</h3>


<ul><li> <p><code>PhyDat()</code>: A convenient wrapper for <span class="pkg">phangorn</span>'s
<code>phyDat()</code>, which converts a <strong>list</strong> of morphological characters into a
<code>phyDat</code> object.
If your morphological characters are in the form of a <strong>matrix</strong>, perhaps
because they have been read using <code>read.table()</code>, try <code>MatrixToPhyDat()</code>
instead.
</p>
</li></ul>
<h3>Author(s)</h3>

<p><a href="https://orcid.org/0000-0001-5660-1727">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>


<h3>References</h3>

<p>Goloboff PA, Farris JS, Nixon KC (2008).
“TNT, a free program for phylogenetic analysis.”
<em>Cladistics</em>, <b>24</b>(5), 774–786.<br><br> Maddison DR, Swofford DL, Maddison WP (1997).
“Nexus: an extensible file format for systematic information.”
<em>Systematic Biology</em>, <b>46</b>, 590–621.
<a href="https://doi.org/10.1093/sysbio/46.4.590">doi:10.1093/sysbio/46.4.590</a>.<br><br> O’Leary MA, Kaufman S (2011).
“MorphoBank: phylophenomics in the "cloud".”
<em>Cladistics</em>, <b>27</b>(5), 529–537.
</p>


<h3>See Also</h3>


<ul>
<li>
<p> Convert between matrices and <code>phyDat</code> objects: <code>MatrixToPhyDat()</code>
</p>
</li>
<li>
<p> Write characters to TNT-format file: <code>WriteTntCharacters()</code>
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">fileName &lt;- paste0(system.file(package = "TreeTools"),
                   "/extdata/input/dataset.nex")
ReadCharacters(fileName)

fileName &lt;- paste0(system.file(package = "TreeTools"),
                   "/extdata/tests/continuous.nex")

continuous &lt;- ReadCharacters(fileName, encoding = "UTF8")

# To convert from strings to numbers:
at &lt;- attributes(continuous)
continuous &lt;- suppressWarnings(as.numeric(continuous))
attributes(continuous) &lt;- at
continuous
</code></pre>


</div>