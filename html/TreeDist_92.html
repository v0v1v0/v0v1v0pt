<div class="container">

<table style="width: 100%;"><tr>
<td>SPRDist</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Approximate the Subtree Prune and Regraft (SPR) distance.</h2>

<h3>Description</h3>

<p><code>SPRDist()</code> calculates an upper bound on the SPR distance between trees
using the heuristic method of de Oliveira Martins et al. (2008).
Other approximations are available
(e.g. Hickey et al. 2008, Goloboff 2008, Whidden and Matsen 2018).
</p>


<h3>Usage</h3>

<pre><code class="language-R">SPRDist(tree1, tree2 = NULL, method = "deOliveira", symmetric)

## S3 method for class 'phylo'
SPRDist(tree1, tree2 = NULL, method = "deOliveira", symmetric)

## S3 method for class 'list'
SPRDist(tree1, tree2 = NULL, method = "deOliveira", symmetric)

## S3 method for class 'multiPhylo'
SPRDist(tree1, tree2 = NULL, method = "deOliveira", symmetric)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree1, tree2</code></td>
<td>
<p>Trees of class <code>phylo</code>, with leaves labelled identically,
or lists of such trees to undergo pairwise comparison.  Where implemented,
<code>tree2 = NULL</code> will compute distances between each pair of trees in the list
<code>tree1</code> using a fast algorithm based on
Day (1985).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Character specifying which method to use to approximate the
SPR distance.  Currently defaults to <code>"deOliveira"</code>, the only available
option; a new method will eventually become the default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>symmetric</code></td>
<td>
<p>Ignored (redundant after fix of
<a href="https://github.com/KlausVigo/phangorn/issues/97">phangorn#97</a>).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>SPRDist()</code> returns a vector or distance matrix of distances
between trees.
</p>


<h3>Author(s)</h3>

<p><a href="https://orcid.org/0000-0001-5660-1727">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>


<h3>References</h3>

<p>Day WHE (1985).
“Optimal algorithms for comparing trees with labeled leaves.”
<em>Journal of Classification</em>, <b>2</b>(1), 7–28.
<a href="https://doi.org/10.1007/BF01908061">doi:10.1007/BF01908061</a>.<br><br> Goloboff PA (2008).
“Calculating SPR distances between trees.”
<em>Cladistics</em>, <b>24</b>(4), 591-597.
<a href="https://doi.org/10.1111/j.1096-0031.2007.00189.x">doi:10.1111/j.1096-0031.2007.00189.x</a>.<br><br> Hickey G, Dehne F, Rau-Chaplin A, Blouin C (2008).
“SPR distance computation for <em>unrooted</em> trees.”
<em>Evolutionary Bioinformatics</em>, <b>4</b>, EBO–S419.
<a href="https://doi.org/10.4137/EBO.S419">doi:10.4137/EBO.S419</a>.<br><br> Whidden C, Matsen FA (2018).
“Efficiently Inferring Pairwise Subtree Prune-and-Regraft Adjacencies between Phylogenetic Trees.”
<em>2018 Proceedings of the Meeting on Analytic Algorithmics and Combinatorics (ANALCO)</em>, 77–91.
<a href="https://doi.org/10.1137/1.9781611975062.8">doi:10.1137/1.9781611975062.8</a>.<br><br> de Oliveira Martins L, Leal E, Kishino H (2008).
“Phylogenetic detection of recombination with a Bayesian prior on the distance between trees.”
<em>PLoS One</em>, <b>3</b>(7), e2651.
<a href="https://doi.org/10.1371/journal.pone.0002651">doi:10.1371/journal.pone.0002651</a>.
</p>


<h3>See Also</h3>

<p>Exact calculation with <a href="https://ms609.github.io/TBRDist/reference/TreeRearrangementDistances.html"><span class="pkg">TBRDist</span></a>
functions <code>USPRDist()</code> and <code>ReplugDist()</code>.
</p>
<p><span class="pkg">phangorn</span> function <code>SPR.dist()</code> employs
the de Oliveira Martins et al. (2008) algorithm but can crash
when sent trees of certain formats, and tends to have a longer running time.
</p>
<p>Other tree distances: 
<code>JaccardRobinsonFoulds()</code>,
<code>KendallColijn()</code>,
<code>MASTSize()</code>,
<code>MatchingSplitDistance()</code>,
<code>NNIDist()</code>,
<code>NyeSimilarity()</code>,
<code>PathDist()</code>,
<code>Robinson-Foulds</code>,
<code>TreeDistance()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library("TreeTools", quietly = TRUE)

# Compare single pair of trees
SPRDist(BalancedTree(7), PectinateTree(7))

# Compare all pairs of trees        
SPRDist(as.phylo(30:33, 8))

# Compare each tree in one list with each tree in another
SPRDist(BalancedTree(7), as.phylo(0:2, 7))
SPRDist(as.phylo(0:2, 7), PectinateTree(7))

SPRDist(list(bal = BalancedTree(7), pec = PectinateTree(7)),
        as.phylo(0:2, 7))
</code></pre>


</div>