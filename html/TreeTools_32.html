<div class="container">

<table style="width: 100%;"><tr>
<td>ArtificialExtinction</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Artificial Extinction</h2>

<h3>Description</h3>

<p>Remove tokens that do not occur in a fossil "template" taxon from a living
taxon, to simulate the process of fossilization in removing data from
a phylogenetic dataset.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ArtificialExtinction(
  dataset,
  subject,
  template,
  replaceAmbiguous = "ambig",
  replaceCoded = "original",
  replaceAll = TRUE,
  sampleFrom = NULL
)

## S3 method for class 'matrix'
ArtificialExtinction(
  dataset,
  subject,
  template,
  replaceAmbiguous = "ambig",
  replaceCoded = "original",
  replaceAll = TRUE,
  sampleFrom = NULL
)

## S3 method for class 'phyDat'
ArtificialExtinction(
  dataset,
  subject,
  template,
  replaceAmbiguous = "ambig",
  replaceCoded = "original",
  replaceAll = TRUE,
  sampleFrom = NULL
)

ArtEx(
  dataset,
  subject,
  template,
  replaceAmbiguous = "ambig",
  replaceCoded = "original",
  replaceAll = TRUE,
  sampleFrom = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dataset</code></td>
<td>
<p>Phylogenetic dataset of class <code>phyDat</code> or <code>matrix</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subject</code></td>
<td>
<p>Vector identifying subject taxa, by name or index.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>template</code></td>
<td>
<p>Character or integer identifying taxon to use as a template.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>replaceAmbiguous, replaceCoded</code></td>
<td>
<p>Character specifying whether tokens
that are ambiguous (<code style="white-space: pre;">⁠?⁠</code>) or coded (not <code style="white-space: pre;">⁠?⁠</code>) in the fossil template should
be replaced with:
</p>

<ul>
<li> <p><code>original</code>: Their original value; i.e. no change;
</p>
</li>
<li> <p><code>ambiguous</code>: The ambiguous token, <code style="white-space: pre;">⁠?⁠</code>;
</p>
</li>
<li> <p><code>binary</code>: The tokens <code>0</code> or <code>1</code>, with equal probability;
</p>
</li>
<li> <p><code>uniform</code>: One of the tokens present in <code>sampleFrom</code>, with equal
probability;
</p>
</li>
<li> <p><code>sample</code>: One of the tokens present in <code>sampleFrom</code>, sampled according
to their frequency.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>replaceAll</code></td>
<td>
<p>Logical: if <code>TRUE</code>, replace all tokens in a subject; if
<code>FALSE</code>, leave any ambiguous tokens (<code style="white-space: pre;">⁠?⁠</code>) ambiguous.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampleFrom</code></td>
<td>
<p>Vector identifying a subset of characters from which to
sample replacement tokens.
If <code>NULL</code>, replacement tokens will be sampled from the initial states of
all taxa not used as a template (including the subjects).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Further details are provided in Asher and Smith (2022).
</p>
<p>Note: this simple implementation does not account for character contingency,
e.g. characters whose absence imposes inapplicable or absent tokens on
dependent characters.
</p>


<h3>Value</h3>

<p>A dataset with the same class as <code>dataset</code> in which entries that
are ambiguous in <code>template</code> are made ambiguous in <code>subject</code>.
</p>


<h3>Author(s)</h3>

<p><a href="https://orcid.org/0000-0001-5660-1727">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>


<h3>References</h3>

<p>Asher R, Smith MR (2022).
“Phylogenetic signal and bias in paleontology.”
<em>Systematic Biology</em>, <b>71</b>(4), 986–1008.
<a href="https://doi.org/10.1093/sysbio/syab072">doi:10.1093/sysbio/syab072</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)
dataset &lt;- matrix(c(sample(0:2, 4 * 8, TRUE),
                    "0", "0", rep("?", 6)), nrow = 5,
                    dimnames = list(c(LETTERS[1:4], "FOSSIL"),
                                    paste("char", 1:8)), byrow = TRUE)
artex &lt;- ArtificialExtinction(dataset, c("A", "C"), "FOSSIL")
</code></pre>


</div>