<div class="container">

<table style="width: 100%;"><tr>
<td>prewhiten</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Prewhiten a Bivariate Time Series, and Compute and Plot Their Sample Cross-Correlation Function</h2>

<h3>Description</h3>

<p>The bivariate time series are prewhitened according to an AR model fitted to
the x-component of the bivariate series. Alternatively, if an ARIMA model 
is provided, it will be used to prewhiten both series. The CCF of the
prewhitened bivariate
series is then computed and plotted.
</p>


<h3>Usage</h3>

<pre><code class="language-R">prewhiten(x, y, x.model = ar.res,ylab="CCF", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>first component series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>second  component series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.model</code></td>
<td>
<p>an ARIMA model; if provided, it is used to prewhiten both series. Otherwise, an AR model is fitted to the x-series and used to prewhiten both
series.The AR order is chosen by minimizing the AIC and the fit carried out by
the ar.ols function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>label of y-axis; default is "CCF"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> additional parameters to be passed to the ar.ols and the
ccf function.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the following components: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>ccf</code></td>
<td>
<p>Output from the ccf function on the prewhitened data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ar</code></td>
<td>
<p>The AR model fit to the x-series, or x.model if it is provided.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Kung-Sik Chan</p>


<h3>Examples</h3>

<pre><code class="language-R">data(milk)
data(electricity)
milk.electricity=ts.intersect(milk,log(electricity))
plot(milk.electricity,yax.flip=TRUE,main='') 
ccf(as.numeric(milk.electricity[,1]),as.numeric(milk.electricity[,2]),
main='milk &amp; electricity',ylab='CCF')
me.dif=ts.intersect(diff(diff(milk,12)),diff(diff(log(electricity),12)))
prewhiten(as.numeric(me.dif[,1]),as.numeric(me.dif[,2]),
,ylab='CCF' )
</code></pre>


</div>