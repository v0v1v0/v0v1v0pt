<div class="container">

<table style="width: 100%;"><tr>
<td>tcplVarMat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create chemical by assay matrices</h2>

<h3>Description</h3>

<p><code>tcplVarMat</code> creates chemical by assay matrices.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tcplVarMat(
  dsstox_substance_id = NULL,
  aeid = NULL,
  add.vars = NULL,
  flag = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dsstox_substance_id</code></td>
<td>
<p>Integer, chemical ID values to subset on</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aeid</code></td>
<td>
<p>Integer, assay endpoint ID values to subset on</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.vars</code></td>
<td>
<p>Character, mc4 or mc5 field(s) not included in the standard
list to add additional matrices</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flag</code></td>
<td>
<p>Integer or Logical of length 1, passed to 
<code>tcplSubsetChid</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>tcplVarMat</code> function is used to create chemical by assay matrices
for different parameters. The standard list of matrices returned includes:
</p>

<ol>
<li>
<p> "ac50" – The active concentration at 50
the winning model.
</p>
</li>
<li>
<p> "ac50_verbose" – The AC50 for the winning model, with text describing
some situations.
</p>
</li>
<li>
<p> "acc" – The active concentration at user-defined cutoff for the 
winning model.
</p>
</li>
<li>
<p> "acc_verbose" – The ACC for the winning model, with text describing
some situations.
</p>
</li>
<li>
<p> "mc_hitc" – The hit-call for the winning model in 
multiple-concentration (mc) screening.
</p>
</li>
<li>
<p> "sc_hitc" – The hit-call in single concentration (sc) screening.
</p>
</li>
</ol>
<p><code>tcplVarMat</code> produces matrices of combined sc-mc output. For the ac50
and acc matrices specifically, values are inserted in place to show complete
views of what was tested and what the results were. ac50 and acc values are:
</p>

<ul>
<li>
<p> set to 1e6 when the chemical is tested but negative in mc. In _verbose 
matrices, these are indicated as "MC neg".
</p>
</li>
<li>
<p> set to 1e7 when the chemical is not tested in mc but was screened in 
sc with a positive hitcall for the same aeid. In _verbose matrices, these 
are indicated as "SC pos, No MC".
</p>
</li>
<li>
<p> set to 1e8 when the chemical is not tested in mc but was screened in 
sc with a negative hitcall for the same aeid. In _verbose matrices, these 
are indicated as "SC neg, No MC"
</p>
</li>
<li>
<p> not changed when chemical is tested in mc and positive, or not tested in
either mc or sc
</p>
</li>
</ul>
<p>sc and mc data both are currently required to be included for these 
calculations. As a result, the "API" driver is not currently supported since
it does not return sc data.
</p>
<p>To add additional matrices, the 'add.vars' parameter can be used to specify
the fields from the mc4 or mc5 tables to create matrices for.
</p>
<p>When more than one sample is included for a chemical/assay pair, 
<code>tcplVarMat</code> aggregates multiple samples to a chemical level call 
utilizing <code>tcplSubsetChid</code>. The input
for the <code>tcplVarMat</code> 'flag' parameter is passed to the 
<code>tcplSubsetChid</code> call and used to parse down the data to create the 
matrices.
</p>


<h3>Value</h3>

<p>A list of chemical by assay matrices (data.tables) where the 
rows are given by the dsstox_substance_id and corresponding chnm (chemical
name) columns and the colnames are given by assay endpoint name (aenm).
</p>


<h3>See Also</h3>

<p><code>tcplSubsetChid</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## Demonstrate the returned values.
varmat &lt;- tcplVarMat()

## Other changes can be made
aeids &lt;- c(80)
dtxsid &lt;- c("DTXSID4034653", "DTXSID2032683", "DTXSID6032358", 
"DTXSID0032651", "DTXSID8034401")
varmat &lt;- tcplVarMat(aeid = aeids, dsstox_substance_id = dtxsid)
varmat &lt;- tcplVarMat(aeid = aeids, add.vars = c("m4id", "resp_max", "max_med"))

## To save output to file
library(writexl)
write_xlsx(varmat, path = "varmat_output.xlsx")

## End(Not run)

</code></pre>


</div>