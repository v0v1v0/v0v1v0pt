<div class="container">

<table style="width: 100%;"><tr>
<td>tess.nTaxa.expected</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>tess.nTaxa.expected: The expected number of taxa at present of a tree under a global, time-dependent birth-death process (  E[ N(T) ]  )</h2>

<h3>Description</h3>

<p>tess.nTaxa.expected computes the expected number of taxa at the present time T (the process start at time s and times increases until the present) under time-dependent. The rates may be any positive function of time or a constant. Additionally, mass-extinction event can be provided and a uniform taxon sampling probability. You have several options for the start of the process (origin vs MRCA). One important feature is that you can compute the expected number of taxa under the reconstructed process, that is, only lineages that survive until the present.</p>


<h3>Usage</h3>

<pre><code class="language-R">tess.nTaxa.expected( begin,
			   t,
			   end,
			   lambda,
			   mu,
			   massExtinctionTimes=c(),
			   massExtinctionSurvivalProbabilities=c(),
			   samplingProbability=1.0,
			   MRCA=TRUE,
			   reconstructed=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>begin</code></td>
<td>
<p>The time when the process starts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>The time at which we want to know the expected number of lineages (could be equal to end).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>end</code></td>
<td>
<p>The time when the process end (e.g. the present).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>The speciation rate function or constant.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>The extinction rate function or constant.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>massExtinctionTimes</code></td>
<td>
<p>The set of mass-extinction times after the start of the process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>massExtinctionSurvivalProbabilities</code></td>
<td>
<p>The set of survival probabilities for each speciation event. The set must have the same length as the set of mass-extinction times.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samplingProbability</code></td>
<td>
<p>The probability for a species to be included in the sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MRCA</code></td>
<td>
<p>Does the process start with the most recent common ancestor? If not, the tree must have a root edge!</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reconstructed</code></td>
<td>
<p>Are we computing the expected number of lineage at time t in the reconstructed process?</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns the expected number of taxa.</p>


<h3>Author(s)</h3>

<p>Sebastian Hoehna</p>


<h3>References</h3>

<p>S. Hoehna: Fast simulation of reconstructed phylogenies under global, time-dependent birth-death processes. 2013, Bioinformatics, 29:1367-1374 </p>


<h3>Examples</h3>

<pre><code class="language-R">
# create the time-dependent speciation and extinction rate functions
# here we use episodic functions
l &lt;- Vectorize(function(x) { if (x &gt; 0.5 || x &lt; 0.3) { return (1) } else { return (2) } })
e &lt;- Vectorize(function(x) { if (x &gt; 0.5 || x &lt; 0.3) { return (0.95) } else { return (0.5) } })

# now we can compute the expected number of taxa at time t
# note that we compute here the actual diversity at time t
# if you set reconstructed=TRUE, then you get the expected
# number of lineages that will survive until the present
tess.nTaxa.expected(begin=0,t=2,end=5,l,e,MRCA=TRUE)


</code></pre>


</div>