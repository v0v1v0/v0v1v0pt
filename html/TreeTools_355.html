<div class="container">

<table style="width: 100%;"><tr>
<td>TotalCopheneticIndex</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Total Cophenetic Index</h2>

<h3>Description</h3>

<p><code>TotalCopheneticIndex()</code> calculates the total cophenetic index
(Mir et al. 2013) for any tree, a measure of its balance;
<code>TCIContext()</code> lists its possible values.
</p>


<h3>Usage</h3>

<pre><code class="language-R">TotalCopheneticIndex(x)

TCIContext(x)

## S3 method for class 'numeric'
TCIContext(x)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A tree of class <code>phylo</code>, its <code style="white-space: pre;">⁠$edge⁠</code> property, or a list thereof.</p>
</td>
</tr></table>
<h3>Details</h3>

<p>The Total Cophenetic Index is a measure of tree balance – i.e. whether
a (phylogenetic) tree comprises symmetric pairs of nodes, or has a pectinate
"caterpillar" shape.
The index has a greater resolution power than Sackin's and Colless' indices,
and can be applied to trees that are not perfectly resolved.
</p>
<p>For a tree with <em>n</em> leaves, the Total Cophenetic Index can take values of
0 to <code>choose(n, 3)</code>.
The minimum value is higher for a perfectly resolved (i.e. dichotomous) tree
(see Lemma 14 of Mir <em>et al.</em> 2013).
Formulae to calculate the expected values under the Yule and Uniform models
of evolution are given in Theorems 17 and 23.
</p>
<p>Full details are provided by Mir et al. (2013).
</p>
<p>The J<sup>1</sup> index
(Lemant et al. 2022) has advantages over the Total Cophenetic
Index, particularly when comparing trees with different numbers of leaves,
or where the population size of nodes is meaningful; see <code>J1Index()</code>.
</p>


<h3>Value</h3>

<p><code>TotalCopheneticIndex()</code> returns an integer denoting the total cophenetic index.
</p>
<p><code>TCIContext()</code> returns a data frame detailing the maximum and minimum value
obtainable for the Total Cophenetic Index for rooted binary trees with the
number of leaves of the given tree, and the expected value under the Yule
and Uniform models.
The variance of the expected value is given under the Yule model, but cannot
be obtained by calculation for the Uniform model.
</p>


<h3>Author(s)</h3>

<p><a href="https://orcid.org/0000-0001-5660-1727">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>


<h3>References</h3>

<p>Lemant J, Le Sueur C, Manojlović V, Noble R (2022).
“Robust, Universal Tree Balance Indices.”
<em>Systematic Biology</em>, <b>71</b>(5), 1210–1224.
<a href="https://doi.org/10.1093/sysbio/syac027">doi:10.1093/sysbio/syac027</a>.<br><br> Mir A, Rosselló F, Rotger LA (2013).
“A new balance index for phylogenetic trees.”
<em>Mathematical Biosciences</em>, <b>241</b>(1), 125–136.
<a href="https://doi.org/10.1016/j.mbs.2012.10.005">doi:10.1016/j.mbs.2012.10.005</a>.
</p>


<h3>See Also</h3>


<ul>
<li> <p><code>J1Index()</code> provides a more robust, universal tree balance index.
</p>
</li>
<li> <p><code>cophen.index()</code> in the package
<a href="https://github.com/LuciaRotger/CollessLike"><span class="pkg">CollessLike</span></a>
provides an alternative implementation of this index and its predecessors.
</p>
</li>
</ul>
<p>Other tree characterization functions: 
<code>CladisticInfo()</code>,
<code>Consensus()</code>,
<code>J1Index()</code>,
<code>Stemwardness</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Balanced trees have the minimum index for a binary tree;
# Pectinate trees the maximum:
TCIContext(8)
TotalCopheneticIndex(PectinateTree(8))
TotalCopheneticIndex(BalancedTree(8))
TotalCopheneticIndex(StarTree(8))


# Examples from Mir et al. (2013):
tree12 &lt;- ape::read.tree(text="(1, (2, (3, (4, 5))));")  #Fig. 4, tree 12
TotalCopheneticIndex(tree12) # 10
tree8  &lt;- ape::read.tree(text="((1, 2, 3, 4), 5);")      #Fig. 4, tree 8
TotalCopheneticIndex(tree8)  # 6
TCIContext(tree8)
TCIContext(5L) # Context for a tree with 5 leaves.

</code></pre>


</div>