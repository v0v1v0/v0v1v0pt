<div class="container">

<table style="width: 100%;"><tr>
<td>tkmeans</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>TKMEANS method for robust K-means clustering</h2>

<h3>Description</h3>

<p>This function searches for <code>k</code> (or less) spherical clusters 
in a data matrix <code>x</code>, whereas the <code>ceiling(alpha n)</code> most outlying 
observations are trimmed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tkmeans(
  x,
  k,
  alpha = 0.05,
  nstart = 500,
  niter1 = 3,
  niter2 = 20,
  nkeep = 5,
  iter.max,
  points = NULL,
  center = FALSE,
  scale = FALSE,
  store_x = TRUE,
  parallel = FALSE,
  n.cores = -1,
  zero_tol = 1e-16,
  drop.empty.clust = TRUE,
  trace = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A matrix or data.frame of dimension n x p, containing the observations (row-wise).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>The number of clusters initially searched for.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The proportion of observations to be trimmed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nstart</code></td>
<td>
<p>The number of random initializations to be performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niter1</code></td>
<td>
<p>The number of concentration steps to be performed for the nstart initializations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niter2</code></td>
<td>
<p>The maximum number of concentration steps to be performed for the 
<code>nkeep</code> solutions kept for further iteration. The concentration steps are 
stopped, whenever two consecutive steps lead to the same data partition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nkeep</code></td>
<td>
<p>The number of iterated initializations (after niter1 concentration 
steps) with the best values in the target function that are kept for further iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter.max</code></td>
<td>
<p>(deprecated, use the combination <code>nkeep, niter1 and niter2</code>) 
The maximum number of concentration steps to be performed.
The concentration steps are stopped, whenever two consecutive steps lead
to the same data partition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>points</code></td>
<td>
<p>Optional initial mean vectors, <code>NULL</code> or a matrix with <code>k</code> 
vectors used as means to initialize the algorithm. If initial mean vectors are 
specified, <code>nstart</code> should be 1 (otherwise the same initial means are 
used for all runs).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>
<p>Optional centering of the data: a function or a vector of length p 
which can optionally be specified for centering x before calculation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>Optional scaling of the data: a function or a vector of length p 
which can optionally be specified for scaling x before calculation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>store_x</code></td>
<td>
<p>A logical value, specifying whether the data matrix <code>x</code> shall be 
included in the result object. By default this value is set to <code>TRUE</code>, because 
some of the plotting functions depend on this information. However, when big data 
matrices are handled, the result object's size can be decreased noticeably 
when setting this parameter to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>A logical value, specifying whether the nstart initializations should be done in parallel.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.cores</code></td>
<td>
<p>The number of cores to use when paralellizing, only taken into account if parallel=TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zero_tol</code></td>
<td>
<p>The zero tolerance used. By default set to 1e-16.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drop.empty.clust</code></td>
<td>
<p>Logical value specifying, whether empty clusters shall be 
omitted in the resulting object. (The result structure does not contain center 
estimates of empty clusters anymore. Cluster names are reassigned 
such that the first l clusters (l &lt;= k) always have at least one observation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>Defines the tracing level, which is set to 0 by default. Tracing level 1 
gives additional information on the stage of the iterative process.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The function returns the following values:
</p>

<ul>
<li>
<p> cluster - A numerical vector of size <code>n</code> containing the cluster assignment 
for each observation. Cluster names are integer numbers from 1 to k, 0 indicates 
trimmed observations. Note that it could be empty clusters with no observations 
when <code>equal.weights=FALSE</code>.
</p>
</li>
<li>
<p> obj - The value of the objective function of the best (returned) solution.
</p>
</li>
<li>
<p> size - An integer vector of size k, returning the number of observations contained by each cluster.
</p>
</li>
<li>
<p> centers - A matrix of size p x k containing the centers (column-wise) of each cluster. 
</p>
</li>
<li>
<p> code - A numerical value indicating if the concentration steps have 
converged for the returned solution (2).
</p>
</li>
<li>
<p> cluster.ini - A matrix with nstart rows and number of columns equal to 
the number of observations and where each row shows the final clustering 
assignments (0 for trimmed observations) obtained after the <code>niter1</code> 
iteration of the <code>nstart</code> random initializations.
</p>
</li>
<li>
<p> obj.ini - A numerical vector of length <code>nstart</code> containing the values 
of the target function obtained after the <code>niter1</code> iteration of the 
<code>nstart</code> random initializations.
</p>
</li>
<li>
<p> x - The input data set.
</p>
</li>
<li>
<p> k - The input number of clusters.
</p>
</li>
<li>
<p> alpha - The input trimming level.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Valentin Todorov, Luis Angel Garcia Escudero, Agustin Mayo Iscar.
</p>


<h3>References</h3>

<p>Cuesta-Albertos, J. A.; Gordaliza, A. and Matr√°n, C. (1997), "Trimmed k-means: 
an attempt to robustify quantizers". Annals of Statistics, Vol. 25 (2), 553-576.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
 
 ##--- EXAMPLE 1 ------------------------------------------
 sig &lt;- diag(2)
 cen &lt;- rep(1,2)
 x &lt;- rbind(MASS::mvrnorm(360, cen * 0,   sig),
            MASS::mvrnorm(540, cen * 5,   sig),
            MASS::mvrnorm(100, cen * 2.5, sig))
 
 ## Two groups and 10\% trimming level
 (clus &lt;- tkmeans(x, k = 2, alpha = 0.1))

 plot(clus)
 plot(clus, labels = "observation")
 plot(clus, labels = "cluster")

 #--- EXAMPLE 2 ------------------------------------------
 data(geyser2)
 (clus &lt;- tkmeans(geyser2, k = 3, alpha = 0.03))
 plot(clus)
 
</code></pre>


</div>