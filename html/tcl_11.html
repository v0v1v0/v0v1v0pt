<div class="container">

<table style="width: 100%;"><tr>
<td>sa_sizeChange</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sample size planning for tests in context of measurement of change using LLTM</h2>

<h3>Description</h3>

<p>Returns sample size for Wald (W), likelihood ratio (LR), Rao score (RS)
and gradient (GR) test given probabilities of errors of first and second kinds <code class="reqn">\alpha</code> and <code class="reqn">\beta</code>
as well as a deviation from the hypothesis to be tested. The hypothesis to be tested states that
the shift parameter quantifying the constant change for all items between time points 1 and 2
equals 0. The alternative states that the shift parameter is not equal to 0. It is assumed that the same
items are presented at both time points. See function <code>change_test</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sa_sizeChange(eta, alpha = 0.05, beta = 0.05, persons = rnorm(10^6))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>eta</code></td>
<td>
<p>A vector of eta parameters of the LLTM. The last element represents the constant change or shift for all items
between time points 1 and 2. The other elements of the vector are the item parameters at time point 1. A choice of the eta
parameters constitutes a scenario of deviation from the hypothesis of no change.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Probability of error of first kind.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>Probability of error of second kind.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>persons</code></td>
<td>
<p>A vector of person parameters (drawn from a specified distribution). By default <code class="reqn">10^6</code> parameters
are drawn at random from the standard normal distribution. The larger this number the more accurate are the computations.
See Details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In general, the sample size is determined from the assumption that the approximate distributions
of the four test statistics are from the family of noncentral <code class="reqn">\chi^2</code> distributions with <code class="reqn">df = 1</code>
and noncentrality parameter <code class="reqn">\lambda</code>. The latter is, inter alia, a function of the sample size. Hence,
the sample size can be determined from the condition <code class="reqn">\lambda = \lambda_0</code>, where <code class="reqn">\lambda_0</code> is
a predetermined constant which depends on the probabilities of the errors of the first and second kinds
<code class="reqn">\alpha</code> and  <code class="reqn">\beta</code> (or power). More details about the distributions of the test statistics
and the relationship between <code class="reqn">\lambda</code>, power, and sample size can be found in Draxler and Alexandrowicz (2015).
</p>
<p>In particular, the determination of <code class="reqn">\lambda</code> and the sample size, respectively, is based on a simple Monte
Carlo approach. As regards the concept of sample size a distinction between informative and total
sample size has to be made. In the conditional maximum likelihood context, the responses of
persons with minimum or maximum person score are completely uninformative. They do not contribute
to the value of the test statistic. Thus, the informative sample size does not include these persons.
The total sample size is composed of all persons. The Monte Carlo approach used in the present
problem to determine <code class="reqn">\lambda</code> and informative (and total) sample size can briefly be described as follows.
Data (responses of a large number of persons to a number of items presented at two time points) are
generated given a user-specified scenario of a deviation from the hypothesis to be tested. The
hypothesis to be tested assumes no change between time points 1 and 2. A scenario of a deviation
is given by a choice of the item parameters at time point 1 and the shift parameter, i.e., the
LLTM eta parameters, as well as the person parameters (to be drawn randomly from a specified distribution).
The shift parameter represents a constant change of all item parameters from time point 1 to time point 2.
A test statistic <code class="reqn">T</code> (Wald, LR, score, or gradient) is computed from the simulated data. The observed
value <code class="reqn">t</code> of the test statistic is then divided by the informative sample size <code class="reqn">n_{infsim}</code> observed
in the simulated data. This yields the so-called global deviation <code class="reqn">e = t / n_{infsim}</code>, i.e.,
the chosen scenario of a deviation from the hypothesis to be tested being represented by a
single number. Let the informative sample size sought be denoted by <code class="reqn">n_{inf}</code> (thus, this is not
the informative sample size observed in the sim. data). The noncentrality parameter <code class="reqn">\lambda</code> can
be expressed by the product <code class="reqn">n_{inf} * e</code>. Then, it follows from the condition <code class="reqn">\lambda = \lambda_0</code> that
</p>
<p style="text-align: center;"><code class="reqn">n_{inf} * e = \lambda_0</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">n_{inf} = \lambda_0 / e.</code>
</p>

<p>Note that the sample of size <code class="reqn">n_{inf}</code> is assumed to be composed only of persons with informative person scores, where
the relative frequency distribution of these informative scores is considered to be equal to the
observed relative frequency distribution of the informative scores in the simulated data. The total sample size
<code class="reqn">n_{total}</code> is then obtained from the relation <code class="reqn">n_{inf} = n_{total} * pr</code>, where <code class="reqn">pr</code> is the proportion
or relative frequency of persons observed in the simulated data with a minimum or maximum score. Basing
the tests given a level <code class="reqn">\alpha</code> on an informative sample of size <code class="reqn">n_{inf}</code> the probability of rejecting
the hypothesis to be tested will be at least <code class="reqn">1 - \beta</code> if the true global deviation <code class="reqn">\geq e</code>.
</p>
<p>Note that in this approach the data have to be generated only once. There are no replications
needed. Thus, the procedure is computationally not very time-consuming.
</p>
<p>Since e is determined from the value of the test statistic observed in the simulated data it has
to be treated as a realized value of a random variable <code class="reqn">E</code>. Consequently, <code class="reqn">n_{inf}</code> is also a
realization of a random variable <code class="reqn">N_{inf}</code>. Thus, the (realized) value <code class="reqn">n_{inf}</code> need not be
equal to the exact value of the informative sample size that follows from the user-specified
(predetermined) <code class="reqn">\alpha</code>, <code class="reqn">\beta</code>, and scenario of a deviation from the hypothesis to be
tested, i.e., the selected item parameters and shift parameter used for the simulation of the data.
If the CML estimates of these parameters computed from the simulated data are close to the
predetermined parameters <code class="reqn">n_{inf}</code> will be close to the exact value. This will generally be the
case if the number of person parameters used for simulating the data is large, e.g.,
<code class="reqn">10^5</code> or even <code class="reqn">10^6</code> persons. In such cases, the possible random error of the computation procedure
of <code class="reqn">n_{inf}</code> based on the sim. data may not be of practical relevance any more. That is why a
large number (of persons for the simulation process) is generally recommended.
</p>
<p>For theoretical reasons, the random error involved in computing <code class="reqn">n_{inf}</code> can be pretty well approximated.
A suitable approach is the well-known delta method. Basically, it is a Taylor polynomial of first order,
i.e., a linear approximation of a function. According to it the variance of a function of a random
variable can be linearly approximated by multiplying the variance of this random variable with the square
of the first derivative of the respective function. In the present problem, the variance of the test
statistic <code class="reqn">T</code> is (approximately) given by the variance of a noncentral <code class="reqn">\chi^2</code> distribution. Thus, <code class="reqn">Var(T) = 2 (df + 2 \lambda)</code>,
with <code class="reqn">df = 1</code> and <code class="reqn">\lambda = t</code>. Since the global deviation
<code class="reqn">e = (1 / n_{infsim}) * t</code> it follows for the variance of the corresponding random variable <code class="reqn">E</code> that
<code class="reqn">Var(E) = (1 / n_{infsim})^2 * Var(T)</code>. Since <code class="reqn">n_{inf} = f(e) = \lambda_0 / e</code> one obtains by the
delta method (for the variance of the corresponding random variable <code class="reqn">N_{inf}</code>)
</p>
<p style="text-align: center;"><code class="reqn">Var(N_{inf}) = Var(E) * (f'(e))^2,</code>
</p>

<p>where <code class="reqn">f'(e) = - \lambda_0 / e^2</code> is the derivative of <code class="reqn">f(e)</code>. The square root of <code class="reqn">Var(N_{inf})</code>
is then used to quantify the random error of the suggested Monte Carlo computation procedure. It is called
Monte Carlo error of informative sample size.
</p>


<h3>Value</h3>

<p>A list results.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>informative sample size</code></td>
<td>
<p>Informative sample size for each test, omitting persons with min. and max score.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MC error of sample size</code></td>
<td>
<p>Monte Carlo error of sample size computation for each test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deviation</code></td>
<td>
<p>Shift parameter estimated from the simulated data representing the constant shift of item
parameters between time points 1 and 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>person score distribution</code></td>
<td>
<p>Relative frequencies of person scores observed in simulated data. Uninformative scores,
i.e., minimum and maximum score, are omitted.
Note that the person score distribution does also have an influence on the sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degrees of freedom</code></td>
<td>
<p>Degrees of freedom <code class="reqn">df</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noncentrality parameter</code></td>
<td>
<p>Noncentrality parameter <code class="reqn">\lambda</code> of <code class="reqn">\chi^2</code> distribution from which sample size is determined.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>total sample size</code></td>
<td>
<p>Total sample size for each test. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The matched call.</p>
</td>
</tr>
</table>
<h3>References</h3>


<p>Draxler, C., &amp; Alexandrowicz, R. W. (2015). Sample size determination within the scope of conditional
maximum likelihood estimation with special focus on testing the Rasch model. Psychometrika, 80(4), 897-919.
</p>
<p>Fischer, G. H. (1995). The Linear Logistic Test Model. In G. H. Fischer &amp; I. W. Molenaar (Eds.),
Rasch models: Foundations, Recent Developments, and Applications (pp. 131-155). New York: Springer.
</p>
<p>Fischer, G. H. (1983). Logistic Latent Trait Models with Linear Constraints. Psychometrika, 48(1), 3-26.

</p>


<h3>See Also</h3>

<p><code>powerChange</code>, and <code>post_hocChange</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Numerical example 4 items presented twice, thus 8 virtual items

# eta Parameter, first 4 are nuisance
# (easiness parameters of the 4 items at time point 1),
# last one is the shift parameter
eta &lt;- c(-2,-1,1,2,0.5)

res &lt;- sa_sizeChange(eta = eta)

# &gt; res
# $`informative sample size`
#   W  LR  RS  GR
# 177 174 175 173
#
# $`MC error of sample size`
#     W    LR    RS    GR
# 1.321 1.287 1.299 1.276
#
# $`deviation (estimate of shift parameter)`
# [1] 0.501
#
# $`person score distribution`
#
#     1     2     3     4     5     6     7
# 0.034 0.094 0.181 0.249 0.227 0.147 0.068
#
# $`degrees of freedom`
# [1] 1
#
# $`noncentrality parameter`
# [1] 12.995
#
# $`total sample size`
#   W  LR  RS  GR
# 182 179 180 178
#
# $call
# sa_sizeChange(alpha = 0.05, beta = 0.05, eta = eta, persons = rnorm(10^6))

## End(Not run)
</code></pre>


</div>