<div class="container">

<table style="width: 100%;"><tr>
<td>TPR.fit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Tensor predictor regression</h2>

<h3>Description</h3>

<p>This function is used for estimation of tensor predictor regression. The available method including standard OLS type estimation, PLS type of estimation as well as envelope estimation with FG, 1D and ECD approaches.
</p>


<h3>Usage</h3>

<pre><code class="language-R">TPR.fit(x, y, u, method=c('standard', 'FG', '1D', 'ECD', 'PLS'), Gamma_init = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The predictor tensor instance of dimension <code class="reqn">p_1\times p_2\times\cdots\times p_m \times n</code>, where <code class="reqn">n</code> is the sample size. Array with the same dimensions and matrix with dimension <code class="reqn">p\times n</code> are acceptable. If <code>y</code> is missing, <code>x</code> should be a list or an environment consisting of predictor and response datasets.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The response matrix of dimension <code class="reqn">r \times n</code>, where <code class="reqn">n</code> is the sample size. Vector of length <code class="reqn">n</code> is acceptable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>The dimension of envelope subspace. <code class="reqn">u=(u_1,\cdots, u_m)</code>. Used for methods "FG", "1D", "ECD" and "PLS". User can use <code>TPRdim</code> to select dimension.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The method used for estimation of tensor response regression. There are four possible choices.
</p>

<ul>
<li>
<p><code>"standard"</code>: The standard OLS type estimation.
</p>
</li>
<li>
<p><code>"FG"</code>: Envelope estimation with full Grassmannian (FG) algorithm.
</p>
</li>
<li>
<p><code>"1D"</code>: Envelope estimation with one dimensional optimization approaches by 1D algorithm.
</p>
</li>
<li>
<p><code>"ECD"</code>: Envelope estimation with one dimensional optimization approaches by ECD algorithm.
</p>
</li>
<li>
<p><code>"PLS"</code>: The SIMPLS-type estimation without manifold optimization.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gamma_init</code></td>
<td>
<p>A list specifying the initial envelope subspace basis for "FG" method. By default, the estimators given by "1D" algorithm is used.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Please refer to <strong>Details</strong> part of <code>TPRsim</code> for the description of the tensor predictor regression model.
</p>


<h3>Value</h3>

<p><code>TPR.fit</code> returns an object of class "Tenv".
</p>
<p>The function <code>summary</code> (i.e., <code>summary.Tenv</code>) is used to print the summary of the results, including additional information, e.g., the p-value and the standard error for coefficients, and the prediction mean squared error.
</p>
<p>The functions <code>coefficients</code>, <code>fitted.values</code> and <code>residuals</code> can be used to extract different features returned from <code>TPR.fit</code>.
</p>
<p>The function <code>plot</code> (i.e., <code>plot.Tenv</code>) plots the two-dimensional coefficients and p-value for object of class "Tenv".
</p>
<p>The function <code>predict</code> (i.e., <code>predict.Tenv</code>) predicts response for the object returned from <code>TPR.fit</code> function.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The original predictor dataset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The original response dataset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The matched call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The implemented method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>The estimation of regression coefficient tensor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gamma</code></td>
<td>
<p>The estimation of envelope subspace basis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>A lists of estimated covariance matrices at each mode for the tensor predictors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values</code></td>
<td>
<p>The fitted response matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>The residuals matrix.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Zhang, X. and Li, L., 2017. Tensor envelope partial least-squares regression. Technometrics, 59(4), pp.426-436.
</p>


<h3>See Also</h3>

<p><code>summary.Tenv</code> for summaries, calculating mean squared error from the prediction.
</p>
<p><code>plot.Tenv</code>(via <code>graphics::image</code>) for drawing the two-dimensional coefficient plot.
</p>
<p><code>predict.Tenv</code> for prediction.
</p>
<p>The generic functions <code>coef, residuals, fitted</code>.
</p>
<p><code>TPRdim</code> for selecting the dimension of envelope by cross-validation.
</p>
<p><code>TPRsim</code> for generating the simulated data used in tensor prediction regression.
</p>
<p>The simulated data <code>square</code> used in tensor predictor regression.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># The dimension of predictor
p &lt;- c(10, 10, 10)
# The envelope dimensions u.
u &lt;- c(1, 1, 1)
# The dimension of response
r &lt;- 5
# The sample size
n &lt;- 200

# Simulate the data with TPRsim.
dat &lt;- TPRsim(p = p, r = r, u = u, n = n)
x &lt;- dat$x
y &lt;- dat$y
B &lt;- dat$coefficients

fit_std &lt;- TPR.fit(x, y, method="standard")
fit_FG &lt;- TPR.fit(x, y, u, method="FG")
fit_pls &lt;- TPR.fit(x, y, u, method="PLS")

rTensor::fnorm(B-stats::coef(fit_std))
rTensor::fnorm(B-stats::coef(fit_FG))
rTensor::fnorm(B-stats::coef(fit_pls))

## ----------- Pass a list or an environment to x also works ------------- ##
# Pass a list to x
l &lt;- dat[c("x", "y")]
fit_std_l &lt;- TPR.fit(l, method="standard")

# Pass an environment to x
e &lt;- new.env()
e$x &lt;- dat$x
e$y &lt;- dat$y
fit_std_e &lt;- TPR.fit(e, method="standard")

## ----------- Use dataset "square" included in the package ------------- ##
data("square")
x &lt;- square$x
y &lt;- square$y
fit_std &lt;- TPR.fit(x, y, method="standard")

</code></pre>


</div>