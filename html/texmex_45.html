<div class="container">

<table style="width: 100%;"><tr>
<td>extremalIndex</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extremal index estimation and automatic declustering</h2>

<h3>Description</h3>

<p>Given a threshold which defines excesses above that threshold, estimate the
extremal index of a dependent sequence by using the method of Ferro and
Segers, 2003.  The extremal index estimate can then be used to carry out
automatic declustering of the sequence to identify independent clusters and
estimate the GPD for cluster maxima.  Graphical diagnostics of model fit are
available.
</p>


<h3>Usage</h3>

<pre><code class="language-R">extremalIndex(y, data = NULL, threshold)

extremalIndexRangeFit(y, data = NULL, umin = quantile(y,.5), umax =
quantile(y, 0.95), nint = 10, nboot = 100, alpha = .05, estGPD=TRUE,
verbose = TRUE, trace = 10, ...)

bootExtremalIndex(x)

declust(y, r=NULL, data = NULL, ...)

## S3 method for class 'extremalIndex'
declust(y, r=NULL,...)

## S3 method for class 'declustered'
plot(x, ylab = "Data",...)

## S3 method for class 'declustered'
evm(y, data=NULL, family=gpd, ...)

## S3 method for class 'extremalIndexRangeFit'
plot(x,addNexcesses=TRUE,estGPD=TRUE,...)

## S3 method for class 'extremalIndex'
print(x,...)

## S3 method for class 'declustered'
print(x,...)

## S3 method for class 'extremalIndexRangeFit'
ggplot(data=NULL, mapping, xlab, ylab, main,
ylim = "auto",ptcol="dark blue",col="dark blue",fill="orange",
textsize=4,addNexcesses=TRUE,estGPD=TRUE,..., environment)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Argument to function <code>extremalIndex</code>: either a numeric vector
or the name of a variable in <code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame containing <code>y</code> and any covariates. In
<code>evm.declustered</code>, it should be NULL and is included to match the
arguments of generic <code>evm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>The threshold for <code>y</code>, exceedances above which will be
used to estimate the extremal index and carry out automatic declustering.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>The type of extreme value model. The user should not change
this from its default in <code>evm.declustered</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Objects passed to methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>Positivie integer: run length to be used under "runs" declustering.
If specified then so-called "runs" declustering will be carried out,
otherwise defaults to NULL in which case the automatic "intervals"
declustering method of Ferro and Segers is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>umin</code></td>
<td>
<p>The minimum threshold above which to esimate the parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>umax</code></td>
<td>
<p>The maximum threshold above which to esimate the parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nint</code></td>
<td>
<p>The number of thresholds at which to perform the estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nboot</code></td>
<td>
<p>Number of bootstrap samples to simulate at each threshold for
estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>100(1 - alpha)% confidence intervals will be plotted with the
point estimates. Defaults to <code>alpha = 0.05</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>Label for the x-axis (ggplot).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>Label for the y-axis (ggplot).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>addNexcesses</code></td>
<td>
<p>Whether to annotate the top axis of plots with the
number of excesses above the corresponding threhsold. Defaults to
<code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estGPD</code></td>
<td>
<p>Whether to estimate GPD parameters at each choice of
thereshold â€“ defaults to <code>TRUE</code> in which case the GPD parameters are
estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Whether to report on progress in RangeFit calculations.
Defaults to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>How frequently to report bootstrap progress in RangeFit
calculations.  Defaults to 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mapping, main, ylim, ptcol, col, fill, textsize, environment</code></td>
<td>
<p>Further arguments to ggplot method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>extremalIndex</code> estimates the extremal index of a
dependent series of observations above a given threshold <code>threshold</code>,
returning an object of class "extremalIndex".  Plot and print methods are
available for this class. A graphical diagnostic akin to Figure 1 in Ferro
and Segers (2003) is produced by the <code>plot</code> method for this class.
This plot is used to test the model assumption underpinning the estimation,
with good fit being indicated by interexceedance times which correspond to
inter-cluster times lying close to the diagonal line indicated.
</p>
<p>In addition to good model fit, an appropriate choice of threshold is one
above which the estimated extremal index is stable over further, higher
thresholds (up to estimation uncertainty).  This can be assessed by using
the function <code>extremalIndexRangeFit</code>, which examines a range of
threshold values.  At each threshold, the extremal index is estimated; that
estimate is used to decluster the series and the parameters of the GPD are
optionally estimated for the resulting declustered series.  Uncertainty in
the estimation of the extremal index and GPD parameters is assessed by using
a bootstrap scheme which accounts for uncertainty in the extremal index
estimation, and the corresponding uncertainty in the declustering of the
series. There are <code>plot</code> and <code>ggplot</code> methods for output of this function, which is of class <code>extremalIndexRangeFit</code>.
</p>
<p>The function <code>declust</code> returns an object of class "declustered",
identifying independent clusters in the original series. Print, plot and
show methods are available for this class. The GPD model can be fitted to
objects of this class, including the use of covariates in the linear
predictors for the parameters of the GPD.  See examples below.
</p>


<h3>Value</h3>

<p>The function <code>extremalIndex</code> returns a list of class
"extremalIndex": </p>
<table>
<tr style="vertical-align: top;">
<td><code>EIintervals</code></td>
<td>
<p>Estimate of the extremal index by using
the intervals estimator of Ferro and Segers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>threshold for
declustering and estimation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TotalN</code></td>
<td>
<p>length of original data series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nExceed</code></td>
<td>
<p>number of exceedances of <code>threshold</code> in original
series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thExceedanceProb</code></td>
<td>
<p>probablity of threshold exceedance in
original series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the original function call </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interExceedTimes</code></td>
<td>
<p>times between threshold exceedances</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thExceedances</code></td>
<td>
<p>observation from the original series which are above
<code>threshold</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exceedanceTimes</code></td>
<td>
<p>times of occurrance of threshold
exceedances</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>original dependent series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data frame or
NULL</p>
</td>
</tr>
</table>
<p>The function <code>declust</code> returns a list of type "declustered":
</p>
<table>
<tr style="vertical-align: top;">
<td><code>clusters</code></td>
<td>
<p>integer labels assigning threshold exceedances to clusters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sizes</code></td>
<td>
<p>number of exceedances in each cluster</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clusterMaxima</code></td>
<td>
<p>vector made up of the largest observation from each
distinct cluster.  In the case of ties, the first value is taken.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>isClusterMax</code></td>
<td>
<p>logical; length equal to number of threshold
exceedances, value is <code>TRUE</code> for threshold exceedances which correspond
to cluster maxima</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>see entry for object of class "extremalIndex"
above</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>see entry for object of class "extremalIndex" above</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>see entry for object of class "extremalIndex" above</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EIintervals</code></td>
<td>
<p>see entry for object of class "extremalIndex" above</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>see entry for object of class "extremalIndex" above</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>InterExceedTimes</code></td>
<td>
<p>times between threshold exceedances, length is one
less than the number of threshold exceedances</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>InterCluster</code></td>
<td>
<p>logical:
indicates inter exceedance times larger than <code>r</code> the run length used
for declustering</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thExceedances</code></td>
<td>
<p>see entry for object of class
"extremalIndex" above</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exceedanceTimes</code></td>
<td>
<p>see entry for object of class
"extremalIndex" above</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>run length used for declustering</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nClusters</code></td>
<td>
<p>Number of indenendent clusters identified</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Method used for declustering (either "intervals" or "runs")</p>
</td>
</tr>
</table>
<p>The function <code>bootExtremalIndex</code> return a single vector corersponding
to a bootstrap sample from the original series: observations are censored at
<code>threshold</code> so that values below this threshold are indicated by the
value -1.
</p>
<p>The method <code>evm</code> for class "declustered" returns an object of type
"evmOpt" or "evmSim" depending on the precise function call - see
documentation for <code>evm</code>.
</p>


<h3>Author(s)</h3>

<p>Janet E. Heffernan
</p>


<h3>References</h3>

<p>Ferro, C.A.T. and Segers, J., (2003) "Inference for clusters of
Extreme Values", JRSS B 65, Part 2, pp 545â€“556.
</p>


<h3>See Also</h3>

<p><code>evm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
par(mfrow=c(2,2));
extremalIndexRangeFit(summer$O3,nboot=10)
ei &lt;- extremalIndex(summer$O3,threshold=45)
plot(ei)
d &lt;- declust(ei)
plot(d)
evm(d)

## fitting with covariates:

so2 &lt;- extremalIndex(SO2,data=winter,threshold=15)
plot(so2)
so2 &lt;- extremalIndex(SO2,data=winter,threshold=20)
plot(so2) ## fits better

so2.d &lt;- declust(so2)
par(mfrow=c(1,1)); plot(so2.d)
so2.d.gpd &lt;- evm(so2.d) # AIC 661.1

evm(so2.d,phi=~NO)
evm(so2.d,phi=~NO2)
evm(so2.d,phi=~O3) # better AIC 651.9
evm(so2.d,phi=~PM10)

so2.d.gpd.o3 &lt;- evm(so2.d,phi=~O3)

par(mfrow=c(2,2)); plot(so2.d.gpd.o3)

</code></pre>


</div>