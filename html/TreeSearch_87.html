<div class="container">

<table style="width: 100%;"><tr>
<td>PlotCharacter</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot the distribution of a character on a tree</h2>

<h3>Description</h3>

<p>Reconstructs the distribution of a character on a tree topology using the
modified Fitch algorithm presented in
Brazeau et al. (2019).
</p>


<h3>Usage</h3>

<pre><code class="language-R">PlotCharacter(
  tree,
  dataset,
  char = 1L,
  updateTips = FALSE,
  plot = TRUE,
  tokenCol = NULL,
  ambigCol = "grey",
  inappCol = "lightgrey",
  ambigLty = "dotted",
  inappLty = "dashed",
  plainLty = par("lty"),
  tipOffset = 1,
  unitEdge = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>A tree of class <code>phylo</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataset</code></td>
<td>
<p>A phylogenetic data matrix of <span class="pkg">phangorn</span> class
<code>phyDat</code>, whose names correspond to the labels of any accompanying tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>char</code></td>
<td>
<p>Index of character to plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>updateTips</code></td>
<td>
<p>Logical; if <code>FALSE</code>, tips will be labelled with their
original state in <code>dataset</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>Logical specifying whether to plot the output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tokenCol</code></td>
<td>
<p>Palette specifying colours to associate with each token in
turn, in the sequence listed in <code>attr(dataset, "levels")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ambigCol, ambigLty, inappCol, inappLty, plainLty</code></td>
<td>
<p>Colours and line types
to apply to ambiguous, inapplicable and applicable tokens.  See the <code>lty</code>
graphical parameter for details of line styles.  Overrides <code>tokenCol</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tipOffset</code></td>
<td>
<p>Numeric: how much to offset tips from their labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unitEdge</code></td>
<td>
<p>Logical: Should all edges be plotted with a unit length?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to pass to <code>plot.phylo()</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>PlotCharacter()</code> invisibly returns a matrix in which each row
corresponds to a numbered tip or node of <code>tree</code>, and each column corresponds
to a token; the tokens that might parsimoniously be present at each point
on a tree are denoted with <code>TRUE</code>.
</p>


<h3>Author(s)</h3>

<p><a href="https://smithlabdurham.github.io/">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>


<h3>References</h3>

<p>Brazeau MD, Guillerme T, Smith MR (2019).
“An algorithm for morphological phylogenetic analysis with inapplicable data.”
<em>Systematic Biology</em>, <b>68</b>(4), 619–631.
<a href="https://doi.org/10.1093/sysbio/syy083">doi:10.1093/sysbio/syy083</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Set up plotting area
oPar &lt;- par(mar = rep(0, 4))

tree &lt;- ape::read.tree(text = 
  "((((((a, b), c), d), e), f), (g, (h, (i, (j, (k, l))))));")
## A character with inapplicable data
dataset &lt;- TreeTools::StringToPhyDat("23--1??--032", tips = tree)
plotted &lt;- PlotCharacter(tree, dataset)
plotted

# Character from a real dataset 
data("Lobo", package = "TreeTools")
dataset &lt;- Lobo.phy
tree &lt;- TreeTools::NJTree(dataset)
PlotCharacter(tree, dataset, 14)
par(oPar)
</code></pre>


</div>