<div class="container">

<table style="width: 100%;"><tr>
<td>internalFunctions</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Helper functions for tapnet</h2>

<h3>Description</h3>

<p>Lower-level, non-exported functions to be called by the main tapnet functions
</p>


<h3>Usage</h3>

<pre><code class="language-R">internalFunctions()

pems_from_tree(tree)

select_relevant_pems(tree, species)

tmatch(delta_t, type = "normal", width = 1, shift = 0, err = 1e-05)

param_vec2list(params, n, m, fit.delta = FALSE)

loglik_tapnet(
  params,
  networks,
  tmatch_type_pem,
  tmatch_type_obs,
  lambda = 0,
  obj_function = "multinom",
  fit.delta = TRUE
)

latent_cor(true_pars, fitted_pars, pems_low, pems_high)

web_indices(web, web_dim, indices)

refit_params(tapnet, fit, fitted_I_mat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>phylogenetic tree in phylo format;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>species</code></td>
<td>
<p>a named vector of species, representing (some of) the tips of the phylogenetic tree;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta_t</code></td>
<td>
<p>vector of pairwise trait differences (higher - lower);</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>trait matching function: either "normal" or "shiftlnorm";</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>width parameter of trait matching function, similar to sd in the normal;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shift</code></td>
<td>
<p>shift parameter (optimum trait distance), currently ignored in fitting;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>err</code></td>
<td>
<p>"baseline" probability of match, even if traits do not match at all;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>
<p>parameter vector with setting for tapnet simulation;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of latent trait linear combination parameters (lower level);</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>number of latent trait linear combination parameters (higher level);</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.delta</code></td>
<td>
<p>logical; should the trait-weighting exponent delta be fitted?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>networks</code></td>
<td>
<p>the "networks" part of a tapnet object;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tmatch_type_pem</code></td>
<td>
<p>type of trait matching function for latent traits;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tmatch_type_obs</code></td>
<td>
<p>type(s) of trait matching functions for observed traits; can be a vector as long as there are traits;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>LASSO shrinkage parameter to avoid collinearity issues when observed traits are phylogenetically correlated;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obj_function</code></td>
<td>
<p>objective function, either "multinom" or anything else (currently anything else leads to OLS fitting);</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>true_pars</code></td>
<td>
<p>parameters used for simulating the network;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted_pars</code></td>
<td>
<p>parameters estimated by <code>fit_tapnet</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pems_low</code></td>
<td>
<p>phylogenetic eigenvectors for the lower trophic level;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pems_high</code></td>
<td>
<p>phylogenetic eigenvectors for the higher trophic level;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>web</code></td>
<td>
<p>data for an interaction network in vector form, e.g. from predict_tapnet;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>web_dim</code></td>
<td>
<p>vector of two numbers indicating the rows and column of the network matrix;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indices</code></td>
<td>
<p>vector of names of network indices to compute; see <code>networklevel</code> for what is available;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tapnet</code></td>
<td>
<p>a tapnet object;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>a fitted tapnet;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted_I_mat</code></td>
<td>
<p>the fitted I-matrix of a fitted tapnet object (I think).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>They do roughly the following: 
</p>

<dl>
<dt><code>pems_from_tree</code></dt>
<dd>
<p>computes phylogenetic eigenvectors from a phylogenetic tree;</p>
</dd>
<dt><code>select_relevant_pems</code></dt>
<dd>
<p>identifies those phylogenetic eigenvectors (PEMs) of the full tree most relevant for a network containing only a subset of species;</p>
</dd>
<dt><code>tmatch</code></dt>
<dd>
<p>calculates interaction probabilities based on trait matching;</p>
</dd>
<dt><code>param_vec2list</code></dt>
<dd>
<p>converts a vector of parameters (for trait matching and latent trait combinations) into a named list;</p>
</dd>
<dt><code>loglik_tapnet</code></dt>
<dd>
<p>the log-likelihood function for fitting the tapnet model; actually quite an important function, easy to break, so not for the user to easily access;</p>
</dd>
<dt><code>latent_cor</code></dt>
<dd>
<p>computes correlation of fitted latent with true constructed traits for simulated data;</p>
</dd>
<dt><code>web_indices</code></dt>
<dd>
<p>computes the specified network indices for the provided network, after turning the prediction vector into a matrix;</p>
</dd>
<dt><code>refit_params</code></dt>
<dd>
<p>Simulate new networks from a fitted tapnet object, re-fit on the simulated network and output the parameter values.</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Gita Benadi &lt;gita.benadi@biom.uni-freiburg.de&gt;, Carsten Dormann &lt;carsten.dormann@biom.uni-freiburg.de&gt; and Jochen Fr√ºnd &lt;jochen.fruend@biom.uni-freiburg.de&gt;
</p>


<h3>References</h3>

<p>Benadi et al. in prep
</p>


</div>