<div class="container">

<table style="width: 100%;"><tr>
<td>predictTensorBF</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Predict Missing Values using the Bayesian tensor factorization model</h2>

<h3>Description</h3>

<p><code>predictTensorBF</code> predicts the missing values in the data <code>Y</code> using the learned model <code>res</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">predictTensorBF(Y, res)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>is a 3-mode tensor containing missing values as NA's. See function <code>tensorBF</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res</code></td>
<td>
<p>the model object returned by the function <code>tensorBF</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If the original data <code>Y</code> contained missing values (NA's),
this function predicts them using the model. The predictions are
returned in the un-normalized space if <code>res$pre</code> contains appropriate
preprocessing information.
</p>


<h3>Value</h3>

<p>A tensor of the same size as <code>Y</code> containing predicted values in place of NA's.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Data generation
## Not run: K &lt;- 2
## Not run: X &lt;- matrix(rnorm(20*K),20,K)
## Not run: W &lt;- matrix(rnorm(30*K),30,K)
## Not run: U &lt;- matrix(rnorm(3*K),3,K)
## Not run: Y = 0
## Not run: for(k in 1:K) Y &lt;- Y + outer(outer(X[,k],W[,k]),U[,k])
## Not run:  Y &lt;- Y + array(rnorm(20*30*3,0,0.25),dim=c(20,30,3))

#insert missing values
## Not run: m.inds = sample(prod(dim(Y)),100)
## Not run: Yobs = Y[m.inds]
## Not run: Y[m.inds] = NA

#Run the method with default options and predict missing values
## Not run: res &lt;- tensorBF(Y)
## Not run: pred = predictTensorBF(Y=Y,res=res)
## Not run: plot(Yobs,pred[m.inds],xlab="obs",ylab="pred",main=round(cor(Yobs,pred[m.inds]),2))
</code></pre>


</div>