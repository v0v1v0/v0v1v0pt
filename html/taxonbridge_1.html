<div class="container">

<table style="width: 100%;"><tr>
<td>annotate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Annotate a custom taxonomy</h2>

<h3>Description</h3>

<p>Annotate a custom taxonomy
</p>


<h3>Usage</h3>

<pre><code class="language-R">annotate(x, names, new_column, present = "1", absent = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A tibble with taxonomic data to be annotated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>names</code></td>
<td>
<p>A character vector containing scientific names that will be matched to scientific names in <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>new_column</code></td>
<td>
<p>A string to be the name of a new column that will contain annotations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>present</code></td>
<td>
<p>A string with the annotation in the case of a match (Defaults to "1").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>absent</code></td>
<td>
<p>A string with the annotation in case of no match (Defaults to NA).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This method takes as input a character vector with scientific names. If the
scientific name(s) in the vector match with scientific names in the tibble, a new
column will be created and an annotation of choice will be added to the relevant row
in the new column. This method is useful for annotating scientific names with identified
ambiguity, duplication or any other characteristic. The character vector could, for example,
even contain scientific names that have not been derived with a Taxonbridge method.
</p>


<h3>Value</h3>

<p>A tibble that contains an additional column with annotations.
</p>


<h3>Examples</h3>

<pre><code class="language-R">sample &lt;- load_sample()
lineages &lt;- get_lineages(sample)
kingdom &lt;- get_validity(lineages, rank = "kingdom", valid = FALSE)
family &lt;- get_validity(lineages, rank = "family", valid = FALSE)
candidates &lt;- list(kingdom, family)
binomials &lt;- get_inconsistencies(candidates, uninomials = FALSE, set = "intersect")
x &lt;- annotate(sample, binomials, new_column = "inconsistencies", "Accepted but ambigious")
x[!is.na(x$inconsistencies),c("inconsistencies")]
</code></pre>


</div>