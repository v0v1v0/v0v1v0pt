<div class="container">

<table style="width: 100%;"><tr>
<td>tensorBF</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bayesian Factorization of a Tensor</h2>

<h3>Description</h3>

<p><code>tensorBF</code> implements the Bayesian factorization of a tensor.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tensorBF(Y, method = "CP", K = NULL, opts = NULL,
  fiberCentering = NULL, slabScaling = NULL, noiseProp = c(0.5, 0.5))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>is a three-mode tensor to be factorized.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the factorization method. Currently only "CP" (default) is supported.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>The number of components (i.e. latent variables or factors). Recommended to be
set somewhat higher than the expected component number, so that the method
can determine the model complexity by prunning excessive components
(default: 20% of the sum of lower two dimensions).
High values result in high CPU time.
</p>
<p>NOTE: Adjust parameter noiseProp if sufficiently
large values of K do not lead to a model with pruned components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opts</code></td>
<td>
<p>List of model options; see function <code>getDefaultOpts</code> for details and default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fiberCentering</code></td>
<td>
<p>the mode for which fibers are to be centered at zero (default = NULL).
Fiber is analogous to a vector in a particular mode.
Fiber centering and Slab scaling are the recommended normalizations for a tensor.
For details see the provided normalization functions and the references therein.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slabScaling</code></td>
<td>
<p>the mode for which slabs are to be scaled to unit variance (default = NULL).
Slab is analogous to a matrix in a particular mode.
Alternativly, you can preprocess the data using the provided normalization functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noiseProp</code></td>
<td>
<p>c(prop,conf); sets an informative noise prior for tensorBF.
The model sets the noise prior such that the expected proportion of
variance explained by noise is defined by this parameter. It is recommended when
the standard prior from <code>getDefaultOpts</code> seems to overfit the model
by not prunning any component with high initial K. Use NULL to switch off
informative noise prior.
</p>
<p>- prop defines the proportion of total variance to be explained by noise (between 0.1 and 0.9),
</p>
<p>- conf defines the confidence in the prior (between 0.1 and 10).
</p>
<p>We suggest a default value of c(0.5,0.5) for real data sets.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Bayesian Tensor Factorization performs tri-linear (CP) factorization of a tensor.
The method automatically identifies the number of components,
given K is initialized to a large enough value, see arguments.
Missing values are supported and should be set as NA's in the data.
They will not affect the model parameters, and can be predicted
with function <code>predictTensorBF</code>, based on the observed values.
</p>


<h3>Value</h3>

<p>A list containing model parameters.
For key parameters, the final posterior sample ordered w.r.t. component variance is provided to aid in
initial checks; all the posterior samples should be used for model
analysis. The list elements are:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>The number of learned components. If this value is not less then the input argument K, the model should be rerun with a larger K or use the noiseProp parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a matrix of <code class="reqn">N \times K</code> dimensions, containing the last Gibbs sample of the first-mode latent variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>
<p>a matrix of <code class="reqn">D \times K</code> dimensions, containing the last Gibbs sample of the second-mode latent variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>U</code></td>
<td>
<p>a matrix of <code class="reqn">L \times K</code> dimensions, containing the last Gibbs sample of the third-mode latent variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>The last sample of noise precision.</p>
</td>
</tr>
</table>
<p>and the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>posterior</code></td>
<td>
<p>the posterior samples of model parameters (X,U,W,Z,tau).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cost</code></td>
<td>
<p>The likelihood of all the posterior samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opts</code></td>
<td>
<p>The options used to run the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conv</code></td>
<td>
<p>An estimate of the convergence of the model, based on reconstruction
of data using the Geweke diagnostic. Values significantly above 0.05 occur when
model has not converged and should therefore be rerun with a higher value of iter.burnin in <code>getDefaultOpts</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pre</code></td>
<td>
<p>A list of centering and scaling values used to transform the data, if any. Else an empty list.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">#Data generation
K &lt;- 2
X &lt;- matrix(rnorm(20*K),20,K)
W &lt;- matrix(rnorm(25*K),25,K)
U &lt;- matrix(rnorm(3*K),3,K)
Y = 0
for(k in 1:K) Y &lt;- Y + outer(outer(X[,k],W[,k]),U[,k])
 Y &lt;- Y + array(rnorm(20*25*3,0,0.25),dim=c(20,25,3))

#Run the method with default options
## Not run: res2 &lt;- tensorBF(Y=Y)

#Run the method with K=3 and iterations=1000
## Not run: opts &lt;- getDefaultOpts(); opts$iter.burnin = 1000
## Not run: res1 &lt;- tensorBF(Y=Y,K=3,opts=opts)

#Vary the user defined expected proportion of noise variance
#explained. c(0.2,1) represents 0.2 as the noise proportion
#and confidence of 1
## Not run: res3 &lt;- tensorBF(Y=Y,noiseProp=c(0.2,1))

</code></pre>


</div>