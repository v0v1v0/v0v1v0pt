<div class="container">

<table style="width: 100%;"><tr>
<td>clean_dup_by_date</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function to thin occurrence data
Cleans up duplicated longitude and latitude data by year using a specified
distance threshold. The distance can be specified as a geographic distance
or, if a raster_mask is provided, as a pixel distance.</h2>

<h3>Description</h3>

<p>Function to thin occurrence data
Cleans up duplicated longitude and latitude data by year using a specified
distance threshold. The distance can be specified as a geographic distance
or, if a raster_mask is provided, as a pixel distance.
</p>


<h3>Usage</h3>

<pre><code class="language-R">clean_dup_by_date(
  this_species,
  threshold,
  by_mask = FALSE,
  raster_mask = NULL,
  n_ngbs = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>this_species</code></td>
<td>
<p>An object of class sp.temporal.modeling representing
species occurrence data organized by date.
See <code>sp_temporal_data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>A numeric value representing the distance threshold between
coordinates to be considered duplicates. Units depend on whether
<code>by_mask</code> is <code>TRUE</code> or <code>FALSE</code>. If <code>TRUE</code>, the user needs
to specify the number of pixels that define the neighborhood of duplicates
(see n_ngbs parameter).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by_mask</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the thinning process will use a
raster layer as a mask for defining distance in pixel units.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>raster_mask</code></td>
<td>
<p>An object of class SpatRaster that serves as a reference
to thin the occurrence data. Required if <code>by_mask</code> is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_ngbs</code></td>
<td>
<p>Number of pixels used to define the neighborhood matrix that
helps determine which occurrences are duplicates:
</p>

<ul>
<li>
<p> 0 removes occurrences within the same pixel, keeping one.
</p>
</li>
<li>
<p> 1 considers duplicates all occurrences within a distance of one pixel.
</p>
</li>
<li>
<p> n considers duplicates all occurrences within a distance of n pixels.
</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is based on <code>clean_dup</code>. It cleans up
duplicated occurrences based on the specified threshold. If <code>by_mask</code>
is <code>TRUE</code>, the distance is interpreted as pixel distance using the provided
raster_mask; otherwise, it is interpreted as geographic distance.
</p>


<h3>Value</h3>

<p>An object of class sp.temporal.modeling containing a temporal
data.frame with cleaned occurrence data, including columns for
longitude, latitude, date variable, layers_dates, and layers_path.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(tenm)
data("abronia")
tempora_layers_dir &lt;- system.file("extdata/bio",package = "tenm")
tenm_mask &lt;- terra::rast(file.path(tempora_layers_dir,"1939/bio_01.tif"))
# Clean duplicates without raster mask (just by distance threshold)
abt &lt;- tenm::sp_temporal_data(occs = abronia,
                              longitude = "decimalLongitude",
                              latitude = "decimalLatitude",
                              sp_date_var = "year",
                              occ_date_format="y",
                              layers_date_format= "y",
                              layers_by_date_dir = tempora_layers_dir,
                              layers_ext="*.tif$")
abtc1 &lt;- tenm::clean_dup_by_date(abt,threshold = terra::res(tenm_mask)[1])
# Check number of records
print(nrow(abtc1$temporal_df))
# Clean duplicates using a raster mask
abtc2 &lt;- tenm::clean_dup_by_date(this_species = abt,
                                by_mask = TRUE,
                                threshold = terra::res(tenm_mask)[1],
                                raster_mask = tenm_mask,
                                n_ngbs = 0)
# Check number of records
print(nrow(abtc2$temporal_df))

abtc3 &lt;- tenm::clean_dup_by_date(this_species = abt,
                                by_mask = TRUE,
                                threshold = terra::res(tenm_mask)[1],
                                raster_mask = tenm_mask,
                                n_ngbs = 2)
# Check number of records
print(nrow(abtc3$temporal_df))
</code></pre>


</div>