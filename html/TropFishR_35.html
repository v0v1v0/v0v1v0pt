<div class="container">

<table style="width: 100%;"><tr>
<td>prod_mod_ts</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Production models with time series fitting</h2>

<h3>Description</h3>

<p>This function applies the production models under non-equilibrium
conditions by applying time series fitting using non-linear least squares
minimisation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">prod_mod_ts(
  data,
  method = "Schaefer",
  B0_init = NA,
  B0_est = NA,
  effort_unit = 1,
  plot = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a dataframe of parameters
</p>

<ul>
<li> <p><code>year</code> years,
</p>
</li>
<li> <p><code>yield</code> catch in weight of fishery per year,
</p>
</li>
<li> <p><code>effort</code> fishing effort per year,
</p>
</li>
<li> <p><code>CPUE</code> catch per unit of effort per year (optional).
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>indicating if Schaefer or Fox model should be applied. First assumes a
logistic relationship between growth rate and biomass, whereas second assumes it to
foolow the Gompertz distribution (Richards 1959). Default is the dynamic Schaefer model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B0_init</code></td>
<td>
<p>numeric; if realistic initial estimate for virgin biomass is available.
If NA initial estimate for virgin biomass is set to two times average yield of all
or part of yield values (see <code>B0_est</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B0_est</code></td>
<td>
<p>intital value of virgin biomass estimating using all yield values (NA) or
first years of time series, then provide numerical representing number of years</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effort_unit</code></td>
<td>
<p>multiplication factor for the unit of effort. Default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical; if TRUE (default) a graph is displayed</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Either catch per unit of effort (CPUE) is inserted
into the model directly (by a column <code>CPUE</code>) or CPUE is calculated from
the catch and effort, then these two vectors should have required units.
Whenever a good estimate for the virigin biomass is available, this estimate
should be inserted for <code>B_init</code>. The default approach for the initial
estimate of the virgin biomass is to multiply the average yield by 2 (Dharmendra
and Solmundsson, 2005). Alternatively, just a part of the time series of
yield values can be choosen to represent the virgin biomass.
The minimisation procedure is based on least error sum of squares (SSE). For
the logistic (Schaefer) method the standard calculation of SSE is applied
(<code>sum((CPUE - predicted CPUE)^2)</code>), for
the method with Gompertz distribution (Fox) SSE is calculated according to
the Thiel's U statistic <code>sqrt(sum(CPUE - predicted CPUE)/sum(CPUE(t) - CPUE(t-1)))</code>
(Wittink, 1988).
</p>


<h3>Value</h3>

<p>A list with the input parameters and following list objects:
</p>

<ul>
<li> <p><strong>Bvec</strong>: biomass vector,
</p>
</li>
<li> <p><strong>CPUE_hat</strong>: predicted CPUE,
</p>
</li>
<li> <p><strong>K</strong>: carrying capacity,
</p>
</li>
<li> <p><strong>r</strong>: population growth rate,
</p>
</li>
<li> <p><strong>q</strong>: catchability coefficient,
</p>
</li>
<li> <p><strong>MSY</strong>: maximum sustainabale yield (MSY),
</p>
</li>
<li> <p><strong>Bmsy</strong>: biomass at MSY,
</p>
</li>
<li> <p><strong>Emsy</strong>: fishing effort at MSY
</p>
</li>
<li> <p><strong>Fmsy</strong>: fishing mortality at MSY,
</p>
</li>
</ul>
<h3>References</h3>

<p>Dharmendra, D., Solmundsson, J., 2005. Stock assessment of the offshore Mauritian banks
using dynamic biomass models and analysis of length frequency of the Sky Emperor
(<em>Lethrinus mahsena</em>). Fisheries Training Program The United Nations University, 61
</p>
<p>Hilborn, R. and Walters, C., 1992. Quantitative Fisheries Stock Assessment: Choice,
Dynamics and Uncertainty. Chapman and Hall, New York
</p>
<p>Prager, M. H., 1994. A suite of extensions to a non-equilibrium surplus production
model. <em>Fishery Bulletin</em> 92: 374-389
</p>
<p>Richards, F. J., 1959. A flexible growth function for empirical use.
<em>Journal of experimental Botany</em>, 10(2), 290-301.
</p>
<p>Wittink, D. R., 1988. The application of regression analysis. Allyn and Bacon. Inc.
Boston. MA. 324p.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(emperor)
prod_mod_ts(emperor, method = "Schaefer")
prod_mod_ts(emperor, method = "Fox")

</code></pre>


</div>