<div class="container">

<table style="width: 100%;"><tr>
<td>kozak_di</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate the diameter at a given height based on a fitted Kozak (2004) taper equation.</h2>

<h3>Description</h3>

<p>Estimates the diameter at a given height of a tree from the diameter at breast height, total height and the coefficients of the Kozak (2004) taper function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">kozak_di(dbh, h, hi, coef, p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dbh</code></td>
<td>
<p>tree diameter at breast height, in centimeters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>total tree height, in meters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hi</code></td>
<td>
<p>height at which the diameter will be calculated, in meters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef</code></td>
<td>
<p>numerical vector containing nine coefficients of the Kozak taper function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>numerical value representing the first inflection point calculated in the segmented model of Max and Burkhart (1976).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>the Kozak (2004) variable-form taper function is represented mathematically by the following expression
</p>
<p>di ~b0*(dbh^b1)<em>(h^b2)</em>((1-(hi/h)^(1/4))/(1-(p^(1/3))))^(b3*(hi/h)^4+b4*(1/exp(dbh/h))+b5*((1-(hi/h)^(1/4))/(1-(p^(1/3))))^0.1+b6*(1/dbh)+b7*(h^(1-(hi/h)^(1/3)))+b8*((1-(hi/h)^(1/4))/(1-(p^(1/3)))))
</p>


<h3>Value</h3>

<p>a numeric value indicating the diameter at the given height.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(dplyr)
library(minpack.lm)
library(timbeR)

tree_scaling &lt;- tree_scaling %&gt;%
mutate(did = di/dbh,
       hih = hi/h)

kozak &lt;- nlsLM(di ~ taper_kozak(dbh, h, hih, b0, b1, b2, b3, b4, b5, b6, b7, b8, p),
               start=list(b0=1.00,b1=.97,b2=.03,b3=.49,b4=-
                            0.87,b5=0.50,b6=3.88,b7=0.03,b8=-0.19, p = .1),
               data = tree_scaling,
               control = nls.lm.control(maxiter = 1000, maxfev = 2000)
)

coef_kozak &lt;- coef(kozak)[-10]
p_kozak &lt;- coef(kozak)[10]

h &lt;- 20
dbh &lt;- 25
di &lt;- 5

kozak_di(dbh, h, di, coef_kozak, p_kozak)

</code></pre>


</div>