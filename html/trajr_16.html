<div class="container">

<table style="width: 100%;"><tr>
<td>TrajAcceleration</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Approximates the acceleration of a trajectory</h2>

<h3>Description</h3>

<p>Returns an approximation of the acceleration of a trajectory at each point
using the second-order central finite differences.
</p>


<h3>Usage</h3>

<pre><code class="language-R">TrajAcceleration(trj)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>trj</code></td>
<td>
<p>Trajectory whose acceleration is to be calculated.</p>
</td>
</tr></table>
<h3>Details</h3>

<p>'trajr' trajectories, which consist of straight line displacements between
sampled locations, do not contain enough information to correctly derive
velocity or acceleration. Since we have to assume a constant velocity at each
step, the first derivative is discontinuous. Acceleration, therefore, is zero
during each step and infinite at each change of velocity. The approximation
implemented by this function assumes that acceleration occurs over a period
of time: half the duration of the previous step plus half the duration of the
next step.
</p>


<h3>Value</h3>

<p>Vector of complex numbers. The modulus (<code>Mod(a)</code>) is the
magnitude of the acceleration at each point, and the argument
(<code>Arg(a)</code>) is the direction of the acceleration. The vector has an
attribute, <code>trj</code>, with the trajectory as its value. The first and last
values will always be <code>NA</code>, since acceleration cannot be estimated for
those points.
</p>


<h3>See Also</h3>

<p><code>TrajVelocity</code> for calculating velocity,
<code>TrajResampleTime</code> and <code>TrajRediscretize</code> to
resample a trajectory to fixed time or length steps.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># A function to plot acceleration as arrows (scaled in length)
AccArrows &lt;- function(acc, scale = .001, trj = attr(acc, "trj"), ...) {
  graphics::arrows(trj$x, trj$y, trj$x + Re(acc) * scale, trj$y + Im(acc) * scale, ...)
}

# Generate and plot a random trajectory
set.seed(101)
trj &lt;- TrajGenerate(30)
plot(trj)

# Calculate acceleration
acc &lt;- TrajAcceleration(trj)
# Plot acceleration as red arrows at each point. They need to be scaled down to
# fit in the plot, and the arrowhead lengths need to be shortened to look good
AccArrows(acc, scale = .001, col = "red", length = .1)

</code></pre>


</div>