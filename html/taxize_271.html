<div class="container">

<table style="width: 100%;"><tr>
<td>class2tree</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Convert a list of classifications to a tree.</h2>

<h3>Description</h3>

<p>This function converts a list of hierarchies for individual species into
a single species by taxonomic level matrix, then calculates a distance
matrix based on taxonomy alone, and outputs either a phylo or dist object.
See details for more information.
</p>


<h3>Usage</h3>

<pre><code class="language-R">class2tree(input, varstep = TRUE, check = TRUE, ...)

## S3 method for class 'classtree'
plot(x, ...)

## S3 method for class 'classtree'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>input</code></td>
<td>
<p>List of classification data.frame's from the function
<code>classification()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varstep</code></td>
<td>
<p>Vary step lengths between successive levels relative to
proportional loss of the number of distinct classes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check</code></td>
<td>
<p>If TRUE, remove all redundant levels which are different for
all rows or constant for all rows and regard each row as a different basal
taxon (species). If FALSE all levels are retained and basal taxa (species)
also must be coded as variables (columns). You will get a warning if
species are not coded, but you can ignore this if that was your intention.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed on to hclust.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Input object to print or plot - output from class2tree function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See <code>vegan::taxa2dist()</code>. Thanks to Jari Oksanen for
making the taxa2dist function and pointing it out, and Clarke &amp; Warwick
(1998, 2001), which taxa2dist was based on.
The taxonomy tree created is not only based on the clustering of the
taxonomy ranks (e.g. strain, species, genus, ...), but it also utilizes the
actual taxon clades (e.g. mammals, plants or reptiles, etc.). The process of
this function is as following: First, all possible taxonomy ranks and their
corresponding IDs for each given taxon will be collected from the input.
Then, the rank vectors of all taxa will be aligned, so that they together
will become a matrix where columns are ordered taxonomy ranks of all taxa and
rows are the rank vectors of those taxa. After that, the rank matrix will be
converted into taxonomy ID matrix, any missing rank will have a pseudo
ID from the previous rank. Finally, this taxonomy ID matrix will be used to
cluster taxa that have similar taxonomy hierarchy together.
</p>


<h3>Value</h3>

<p>An object of class "classtree" with slots:
</p>

<ul>
<li>
<p> phylo - The resulting object, a phylo object
</p>
</li>
<li>
<p> classification - The classification data.frame, with taxa as rows,
and different classification levels as columns
</p>
</li>
<li>
<p> distmat - Distance matrix
</p>
</li>
<li>
<p> names - The names of the tips of the phylogeny
</p>
</li>
</ul>
<p>Note that when you execute the resulting object, you only get the phylo
object. You can get to the other 3 slots by calling them directly, like
output$names, etc.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
spnames &lt;- c('Quercus robur', 'Iris oratoria', 'Arachis paraguariensis',
 'Helianthus annuus','Madia elegans','Lupinus albicaulis',
 'Pinus lambertiana')
out &lt;- classification(spnames, db='itis')
tr &lt;- class2tree(out)
plot(tr)

spnames &lt;- c('Klattia flava', 'Trollius sibiricus',
 'Arachis paraguariensis',
 'Tanacetum boreale', 'Gentiana yakushimensis','Sesamum schinzianum',
 'Pilea verrucosa','Tibouchina striphnocalyx','Lycium dasystemum',
 'Berkheya echinacea','Androcymbium villosum',
 'Helianthus annuus','Madia elegans','Lupinus albicaulis',
 'Pinus lambertiana')
out &lt;- classification(spnames, db='ncbi')
tr &lt;- class2tree(out)
plot(tr)

## End(Not run)

</code></pre>


</div>