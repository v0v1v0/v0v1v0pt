<div class="container">

<table style="width: 100%;"><tr>
<td>TBR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Tree bisection and reconnection (TBR)</h2>

<h3>Description</h3>

<p><code>TBR</code> performs a single random <abbr><span class="acronym">TBR</span></abbr> iteration.
</p>


<h3>Usage</h3>

<pre><code class="language-R">TBR(tree, edgeToBreak = NULL, mergeEdges = NULL)

TBRMoves(tree, edgeToBreak = integer(0))

## S3 method for class 'phylo'
TBRMoves(tree, edgeToBreak = integer(0))

## S3 method for class 'matrix'
TBRMoves(tree, edgeToBreak = integer(0))

TBRSwap(
  parent,
  child,
  nEdge = length(parent),
  edgeToBreak = NULL,
  mergeEdges = NULL
)

RootedTBR(tree, edgeToBreak = NULL, mergeEdges = NULL)

RootedTBRSwap(
  parent,
  child,
  nEdge = length(parent),
  edgeToBreak = NULL,
  mergeEdges = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>A bifurcating tree of class <code>phylo</code>, with all nodes resolved;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edgeToBreak</code></td>
<td>
<p>(optional) integer specifying the index of an edge to bisect/prune,
generated randomly if not specified.
Alternatively, set to <code>-1</code> to return a complete list
of all trees one step from the input tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mergeEdges</code></td>
<td>
<p>(optional) vector of length 1 or 2, listing edge(s) to be joined:
In SPR, this is where the pruned subtree will be reconnected.
In TBR, these edges will be reconnected (so must be on opposite
sides of <code>edgeToBreak</code>); if only a single edge is specified,
the second will be chosen at random</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parent</code></td>
<td>
<p>Integer vector corresponding to the first column of the edge
matrix of a tree of class <code>phylo</code>, i.e. <code>tree$edge[, 1]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>child</code></td>
<td>
<p>Integer vector corresponding to the second column of the edge
matrix of a tree of class <code>phylo</code>, i.e. <code>tree$edge[, 2]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nEdge</code></td>
<td>
<p>(optional) Number of edges.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Branch lengths are not (yet) supported.
</p>
<p>All nodes in a tree must be bifurcating; ape::collapse.singles and
ape::multi2di may help.
</p>


<h3>Value</h3>

<p><code>TBR()</code> returns a tree in <code>phyDat</code> format that has undergone one
<abbr><span class="acronym">TBR</span></abbr> iteration.
</p>
<p><code>TBRMoves()</code> returns a <code>multiPhylo</code> object listing all trees one
<abbr><span class="acronym">TBR</span></abbr> move away from <code>tree</code>, with edges and nodes in preorder,
rooted on the first-labelled tip.
</p>
<p><code>TBRSwap()</code> returns a list containing two elements corresponding
to the rearranged <code>parent</code> and <code>child</code> parameters.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>TBRSwap()</code>: faster version that takes and returns parent and child
parameters
</p>
</li>
<li> <p><code>RootedTBR()</code>: Perform <abbr><span class="acronym">TBR</span></abbr> rearrangement, retaining position of root
</p>
</li>
<li> <p><code>RootedTBRSwap()</code>: faster version that takes and returns parent and child parameters
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p><a href="https://smithlabdurham.github.io/">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>


<h3>References</h3>

<p>The <abbr><span class="acronym">TBR</span></abbr> algorithm is summarized in
Felsenstein J (2004).
<em>Inferring phylogenies</em>.
Sinauer Associates, Sunderland, Massachusetts.
</p>


<h3>See Also</h3>

<p><code>RootedTBR()</code>: useful when the position of the root node should be retained.
</p>
<p>Other tree rearrangement functions: 
<code>NNI()</code>,
<code>SPR()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library("ape")
tree &lt;- rtree(20, br=NULL)
TBR(tree)
</code></pre>


</div>