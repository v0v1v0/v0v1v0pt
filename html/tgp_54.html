<div class="container">

<table style="width: 100%;"><tr>
<td>tgp.design</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Sequential Treed D-Optimal Design for Treed Gaussian Process Models </h2>

<h3>Description</h3>

<p>Based on the maximum a' posteriori (MAP)
treed partition extracted from a <code>"tgp"</code>-class object,
calculate independent sequential treed D-Optimal designs in each of the regions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tgp.design(howmany, Xcand, out, iter = 5000, verb = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>howmany</code></td>
<td>
<p>Number of new points in the design. Must
be less than the number of candidates contained in
<code>Xcand</code>, i.e., <code>howmany &lt;= nrow(Xcand)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xcand</code></td>
<td>
 <p><code>data.frame</code>, <code>matrix</code> or vector of candidates 
from which new design points are subsampled.  Must have
<code>nrow(Xcand) == nrow(out$X)</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out</code></td>
<td>
 <p><code>"tgp"</code>-class object output from one of the
model functions which has tree support, e.g., <code>btgpllm</code>,
<code>btgp</code>, <code>btlm</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>number of iterations of stochastic accent algorithm,
default <code>5000</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verb</code></td>
<td>
<p>positive integer indicating after how many rounds of
stochastic approximation in <code>dopt.gp</code>
to print each progress statement;
default <code>verb=0</code> results in no printing</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function partitions <code>Xcand</code> and <code>out$X</code> based on
the MAP tree (obtained on <code>"tgp"</code>-class <code>out</code> with
<code>partition</code>) and calls
<code>dopt.gp</code> in order to obtain a D-optimal design under
independent stationary Gaussian processes models defined in each
region.  The aim is to obtain a design where new points from <code>Xcand</code>
are spaced out relative to themselves, and relative to
the existing locations (<code>out$X</code>) in the region.
The number of new points from each region of the partition is
proportional to the number of candidates <code>Xcand</code> in the region.
</p>


<h3>Value</h3>

<p>Output is a list of <code>data.frame</code>s containing <code>XX</code> design
points for each region of the MAP tree in <code>out</code>
</p>


<h3>Note</h3>

<p>Input <code>Xcand</code> containing <code>NaN, NA, Inf</code> are discarded with non-fatal
warnings
</p>
<p>D-Optimal computation in each region is preceded by a print statement
indicated the number of new locations to be chosen and the number of candidates
in the region.  Other than that, there are no other indicators of progress.
You will have to be patient.
Creating treed sequential D-optimal designs is no speedy task.  At least it 
faster than the non-treed version (see <code>dopt.gp</code>).
</p>
<p>The example below is also part of <code>vignette("tgp")</code>.
Please see <code>vignette("tgp2")</code> for a similar example based on
optimization using the <code>optim.step.tgp</code> 
</p>


<h3>Author(s)</h3>

 
<p>Robert B. Gramacy, <a href="mailto:rbg@vt.edu">rbg@vt.edu</a>, and
Matt Taddy, <a href="mailto:mataddy@amazon.com">mataddy@amazon.com</a>
</p>


<h3>References</h3>

<p>Gramacy, R. B. (2020) <em>Surrogates: Gaussian Process Modeling,
Design and Optimization for the Applied Sciences</em>. Boca Raton,
Florida: Chapman Hall/CRC.  (See Chapter 9.)
<a href="https://bobby.gramacy.com/surrogates/">https://bobby.gramacy.com/surrogates/</a>
</p>
<p>Gramacy, R. B. (2007). <em><span class="pkg">tgp</span>: An <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> Package for Bayesian
Nonstationary, Semiparametric Nonlinear Regression and Design by
Treed Gaussian Process Models.</em> Journal of Statistical Software, <b>19</b>(9).
<a href="https://www.jstatsoft.org/v19/i09">https://www.jstatsoft.org/v19/i09</a>
<a href="https://doi.org/10.18637/jss.v019.i09">doi:10.18637/jss.v019.i09</a>
</p>
<p>Robert B. Gramacy, Matthew Taddy (2010). <em>Categorical Inputs,
Sensitivity Analysis, Optimization and Importance Tempering with <span class="pkg">tgp</span>
Version 2, an <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> Package for Treed Gaussian Process Models.</em>
Journal of Statistical Software, <b>33</b>(6), 1–48.
<a href="https://www.jstatsoft.org/v33/i06/">https://www.jstatsoft.org/v33/i06/</a>
<a href="https://doi.org/10.18637/jss.v033.i06">doi:10.18637/jss.v033.i06</a>
</p>
<p>Gramacy, R. B., Lee, H. K. H. (2006).
<em>Adaptive design and analysis of supercomputer experiments.</em>
Technometrics, 51(2), pp. 130-145.  Also avaliable on ArXiv article 0805.4359
<a href="https://arxiv.org/abs/0805.4359">https://arxiv.org/abs/0805.4359</a>
</p>
<p>Gramacy, R. B., Lee, H. K. H., &amp; Macready, W. (2004).
<em>Parameter space exploration with Gaussian process trees.</em> 
ICML (pp. 353–360).  Omnipress &amp; ACM Digital Library.
</p>
<p><a href="https://bobby.gramacy.com/r_packages/tgp/">https://bobby.gramacy.com/r_packages/tgp/</a>
</p>


<h3>See Also</h3>

 <p><code>bgpllm</code>, <code>btlm</code>, <code>blm</code>, 
<code>bgp</code>, <code>btgpllm</code>, <code>plot.tgp</code>, 
<code>dopt.gp</code>, <code>lhs</code>,
<code>partition</code>, <code>optim.step.tgp</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
#
# 2-d Exponential data
# (This example is based on random data.  
# It might be fun to run it a few times)
#

# get the data
exp2d.data &lt;- exp2d.rand()
X &lt;- exp2d.data$X; Z &lt;- exp2d.data$Z
Xcand &lt;- exp2d.data$XX

# fit treed GP LLM model to data w/o prediction
# basically just to get MAP tree (and plot it)
out &lt;- btgpllm(X=X, Z=Z, pred.n=FALSE, corr="exp")
tgp.trees(out)

# find a treed sequential D-Optimal design 
# with 10 more points.  It is interesting to 
# contrast this design with one obtained via
# the dopt.gp function
XX &lt;- tgp.design(10, Xcand, out)

# now fit the model again in order to assess
# the predictive surface at those new design points
dout &lt;- btgpllm(X=X, Z=Z, XX=XX, corr="exp")
plot(dout)

</code></pre>


</div>