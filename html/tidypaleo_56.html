<div class="container">

<table style="width: 100%;"><tr>
<td>nested_hclust</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Nested (Constrained) hierarchical clustering</h2>

<h3>Description</h3>

<p>Powered by chclust and hclust; broken stick using bstick.
</p>


<h3>Usage</h3>

<pre><code class="language-R">nested_hclust(
  .data,
  data_column = "data",
  qualifiers_column = "qualifiers",
  distance_fun = stats::dist,
  n_groups = NULL,
  ...,
  .fun = stats::hclust,
  .reserved_names = character(0)
)

nested_chclust_conslink(
  .data,
  data_column = "data",
  qualifiers_column = "qualifiers",
  distance_fun = stats::dist,
  n_groups = NULL,
  ...
)

nested_chclust_coniss(
  .data,
  data_column = "data",
  qualifiers_column = "qualifiers",
  distance_fun = stats::dist,
  n_groups = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>.data</code></td>
<td>
<p>A data frame with a list column of data frames, possibly created using
nested_data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data_column</code></td>
<td>
<p>An expression that evalulates to the data object within each row of .data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qualifiers_column</code></td>
<td>
<p>The column that contains the qualifiers</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance_fun</code></td>
<td>
<p>A distance function like dist or vegdist.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_groups</code></td>
<td>
<p>The number of groups to use (can be a vector or expression using vars in .data)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Passed to chclust or hclust.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.fun</code></td>
<td>
<p>Function powering the clustering. Must return an hclust object of some kind.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.reserved_names</code></td>
<td>
<p>Names that should not be allowed as columns in any
data frame within this object</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>.data</code> with additional columns
</p>


<h3>References</h3>

<p>Bennett, K. (1996) Determination of the number of zones in a biostratigraphic sequence.
New Phytologist, 132, 155-170.
<a href="https://doi.org/10.1111/j.1469-8137.1996.tb04521.x">doi:10.1111/j.1469-8137.1996.tb04521.x</a> (Broken stick)
</p>
<p>Grimm, E.C. (1987) CONISS: A FORTRAN 77 program for stratigraphically constrained cluster
analysis by the method of incremental sum of squares. Computers &amp; Geosciences, 13, 13-35.
<a href="https://doi.org/10.1016/0098-3004%2887%2990022-7">doi:10.1016/0098-3004(87)90022-7</a>
</p>
<p>Juggins, S. (2017) rioja: Analysis of Quaternary Science Data, R package version (0.9-15.1).
(<a href="https://cran.r-project.org/package=rioja">https://cran.r-project.org/package=rioja</a>).
</p>
<p>See hclust for hierarchical clustering references
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(tidyr)
library(dplyr, warn.conflicts = FALSE)

nested_coniss &lt;- keji_lakes_plottable %&gt;%
  group_by(location) %&gt;%
  nested_data(depth, taxon, rel_abund, fill = 0) %&gt;%
  nested_chclust_coniss()

# plot the dendrograms using base graphics
plot(nested_coniss, main = location, ncol = 1)

# plot broken stick dispersion to verify number of plausible groups
library(ggplot2)

nested_coniss %&gt;%
  select(location, broken_stick) %&gt;%
  unnest(broken_stick) %&gt;%
  tidyr::gather(type, value, broken_stick_dispersion, dispersion) %&gt;%
  ggplot(aes(x = n_groups, y = value, col = type)) +
  geom_line() +
  geom_point() +
  facet_wrap(vars(location))

</code></pre>


</div>