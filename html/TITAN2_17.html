<div class="container">

<table style="width: 100%;"><tr>
<td>plot-cps</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plots probability densities of empirical distributions of bootstrapped change
points</h2>

<h3>Description</h3>

<p>This function allows more detailed exploration of taxon-specific response
documented by TITAN through analysis of empirical distributions of
bootstrapped change points, comparison of those distributions with observed
counts, and aggregate (optionally weighted) summaries of those distributions
across taxa.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_cps(
  titan.out,
  taxa.dist = T,
  z.weights = T,
  taxaID = NULL,
  cp.med = F,
  cp.trace = F,
  cp.hist = T,
  stacked = F,
  xlabel = "Environmental Gradient",
  xmin = min(titan.out$env),
  xmax = max(titan.out$envcls) * 1.25,
  tck = 0.025,
  bty = "u",
  ntick = 6,
  cex = 1.75,
  cex.axis = 1.75,
  cex.leg = 1.5,
  cex.lab = 1.75,
  write = F,
  leg.x = 0.8,
  leg.y = 0.8,
  leg = TRUE,
  ...
)

plotCPs(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>titan.out</code></td>
<td>
<p>A TITAN output object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taxa.dist</code></td>
<td>
<p>A logical specifying whether taxon-specific distributions
should be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z.weights</code></td>
<td>
<p>A logical specifying whether taxon-specific or aggregate
community distributions should be weighted by their median z scores (median
of z-score maxima values across bootstrap replicates).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taxaID</code></td>
<td>
<p>An index specifying whether a particular taxon should be
targeted for plotting. A 'NULL' value indicates all taxa should be plotted.
Values &gt;0 will select pure and reliabile taxa by their row number within
the 'sppmax' output table. Character strings may also be used corresponding
to the row name within the 'sppmax' output table.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cp.med</code></td>
<td>
<p>A logical specifying whether change point locations should be
plotted using the median value across all bootstrap replicates instead of
the observed value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cp.trace</code></td>
<td>
<p>A logical specifying whether IndVals and z scores across all
candidate change points should be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cp.hist</code></td>
<td>
<p>A logical specifying whether histograms of replicate change
point PDFs should be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stacked</code></td>
<td>
<p>A logical specifying whether community level aggregations of
change point PDFs are stacked or plotted separately.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlabel</code></td>
<td>
<p>A character string for the x axis label.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xmin</code></td>
<td>
<p>A graphical argument specifying the value of the x axis minimum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xmax</code></td>
<td>
<p>A graphical argument specifying the value of the x axis maximum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tck</code></td>
<td>
<p>A graphical argument specifying the scale of axis tick marks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bty</code></td>
<td>
<p>A graphical argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntick</code></td>
<td>
<p>A graphical argument specifying the default number of axis tick
marks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p>A graphical argument specifying the scaling of the figure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.axis</code></td>
<td>
<p>A graphical argument specifying the scaling of the axes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.leg</code></td>
<td>
<p>A graphical argument specifying the scaling of the legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.lab</code></td>
<td>
<p>A graphical argument specifying the scaling of the lables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>write</code></td>
<td>
<p>A logical specifying whether taxa subsets are written to screen.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leg.x</code></td>
<td>
<p>A graphical argument specifying the x coordinate of the legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leg.y</code></td>
<td>
<p>A graphical argument specifying the y coordinate of the legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leg</code></td>
<td>
<p>A logical specifying whether or not to plot the legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>An argument for passing generic plotting function parameters.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Following the intitial (v1.0) TITAN publications, it was clear that
substantial information regarding taxon-specific change points was lost when
bootstrapped distributions were represented solely as quantiles (i.e., as in
<code>plot_taxa()</code> and the 'sppmax' output table).  Empirical probability densities
allow greater detail and more nuanced interpretation associated with this
uncertainty, especially when compared against observed abundance and
occurrence.  Further, comparison of the summed probability densities and the
filtered sum(z) plots with the default sum(z) output provides additional
support of community changes consistent with threshold behavior.
</p>


<h3>Value</h3>

<p>Three types of plots are possible outcomes of this function.  The
first (taxa.dist=T, taxID=NULL) is a matrix of histograms showing empirical
distributions of bootstrapped change-point locations (as probability
densities) for all pure and reliable taxa.  The value of the probability
densities can be weighted by the median z score for each taxon
(z.weights=T). The second plot (taxa.dist=T, taxID&gt;0 or a taxon label)
overlays a taxon-specific histogram on an abundance scatter plot and the
observed change-point location.  The third plot (taxa.dist=F) shows the sum
of probability densities across all pure and reliable taxa, optionally
weighted by median z scores (z.weights=T) or stacked (stacked=T).
</p>


<h3>Note</h3>

<p>Should not be used with output objects from TITAN v1.0.
</p>


<h3>Author(s)</h3>

<p>M. Baker and R. King
</p>


<h3>References</h3>

<p>Baker, ME and RS King.  2010. A new method for detecting and
interpreting biodiversity and ecological community thresholds.  Methods in
Ecology and Evolution 1(1): 25:37.
</p>
<p>King, RS and ME Baker  2010. Considerations for identifying and
interpreting ecological community thresholds. Journal of the North American
Benthological Association 29(3):998-1008.
</p>


<h3>See Also</h3>

<p><code>plot_taxa()</code>, <code>plot_sumz()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(glades.titan)
plot_cps(glades.titan,
  taxa.dist = FALSE,
  xlabel = "Surface Water TP (ug/l)",
  stacked = TRUE
)

</code></pre>


</div>