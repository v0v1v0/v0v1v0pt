<div class="container">

<table style="width: 100%;"><tr>
<td>fmri_ROI_phase1</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>p-values on region of interest(ROI) of the brain</h2>

<h3>Description</h3>

<p>This function takes a 4 dimensional real-valued fMRI data and calculates p-values for the ROIs individually to test whether the ROI is potentially activated.
It is the first phase of a ROI 3-phase analysis and usually followed by second phase analysis <code>fmri_ROI_phase2</code> .
</p>


<h3>Usage</h3>

<pre><code class="language-R">fmri_ROI_phase1(
  fmridata,
  label_mask = NULL,
  label_dict = NULL,
  stimulus_idx = NULL,
  rest_idx = NULL,
  p_threshold = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fmridata</code></td>
<td>
<p>a 4d array which contains the spatial and temporal record of fmri data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label_mask</code></td>
<td>
<p>a 3D nifti or 3D array of data to indicates the corresponding indices of the ROIs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label_dict</code></td>
<td>
<p>a dataframe which contains the name of ROIs and their corresponding index</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stimulus_idx</code></td>
<td>
<p>a vector that specifies when motion happens</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rest_idx</code></td>
<td>
<p>a vector that specifies when study participant does not move</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_threshold</code></td>
<td>
<p>NULL or a numeric value that can be selected randomly below 0.05 to drop all p-values above the threshold.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>fmri_ROI_phase1</code> is used to calculate p-values of ROIs for a given real-valued fmridata. It first takes in the fmridata and corresponding mask. 
For a fixed region, the function will first compute Temporal Contrast-to-noise Ratio (tCNR) for each voxel in that region, which is the mean of 80 paired differences in intensity for "on" and "off" states divided by its standard deviation. Second, it will conduct t-test on all tCNRs of a fixed region to see there are significant changes for the ROI during the on and off period. Finally, it will use bonferroni correction to control significant level and select the ROIs with p-values under the significant level to enter next phase analysis.
</p>


<h3>Value</h3>

<p>a list of two elements
</p>

<ul>
<li>
<p> all_ROI - the test result for all ROIs
</p>
</li>
<li>
<p> sign_ROI - the test result for significant ROIs
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>SOCR team &lt;<a href="http://socr.umich.edu/people/">http://socr.umich.edu/people/</a>&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R">fmri_generate = fmri_simulate_func(dim_data = c(64, 64, 40), mask = mask)
# p-values for phase 1

result = fmri_ROI_phase1(fmri_generate$fmri_data, mask_label,
                          mask_dict, stimulus_idx = fmri_generate$on_time)

</code></pre>


</div>