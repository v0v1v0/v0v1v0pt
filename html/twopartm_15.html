<div class="container">

<table style="width: 100%;"><tr>
<td>residuals-methods</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Method for Function <code>residuals</code> for Two-part Model Objects in Package <span class="pkg">twopartm</span>
</h2>

<h3>Description</h3>

<p>The <code>residuals</code> method for <code>twopartm-class</code> that extracts model residuals from a fitted two-part regression model object of class <code>twopartm</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'twopartm'
residuals(object,model = c("tpm","model1","model2"),
type = c("deviance", "pearson", "working","response", "partial"))

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>a fitted two-part model object of class <code>twopartm</code> as returned by <code>tpm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>character specifying for which part of the model the residuals should be extracted. It could be either “tpm” for the full two-part model, or “model1”, “model2” for the first-part model and the second-part model respectively.The default is “tpm”.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>if <code>model == "model1" | "model2"</code>, the type of residuals which should be returned. The alternatives are: “response” (default), “pearson”, “working”, “deviance”, and “partial”. Can be abbreviated.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>residuals</code> method for <code>twopartm-class</code> can compute raw response residuals (observed - fitted) for the full two-part model, or different types of residues from both parts models respectively. The references define the types of residuals: Davison &amp; Snell is a good reference for the usages of each. The partial residuals are a matrix of working residuals, with each column formed by omitting a term from the model.
</p>


<h3>Value</h3>

<p>Returns a numerical vector of residuals, either for the full two-part model, or two separate part models from an object <code>twopartm</code>.
</p>


<h3>Author(s)</h3>

<p>Yajie Duan, Birol Emir, Griffith Bell and Javier Cabrera</p>


<h3>References</h3>

<p>Belotti, F., Deb, P., Manning, W.G. and Norton, E.C. (2015). twopm: Two-part models.
<em>The Stata Journal</em>, 15(1), pp.3-20.
</p>
<p>Davison, A. C. and Snell, E. J. (1991). Residuals and diagnostics. <em>Statistical Theory and Modeling</em>. In Honour of Sir David Cox, FRS, eds. Hinkley, D. V., Reid, N. and Snell, E. J., Chapman and Hall.
</p>


<h3>See Also</h3>

<p><code>twopartm-class</code>, <code>glm</code>,<code>residuals.glm</code>, <code>tpm</code>,  <code>predict-methods</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
##data about health expenditures, i.e., non-negative continuous response
data(meps,package = "twopartm")


##fit two-part model with the same regressors in both parts, with logistic
##regression model for the first part, and glm with Gamma family with log
##link for the second-part model
tpmodel = tpm(exp_tot~female+age, data = meps,link_part1 = "logit",
family_part2 = Gamma(link = "log"))

tpmodel

##summary information
summary(tpmodel)

##response residues from the full two-part model
residuals(tpmodel)

##response residues from the first-part model
residuals(tpmodel,model = "model1")

##deviance residues from the second-part model
residuals(tpmodel,model = "model2",type = "deviance")


</code></pre>


</div>