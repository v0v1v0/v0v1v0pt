<div class="container">

<table style="width: 100%;"><tr>
<td>case_control_sampling_trials</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Case-control sampling of expanded data for the sequence of emulated trials</h2>

<h3>Description</h3>

<p>Perform case-control sampling of expanded data to create a data set of reduced size and calculate sampling weights
to be used in <code>trial_msm()</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">case_control_sampling_trials(
  data_prep,
  p_control = NULL,
  subset_condition,
  sort = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data_prep</code></td>
<td>
<p>Result from <code>data_preparation()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_control</code></td>
<td>
<p>Control sampling probability for selecting potential controls at each follow-up time of each trial.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset_condition</code></td>
<td>
<p>Expression used to <code>subset()</code> the trial data before case-control sampling.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sort</code></td>
<td>
<p>Sort data before applying case-control sampling to make sure that the resulting data are identical when
sampling from the expanded data created with <code>separate_files = TRUE</code> or <code>separate_files = FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>data.frame</code> or a <code>split()</code> <code>data.frame</code> if  <code>length(p_control) &gt; 1</code>. An additional column <code>sample_weight</code>
containing the sample weights will be added to the result. These can be included in the models fit with
<code>trial_msm()</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># If necessary reduce the number of threads for data.table
data.table::setDTthreads(2)

data("te_data_ex")
samples &lt;- case_control_sampling_trials(te_data_ex, p_control = 0.01)
</code></pre>


</div>