<div class="container">

<table style="width: 100%;"><tr>
<td>MSTSegments</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Add minimum spanning tree to plot, colouring by stress</h2>

<h3>Description</h3>

<p>To identify strain in a multidimensional scaling of distances, it can be
useful to plot a minimum spanning tree
(Gower 1966; Smith 2022).  Colouring each edge of the
tree according to its strain can identify areas where the mapping is
stretched or compressed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MSTSegments(mapping, mstEnds, ...)

StrainCol(
  distances,
  mapping,
  mstEnds = MSTEdges(distances),
  palette = rev(hcl.colors(256L, "RdYlBu"))
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mapping</code></td>
<td>
<p>Two-column matrix giving <em>x</em> and <em>y</em> coordinates of plotted
points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mstEnds</code></td>
<td>
<p>Two-column matrix identifying rows of <code>mapping</code> at end of
each edge of the MST, as output by <code>TreeTools::MSTEdges()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to <code>segments()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distances</code></td>
<td>
<p>Matrix or <code>dist</code> object giving original distances between
each pair of points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>palette</code></td>
<td>
<p>Vector of colours with which to colour edges.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>StrainCol()</code> returns a vector in which each entry is selected from
<code>palette</code>, with an attribute <code>logStrain</code> denoting the logarithm of the
mapped over original distance, shifted such that the median value is zero.
Palette colours are assigned centred on the median value, with entries
early in <code>palette</code> assigned to edges in which the ratio of mapped
distance to original distance is small.
</p>


<h3>Author(s)</h3>

<p><a href="https://orcid.org/0000-0001-5660-1727">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>


<h3>References</h3>

<p>Gower JC (1966).
“Some distance properties of latent root and vector methods used in multivariate analysis.”
<em>Biometrika</em>, <b>53</b>(3/4), 325–338.
<a href="https://doi.org/10.2307/2333639">doi:10.2307/2333639</a>.<br><br> Smith MR (2022).
“Robust analysis of phylogenetic tree space.”
<em>Systematic Biology</em>, <b>71</b>(5), 1255–1270.
<a href="https://doi.org/10.1093/sysbio/syab100">doi:10.1093/sysbio/syab100</a>.
</p>


<h3>See Also</h3>

<p>Other tree space functions: 
<code>Islands()</code>,
<code>MapTrees()</code>,
<code>MappingQuality()</code>,
<code>SpectralEigens()</code>,
<code>cluster-statistics</code>,
<code>median.multiPhylo()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(0)
library("TreeTools", quietly = TRUE)
distances &lt;- ClusteringInfoDist(as.phylo(5:16, 8))
mapping &lt;- cmdscale(distances, k = 2)
mstEnds &lt;- MSTEdges(distances)

# Set up blank plot
plot(mapping, asp = 1, frame.plot = FALSE, ann = FALSE, axes = FALSE,
     type = "n")
# Add MST
MSTSegments(mapping, mstEnds, 
            col = StrainCol(distances, mapping, mstEnds))
# Add points at end so they overprint the MST
points(mapping)
PlotTools::SpectrumLegend(
 "bottomleft",
 legend = c("Extended", "Median", "Contracted"),
 bty = "n",     # No box
 y.intersp = 2, # Expand in Y direction
 palette = hcl.colors(256L, "RdYlBu", rev = TRUE)
)
</code></pre>


</div>