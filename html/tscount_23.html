<div class="container">

<table style="width: 100%;"><tr>
<td>marcal</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Predictive Model Assessment with a Marginal Calibration Plot
</h2>

<h3>Description</h3>

<p>The function produces a marginal calibration plot.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'tsglm'
marcal(object, plot=TRUE, ...)
## Default S3 method:
marcal(response, pred, distr=c("poisson", "nbinom"), distrcoefs, plot=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>an object of class <code>"tsglm"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>

<p>logical. If <code>plot=TRUE</code> (the default), the marginal calibration is plotted and the underlying data are returned invisibly only. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>response</code></td>
<td>

<p>integer vector. Vector of observed values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred</code></td>
<td>

<p>numeric vector. Vector of predicted values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distr</code></td>
<td>

<p>character giving the conditional distribution. Currently implemented are the Poisson (<code>"poisson"</code>)and the Negative Binomial (<code>"nbinom"</code>) distribution.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distrcoefs</code></td>
<td>

<p>numeric vector of additional coefficients specifying the conditional distribution. For <code>distr="poisson"</code> no additional parameters need to be provided. For <code>distr="nbinom"</code> the additional parameter <code>size</code> needs to be specified (e.g. by <code>distrcoefs=2</code>), see <code>tsglm</code> for details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>additional arguments to be passed to <code>plot</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Marginal Calibration can be assessed by taking the difference between the average predictive cumulative distribution function (c.d.f.) and the empirical c.d.f. of the observations. Minor fluctuations about zero are expected if the marginal calibration hypothesis is true. For more information about marginal calibration see the refererences listed below.
</p>


<h3>Value</h3>

<p>Produces a plot of the difference between the average predictive cumulative distribution function (c.d.f.) and the empirical c.d.f. of the observations at each value between the highest and lowest observation of the time series (only for <code>plot=TRUE</code>).
</p>
<p>Returns a list with elements <code>x</code> and <code>y</code>, where <code>x</code> are the threshold values and <code>y</code> the respective differences of predictive and empirical cumulative distribution function (invisibly for <code>plot=TRUE</code>).
</p>


<h3>Author(s)</h3>

<p>Philipp Probst and Tobias Liboschik
</p>


<h3>References</h3>

<p>Christou, V. and Fokianos, K. (2013) On count time series prediction. <em>Journal of Statistical Computation and Simulation</em> (published online), <a href="http://dx.doi.org/10.1080/00949655.2013.823612">http://dx.doi.org/10.1080/00949655.2013.823612</a>.
</p>
<p>Czado, C., Gneiting, T. and Held, L. (2009) Predictive model assessment for count data. <em>Biometrics</em> <b>65</b>, 1254–1261, <a href="http://dx.doi.org/10.1111/j.1541-0420.2009.01191.x">http://dx.doi.org/10.1111/j.1541-0420.2009.01191.x</a>.
</p>
<p>Gneiting, T., Balabdaoui, F. and Raftery, A.E. (2007) Probabilistic forecasts, calibration and sharpness. <em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em> <b>69</b>, 243–268, <a href="http://dx.doi.org/10.1111/j.1467-9868.2007.00587.x">http://dx.doi.org/10.1111/j.1467-9868.2007.00587.x</a>.
</p>


<h3>See Also</h3>

<p><code>tsglm</code> for fitting a GLM for time series of counts.
</p>
<p><code>pit</code> and <code>scoring</code> for other predictive model assessment tools.
</p>


<h3>Examples</h3>

<pre><code class="language-R">###Campylobacter infections in Canada (see help("campy"))
campyfit &lt;- tsglm(ts=campy, model=list(past_obs=1, past_mean=c(7,13)))
marcal(campyfit)
</code></pre>


</div>