<div class="container">

<table style="width: 100%;"><tr>
<td>GIRF</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generalized Impulse response Function (GIRF)</h2>

<h3>Description</h3>

<p>Generates a GIRF for multiple innovations and histories
</p>


<h3>Usage</h3>

<pre><code class="language-R">GIRF(object, n.ahead, seed = NULL, ...)

## S3 method for class 'setar'
GIRF(
  object,
  n.ahead = 10,
  seed = NULL,
  n.hist = 20,
  n.shock = 20,
  R = 10,
  hist_li = NULL,
  shock_li = NULL,
  ...
)

## S3 method for class 'linear'
GIRF(
  object,
  n.ahead = 10,
  seed = NULL,
  n.hist = 20,
  n.shock = 20,
  R = 10,
  hist_li = NULL,
  shock_li = NULL,
  ...
)

## S3 method for class 'nlVar'
GIRF(
  object,
  n.ahead = 10,
  seed = NULL,
  n.hist = 20,
  n.shock = 20,
  R = 10,
  hist_li = NULL,
  shock_li = NULL,
  ...
)

## S3 method for class 'GIRF_df'
plot(
  x,
  plot_type = c("density", "line"),
  n.ahead = c(1, 5, 10),
  var = unique(x$var)[1],
  n_simu = c(1, 2),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of class <code>linear</code>, <code>setar</code> or <code>nlVar</code> (<code>TVAR</code>, <code>TVECM</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.ahead</code></td>
<td>
<p>The number of steps ahead to compute</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>optional, the seed for the random numbers</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.hist</code></td>
<td>
<p>The number of past histories to consider. Should be high, ideally size of data (minus lags).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.shock</code></td>
<td>
<p>The number of actual shocks to consider</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>the number of draws to use for the n.ahead innovations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hist_li</code></td>
<td>
<p>optional, a list of histories (each of same length as lags in the model). 
If not provided, <code>n.hist</code> histories will be randomly drawn for the original series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shock_li</code></td>
<td>
<p>optional, a list of innovations. 
If not provided, <code>n.shock</code> shocks will be randomly drawn from the estimated residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>output of girf</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_type</code></td>
<td>
<p>plot: density (for each <code>n.ahead</code>), or line (for multipe <code>n_simu</code>)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var</code></td>
<td>
<p>plot: which variable to plot?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_simu</code></td>
<td>
<p>line plot: which simulation to plot?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to specific methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In a nonlinear model, the Impulse response Function (IRF) is not time-, scale- and sign-invariant as in linear models. 
To address this, Koop et al (1996) introduced the Generalized Impulse response Function (GIRF):
</p>
<p style="text-align: center;"><code class="reqn">GIRF(h,\delta,\omega_{t-1})=E[y_{t+h}|\epsilon_{t}=\delta,\epsilon_{t+h}=0,\omega_{t-1}]-E[y_{t+h}|\epsilon_{t}=0,\epsilon_{t+h}=0,\omega_{t-1}]</code>
</p>

<p>It is the difference between two conditional expectations, one containing the shock of interest, the second one averaging it out. The averaging-out is done
by comparing against random innovations (unlike the IRF, which compares against innovation 0), 
The parameter <code>R</code> corresponds to the number of times this is done. 
</p>
<p>The GIRF as defined here depends on the particular shock, as well as on the history. 
Koop et al (1996) suggest to draw multiple combinations of histories and innovations. This is done with arguments <code>n.hist</code> and <code>n.shock</code> 
(or, alternatively, provide one of, or both, <code>hist_li</code> and <code>hist_li</code> as list of histories and shocks).
</p>
<p>The output is a data-frame containing the two average paths for each combinations of shocks and histories.
</p>


<h3>Value</h3>

<p>A data-frame, with:
</p>
 
<dl>
<dt>n_simu:</dt>
<dd>
<p>Id for the simulation (total number is n.hist times n.shock)</p>
</dd> 
<dt>hist, shock</dt>
<dd>
<p>History and shock used in the nth simulation</p>
</dd>
<dt>n.ahead:</dt>
<dd>
<p>The forecasting horizon. Note the shocks happens at time 0</p>
</dd>
<dt>var:</dt>
<dd>
<p>The variable (on which the shock happens, corresponds hence to the <code>response</code> argument in <code>irf</code>)</p>
</dd>
<dt>sim_1, sim_2</dt>
<dd>
<p>The average (over R times) simulation with the specific shock (sim_1) or with random shocks (sim_2). </p>
</dd>
<dt>girf</dt>
<dd>
<p>The difference between sim_1 and sim_2</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Matthieu Stigler
</p>


<h3>References</h3>

<p>Koop, G, Pesaran, M. H. &amp; Potter, S. M. (1996) Impulse response analysis in nonlinear multivariate models. Journal of Econometrics, 74, 119-147
</p>


<h3>See Also</h3>

<p><code>irf.nlVar</code> for the IRF, for linear models, or in case of non-linear models, for each regime.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## simulate a SETAR for the example. Higher regime more persistent (AR coef 0.5 instead of 0.2)
set &lt;- setar.sim(B = c(0.5, 0.2, 0.5, 0.5), lag = 1, Thresh = 0.5, n = 500)
set_estim &lt;- setar(set, m = 1)

## regime-specific IRF:
plot(irf(set_estim, regime = "L", boot = FALSE))
plot(irf(set_estim, regime = "H", boot = FALSE))

## GIRF
girf_out &lt;- GIRF(set_estim, n.hist = 10, n.shock = 10) # smaller number for example only

## the GIRF shows a very fast convergence (the shock at n.ahead = 4 is already very close to 0)
plot(girf_out, n.ahead = 1:4)
## investigate a few specific GIRFS:
plot(girf_out, plot_type = "line", n_simu  = 1:5)
</code></pre>


</div>