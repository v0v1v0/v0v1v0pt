<div class="container">

<table style="width: 100%;"><tr>
<td>cvm_test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cramer-von Mises Test</h2>

<h3>Description</h3>

<p>A two-sample test based on the Cramer-Von Mises test statistic (<code>cvm_stat</code>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">cvm_test(a, b, nboots = 2000, p = default.p, keep.boots = T, keep.samples = F)

cvm_stat(a, b, power = def_power)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>a vector of numbers (or factors – see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>a vector of numbers</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nboots</code></td>
<td>
<p>Number of bootstrap iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>power to raise test stat to</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep.boots</code></td>
<td>
<p>Should the bootstrap values be saved in the output?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep.samples</code></td>
<td>
<p>Should the samples be saved in the output?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>power to raise test stat to</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The CVM test compares two ECDFs by looking at the sum of the squared differences between them – evaluated at each point in the joint sample. Formally – if E is the ECDF of sample 1 and F is the ECDF of sample 2, then </p>
<p style="text-align: center;"><code class="reqn">CVM = \sum_{x\in k}|E(x)-F(x)|^p</code>
</p>
<p> where k is the joint sample. The test p-value is calculated by randomly resampling two samples of the same size using the combined sample. Intuitively the CVM test improves on KS by using the full joint sample, rather than just the maximum distance – this gives it greater power against shifts in higher moments, like variance changes.
</p>
<p>In the example plot below, the CVM statistic is the sum of the heights of the vertical black lines.
</p>
<p><img src="../help/figures/cvm.png" alt="Example CVM stat plot"></p>
<p>Inputs <code>a</code> and <code>b</code> can also be vectors of ordered (or unordered) factors, so long as both have the same levels and orderings. When possible, ordering factors will substantially increase power.
</p>


<h3>Value</h3>

<p>Output is a length 2 Vector with test stat and p-value in that order. That vector has 3 attributes – the sample sizes of each sample, and the number of bootstraps performed for the pvalue.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>cvm_test()</code>: Permutation based two sample Cramer-Von Mises test
</p>
</li>
<li> <p><code>cvm_stat()</code>: Permutation based two sample Cramer-Von Mises test
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>dts_test()</code> for a more powerful test statistic. See <code>ks_test()</code> or <code>kuiper_test()</code> for the predecessors to this test statistic. See <code>wass_test()</code> and <code>ad_test()</code> for the successors to this test statistic.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(314159)
vec1 = rnorm(20)
vec2 = rnorm(20,0.5)
out = cvm_test(vec1,vec2)
out
summary(out)
plot(out)

# Example using ordered factors
vec1 = factor(LETTERS[1:5],levels = LETTERS,ordered = TRUE)
vec2 = factor(LETTERS[c(1,2,2,2,4)],levels = LETTERS, ordered=TRUE)
cvm_test(vec1,vec2)
</code></pre>


</div>