<div class="container">

<table style="width: 100%;"><tr>
<td>TVAR.LRtest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Test of linearity</h2>

<h3>Description</h3>

<p>Multivariate extension of the linearity against threshold test from Hansen
(1999) with bootstrap distribution
</p>


<h3>Usage</h3>

<pre><code class="language-R">TVAR.LRtest(
  data,
  lag = 1,
  trend = TRUE,
  series,
  thDelay = 1:m,
  mTh = 1,
  thVar,
  nboot = 10,
  plot = FALSE,
  trim = 0.1,
  test = c("1vs", "2vs3"),
  model = c("TAR", "MTAR"),
  hpc = c("none", "foreach"),
  trace = FALSE,
  check = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>multivariate time series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lag</code></td>
<td>
<p>Number of lags to include in each regime</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trend</code></td>
<td>
<p>whether a trend should be added</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>series</code></td>
<td>
<p>name of the series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thDelay</code></td>
<td>
<p>'time delay' for the threshold variable (as multiple of
embedding time delay d) PLEASE NOTE that the notation is currently different
to univariate models in tsDyn. The left side variable is taken at time t, and
not t+1 as in univariate cases.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mTh</code></td>
<td>
<p>combination of variables with same lag order for the transition
variable. Either a single value (indicating which variable to take) or a
combination</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thVar</code></td>
<td>
<p>external transition variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nboot</code></td>
<td>
<p>Number of bootstrap replications</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>Whether a plot showing the results of the grid search should be
printed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trim</code></td>
<td>
<p>trimming parameter indicating the minimal percentage of
observations in each regime</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>Type of usual and alternative hypothesis. See details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Whether the threshold variable is taken in level (TAR) or
difference (MTAR)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hpc</code></td>
<td>
<p>Possibility to run the bootstrap on parallel core. See details in
<code>TVECM.HStest</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>should additional infos be printed? (logical)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check</code></td>
<td>
<p>Possibility to check the function by no sampling: the test value
should be the same as in the original data</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This test is just the multivariate extension proposed by Lo and Zivot of the
linearity test of Hansen (1999). As in univariate case, estimation of the
first threshold parameter is made with CLS, for the second threshold a
conditional search with one iteration is made. Instead of a Ftest comparing
the SSR for the univariate case, a Likelihood Ratio (LR) test comparing the
covariance matrix of each model is computed.
</p>
<p style="text-align: center;"><code class="reqn"> LR_{ij}=T( ln(\det \hat \Sigma_{i}) -ln(\det \hat \Sigma_{j}))</code>
</p>
<p> where
<code class="reqn"> \hat \Sigma_{i}</code> is the estimated covariance matrix of the model with i
regimes (and so i-1 thresholds).
</p>
<p>Three test are available. The both first can be seen as linearity test,
whereas the third can be seen as a specification test: once the 1vs2 or/and
1vs3 rejected the linearity and henceforth accepted the presence of a
threshold, is a model with one or two thresholds preferable?
</p>
<p>Test <b>1vs</b>2: Linear VAR versus 1 threshold TVAR
</p>
<p>Test <b>1vs</b>3: Linear VAR versus 2 threshold2 TVAR
</p>
<p>Test <b>2vs3</b>: 1 threshold TAR versus 2 threshold2 TAR
</p>
<p>The both first are computed together and available with test="1vs". The third
test is available with test="2vs3".
</p>
<p>The homoskedastik bootstrap distribution is based on resampling the residuals
from H0 model, estimating the threshold parameter and then computing the
Ftest, so it involves many computations and is pretty slow.
</p>


<h3>Value</h3>

<p>A list containing:
</p>
<p>-The values of each LR test
</p>
<p>-The bootstrap Pvalues and critical values for the test selected
</p>


<h3>Author(s)</h3>

<p>Matthieu Stigler
</p>


<h3>References</h3>

<p>Hansen (1999) Testing for linearity, Journal of Economic Surveys,
Volume 13, Number 5, December 1999 , pp. 551-576(26) available at:
<a href="http://www.ssc.wisc.edu/~bhansen/papers/cv.htm">http://www.ssc.wisc.edu/~bhansen/papers/cv.htm</a>
</p>
<p>Lo and Zivot (2001) "Threshold Cointegration and Nonlinear Adjustment to the
Law of One Price," Macroeconomic Dynamics, Cambridge University Press, vol.
5(4), pages 533-76, September.
</p>


<h3>See Also</h3>

<p><code>setarTest</code> for the univariate version.
<code>OlsTVAR</code> for estimation of the model.
</p>


<h3>Examples</h3>

<pre><code class="language-R">

data(zeroyld)
data&lt;-zeroyld

TVAR.LRtest(data, lag=2, mTh=1,thDelay=1:2, nboot=3, plot=FALSE, trim=0.1, test="1vs")
</code></pre>


</div>