<div class="container">

<table style="width: 100%;"><tr>
<td>nn_poisson_nll_loss</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Poisson NLL loss</h2>

<h3>Description</h3>

<p>Negative log likelihood loss with Poisson distribution of target.
The loss can be described as:
</p>


<h3>Usage</h3>

<pre><code class="language-R">nn_poisson_nll_loss(
  log_input = TRUE,
  full = FALSE,
  eps = 1e-08,
  reduction = "mean"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>log_input</code></td>
<td>
<p>(bool, optional): if <code>TRUE</code> the loss is computed as
<code class="reqn">\exp(\mbox{input}) - \mbox{target}*\mbox{input}</code>, if <code>FALSE</code> the loss is
<code class="reqn">\mbox{input} - \mbox{target}*\log(\mbox{input}+\mbox{eps})</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>full</code></td>
<td>
<p>(bool, optional): whether to compute full loss, i. e. to add the
Stirling approximation term
<code class="reqn">\mbox{target}*\log(\mbox{target}) - \mbox{target} + 0.5 * \log(2\pi\mbox{target})</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>(float, optional): Small value to avoid evaluation of <code class="reqn">\log(0)</code> when
<code>log_input = FALSE</code>. Default: 1e-8</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reduction</code></td>
<td>
<p>(string, optional): Specifies the reduction to apply to the output:
<code>'none'</code> | <code>'mean'</code> | <code>'sum'</code>. <code>'none'</code>: no reduction will be applied,
<code>'mean'</code>: the sum of the output will be divided by the number of
elements in the output, <code>'sum'</code>: the output will be summed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p style="text-align: center;"><code class="reqn">
\mbox{target} \sim \mathrm{Poisson}(\mbox{input})
\mbox{loss}(\mbox{input}, \mbox{target}) = \mbox{input} - \mbox{target} * \log(\mbox{input})
+ \log(\mbox{target!})
</code>
</p>

<p>The last term can be omitted or approximated with Stirling formula. The
approximation is used for target values more than 1. For targets less or
equal to 1 zeros are added to the loss.
</p>


<h3>Shape</h3>


<ul>
<li>
<p> Input: <code class="reqn">(N, *)</code> where <code class="reqn">*</code> means, any number of additional
dimensions
</p>
</li>
<li>
<p> Target: <code class="reqn">(N, *)</code>, same shape as the input
</p>
</li>
<li>
<p> Output: scalar by default. If <code>reduction</code> is <code>'none'</code>, then <code class="reqn">(N, *)</code>,
the same shape as the input
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">if (torch_is_installed()) {
loss &lt;- nn_poisson_nll_loss()
log_input &lt;- torch_randn(5, 2, requires_grad = TRUE)
target &lt;- torch_randn(5, 2)
output &lt;- loss(log_input, target)
output$backward()
}
</code></pre>


</div>