<div class="container">

<table style="width: 100%;"><tr>
<td>truncAIPW</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Doubly Robust Estimation under Covariate-induced Dependent Left Truncation and No Censoring</h2>

<h3>Description</h3>

<p>Doubly robust estimation for the mean of an arbitrarily transformed survival time under covariate-induced dependent left truncation and no right censoring.
</p>


<h3>Usage</h3>

<pre><code class="language-R">truncAIPW(dat, nu, Fuz.mx, Gvz.mx, T.name, Q.name, trim = 1e-07)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>data frame that contains the data for constructing the estimating equation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p>transformation that defines the parameter of interest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Fuz.mx</code></td>
<td>
<p>matrix for the estimated conditional CDF of the event time given covariates. Each row corresponds to a subject, and each column corresponds to a time point. The column names of the matrix are the time points. See <code>F_est</code> for an example of computing this conditional CDF matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gvz.mx</code></td>
<td>
<p>matrix for the estimated conditional CDF of the truncation time given covariates. Each row corresponds to a subject, and each column corresponds to a time point. The column names of the matrix are the time points. See <code>G_est</code> for an example of computing this conditional CDF matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T.name</code></td>
<td>
<p>name of the event time variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q.name</code></td>
<td>
<p>name of the left truncation time variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trim</code></td>
<td>
<p>constant that is used to bound from below for the denominators involved in the computation.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>truncAIPW()</code> returns a list of estimators (‘dr’, ‘IPW.Q’, ‘Reg.T1’, ‘Reg.T2’), and the model-based standard errors for the ‘dr’ and ‘IPW.Q’ estimators.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>dr</code></td>
<td>
<p>doubly robust estimator ‘dr’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>IPW.Q</code></td>
<td>
<p>inverse probability of truncation weighted estimator ‘IPW.Q’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Reg.T1</code></td>
<td>
<p>regression based estimator ‘Reg.T1’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Reg.T2</code></td>
<td>
<p>regression based estimator ‘Reg.T2’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SE_dr</code></td>
<td>
<p>standard error of the ‘dr’ estimator based on the efficient influence function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SE_IPW.Q</code></td>
<td>
<p>standard error of the ‘IPW.Q’ estimator computed from the robust sandwich variance estimator assuming the truncation weights are known.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Wang, Y., Ying, A., Xu, R. (2022) "Doubly robust estimation under covariate-induced dependent left truncation" &lt;arXiv:2208.06836&gt;.
</p>


<h3>See Also</h3>

<p>See <code>truncAIPW_cen1</code>, <code>truncAIPW_cen2</code> for the estimations also under noninformative right censoring. See <code>F_est</code>, <code>G_est</code> for examples of computing the input matrices for the conditional CDF's.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("simu")
nu &lt;- function(t){ return(as.numeric(t&gt;3)) }
u = c(min(simu$time)-1e-10, sort(simu$time), max(simu$time)+1e-10)
v = c(min(simu$Q)-1e-10, sort(simu$Q), max(simu$Q)+1e-10)
Fuz.mx = F_est(simu, simu, u, "Cox", "time", "Q", "delta", c("Z1","Z2"))
Gvz.mx = G_est(simu, simu, v, "Cox", "time", "Q", "delta", c("Z1","Z2"))

est = truncAIPW(simu, nu, Fuz.mx, Gvz.mx, "time", "Q", trim = 1e-7)
est
</code></pre>


</div>