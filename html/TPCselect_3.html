<div class="container">

<table style="width: 100%;"><tr>
<td>TPC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Variable Selection via Thresholded Partial Correlation</h2>

<h3>Description</h3>

<p>These are the main selection functions with fixed significance level <code>s</code> and <code>constant</code>.
The function <code>TPC</code> implements the thresholded partial correlation (TPC) approach to selecting important
variables in linear models of Li et al. (2017).
The function <code>TPC_pl</code> implements the thresholded partial correlation approach to selecting important
variables in partial linear models of Liu et al. (2018).
This function also extends the PC-simple algorithm of BÃ¼hlmann et al. (2010) to partial linear models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">TPC(y, x, s = 0.05, constant = 1, method = "threshold")

TPCselect(y, x, s = 0.05, constant = 1, method = "threshold")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>response vector;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>covariate matrix;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>a numeric value that used as significance level(s) for partial
correlation test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constant</code></td>
<td>
<p>a value that used as the tuning constant for partial
correlation test. <code>constant</code> is treated as 1 when method is "simple".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the method to be used; default set as method = "threshold";
"simple" is also available.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>TPC.object a TPC object, which extends the <code>lm</code> object. New attributes are:
</p>

<ul>
<li>
<p> beta - the fitted coefficients
</p>
</li>
<li>
<p> selected_index - the selected coefficients indices
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">#generate sample data
p = 200
n = 200
truebeta &lt;- c(c(3,1.5,0,0,2),rep(0,p-5))
rho = 0.3
sigma =  matrix(0,p+1,p+1)
for(i in 1:(p+1)){
  for(j in 1:(p+1)){
    sigma[i,j] = rho^(abs(i-j))
  }
}
x_error = 0.9*MASS::mvrnorm(n,rep(0,p+1),sigma) + 0.1*MASS::mvrnorm(n,rep(0,p+1),9*sigma)
x = x_error[,1:p]
error = x_error[,p+1]
y = x%*%truebeta + error

#perform variable selection via partial correlation
TPC.fit = TPC(y,x,0.05,1,method="threshold")
TPC.fit$beta

</code></pre>


</div>