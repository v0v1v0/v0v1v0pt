<div class="container">

<table style="width: 100%;"><tr>
<td>sts_decompose_by_component</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Decompose an observed time series into contributions from each component.</h2>

<h3>Description</h3>

<p>This method decomposes a time series according to the posterior represention
of a structural time series model. In particular, it:
</p>

<ul>
<li>
<p> Computes the posterior marginal mean and covariances over the additive
model's latent space.
</p>
</li>
<li>
<p> Decomposes the latent posterior into the marginal blocks for each
model component.
</p>
</li>
<li>
<p> Maps the per-component latent posteriors back through each component's
observation model, to generate the time series modeled by that component.
</p>
</li>
</ul>
<h3>Usage</h3>

<pre><code class="language-R">sts_decompose_by_component(observed_time_series, model, parameter_samples)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>observed_time_series</code></td>
<td>
<p><code>float</code> <code>tensor</code> of shape
<code style="white-space: pre;">⁠concat([sample_shape, model.batch_shape, [num_timesteps, 1]])⁠</code> where
<code>sample_shape</code> corresponds to i.i.d. observations, and the trailing <code style="white-space: pre;">⁠[1]⁠</code>
dimension may (optionally) be omitted if <code>num_timesteps &gt; 1</code>. May
optionally be an instance of <code>sts_masked_time_series</code>, which includes
a mask <code>tensor</code> to specify timesteps with missing observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>An instance of <code>sts_sum</code> representing a structural time series model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameter_samples</code></td>
<td>
<p><code>list</code> of <code>tensors</code> representing posterior samples
of model parameters, with shapes
<code style="white-space: pre;">⁠list(tf$concat(list(list(num_posterior_draws), param&lt;1&gt;$prior$batch_shape, param&lt;1&gt;$prior$event_shape), list(list(num_posterior_draws), param&lt;2&gt;$prior$batch_shape, param&lt;2&gt;$prior$event_shape), ... ) )⁠</code>
for all model parameters.
This may optionally also be a named list mapping parameter names to <code>tensor</code> values.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>component_dists A named list mapping
component StructuralTimeSeries instances (elements of <code>model$components</code>)
to <code>Distribution</code> instances representing the posterior marginal
distributions on the process modeled by each component. Each distribution
has batch shape matching that of <code>posterior_means</code>/<code>posterior_covs</code>, and
event shape of <code>list(num_timesteps)</code>.
</p>


<h3>See Also</h3>

<p>Other sts-functions: 
<code>sts_build_factored_surrogate_posterior()</code>,
<code>sts_build_factored_variational_loss()</code>,
<code>sts_decompose_forecast_by_component()</code>,
<code>sts_fit_with_hmc()</code>,
<code>sts_forecast()</code>,
<code>sts_one_step_predictive()</code>,
<code>sts_sample_uniform_initial_state()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
observed_time_series &lt;- array(rnorm(2 * 1 * 12), dim = c(2, 1, 12))
day_of_week &lt;- observed_time_series %&gt;% sts_seasonal(num_seasons = 7, name = "seasonal")
local_linear_trend &lt;- observed_time_series %&gt;% sts_local_linear_trend(name = "local_linear")
model &lt;- observed_time_series %&gt;%
  sts_sum(components = list(day_of_week, local_linear_trend))
states_and_results &lt;- observed_time_series %&gt;%
  sts_fit_with_hmc(
    model,
    num_results = 10,
    num_warmup_steps = 5,
    num_variational_steps = 15
    )
samples &lt;- states_and_results[[1]]

component_dists &lt;- observed_time_series %&gt;%
 sts_decompose_by_component(model = model, parameter_samples = samples)

</code></pre>


</div>