<div class="container">

<table style="width: 100%;"><tr>
<td>mcmc_potential_scale_reduction</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Gelman and Rubin (1992)'s potential scale reduction for chain convergence.</h2>

<h3>Description</h3>

<p>Given <code>N &gt; 1</code> states from each of <code>C &gt; 1</code> independent chains, the potential
scale reduction factor, commonly referred to as R-hat, measures convergence of
the chains (to the same target) by testing for equality of means.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mcmc_potential_scale_reduction(
  chains_states,
  independent_chain_ndims = 1,
  name = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>chains_states</code></td>
<td>
<p><code>Tensor</code> or <code>list</code> of <code>Tensor</code>s representing the
state(s) of a Markov Chain at each result step.  The <code>ith</code> state is
assumed to have shape <code style="white-space: pre;">⁠[Ni, Ci1, Ci2,...,CiD] + A⁠</code>.
Dimension <code>0</code> indexes the <code>Ni &gt; 1</code> result steps of the Markov Chain.
Dimensions <code>1</code> through <code>D</code> index the <code style="white-space: pre;">⁠Ci1 x ... x CiD⁠</code> independent
chains to be tested for convergence to the same target.
The remaining dimensions, <code>A</code>, can have any shape (even empty).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>independent_chain_ndims</code></td>
<td>
<p>Integer type <code>Tensor</code> with value <code style="white-space: pre;">⁠&gt;= 1⁠</code> giving the
number of giving the number of dimensions, from <code>dim = 1</code> to <code>dim = D</code>,
holding independent chain results to be tested for convergence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>name to prepend to created tf.  Default: <code>potential_scale_reduction</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Specifically, R-hat measures the degree to which variance (of the means)
between chains exceeds what one would expect if the chains were identically
distributed. See Gelman and Rubin (1992), Brooks and Gelman (1998)].
</p>
<p>Some guidelines:
</p>

<ul>
<li>
<p> The initial state of the chains should be drawn from a distribution overdispersed with respect to the target.
</p>
</li>
<li>
<p> If all chains converge to the target, then as <code style="white-space: pre;">⁠N --&gt; infinity⁠</code>, R-hat –&gt; 1.
Before that, R-hat &gt; 1 (except in pathological cases, e.g. if the chain paths were identical).
</p>
</li>
<li>
<p> The above holds for any number of chains <code>C &gt; 1</code>.  Increasing <code>C</code> improves effectiveness of the diagnostic.
</p>
</li>
<li>
<p> Sometimes, R-hat &lt; 1.2 is used to indicate approximate convergence, but of
course this is problem dependent. See Brooks and Gelman (1998).
</p>
</li>
<li>
<p> R-hat only measures non-convergence of the mean. If higher moments, or
other statistics are desired, a different diagnostic should be used. See Brooks and Gelman (1998).
</p>
</li>
</ul>
<p>To see why R-hat is reasonable, let <code>X</code> be a random variable drawn uniformly
from the combined states (combined over all chains).  Then, in the limit
<code style="white-space: pre;">⁠N, C --&gt; infinity⁠</code>, with <code>E</code>, <code>Var</code> denoting expectation and variance,
<code style="white-space: pre;">⁠R-hat = ( E[Var[X | chain]] + Var[E[X | chain]] ) / E[Var[X | chain]].⁠</code>
Using the law of total variance, the numerator is the variance of the combined
states, and the denominator is the total variance minus the variance of the
the individual chain means.  If the chains are all drawing from the same
distribution, they will have the same mean, and thus the ratio should be one.
</p>


<h3>Value</h3>

<p><code>Tensor</code> or <code>list</code> of <code>Tensor</code>s representing the R-hat statistic for
the state(s).  Same <code>dtype</code> as <code>state</code>, and shape equal to
<code style="white-space: pre;">⁠state$shape[1 + independent_chain_ndims:]⁠</code>.
</p>


<h3>References</h3>


<ul>
<li>
<p> Stephen P. Brooks and Andrew Gelman. General Methods for Monitoring Convergence of Iterative Simulations.
<em>Journal of Computational and Graphical Statistics</em>, 7(4), 1998.
</p>
</li>
<li>
<p> Andrew Gelman and Donald B. Rubin. Inference from Iterative Simulation Using Multiple Sequences.
<em>Statistical Science</em>, 7(4):457-472, 1992.
</p>
</li>
</ul>
<h3>See Also</h3>

<p>Other mcmc_functions: 
<code>mcmc_effective_sample_size()</code>,
<code>mcmc_sample_annealed_importance_chain()</code>,
<code>mcmc_sample_chain()</code>,
<code>mcmc_sample_halton_sequence()</code>
</p>


</div>