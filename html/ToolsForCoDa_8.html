<div class="container">

<table style="width: 100%;"><tr>
<td>lrlda</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Logratio Linear Discriminant Analysis</h2>

<h3>Description</h3>

<p>Function <code>lrlda</code> implements logratio linear discriminant analysis for compositional data, using the centred logratio
transformation (clr) 
</p>


<h3>Usage</h3>

<pre><code class="language-R">lrlda(Xtrain, group, Xtest = NULL, divisorn = FALSE, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Xtrain</code></td>
<td>
<p>A compositional data set, the training data for logratio-LDA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>A categorical variable defining the groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xtest</code></td>
<td>
<p>A compositional data set for which group prediction is sought (the test data). If no test data is supplied, the
training data itself is classified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>divisorn</code></td>
<td>
<p>Use divisor "n" (<code>divisorn=TRUE</code>) in the calculation of covariance or use "n-1" (<code>divisorn=TRUE</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Print output (<code>verbose = TRUE</code>) or not.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Function <code>lrlda</code> uses the centred logratio transformation, which produces a singular covariance matrix. This singularity is
dealt with by using a generalized inverse. When test data is supplied via argument <code>Xtest</code>, the scores of the linear classifier,
the poster probabilities and the predicted classes are calculated for the test data. If no test data is supplied, these quantities
are calculated for the training data.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>LD</code></td>
<td>
<p>Scores on the linear classifier for the test observations. These are also the biplot coordinates of the individuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Fp</code></td>
<td>
<p>Biplot coordinates of the group means.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gs</code></td>
<td>
<p>Biplot coordinates of the variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sp</code></td>
<td>
<p>Pooled covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Mc</code></td>
<td>
<p>Matrix of centred clr mean vectors, one row for each group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S.list</code></td>
<td>
<p>Covariance matrices of each group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>la</code></td>
<td>
<p>Vector of eigenvalues.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred</code></td>
<td>
<p>Predicted class for the test observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CM</code></td>
<td>
<p>The confusion matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gsize</code></td>
<td>
<p>Sample size of each group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Mclr</code></td>
<td>
<p>Matrix of mean vectors for clr coordinates, one row for each group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob.posterior</code></td>
<td>
<p>Vector of posterior probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>decom</code></td>
<td>
<p>Table with decomposition of variability as expressed by the eigenvalues.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Jan Graffelman (jan.graffelman@upc.edu) </p>


<h3>See Also</h3>

<p><code>lrpca</code>,<code>lrlda</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  data(Tubb)
  sampleid &lt;- Tubb$Sample
  site     &lt;- factor(Tubb$site)
  Oxides   &lt;- as.matrix(Tubb[,2:10])
  rownames(Oxides) &lt;- sampleid
  Oxides   &lt;- Oxides/rowSums(Oxides)
  out.lda  &lt;- lrlda(Oxides,site,verbose=FALSE)
</code></pre>


</div>