<div class="container">

<table style="width: 100%;"><tr>
<td>dtweedie.dldphi</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Tweedie Distributions</h2>

<h3>Description</h3>

<p>Derivatives of the log-likelihood with respect to <code class="reqn">\phi</code></p>


<h3>Usage</h3>

<pre><code class="language-R">dtweedie.dldphi(phi, mu, power, y )
dtweedie.dldphi.saddle(phi, mu, power, y )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>vector of quantiles</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>the mean</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>the dispersion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>the value of <code class="reqn">p</code> such that the variance is 
<code class="reqn">\mbox{var}[Y]=\phi\mu^p</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Tweedie family of distributions belong to the class
of exponential dispersion models (<abbr><span class="acronym">EDM</span></abbr>s),
famous for their role in generalized linear models.
The Tweedie distributions are the <abbr><span class="acronym">EDM</span></abbr>s with a variance of the form
<code class="reqn">\mbox{var}[Y]=\phi\mu^p</code>
where <code class="reqn">p</code> is greater than or equal to one, or less than or equal to zero.
<b>This function only evaluates for <code class="reqn">p</code>
greater than or equal to one.</b>
Special cases include the 
normal (<code class="reqn">p=0</code>),
Poisson (<code class="reqn">p=1</code> with <code class="reqn">\phi=1</code>),
gamma (<code class="reqn">p=2</code>)
and
inverse Gaussian (<code class="reqn">p=3</code>)
distributions.
For other values of  <code>power</code>,
the distributions are still defined but cannot be written in closed form,
and hence evaluation is very difficult.
</p>


<h3>Value</h3>

<p>the value of the derivative 
<code class="reqn">\partial\ell/\partial\phi</code>
where <code class="reqn">\ell</code> is the log-likelihood for the specified
Tweedie distribution.
<code>dtweedie.dldphi.saddle</code>
uses the saddlepoint approximation to determine the derivative;
<code>dtweedie.dldphi</code>
uses an infinite series expansion.
</p>


<h3>Author(s)</h3>

<p>Peter Dunn (<a href="mailto:pdunn2@usc.edu.au">pdunn2@usc.edu.au</a>)</p>


<h3>References</h3>

<p>Dunn, P. K. and Smyth, G. K. (2008).
Evaluation of Tweedie exponential dispersion model densities by Fourier inversion.
<em>Statistics and Computing</em>, 
<b>18</b>, 73–86.
doi: <a href="https://doi.org/10.1007/s11222-007-9039-6">10.1007/s11222-007-9039-6</a>
</p>
<p>Dunn, Peter K and Smyth, Gordon K (2005).
Series evaluation of Tweedie exponential dispersion model densities
<em>Statistics and Computing</em>,
<b>15</b>(4). 267–280.
doi: <a href="https://doi.org/10.1007/s11222-005-4070-y">10.1007/s11222-005-4070-y</a>
</p>
<p>Dunn, Peter K and Smyth, Gordon K (2001).
Tweedie family densities: methods of evaluation.
<em>Proceedings of the 16th International Workshop on Statistical Modelling</em>,
Odense, Denmark, 2–6 July
</p>
<p>Jorgensen, B. (1987).
Exponential dispersion models.
<em>Journal of the Royal Statistical Society</em>, B,
<b>49</b>, 127–162.
</p>
<p>Jorgensen, B. (1997).
<em>Theory of Dispersion Models</em>.
Chapman and Hall, London.
</p>
<p>Sidi, Avram (1982).
The numerical evaluation of very oscillatory infinite integrals by
extrapolation.
<em>Mathematics of Computation</em>
<b>38</b>(158), 517–529.
doi: <a href="https://doi.org/10.1090/S0025-5718-1982-0645667-5">10.1090/S0025-5718-1982-0645667-5</a>
</p>
<p>Sidi, Avram (1988).  
A user-friendly extrapolation method for
oscillatory infinite integrals.
<em>Mathematics of Computation</em>
<b>51</b>(183), 249–266.
doi: <a href="https://doi.org/10.1090/S0025-5718-1988-0942153-5">10.1090/S0025-5718-1988-0942153-5</a>
</p>
<p>Tweedie, M. C. K. (1984).
An index which distinguishes between some important exponential families.
<em>Statistics: Applications and New Directions.
Proceedings of the Indian Statistical Institute Golden Jubilee International Conference</em>
(Eds. J. K. Ghosh and J. Roy), pp. 579-604. Calcutta: Indian Statistical Institute.
</p>


<h3>See Also</h3>

<p><code>dtweedie.saddle</code>, 
<code>dtweedie</code>,
<code>tweedie.profile</code>, 
<code>tweedie</code> 
</p>


<h3>Examples</h3>

<pre><code class="language-R">### Plot dl/dphi against candidate values of phi
power &lt;- 2
mu &lt;- 1 
phi &lt;- seq(2, 8, by=0.1)

set.seed(10000) # For reproducability
y &lt;- rtweedie( 100, mu=mu, power=power, phi=3)
   # So we expect the maximum to occur at  phi=3

dldphi &lt;- dldphi.saddle &lt;- array( dim=length(phi))

for (i in (1:length(phi))) {
   dldphi[i] &lt;- dtweedie.dldphi( y=y, power=power, mu=mu, phi=phi[i]) 
   dldphi.saddle[i] &lt;- dtweedie.dldphi.saddle( y=y, power=power, mu=mu, phi=phi[i]) 
}

plot( dldphi ~ phi, lwd=2, type="l",
   ylab=expression(phi), xlab=expression(paste("dl / d",phi) ) )
lines( dldphi.saddle ~ phi, lwd=2, col=2, lty=2)
legend( "bottomright", lwd=c(2,2), lty=c(1,2), col=c(1,2),
   legend=c("'Exact' (using series)","Saddlepoint") )

# Neither are very good in this case!
   
</code></pre>


</div>