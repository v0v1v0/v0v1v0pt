<div class="container">

<table style="width: 100%;"><tr>
<td>tvAR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Time-Varying Autoregressive Model</h2>

<h3>Description</h3>

<p><code>tvAR</code> is used to fit an autorregressive model with time varying coefficients.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tvAR(
  y,
  p = 1,
  z = NULL,
  ez = NULL,
  bw = NULL,
  cv.block = 0,
  type = c("const", "none"),
  exogen = NULL,
  fixed = NULL,
  est = c("lc", "ll"),
  tkernel = c("Triweight", "Epa", "Gaussian"),
  singular.ok = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A vector with the dependent variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>A scalar indicating the number of lags in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>A vector with the smoothing variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ez</code></td>
<td>
<p>(optional) A scalar or vector with the smoothing values. If 
values are not included then the vector <code>z</code> is used instead.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw</code></td>
<td>
<p>An opcional scalar or vector of length the number of equations. It represents
the bandwidth in the estimation of coefficients. If NULL, it is selected
by cross validation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv.block</code></td>
<td>
<p>A positive scalar with the size of the block in leave one block out cross-validation.
By default 'cv.block=0' meaning leave one out cross-validation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>A character 'const' if the model contains an intercept and 'none' otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exogen</code></td>
<td>
<p>A matrix or data.frame with the exogenous variables (optional)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>(optional) numeric vector of the same length as the total number of parameters. 
The order of the parameters is intercept (if type = "const"), lags in ascending order and 
exogenous variables. If supplied, only NA entries in fixed will be estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est</code></td>
<td>
<p>The nonparametric estimation method, one of "lc" (default) for linear constant
or "ll" for local linear.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tkernel</code></td>
<td>
<p>A character, either "Triweight" (default), "Epa" or "Gaussian" kernel function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>singular.ok</code></td>
<td>
<p>Logical. If FALSE, a singular model is an error.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>It is a special case of linear model in which the regressors are lags of the
dependent variable. If any variable is included in the <code>xreg</code> term, these are added 
to the regressors matrix. A time-varying coefficients linear regression (with an
intercept if type = "const") is fitted.
</p>


<h3>Value</h3>

<p>An object of class <code>tvar</code> with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>A vector of dimension obs (obs = number of observations - number lags),
with the time-varying coefficients estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted</code></td>
<td>
<p>The fitted values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>Estimation residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A matrix of model data, with lagged y and exogenous variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A vector with the dependent data used in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>A vector with the smoothing variable in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ez</code></td>
<td>
<p>A vector with the smoothing estimation values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.orig</code></td>
<td>
<p>A vector with the original variable y.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw</code></td>
<td>
<p>Bandwidth of mean estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Whether the model has a constant or not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exogen</code></td>
<td>
<p>A matrix or data.frame with other exogenous variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Number of lags</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs</code></td>
<td>
<p>Number of observations in estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>totobs</code></td>
<td>
<p>Number of observations in the original set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>Confidence interval range.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>runs</code></td>
<td>
<p>Number of bootstrap replications.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tboot</code></td>
<td>
<p>Type of bootstrap.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BOOT</code></td>
<td>
<p>List with all bootstrap replications of <code>coefficients</code>, if done.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Cai, Z. (2007) Trending time-varying coefficient time series with serially
correlated errors, <em>Journal of Econometrics</em>, 136, pp. 163-188.
</p>
<p>Casas, I., Mao, X. and Veiga, H. (2018) Reexamining financial and economic 
predictability with new estimators of realized variance and variance 
risk premium. Url= http://pure.au.dk/portal/files/123066669/rp18_10.pdf
</p>
<p>Chen, X. B., Gao, J., Li, D., and Silvapulle, P (2017) Nonparametric Estimation and 
Forecasting for Time-Varying Coefficient Realized Volatility Models.
<em>Journal of Business and Economic Statistics</em>, 36, 88-100.
</p>
<p>Corsi, F. (2009) A simple approximate long-memory model of realized 
volatility. <em>Journal of Financial Econometrics</em>, 7, 174-196.
</p>


<h3>See Also</h3>

<p><code>bw</code>, <code>tvLM</code>, <code>confint</code>, 
<code>plot</code>, <code>print</code> and <code>summary</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Estimate coefficients of different realized variance models
data("RV")
RV2 &lt;- head(RV, 2000)
RV &lt;- RV2$RV
RV_week &lt;- RV2$RV_week
RV_month &lt;- RV2$RV_month
RQ &lt;- RV2$RQ_lag_sqrt
##Corsi (2009) HAR model
HAR &lt;- arima(RV, order = c(1, 0, 0), xreg = cbind (RV_week, RV_month))
print(HAR)

##Chen et al (2017) TVCHAR model 
TVCHAR &lt;- tvAR (RV, p = 1, exogen = cbind (RV_week, RV_month), bw = 20)
print(TVCHAR)

##Casas et al (2018) TVHARQ model
TVHARQ &lt;- tvAR (RV, p = 1, exogen = cbind (RV_week, RV_month), 
z=RQ, bw = 0.0062)
print(TVHARQ)

</code></pre>


</div>