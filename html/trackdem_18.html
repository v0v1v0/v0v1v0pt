<div class="container">

<table style="width: 100%;"><tr>
<td>testNN</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Train, validate and test artificial
neural networks</h2>

<h3>Description</h3>

<p>Fits multiple neural networks to
a dataset; data set has been randomly assigned to each
of three categories: train, validate and test.
A final neural net is selected based on a fit statistic
(either precision, recall or the F1-score). All neural networks
are trained to the training dataset. Neural network may vary in
the number of hidden layers. Classification thresholds are selected
based on the validation data, and then the final neural network
is selected based on the test data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">testNN(
  dat,
  stat = "F",
  maxH = 5,
  repetitions = 3,
  prop = c(8, 1, 1),
  predictors = NULL,
  pca = TRUE,
  thr = 0.95,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>a previously constructed dataset obtained from
<code>manuallySelect</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stat</code></td>
<td>
<p>Fit statistic. May be <code>"precision"</code>, <code>"recall"</code>, or
<code>"F"</code> for the harmonic mean of precision and recall.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxH</code></td>
<td>
<p>maximum number of hidden layers to test
note that more layers will require more time to fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>repetitions</code></td>
<td>
<p>the number of repetitions
for the neural network's training.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prop</code></td>
<td>
<p>the proportion or ratio for each class
c(training, validation,test).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predictors</code></td>
<td>
<p>Optional. A set of custom predictors
for the neural network. Default uses all columns in <code>dat</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pca</code></td>
<td>
<p>Logical. <code>TRUE</code> by default. Should the
set of predictors be compressed to the most informative? In short,
should a principal component analysis be conducted to select axis that
explain at least a fraction <code>thr</code> (see below)
of the variance in the full set of predictors?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thr</code></td>
<td>
<p>Threshold for pca (above).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional parameters, passed to neuralnet.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The neural networks may be selected based on precision, recall or
a F1-score (default).
In binary classification, precision is the number of correct positive
results divided by the number of all positive predictions. Recall is
the number of correct positive results divided by the number of positive
results that could have been returned if the algorithm was perfect.
A F1 score (F-score/ F-measure) is a statistical
measure of accuracy. F1 scores considers both the precision
and the recall. A F1 score may be seen as a weighted average
(harmonic mean) of the precision and recall.
Precision, recall and F1 scores are at best 1 and at worst 0.
</p>


<h3>Value</h3>

<p>Returns trained artificial neural net.
</p>


<h3>Author(s)</h3>

<p>Marjolein Bruijning, Caspar A. Hallmann &amp; Marco D. Visser
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
dir.create("images")
## Create image sequence
traj &lt;- simulTrajec(path="images",
                    nframes=30,nIndividuals=20,domain='square',
                    h=0.01,rho=0.9,movingNoise=TRUE,
                    parsMoving = list(density=20, duration=10, size=1,
                                      speed = 10, colRange = c(0,1)),
                    sizes=runif(20,0.004,0.006))
## Load images
dir &lt;- "images"
allFullImages &lt;- loadImages (dirPictures=dir,nImages=1:30)
stillBack &lt;- createBackground(allFullImages,method="mean")
allImages &lt;- subtractBackground(stillBack)
partIden &lt;- identifyParticles(allImages,threshold=-0.1,
                                   pixelRange=c(3,400))
nframes &lt;- 3
frames &lt;- order(tapply(partIden$patchID,partIden$frame,length),
                decreasing=TRUE)[1:nframes]
mId &lt;- manuallySelect(particles=partIden,frame=frames)
finalNN &lt;- testNN(dat=mId,repetitions=10,maxH=4,prop=c(6,2,2))
summary(finalNN)

## End(Not run)
</code></pre>


</div>