<div class="container">

<table style="width: 100%;"><tr>
<td>prh_predictor1</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Predict the tag position on a diving animal from depth and acceleration data</h2>

<h3>Description</h3>

<p>Predict the tag position on a diving animal parameterized by p0, r0, and
h0, the canonical angles between the principal axes of the tag and the animal.
The tag orientation on the animal can change with time and this function
provides a way to estimate the orientation at the start and end of each suitable
dive. The function critically assumes that the animal rests horizontally at the
surface (at least on average) and dives steeply away from the surface without an
initial roll. If ascents are processed, there must also be no roll in the last
seconds of the ascents. See prh_predictor2 for a method more suitable to animals
that make short dives between respirations.
The function provides a graphical interface showing the estimated tag-to-animal
orientation throughout the deployment. Follow the directions above the top panel
of the figure to edit or delete an orientation estimate.
</p>


<h3>Usage</h3>

<pre><code class="language-R">prh_predictor1(P, A, sampling_rate = NULL, TH = 100, DIR = "descent")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>is a dive depth vector or sensor structure with units of m H2O.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>is an acceleration matrix or sensor structure with columns ax, ay, and az. Acceleration can be in any consistent unit, e.g., g or m/s^2, and must have the same sampling rate as P.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampling_rate</code></td>
<td>
<p>is the sampling rate of the sensor data in Hz (samples per second). This is only needed if neither A nor M are sensor structures.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TH</code></td>
<td>
<p>is an optional minimum dive depth threshold (default is 100m). Only the descents at the start of dives deeper than TH will be analysed (and the ascents at the end of dives deeper than TH if ALL is true).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DIR</code></td>
<td>
<p>is an optional dive direction constraint. The default (DIR = 'descent') is to only analyse descents as these tend to give better results. But if DIR = 'both', both descents and ascents are analysed.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>PRH, a data frame with columns <code>cue</code> <code>p0</code>, <code>r0</code>, <code>h0</code>, and <code>q</code>
with a row for each dive edge analysed. <code>cue</code> is the time in second-since-tag-start of the dive edge analysed.
<code>p0</code>, <code>r0</code>, and <code>h0</code> are the deduced tag orientation angles in radians.
<code>q</code> is the quality indicator with a low value (near 0, e.g., &lt;0.05) indicating that the data fit more consistently with the assumptions of the method.
</p>


<h3>See Also</h3>

<p>prh_predictor2, tag2animal
</p>


</div>