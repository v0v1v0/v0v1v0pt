<div class="container">

<table style="width: 100%;"><tr>
<td>dynreg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit time-varying regression model</h2>

<h3>Description</h3>

<p>Fits time-varying regression model with partly parametric components.
Time-dependent variables for longitudinal data.  The model assumes that the
mean of the observed responses given covariates is a linear time-varying
regression model :
</p>


<h3>Usage</h3>

<pre><code class="language-R">dynreg(
  formula = formula(data),
  data = parent.frame(),
  aalenmod,
  bandwidth = 0.5,
  id = NULL,
  bhat = NULL,
  start.time = 0,
  max.time = NULL,
  n.sim = 500,
  meansub = 1,
  weighted.test = 0,
  resample = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula object with the response on the left of a '~'
operator, and the independent terms on the right as regressors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data.frame with the variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aalenmod</code></td>
<td>
<p>Aalen model for measurement times. Specified as a survival
model (see aalen function).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bandwidth</code></td>
<td>
<p>bandwidth for local iterations. Default is 50% of the
range of the considered observation period.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>For timevarying covariates the variable must associate each record
with the id of a subject.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bhat</code></td>
<td>
<p>initial value for estimates. If NULL local linear estimate is
computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start.time</code></td>
<td>
<p>start of observation period where estimates are computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.time</code></td>
<td>
<p>end of observation period where estimates are computed.
Estimates thus computed from [start.time, max.time]. Default is max of data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.sim</code></td>
<td>
<p>number of simulations in resampling.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meansub</code></td>
<td>
<p>if '1' then the mean of the responses is subtracted before
the estimation is carried out.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weighted.test</code></td>
<td>
<p>to compute a variance weighted version of the
test-processes used for testing time-varying effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resample</code></td>
<td>
<p>returns resample processes.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p style="text-align: center;"><code class="reqn"> E( Z_{ij} | X_{ij}(t) ) = \beta^T(t) X_{ij}^1(t) + \gamma^T X_{ij}^2(t) </code>
</p>
 
<p>where <code class="reqn">Z_{ij}</code> is the j'th measurement at time t for the
i'th subject with covariates <code class="reqn">X_{ij}^1</code> and <code class="reqn">X_{ij}^2</code>. Resampling
is used for computing p-values for tests of timevarying effects.
The data for a subject is presented as multiple rows or 'observations', each
of which applies to an interval of observation (start, stop].  For counting
process data with the )start,stop] notation is used the 'id' variable is
needed to identify the records for each subject. The program assumes that
there are no ties, and if such are present random noise is added to break
the ties.
</p>


<h3>Value</h3>

<p>returns an object of type "dynreg". With the following arguments:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>cum</code></td>
<td>
<p>the cumulative regression coefficients. This is the efficient
estimator based on an initial smoother obtained by local linear regression :
</p>
<p style="text-align: center;"><code class="reqn"> \hat B(t) = \int_0^t \tilde \beta(s) ds+ \hspace{4 cm}</code>
</p>
 
<p style="text-align: center;"><code class="reqn">\int_0^t X^{-} (Diag(z) -Diag( X^T(s) \tilde \beta(s)) ) dp(ds \times dz), </code>
</p>
 
<p>where <code class="reqn">\tilde \beta(t)</code> is an initial estimate either
provided or computed by local linear regression. To plot this estimate use
type="eff.smooth" in the plot() command. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.cum</code></td>
<td>
<p>the martingale based pointwise variance estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robvar.cum</code></td>
<td>
<p>robust pointwise variances estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>estimate of semi-parametric components of model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.gamma</code></td>
<td>
<p>variance for gamma.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robvar.gamma</code></td>
<td>
<p>robust variance for gamma.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cum0</code></td>
<td>
<p>simple estimate of cumulative regression
coefficients that does not use use an initial smoothing based estimate
</p>
<p style="text-align: center;"><code class="reqn"> \hat B_0(t) = \int_0^t X^{-} Diag(z) dp(ds \times dz). </code>
</p>
<p> To plot this
estimate use type="0.mpp" in the plot() command. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.cum0</code></td>
<td>
<p>the martingale based pointwise variance estimates of cum0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cum.ms</code></td>
<td>
<p>estimate of cumulative regression coefficients based on
initial smoother (but robust to this estimator).  </p>
<p style="text-align: center;"><code class="reqn"> \hat B_{ms}(t) =
\int_0^t X^{-} (Diag(z)-f(s)) dp(ds \times dz), </code>
</p>
<p> where <code class="reqn">f</code> is chosen as
the matrix </p>
<p style="text-align: center;"><code class="reqn"> f(s) = Diag( X^T(s) \tilde \beta(s)) ( I - X_\alpha(s) X_\alpha^-(s) ), </code>
</p>

<p>where <code class="reqn">X_{\alpha}</code> is the design for the sampling
intensities.
This is also an efficient estimator when the initial estimator is consistent
for <code class="reqn">\beta(t)</code> and then asymptotically equivalent to cum, but small
sample properties appear inferior. Its variance is estimated by var.cum.
To plot this estimate use type="ms.mpp" in the plot() command. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cum.ly</code></td>
<td>
<p>estimator where local averages are subtracted. Special case of
cum.ms. To plot this estimate use type="ly.mpp" in plot.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.cum.ly</code></td>
<td>
<p>the martingale based pointwise variance estimates. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma0</code></td>
<td>
<p>estimate of parametric component of model.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.gamma0</code></td>
<td>
<p>estimate of variance of parametric component of model. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma.ly</code></td>
<td>
<p>estimate of parametric components of model. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.gamma.ly</code></td>
<td>
<p>estimate of variance of parametric component of model. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma.ms</code></td>
<td>
<p>estimate of variance of parametric component of model. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.gamma.ms</code></td>
<td>
<p>estimate of variance of parametric component of model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs.testBeq0</code></td>
<td>
<p>observed absolute value of supremum of cumulative
components scaled with the variance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval.testBeq0</code></td>
<td>
<p>p-value for
covariate effects based on supremum test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sim.testBeq0</code></td>
<td>
<p>resampled
supremum values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs.testBeqC</code></td>
<td>
<p>observed absolute value of supremum of
difference between observed cumulative process and estimate under null of
constant effect.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval.testBeqC</code></td>
<td>
<p>p-value based on resampling.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sim.testBeqC</code></td>
<td>
<p>resampled supremum values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs.testBeqC.is</code></td>
<td>
<p>observed integrated squared differences between
observed cumulative and estimate under null of constant effect.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval.testBeqC.is</code></td>
<td>
<p>p-value based on resampling.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sim.testBeqC.is</code></td>
<td>
<p>resampled supremum values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.band</code></td>
<td>
<p>resampling based constant to construct robust 95% uniform
confidence bands.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test.procBeqC</code></td>
<td>
<p>observed test-process of difference
between observed cumulative process and estimate under null of constant effect.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sim.test.procBeqC</code></td>
<td>
<p>list of 50 random realizations of
test-processes under null based on resampling.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariance</code></td>
<td>
<p>covariances for nonparametric terms of model.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Thomas Scheike
</p>


<h3>References</h3>

<p>Martinussen and Scheike, Dynamic Regression Models for Survival
Data, Springer (2006).
</p>


<h3>Examples</h3>

<pre><code class="language-R">
 
## this runs slowly and is therfore donttest
data(csl)
indi.m&lt;-rep(1,length(csl$lt)) 

# Fits time-varying regression model 
out&lt;-dynreg(prot~treat+prot.prev+sex+age,data=csl,
Surv(lt,rt,indi.m)~+1,start.time=0,max.time=2,id=csl$id,
n.sim=100,bandwidth=0.7,meansub=0)
summary(out)
par(mfrow=c(2,3))
plot(out)

# Fits time-varying semi-parametric regression model.
outS&lt;-dynreg(prot~treat+const(prot.prev)+const(sex)+const(age),data=csl,
Surv(lt,rt,indi.m)~+1,start.time=0,max.time=2,id=csl$id,
n.sim=100,bandwidth=0.7,meansub=0)
summary(outS)


</code></pre>


</div>