<div class="container">

<table style="width: 100%;"><tr>
<td>tfb_correlation_cholesky</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Maps unconstrained reals to Cholesky-space correlation matrices.</h2>

<h3>Description</h3>

<p>This bijector is a mapping between <code>R^{n}</code> and the <code>n</code>-dimensional manifold of
Cholesky-space correlation matrices embedded in <code>R^{m^2}</code>, where <code>n</code> is the
<code>(m - 1)</code>th triangular number; i.e. <code>n = 1 + 2 + ... + (m - 1)</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tfb_correlation_cholesky(validate_args = FALSE, name = "correlation_cholesky")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>validate_args</code></td>
<td>
<p>Logical, default FALSE. Whether to validate input with asserts. If validate_args is
FALSE, and the inputs are invalid, correct behavior is not guaranteed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>name prefixed to Ops created by this class.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Mathematical Details
</p>
<p>The image of unconstrained reals under the <code>CorrelationCholesky</code> bijector is
the set of correlation matrices which are positive definite.
A <a href="https://en.wikipedia.org/wiki/Correlation_and_dependence#Correlation_matrices">correlation matrix</a>
can be characterized as a symmetric positive semidefinite matrix with 1s on
the main diagonal. However, the correlation matrix is positive definite if no
component can be expressed as a linear combination of the other components.
For a lower triangular matrix <code>L</code> to be a valid Cholesky-factor of a positive
definite correlation matrix, it is necessary and sufficient that each row of
<code>L</code> have unit Euclidean norm. To see this, observe that if <code>L_i</code> is the
<code>i</code>th row of the Cholesky factor corresponding to the correlation matrix <code>R</code>,
then the <code>i</code>th diagonal entry of <code>R</code> satisfies:
</p>
<div class="sourceCode"><pre>1 = R_i,i = L_i . L_i = ||L_i||^2
</pre></div>
<p>where '.' is the dot product of vectors and <code style="white-space: pre;">⁠||...||⁠</code> denotes the Euclidean
norm. Furthermore, observe that <code style="white-space: pre;">⁠R_i,j⁠</code> lies in the interval <code style="white-space: pre;">⁠[-1, 1]⁠</code>. By the
Cauchy-Schwarz inequality:
</p>
<div class="sourceCode"><pre>|R_i,j| = |L_i . L_j| &lt;= ||L_i|| ||L_j|| = 1
</pre></div>
<p>This is a consequence of the fact that <code>R</code> is symmetric positive definite with
1s on the main diagonal.
The LKJ distribution with <code>input_output_cholesky=TRUE</code> generates samples from
(and computes log-densities on) the set of Cholesky factors of positive
definite correlation matrices. The <code>CorrelationCholesky</code> bijector provides
a bijective mapping from unconstrained reals to the support of the LKJ
distribution.
</p>


<h3>Value</h3>

<p>a bijector instance.
</p>


<h3>References</h3>


<ul>
<li> <p><a href="https://mc-stan.org/docs/2_18/functions-reference/cholesky-lkj-correlation-distribution.html">Stan Manual. Section 24.2. Cholesky LKJ Correlation Distribution.</a>
</p>
</li>
<li>
<p> Daniel Lewandowski, Dorota Kurowicka, and Harry Joe, "Generating random correlation matrices based on vines and extended onion method," Journal of Multivariate Analysis 100 (2009), pp 1989-2001.
</p>
</li>
</ul>
<h3>See Also</h3>

<p>For usage examples see <code>tfb_forward()</code>, <code>tfb_inverse()</code>, <code>tfb_inverse_log_det_jacobian()</code>.
</p>
<p>Other bijectors: 
<code>tfb_absolute_value()</code>,
<code>tfb_affine_linear_operator()</code>,
<code>tfb_affine_scalar()</code>,
<code>tfb_affine()</code>,
<code>tfb_ascending()</code>,
<code>tfb_batch_normalization()</code>,
<code>tfb_blockwise()</code>,
<code>tfb_chain()</code>,
<code>tfb_cholesky_outer_product()</code>,
<code>tfb_cholesky_to_inv_cholesky()</code>,
<code>tfb_cumsum()</code>,
<code>tfb_discrete_cosine_transform()</code>,
<code>tfb_expm1()</code>,
<code>tfb_exp()</code>,
<code>tfb_ffjord()</code>,
<code>tfb_fill_scale_tri_l()</code>,
<code>tfb_fill_triangular()</code>,
<code>tfb_glow()</code>,
<code>tfb_gompertz_cdf()</code>,
<code>tfb_gumbel_cdf()</code>,
<code>tfb_gumbel()</code>,
<code>tfb_identity()</code>,
<code>tfb_inline()</code>,
<code>tfb_invert()</code>,
<code>tfb_iterated_sigmoid_centered()</code>,
<code>tfb_kumaraswamy_cdf()</code>,
<code>tfb_kumaraswamy()</code>,
<code>tfb_lambert_w_tail()</code>,
<code>tfb_masked_autoregressive_default_template()</code>,
<code>tfb_masked_autoregressive_flow()</code>,
<code>tfb_masked_dense()</code>,
<code>tfb_matrix_inverse_tri_l()</code>,
<code>tfb_matvec_lu()</code>,
<code>tfb_normal_cdf()</code>,
<code>tfb_ordered()</code>,
<code>tfb_pad()</code>,
<code>tfb_permute()</code>,
<code>tfb_power_transform()</code>,
<code>tfb_rational_quadratic_spline()</code>,
<code>tfb_rayleigh_cdf()</code>,
<code>tfb_real_nvp_default_template()</code>,
<code>tfb_real_nvp()</code>,
<code>tfb_reciprocal()</code>,
<code>tfb_reshape()</code>,
<code>tfb_scale_matvec_diag()</code>,
<code>tfb_scale_matvec_linear_operator()</code>,
<code>tfb_scale_matvec_lu()</code>,
<code>tfb_scale_matvec_tri_l()</code>,
<code>tfb_scale_tri_l()</code>,
<code>tfb_scale()</code>,
<code>tfb_shifted_gompertz_cdf()</code>,
<code>tfb_shift()</code>,
<code>tfb_sigmoid()</code>,
<code>tfb_sinh_arcsinh()</code>,
<code>tfb_sinh()</code>,
<code>tfb_softmax_centered()</code>,
<code>tfb_softplus()</code>,
<code>tfb_softsign()</code>,
<code>tfb_split()</code>,
<code>tfb_square()</code>,
<code>tfb_tanh()</code>,
<code>tfb_transform_diagonal()</code>,
<code>tfb_transpose()</code>,
<code>tfb_weibull_cdf()</code>,
<code>tfb_weibull()</code>
</p>


</div>