<div class="container">

<table style="width: 100%;"><tr>
<td>bootstrapDiagram</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Bootstrapped Confidence Set for a Persistence Diagram, using the Bottleneck Distance (or the Wasserstein distance).
</h2>

<h3>Description</h3>

<p>The function <code>bootstrapDiagram</code> computes a <code>(1-alpha)</code> confidence set for the Persistence Diagram of a filtration of sublevel sets (or superlevel sets) of a function evaluated over a grid of points. The function returns the (<code>1-alpha</code>) quantile of <code>B</code> bottleneck distances (or Wasserstein distances), computed in <code>B</code> iterations of the bootstrap algorithm.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bootstrapDiagram(
    X, FUN, lim, by, maxdimension = length(lim) / 2 - 1,
    sublevel = TRUE, library = "GUDHI", B = 30, alpha = 0.05,
    distance = "bottleneck", dimension = min(1, maxdimension),
	p = 1, parallel = FALSE, printProgress = FALSE, weight = NULL,
    ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>an <code class="reqn">n</code> by <code class="reqn">d</code> matrix of coordinates, used by the function <code>FUN</code>, where <code class="reqn">n</code> is the number of points stored in <code>X</code> and <code class="reqn">d</code> is the dimension of the space.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FUN</code></td>
<td>

<p>a function whose inputs are 1) an <code class="reqn">n</code> by <code class="reqn">d</code> matrix of coordinates <code>X</code>, 2) an <code class="reqn">m</code> by <code class="reqn">d</code> matrix of coordinates <code>Grid</code>, 3) an optional smoothing parameter, and returns a numeric vector of length <code class="reqn">m</code>. For example see <code>distFct</code>,  <code>kde</code>, and <code>dtm</code>  which compute the distance function, the kernel density estimator and the distance to measure, over a grid of points using the input <code>X</code>. Note that <code>Grid</code> is not an input of <code>bootstrapDiagram</code>, but is automatically computed by the function using <code>lim</code> and <code>by</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lim</code></td>
<td>

<p>a <code class="reqn">2</code> by <code class="reqn">d</code> matrix, where each column specifies the range of each dimension of the grid, over which the function <code>FUN</code> is evaluated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by</code></td>
<td>

<p>either a number or a vector of length <code class="reqn">d</code> specifying space between points of the grid in each dimension. If a number is given, then same space is used in each dimension.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxdimension</code></td>
<td>

<p>a number that indicates the maximum dimension to compute persistent homology to. The default value is <code class="reqn">d - 1</code>, which is (dimension of embedding space - 1).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sublevel</code></td>
<td>

<p>a logical variable indicating if the Persistence Diagram should be computed for sublevel sets (<code>TRUE</code>) or superlevel sets (<code>FALSE</code>) of the function. The default value is <code>TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>library</code></td>
<td>

<p>a string specifying which library to compute the persistence diagram. The user can choose either the library <code>"GUDHI"</code>, <code>"Dionysus"</code>, or <code>"PHAT"</code>. The default value is <code>"GUDHI"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>

<p>the number of bootstrap iterations. The default value is <code>30</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>The function <code>bootstrapDiagram</code> returns a (<code>1 - alpha</code>) quantile. The default value is <code>0.05</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>

<p>a string specifying the distance to be used for persistence diagrams: either <code>"bottleneck"</code> or <code>"wasserstein"</code>. The default value is <code>"bottleneck"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dimension</code></td>
<td>

<p><code>dimension</code> is an integer or a vector specifying the dimension of the features used to compute the bottleneck distance. <code>0</code> for connected components, <code>1</code> for loops, <code>2</code> for voids, and so on. The default value is <code>1</code> if <code class="reqn">maxdimension \ge 1</code>, and else <code>0</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>

<p>if <code>distance == "wasserstein"</code>, then <code>p</code> is an integer specifying the power to be used in the computation of the Wasserstein distance. The default value is <code>1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>

<p>logical: if <code>TRUE</code> the bootstrap iterations are parallelized, using the library <code>parallel</code>. The default value is <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>printProgress</code></td>
<td>

<p>if <code>TRUE</code> a progress bar is printed. The default value is <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>

<p>either NULL, a number, or a vector of length <code class="reqn">n</code>. If it is NULL, weight is not used. If it is a number, then same weight is applied to each points of <code>X</code>. If it is a vector, <code>weight</code> represents weights of each points of <code>X</code>. The default value is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>additional parameters for the function <code>FUN</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>bootstrapDiagram</code> uses <code>gridDiag</code> to compute the persistence diagram of the input function using the entire sample. Then the bootstrap algorithm, for <code>B</code> times, computes the bottleneck distance between the original persistence diagram and the one computed using a subsample. Finally the (<code>1-alpha</code>) quantile of these <code>B</code> values is returned. See (Chazal, Fasy, Lecci, Michel, Rinaldo, and Wasserman, 2014) for discussion of the method.
</p>


<h3>Value</h3>

<p>The function <code>bootstrapDiagram</code> returns the (<code>1-alpha</code>) quantile of the values computed by the bootstrap algorithm. 
</p>


<h3>Note</h3>

<p>The function <code>bootstrapDiagram</code> uses the C++ library <a href="https://www.mrzv.org/software/dionysus/">Dionysus</a> for the computation of bottleneck and Wasserstein distances. See references.
</p>


<h3>Author(s)</h3>

<p>Jisu Kim and Fabrizio Lecci
</p>


<h3>References</h3>

<p>Chazal F, Fasy BT, Lecci F, Michel B, Rinaldo A, Wasserman L (2014). "Robust Topological Inference: Distance-To-a-Measure and Kernel Distance." Technical Report. 
</p>
<p>Wasserman L (2004), "All of statistics: a concise course in statistical inference." Springer.
</p>
<p>Morozov D (2007). "Dionysus, a C++ library for computing persistent homology." <a href="https://www.mrzv.org/software/dionysus/">https://www.mrzv.org/software/dionysus/</a>
</p>


<h3>See Also</h3>

<p><code>bottleneck</code>, <code>bootstrapBand</code>,
<code>distFct</code>, <code>kde</code>, <code>kernelDist</code>, <code>dtm</code>,
<code>summary.diagram</code>, <code>plot.diagram</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## confidence set for the Kernel Density Diagram

# input data
n &lt;- 400
XX &lt;- circleUnif(n)

## Ranges of the grid
Xlim &lt;- c(-1.8, 1.8)
Ylim &lt;- c(-1.6, 1.6)
lim &lt;- cbind(Xlim, Ylim)
by &lt;- 0.05

h &lt;- .3  #bandwidth for the function kde

#Kernel Density Diagram of the superlevel sets
Diag &lt;- gridDiag(XX, kde, lim = lim, by = by, sublevel = FALSE,
                 printProgress = TRUE, h = h) 

# confidence set
B &lt;- 10       ## the number of bootstrap iterations should be higher!
              ## this is just an example
alpha &lt;- 0.05

cc &lt;- bootstrapDiagram(XX, kde, lim = lim, by = by, sublevel = FALSE, B = B,
          alpha = alpha, dimension = 1, printProgress = TRUE, h = h)

plot(Diag[["diagram"]], band = 2 * cc)
</code></pre>


</div>