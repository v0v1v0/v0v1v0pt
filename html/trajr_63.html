<div class="container">

<table style="width: 100%;"><tr>
<td>TrajVelocity</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Velocity of a trajectory</h2>

<h3>Description</h3>

<p>The velocity is approximated at each point of the trajectory using
first-order finite differences. Central, forward or backward differences can
be used. Central differences yield a more accurate approximation if the
velocity is smooth. As a practical guide, if velocity doesn't change much
between steps, use central differences. If it changes substantially (and not
just as an artifact of recording noise), then use either forward or backward
differences.
</p>


<h3>Usage</h3>

<pre><code class="language-R">TrajVelocity(trj, diff = c("central", "forward", "backward"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>trj</code></td>
<td>
<p>Trajectory whose velocity is to be calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diff</code></td>
<td>
<p>Type of difference to be calculated, one of "central" (the
default), "forward" or "backward".</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Intuitively, think of the central difference velocity at a point as the mean
of the velocities of the two adjacent steps. Forward difference velocity is
the velocity of the step starting at the point. Backward difference is the
velocity of the step ending at the point.
</p>


<h3>Value</h3>

<p>A vector of complex numbers representing the velocity at each point
along the trajectory. The modulus (<code>Mod(v)</code>) is the magnitude of the
velocity, i.e. the speed; the argument (<code>Arg(v)</code>) is the direction of
the velocity; the real part (<code>Re(v)</code>) is velocity in the X direction;
and the imaginary part (<code>Im(v)</code>) is velocity in the Y direction. The
vector has an attribute, <code>trj</code>, with the trajectory as its value. If
<code>diff</code> is <code>"central"</code>, the first and last velocity values are
<code>NA</code> since velocity cannot be calculated for them. If <code>diff</code> is
<code>"forward"</code>, the last value will be NA, and if <code>diff</code> is
<code>"backward"</code>, the first value will be NA.
</p>


<h3>See Also</h3>

<p><code>TrajAcceleration</code> for calculating acceleration;
<code>TrajResampleTime</code> and <code>TrajRediscretize</code> to resample
a trajectory to fixed time or length steps; <code>TrajSpeedIntervals</code>
for calculating when speed crosses some threshold; Finite differences on
<a href="https://en.wikipedia.org/wiki/Finite_difference">Wikipedia</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(11)
trj &lt;- TrajGenerate(100)
# calculate velocity
vel &lt;- TrajVelocity(trj)

# Obtain speed over time, with NAs removed
speed &lt;- na.omit(data.frame(speed = Mod(vel), time = trj$time))

plot(speed ~ time, speed, type = 'l')

</code></pre>


</div>