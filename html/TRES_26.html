<div class="container">

<table style="width: 100%;"><tr>
<td>TPRdim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Envelope dimension by cross-validation for tensor predictor regression (TPR).</h2>

<h3>Description</h3>

<p>Select the envelope dimension by cross-validation for tensor predictor regression.
</p>


<h3>Usage</h3>

<pre><code class="language-R">TPRdim(x, y, maxdim = 10, nfolds = 5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The predictor tensor instance of dimension <code class="reqn">p_1\times p_2\times\cdots\times p_m \times n</code>, where <code class="reqn">n</code> is the sample size. Array with the same dimensions and matrix with dimension <code class="reqn">p\times n</code> are acceptable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The response matrix of dimension <code class="reqn">r \times n</code>, where <code class="reqn">n</code> is the sample size. Vector of length <code class="reqn">n</code> is acceptable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxdim</code></td>
<td>
<p>The largest dimension to be considered for selection.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nfolds</code></td>
<td>
<p>Number of folds for cross-validation.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>According to Zhang and Li (2017), the dimensions of envelopes at each mode are assumed to be equal, so the <code>u</code> returned is a single value representing the equal envelope dimension.
</p>
<p>For each dimension <code>u</code> in <code>1:maxdim</code>, we obtain the prediction
</p>
<p style="text-align: center;"><code class="reqn">\hat{Y}_i = \hat{B}_{(m+1)} vec(X_i)</code>
</p>

<p>for each predictor <code class="reqn">X_i</code> in the <code class="reqn">k</code>-th testing dataset, <code class="reqn">k = 1,\ldots,</code><code>nfolds</code>, where <code class="reqn">\hat{B}</code> is the estimated coefficient based on the <code class="reqn">k</code>-th training dataset. And the mean squared error for the <code class="reqn">k</code>-th testing dataset is defined as
</p>
<p style="text-align: center;"><code class="reqn">1/nk \sum_{i=1}^{nk}||Y_i-\hat{Y}_i||_F^2,</code>
</p>

<p>where <code class="reqn">nk</code> is the sample size of the <code class="reqn">k</code>-th testing dataset and <code class="reqn">||\cdot||_F</code> denotes the Frobenius norm. Then, the average of <code>nfolds</code> mean squared error is recorded as cross-validation mean squared error for the dimension <code>u</code>.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mincv</code></td>
<td>
<p>The minimal cross-validation mean squared error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>The envelope subspace dimension selected.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Zhang, X. and Li, L., 2017. Tensor envelope partial least-squares regression. Technometrics, 59(4), pp.426-436.
</p>


<h3>See Also</h3>

<p><code>TPRsim</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># The dimension of predictor
p &lt;- c(10, 10, 10)
# The envelope dimensions u.
u &lt;- c(1, 1, 1)
# The dimension of response
r &lt;- 5
# The sample size
n &lt;- 200
dat &lt;- TPRsim(p = p, r = r, u = u, n = n)
x &lt;- dat$x
y &lt;- dat$y
TPRdim(x, y, maxdim = 5)

## Use dataset square. (time-consuming)

data("square")
x &lt;- square$x
y &lt;- square$y
# check the dimension of x
dim(x)
# use 32 as the maximal envelope dimension
TPRdim(x, y, maxdim=32)

</code></pre>


</div>