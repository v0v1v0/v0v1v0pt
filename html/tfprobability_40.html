<div class="container">

<table style="width: 100%;"><tr>
<td>mcmc_metropolis_hastings</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Runs one step of the Metropolis-Hastings algorithm.</h2>

<h3>Description</h3>

<p>The Metropolis-Hastings algorithm is a Markov chain Monte Carlo (MCMC) technique which uses a proposal distribution
to eventually sample from a target distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mcmc_metropolis_hastings(inner_kernel, seed = NULL, name = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>inner_kernel</code></td>
<td>
<p><code>TransitionKernel</code>-like object which has <code>collections$namedtuple</code>
<code>kernel_results</code> and which contains a <code>target_log_prob</code> member and optionally a <code>log_acceptance_correction</code> member.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>integer to seed the random number generator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>string prefixed to Ops created by this function. Default value: <code>NULL</code> (i.e., "mh_kernel").</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Note: <code>inner_kernel$one_step</code> must return <code>kernel_results</code> as a <code>collections$namedtuple</code> which must:
</p>

<ul>
<li>
<p> have a <code>target_log_prob</code> field,
</p>
</li>
<li>
<p> optionally have a <code>log_acceptance_correction</code> field, and,
</p>
</li>
<li>
<p> have only fields which are <code>Tensor</code>-valued.
</p>
</li>
</ul>
<p>The Metropolis-Hastings log acceptance-probability is computed as:
</p>
<div class="sourceCode"><pre>log_accept_ratio = (current_kernel_results.target_log_prob
                   - previous_kernel_results.target_log_prob
                   + current_kernel_results.log_acceptance_correction)
</pre></div>
<p>If <code>current_kernel_results$log_acceptance_correction</code> does not exist, it is
presumed <code>0</code> (i.e., that the proposal distribution is symmetric).
The most common use-case for <code>log_acceptance_correction</code> is in the
Metropolis-Hastings algorithm, i.e.,
</p>
<div class="sourceCode"><pre>accept_prob(x' | x) = p(x') / p(x) (g(x|x') / g(x'|x))
where,
p  represents the target distribution,
g  represents the proposal (conditional) distribution,
x' is the proposed state, and,
x  is current state
</pre></div>
<p>The log of the parenthetical term is the <code>log_acceptance_correction</code>.
The <code>log_acceptance_correction</code> may not necessarily correspond to the ratio of
proposal distributions, e.g, <code>log_acceptance_correction</code> has a different
interpretation in Hamiltonian Monte Carlo.
</p>


<h3>Value</h3>

<p>a Monte Carlo sampling kernel
</p>


<h3>See Also</h3>

<p>Other mcmc_kernels: 
<code>mcmc_dual_averaging_step_size_adaptation()</code>,
<code>mcmc_hamiltonian_monte_carlo()</code>,
<code>mcmc_metropolis_adjusted_langevin_algorithm()</code>,
<code>mcmc_no_u_turn_sampler()</code>,
<code>mcmc_random_walk_metropolis()</code>,
<code>mcmc_replica_exchange_mc()</code>,
<code>mcmc_simple_step_size_adaptation()</code>,
<code>mcmc_slice_sampler()</code>,
<code>mcmc_transformed_transition_kernel()</code>,
<code>mcmc_uncalibrated_hamiltonian_monte_carlo()</code>,
<code>mcmc_uncalibrated_langevin()</code>,
<code>mcmc_uncalibrated_random_walk()</code>
</p>


</div>