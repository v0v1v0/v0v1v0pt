<div class="container">

<table style="width: 100%;"><tr>
<td>.get_gtw</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>g_tw: total conductance to water vapour (m/s)</h2>

<h3>Description</h3>

<p>g_tw: total conductance to water vapour (m/s)
</p>


<h3>Usage</h3>

<pre><code class="language-R">.get_gtw(T_leaf, pars, unitless)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>T_leaf</code></td>
<td>
<p>Leaf temperature in Kelvin</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pars</code></td>
<td>
<p>Concatenated parameters (<code>leaf_par</code>, <code>enviro_par</code>, and <code>constants</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unitless</code></td>
<td>
<p>Logical. Should function use parameters with <code>units</code>? The function is faster when FALSE, but input must be in correct units or else results will be incorrect without any warning.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><b>Total conductance to water vapor:</b> The total conductance to water vapor (<code class="reqn">g_\mathrm{tw}</code>) is the sum of the parallel lower (abaxial) and upper (adaxial) conductances:
</p>
<p style="text-align: center;"><code class="reqn">g_\mathrm{tw} = g_\mathrm{w,lower} + g_\mathrm{w,upper}</code>
</p>

<p>The conductance to water vapor on each surface is a function of parallel stomatal (<code class="reqn">g_\mathrm{sw}</code>) and cuticular (<code class="reqn">g_\mathrm{uw}</code>) conductances in series with the boundary layer conductance (<code class="reqn">g_\mathrm{bw}</code>). The stomatal, cuticular, and boundary layer conductance on the lower surface are:
</p>
<p style="text-align: center;"><code class="reqn">g_\mathrm{sw,lower} = g_\mathrm{sw} (1 - sr) R (T_\mathrm{leaf} + T_\mathrm{air}) / 2</code>
</p>

<p style="text-align: center;"><code class="reqn">g_\mathrm{uw,lower} = g_\mathrm{uw} / 2 R (T_\mathrm{leaf} + T_\mathrm{air}) / 2</code>
</p>

<p><br>
See <code>.get_gbw</code> for details on calculating boundary layer conductance. The equations for the upper surface are:
</p>
<p style="text-align: center;"><code class="reqn">g_\mathrm{sw,upper} = g_\mathrm{sw} sr R (T_\mathrm{leaf} + T_\mathrm{air}) / 2</code>
</p>

<p style="text-align: center;"><code class="reqn">g_\mathrm{uw,upper} = g_\mathrm{uw} / 2 R (T_\mathrm{leaf} + T_\mathrm{air}) / 2</code>
</p>

<p><br>
Note that the stomatal and cuticular conductances are given in units of (<code class="reqn">\mu</code>mol H2O) / (m<code class="reqn">^2</code> s Pa) (see <code>make_leafpar</code>) and converted to m/s using the ideal gas law. The total leaf stomatal (<code class="reqn">g_\mathrm{sw}</code>) and cuticular (<code class="reqn">g_\mathrm{uw}</code>) conductances are partitioned across lower and upper surfaces. The stomatal conductance on each surface depends on stomatal ratio (sr); the cuticular conductance is assumed identical on both surfaces. 
</p>

<table>
<tr>
<td style="text-align: left;">
<em>Symbol</em> </td>
<td style="text-align: left;"> <em>R</em> </td>
<td style="text-align: left;"> <em>Description</em> </td>
<td style="text-align: left;"> <em>Units</em> </td>
<td style="text-align: left;"> <em>Default</em>
</td>
</tr>
<tr>
<td style="text-align: left;">
<code class="reqn">g_\mathrm{sw}</code> </td>
<td style="text-align: left;"> <code>g_sw</code> </td>
<td style="text-align: left;"> stomatal conductance to H2O </td>
<td style="text-align: left;"> (<code class="reqn">\mu</code>mol H2O) / (m<code class="reqn">^2</code> s Pa) </td>
<td style="text-align: left;"> 5</td>
</tr>
<tr>
<td style="text-align: left;">
<code class="reqn">g_\mathrm{uw}</code> </td>
<td style="text-align: left;"> <code>g_uw</code> </td>
<td style="text-align: left;"> cuticular conductance to H2O </td>
<td style="text-align: left;"> (<code class="reqn">\mu</code>mol H2O) / (m<code class="reqn">^2</code> s Pa) </td>
<td style="text-align: left;"> 0.1</td>
</tr>
<tr>
<td style="text-align: left;">
<code class="reqn">R</code> </td>
<td style="text-align: left;"> <code>R</code> </td>
<td style="text-align: left;"> ideal gas constant </td>
<td style="text-align: left;"> J / (mol K) </td>
<td style="text-align: left;"> 8.3144598</td>
</tr>
<tr>
<td style="text-align: left;">
<code class="reqn">\mathrm{logit}(sr)</code> </td>
<td style="text-align: left;"> <code>logit_sr</code> </td>
<td style="text-align: left;"> stomatal ratio (logit transformed) </td>
<td style="text-align: left;"> none </td>
<td style="text-align: left;"> 0 = logit(0.5)</td>
</tr>
<tr>
<td style="text-align: left;">
<code class="reqn">T_\mathrm{air}</code> </td>
<td style="text-align: left;"> <code>T_air</code> </td>
<td style="text-align: left;"> air temperature </td>
<td style="text-align: left;"> K </td>
<td style="text-align: left;"> 298.15</td>
</tr>
<tr>
<td style="text-align: left;">
<code class="reqn">T_\mathrm{leaf}</code> </td>
<td style="text-align: left;"> <code>T_leaf</code> </td>
<td style="text-align: left;"> leaf temperature </td>
<td style="text-align: left;"> K </td>
<td style="text-align: left;"> input
</td>
</tr>
</table>
<h3>Value</h3>

<p>Value in m/s of class <code>units</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Total conductance to water vapor

## Hypostomatous leaf; default parameters
leaf_par &lt;- make_leafpar(replace = list(logit_sr = set_units(-Inf)))
enviro_par &lt;- make_enviropar()
constants &lt;- make_constants()
pars &lt;- c(leaf_par, enviro_par, constants)
T_leaf &lt;- set_units(300, K)

## Fixing boundary layer conductance rather than calculating
gbw_lower &lt;- set_units(0.1, m / s)
gbw_upper &lt;- set_units(0.1, m / s)

# Lower surface ----
## Note that pars$logit_sr is logit-transformed! Use stats::plogis() to convert to proportion.
gsw_lower &lt;- set_units(pars$g_sw * (set_units(1) - stats::plogis(pars$logit_sr)) * pars$R * 
                         ((T_leaf + pars$T_air) / 2), "m / s")
guw_lower &lt;- set_units(pars$g_uw * 0.5 * pars$R * ((T_leaf + pars$T_air) / 2), m / s)
gtw_lower &lt;- 1 / (1 / (gsw_lower + guw_lower) + 1 / gbw_lower)

# Upper surface ----
gsw_upper &lt;- set_units(pars$g_sw * stats::plogis(pars$logit_sr) * pars$R * 
                         ((T_leaf + pars$T_air) / 2), m / s)
guw_upper &lt;- set_units(pars$g_uw * 0.5 * pars$R * ((T_leaf + pars$T_air) / 2), m / s)
gtw_upper &lt;- 1 / (1 / (gsw_upper + guw_upper) + 1 / gbw_upper)

## Lower and upper surface are in parallel
g_tw &lt;- gtw_lower + gtw_upper

</code></pre>


</div>