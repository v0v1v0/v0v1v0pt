<div class="container">

<table style="width: 100%;"><tr>
<td>plot_stl_diagnostics</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Visualize STL Decomposition Features for One or More Time Series</h2>

<h3>Description</h3>

<p>An interactive and scalable function for visualizing time series STL Decomposition.
Plots are available in interactive <code>plotly</code> (default) and static <code>ggplot2</code> format.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_stl_diagnostics(
  .data,
  .date_var,
  .value,
  .facet_vars = NULL,
  .feature_set = c("observed", "season", "trend", "remainder", "seasadj"),
  .frequency = "auto",
  .trend = "auto",
  .message = TRUE,
  .facet_scales = "free",
  .line_color = "#2c3e50",
  .line_size = 0.5,
  .line_type = 1,
  .line_alpha = 1,
  .title = "STL Diagnostics",
  .x_lab = "",
  .y_lab = "",
  .interactive = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>.data</code></td>
<td>
<p>A <code>tibble</code> or <code>data.frame</code> with a time-based column</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.date_var</code></td>
<td>
<p>A column containing either date or date-time values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.value</code></td>
<td>
<p>A column containing numeric values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.facet_vars</code></td>
<td>
<p>One or more grouping columns that broken out into <code>ggplot2</code> facets.
These can be selected using <code>tidyselect()</code> helpers (e.g <code>contains()</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.feature_set</code></td>
<td>
<p>The STL decompositions to visualize.
Select one or more of "observed", "season", "trend", "remainder", "seasadj".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.frequency</code></td>
<td>
<p>Controls the seasonal adjustment (removal of seasonality).
Input can be either "auto", a time-based definition (e.g. "2 weeks"),
or a numeric number of observations per frequency (e.g. 10).
Refer to <code>tk_get_frequency()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.trend</code></td>
<td>
<p>Controls the trend component.
For STL, trend controls the sensitivity of the lowess smoother, which is used to remove the remainder.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.message</code></td>
<td>
<p>A boolean. If <code>TRUE</code>, will output information related to automatic frequency
and trend selection (if applicable).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.facet_scales</code></td>
<td>
<p>Control facet x &amp; y-axis ranges. Options include "fixed", "free", "free_y", "free_x"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.line_color</code></td>
<td>
<p>Line color.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.line_size</code></td>
<td>
<p>Line size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.line_type</code></td>
<td>
<p>Line type.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.line_alpha</code></td>
<td>
<p>Line alpha (opacity). Range: (0, 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.title</code></td>
<td>
<p>Plot title.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.x_lab</code></td>
<td>
<p>Plot x-axis label</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.y_lab</code></td>
<td>
<p>Plot y-axis label</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.interactive</code></td>
<td>
<p>If TRUE, returns a <code>plotly</code> interactive plot.
If FALSE, returns a static <code>ggplot2</code> plot.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>plot_stl_diagnostics()</code> function generates a Seasonal-Trend-Loess decomposition.
The function is "tidy" in the sense that it works
on data frames and is designed to work with <code>dplyr</code> groups.
</p>
<p><strong>STL method</strong>:
</p>
<p>The STL method implements time series decomposition using
the underlying <code>stats::stl()</code>. The decomposition separates the
"season" and "trend" components from
the "observed" values leaving the "remainder".
</p>
<p><strong>Frequency &amp; Trend Selection</strong>
</p>
<p>The user can control two parameters: <code>.frequency</code> and <code>.trend</code>.
</p>

<ol>
<li>
<p> The <code>.frequency</code> parameter adjusts the "season" component that is removed
from the "observed" values.
</p>
</li>
<li>
<p> The <code>.trend</code> parameter adjusts the
trend window (<code>t.window</code> parameter from <code>stl()</code>) that is used.
</p>
</li>
</ol>
<p>The user may supply both <code>.frequency</code>
and <code>.trend</code> as time-based durations (e.g. "6 weeks") or numeric values
(e.g. 180) or "auto", which automatically selects the frequency and/or trend
based on the scale of the time series.
</p>


<h3>Value</h3>

<p>A <code>plotly</code> or <code>ggplot2</code> visualization
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(dplyr)

# ---- SINGLE TIME SERIES DECOMPOSITION ----
m4_hourly %&gt;%
    filter(id == "H10") %&gt;%
    plot_stl_diagnostics(
        date, value,
        # Set features to return, desired frequency and trend
        .feature_set = c("observed", "season", "trend", "remainder"),
        .frequency   = "24 hours",
        .trend       = "1 week",
        .interactive = FALSE)


# ---- GROUPS ----
m4_hourly %&gt;%
    group_by(id) %&gt;%
    plot_stl_diagnostics(
        date, value,
        .feature_set = c("observed", "season", "trend"),
        .interactive = FALSE)



</code></pre>


</div>