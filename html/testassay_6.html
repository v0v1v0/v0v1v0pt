<div class="container">

<table style="width: 100%;"><tr>
<td>testassay</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Hypothesis testing procedure for assay validation for precision</h2>

<h3>Description</h3>

<p>Does an m:n:q procedure for assay validation for precision.
Returns an object of class 'assaytest'. There is are <code>predict</code>
and <code>print</code> methods for that class.
</p>


<h3>Usage</h3>

<pre><code class="language-R">testassay(x, m, n, q = 0.9, model = "normal", constant = "SD", data = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The vector of assay values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>The vector of values indicating sample membership</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The vector of values indicating replicate membership</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>The confidence level, typically 0.8 or 0.9</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>String specifying the distribution for the assay values. Valid
values are "normal" or "lognormal"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constant</code></td>
<td>
<p>String specifying whether the standard deviation is assumed to be
constant over the levels ("SD") or the coefficient of variation
is assumed constant over the levels ("CV"). The values "sd", "var", or "variance" may be used for "SD", and "cv" may be used
for "CV".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data frame or environment in which to look for x</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The m:n:q procedure uses m different samples that have different levels of the true value
with n replicates for each sample. The output is a 100q percent upper limit of the bound on the
precision parameter when the true values within the range of values for the m samples all follow either a
a constant coefficient of variation model or a  constant
standard deviation model (same as a constant variance model) (see <code>constant</code> argument).
</p>
<p>For example, if the 4:4:90 percent procedure using a normal model with a constant variance model
returns a bound on the standard deviation  (the Umax element of the assaytest class) of 7.9
then under the assumptions we have 90 percent confidence that the true SD is less than 7.9.
</p>
<p>The <code>predict</code> method gives effective standard deviation intervals (i.e., 68.27 pct CIs)
for the expected response from subsequent observed values from the assay.
</p>


<h3>Value</h3>

<p>An object of class "assaytest", which is a list of components including a data frame of the relevant statistics calculated on x. Print, summary, predict, and plot methods are available.
The list has the following components
</p>

<ul>
<li>
<p>sumtabTable summarizing the experiment, includes mean values, SD or CV estimates, and upper confidence limits on those. 
</p>
</li>
<li>
<p>UmaxThe maximum of the upper limits on the SD or CV, used in the effective SD interval calculation
</p>
</li>
<li>
<p>nThe number of samples per level
</p>
</li>
<li>
<p>mThe number of levels
</p>
</li>
<li>
<p>qThe confidence level
</p>
</li>
<li>
<p>modelThe assumed model
</p>
</li>
<li>
<p>constantThe parameter assumed to be constant (either 'SD' or 'CV').  
</p>
</li>
<li>
<p>alphaThe alpha level, calculated as (1 - q)^(1 / m)
</p>
</li>
<li>
<p>xThe data vector supplied by the user
</p>
</li>
</ul>
<h3>References</h3>

<p>Fay, MP, Sachs, MC, and Miura, K (2016). A Hypothesis Testing Framework for Validating and Assay for Precision
(unpublished manuscript).
</p>


<h3>Examples</h3>

<pre><code class="language-R"># reproduce Table 3 of Fay, Sachs and Miura
I&lt;- gia$parasite=="3D7" &amp; gia$meanAAgia&lt;80
treD7.test&lt;-testassay(x=gia, m=sample, n=assay, q=.9,
  data=subset(gia, parasite=="3D7" &amp; meanAAgia&lt;80))
treD7.test
# get estimated effective standard deviation intervals (68.27 percent CIs)
# for observed values 21.4 and 65.9
# using results from testassay
predict(treD7.test,c(21.4,65.9))

</code></pre>


</div>