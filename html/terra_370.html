<div class="container">

<table style="width: 100%;"><tr>
<td>focalReg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Focal regression</h2>

<h3>Description</h3>

<p>Calculate values for a moving-window by comparing the value in one layers with the values in one to many other layers. A typical case is the computation of the coefficients for a focal linear regression model. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'SpatRaster'
focalReg(x, w=3, fun="ols", ..., fillvalue=NA, filename="", overwrite=FALSE, wopt=list()) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>SpatRaster with at least two layers. The first is the "Y" (dependent) variable and the remainder are the "X" (independent) variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>numeric or matrix to define the focal window. The window an be defined as one (for a square) or two numbers (row, col); or with an odd-sized weights matrix. See the Details section in <code>focal</code>. Note that if a matrix with numbers other than zero or one are used, the values are used as weights. For this to work, <code>fun</code> must have an argument <code>weights</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fun</code></td>
<td>
<p>a function with at least two arguments (one for each layer). There is a built-in function "ols" for both the weighted and unweighted Ordinary Least Square regression. This function has an additional argument <code>na.rm=FALSE</code> and <code>intercept=TRUE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments for <code>fun</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fillvalue</code></td>
<td>
<p>numeric. The value of the cells in the virtual rows and columns outside of the raster</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filename</code></td>
<td>
<p>character. Output filename</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overwrite</code></td>
<td>
<p>logical. If <code>TRUE</code>, <code>filename</code> is overwritten</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wopt</code></td>
<td>
<p>additional arguments for writing files as in <code>writeRaster</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>SpatRaster</p>


<h3>See Also</h3>

 <p><code>focal, focal3D</code>, focalValues</p>


<h3>Examples</h3>

<pre><code class="language-R">r &lt;- rast(ncols=10, nrows=10, ext(0, 10, 0, 10))
values(r) &lt;- 1:ncell(r)
x &lt;- c(r, init(r, runif) * r)
f &lt;- focalReg(x, 3)
</code></pre>


</div>