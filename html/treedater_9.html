<div class="container">

<table style="width: 100%;"><tr>
<td>relaxedClockTest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Use parametric bootstrap to test if relaxed clock offers improved fit to data.</h2>

<h3>Description</h3>

<p>This function simulates phylogenies with branch lengths in units
of substitutions per site. Simulations are based on a fitted
treedater object which provides parameters of the molecular clock
model. The coefficient of variation of rates is estimated using a
relaxed clock model applied to strict clock simulations. Estimates
of the CV is then compared to the null distribution provided by
simulations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">relaxedClockTest(..., nreps = 100, overrideTempConstraint = T,
  ncpu = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments passed to *dater*</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nreps</code></td>
<td>
<p>Integer number of simulations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overrideTempConstraint</code></td>
<td>
<p>see *parboot*</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncpu</code></td>
<td>
<p>Number of threads to use for parallel computation. Recommended.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function will print the optimal clock model
and the distribution of the coefficient of variation statistic under the null hypothesis (strict
clock). Parameters passed to this function should be the same as when calling *dater*.
</p>


<h3>Value</h3>

<p>A list with elements:
</p>

<ul>
<li>
<p> strict_treedater: A dater object under a strict clock
</p>
</li>
<li>
<p> relaxed_treedater: A dater object under a relaxed clock
</p>
</li>
<li>
<p> clock: The favoured clock model 
</p>
</li>
<li>
<p> parboot: Result of call to *parboot* using fitted treedater and forcing a relaxed clock
</p>
</li>
<li>
<p> nullHypothesis_coef_of_variation_CI: The null hypothesis CV
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Erik M Volz &lt;erik.volz@gmail.com&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R"># simulate a tree 
tre &lt;- ape::rtree(25)
# sample times based on distance from root to tip:
sts &lt;- setNames( ape::node.depth.edgelength( tre )[1:ape::Ntip(tre)], tre$tip.label)
# modify edge length to represent evolutionary distance with rate 1e-3:
tre$edge.length &lt;- tre$edge.length * 1e-3
relaxedClockTest( tre, sts, s= 1000,  omega0=.0015 , nreps=25)


</code></pre>


</div>