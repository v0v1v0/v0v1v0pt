<div class="container">

<table style="width: 100%;"><tr>
<td>IRTLikelihood.cfa</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Individual Likelihood for Confirmatory Factor Analysis
</h2>

<h3>Description</h3>

<p>This function computes the individual likelihood evaluated
at a <code>theta</code> grid for confirmatory factor analysis
under the normality assumption of residuals. Either
the item parameters (item loadings <code>L</code>, item
intercepts <code>nu</code> and residual covariances <code>psi</code>)
or a fitted <code>cfa</code> object from the <span class="pkg">lavaan</span>
package can be provided. The individual likelihood
can be used for drawing plausible values.
</p>


<h3>Usage</h3>

<pre><code class="language-R">IRTLikelihood.cfa(data, cfaobj=NULL, theta=NULL, L=NULL, nu=NULL,
    psi=NULL, snodes=NULL, snodes.adj=2, version=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>Dataset with item responses
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cfaobj</code></td>
<td>

<p>Fitted <code>lavaan::cfa</code> (<span class="pkg">lavaan</span>) object
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>

<p>Optional matrix containing the <code>theta</code> values
used for evaluating the individual likelihood
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>

<p>Matrix of item loadings (if <code>cfaobj</code> is not provided)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>

<p>Vector of item intercepts (if <code>cfaobj</code> is not provided)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi</code></td>
<td>

<p>Matrix with residual covariances
(if <code>cfaobj</code> is not provided)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>snodes</code></td>
<td>

<p>Number of <code>theta</code> values used for the approximation
of the distribution of latent variables.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>snodes.adj</code></td>
<td>

<p>Adjustment factor for quasi monte carlo nodes for
more than two latent variables.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>version</code></td>
<td>
<p>Function version. <code>version=1</code> is based on a
<span class="pkg">Rcpp</span> implementation while <code>version=0</code> is
a pure <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> implementation.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Individual likelihood evaluated at <code>theta</code>
</p>


<h3>See Also</h3>

<p><code>CDM::IRT.likelihood</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
#############################################################################
# EXAMPLE 1: Two-dimensional CFA data.Students
#############################################################################

library(lavaan)
library(CDM)

data(data.Students, package="CDM")
dat &lt;- data.Students

dat2 &lt;- dat[, c(paste0("mj",1:4), paste0("sc",1:4)) ]
# lavaan model with DO operator
lavmodel &lt;- "
DO(1,4,1)
   mj=~ mj%
   sc=~ sc%
DOEND
   mj ~~ sc
   mj ~~ 1*mj
   sc ~~ 1*sc
     "
lavmodel &lt;- TAM::lavaanify.IRT( lavmodel, data=dat2 )$lavaan.syntax
cat(lavmodel)

mod4 &lt;- lavaan::cfa( lavmodel, data=dat2, std.lv=TRUE )
summary(mod4, standardized=TRUE, rsquare=TRUE )
# extract item parameters
res4 &lt;- TAM::cfa.extract.itempars( mod4 )
# create theta grid
theta0 &lt;- seq( -6, 6, len=15)
theta &lt;- expand.grid( theta0, theta0 )
L &lt;- res4$L
nu &lt;- res4$nu
psi &lt;- res4$psi
data &lt;- dat2
# evaluate likelihood using item parameters
like2 &lt;- TAM::IRTLikelihood.cfa( data=dat2, theta=theta, L=L, nu=nu, psi=psi )
# The likelihood can also be obtained by direct evaluation
# of the fitted cfa object "mod4"
like4 &lt;- TAM::IRTLikelihood.cfa( data=dat2, cfaobj=mod4 )
attr( like4, "theta")
# the theta grid is automatically created if theta is not
# supplied as an argument

## End(Not run)
</code></pre>


</div>