<div class="container">

<table style="width: 100%;"><tr>
<td>shielding</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute Optimal Transport (Cost/Plan) Using the Multiscale Shielding Method</h2>

<h3>Description</h3>

<p>Runs the multiscale version of the Shielding Method (a.k.a. Short Cut Method) for computing the optimal transport
(cost/plan) on a rectangular grid in <code class="reqn">d</code> dimensions for the squared Euclidean distance as cost function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">shielding(
  a,
  b,
  nscales = 2,
  startscale = 1,
  flood = 0,
  measureScale = 1e-06,
  verbose = FALSE,
  basisKeep = 1,
  basisRefine = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>a, b</code></td>
<td>
<p>arrays with <code class="reqn">d</code> coordinates representing source and target measure, respectively.
The entries must be all positive.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nscales</code></td>
<td>
<p>the number of scales generated in the multiscale algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>startscale</code></td>
<td>
<p>the first scale on which the problem is solved.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flood</code></td>
<td>
<p>a real number. If positive, take the maximum of entry and <code>flood</code> for each
entry of <code>a</code> and <code>b</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>measureScale</code></td>
<td>
<p>the required precision for the entries. Computations are performed on
<code>round(a/measureScale)</code> and the same for <code>b</code> using integer arithmetics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical. Toggles output to the console about the progress of the algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basisKeep, basisRefine</code></td>
<td>
<p>internal use only.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>a</code> and <code>b</code> do not have the same sum, they are normalized to sum 1 <em>before</em>
<code>flood</code> and <code>measureScale</code> transformations are applied.
</p>


<h3>Value</h3>

<p>A list of components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>err</code></td>
<td>
<p>error code. 0 if everything is ok.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a_used,b_used</code></td>
<td>
<p>the vectorized arrays that were actually used by the algorithm. <code>a</code>, <code>b</code> after
applying <code>flood</code> and <code>measureScale</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coupling</code></td>
<td>
<p>a vectorized coupling describing the optimal transport from a_used to b_used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basis</code></td>
<td>
<p>a matrix with two columns describing the basis obtained for the optimal transport</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u,v</code></td>
<td>
<p>vectors of optimal values in the dual problem</p>
</td>
</tr>
</table>
<h3>Use of CPLEX</h3>

<p>For larger problems (thousands of grid points) there are considerable speed improvements when <code>shielding</code>
can use the CPLEX numerical solver for the underlying constrained optimization problems.
If a local installation of CPLEX is available, the transport package can be linked against it during installation.
See the file src/Makevars in the source package for instructions.
</p>


<h3>Author(s)</h3>

<p>Bernhard Schmitzer <a href="mailto:schmitzer@uni-muenster.de">schmitzer@uni-muenster.de</a> and<br>
Dominic Schuhmacher <a href="mailto:dschuhm1@uni-goettingen.de">dschuhm1@uni-goettingen.de</a><br>
(based on C++ code by Bernhard Schmitzer)
</p>


<h3>References</h3>

<p>B. Schmitzer (2016). A sparse multiscale algorithm for dense optimal transport. J. Math. Imaging Vision 56(2), 238â€“259. <a href="https://arxiv.org/abs/1510.05466">https://arxiv.org/abs/1510.05466</a>
</p>


<h3>See Also</h3>

<p><code>transport</code>, which calls this function if appropriate.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
shielding(random64a$mass,random64b$mass,nscales=6,measureScale=1) 
## End(Not run)

</code></pre>


</div>