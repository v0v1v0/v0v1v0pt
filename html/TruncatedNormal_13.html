<div class="container">

<table style="width: 100%;"><tr>
<td>mvNqmc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Truncated multivariate normal cumulative distribution  (quasi-Monte Carlo)</h2>

<h3>Description</h3>

<p>Computes an estimate and a deterministic upper bound of the probability Pr<code class="reqn">(l&lt;X&lt;u)</code>,
where <code class="reqn">X</code> is a zero-mean multivariate normal vector
with covariance matrix <code class="reqn">\Sigma</code>, that is, <code class="reqn">X</code> is drawn from <code class="reqn">N(0,\Sigma)</code>.
Infinite values for vectors <code class="reqn">u</code> and <code class="reqn">l</code> are accepted.
The Monte Carlo method uses sample size <code class="reqn">n</code>:
the larger <code class="reqn">n</code>, the smaller the relative error of the estimator.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mvNqmc(l, u, Sig, n = 1e+05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>l</code></td>
<td>
<p>lower truncation limit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>upper truncation limit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sig</code></td>
<td>
<p>covariance matrix of <code class="reqn">N(0,\Sigma)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of Monte Carlo simulations</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Suppose you wish to estimate Pr<code class="reqn">(l&lt;AX&lt;u)</code>,
where <code class="reqn">A</code> is a full rank matrix
and <code class="reqn">X</code> is drawn from <code class="reqn">N(\mu,\Sigma)</code>, then you simply compute
Pr<code class="reqn">(l-A\mu&lt;AY&lt;u-A\mu)</code>,
where <code class="reqn">Y</code> is drawn from <code class="reqn">N(0, A\Sigma A^\top)</code>.
</p>


<h3>Value</h3>

<p>a list with components
</p>

<ul>
<li> <p><code>prob</code>: estimated value of probability Pr<code class="reqn">(l&lt;X&lt;u)</code>
</p>
</li>
<li> <p><code>relErr</code>: estimated relative error of estimator
</p>
</li>
<li> <p><code>upbnd</code>: theoretical upper bound on true Pr<code class="reqn">(l&lt;X&lt;u)</code>
</p>
</li>
</ul>
<h3>Note</h3>

<p>This version uses a Quasi Monte Carlo (QMC) pointset
of size <code>ceiling(n/12)</code> and estimates the relative error
using 12 independent randomized QMC estimators. QMC
is slower than ordinary Monte Carlo,
but is also likely to be more accurate when <code class="reqn">d&lt;50</code>.
For high dimensions, say <code class="reqn">d&gt;50</code>, you may obtain the same accuracy using
the (typically faster) <code>mvNcdf</code>.
</p>


<h3>Author(s)</h3>

<p>Zdravko I. Botev
</p>


<h3>References</h3>

<p>Z. I. Botev (2017), <em>The Normal Law Under Linear Restrictions:
Simulation and Estimation via Minimax Tilting</em>, Journal of the Royal
Statistical Society, Series B, <b>79</b> (1), pp. 1â€“24.
</p>


<h3>See Also</h3>

<p><code>mvNcdf</code>, <code>mvrandn</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">d &lt;- 15
l &lt;- 1:d
u &lt;- rep(Inf, d)
Sig &lt;- matrix(rnorm(d^2), d, d)*2
Sig &lt;- Sig %*% t(Sig)
mvNqmc(l, u, Sig, 1e4) # compute the probability
</code></pre>


</div>