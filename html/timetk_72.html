<div class="container">

<table style="width: 100%;"><tr>
<td>slidify_vec</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Rolling Window Transformation</h2>

<h3>Description</h3>

<p><code>slidify_vec()</code> applies a <em>summary function</em> to a rolling sequence of windows.
</p>


<h3>Usage</h3>

<pre><code class="language-R">slidify_vec(
  .x,
  .f,
  ...,
  .period = 1,
  .align = c("center", "left", "right"),
  .partial = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>.x</code></td>
<td>
<p>A vector to have a rolling window transformation applied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.f</code></td>
<td>
<p>A summary <code style="white-space: pre;">⁠[function / formula]⁠</code>
</p>

<ul>
<li>
<p> If a <strong>function</strong>, e.g. <code>mean</code>, the function is used with any
additional arguments, <code>...</code>.
</p>
</li>
<li>
<p> If a <strong>formula</strong>, e.g. <code>~ mean(., na.rm = TRUE)</code>, it is converted to a function.
</p>
</li>
</ul>
<p>This syntax allows you to create very compact anonymous functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed on to the <code>.f</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.period</code></td>
<td>
<p>The number of periods to include in the local rolling window.
This is effectively the "window size".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.align</code></td>
<td>
<p>One of "center", "left" or "right".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.partial</code></td>
<td>
<p>Should the moving window be allowed to return partial (incomplete) windows instead of <code>NA</code> values.
Set to FALSE by default, but can be switched to TRUE to remove <code>NA</code>'s.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>slidify_vec()</code> function is a wrapper for <code>slider::slide_vec()</code> with parameters
simplified "center", "left", "right" alignment.
</p>
<p><strong>Vector Length In == Vector Length Out</strong>
</p>
<p><code>NA</code> values or <code>.partial</code> values
are always returned to ensure the length of the return vector
is the same length of the incoming vector. This ensures easier use with <code>dplyr::mutate()</code>.
</p>
<p><strong>Alignment</strong>
</p>
<p>Rolling functions generate <code>.period - 1</code> fewer values than the incoming vector.
Thus, the vector needs to be aligned. Alignment of the vector follows 3 types:
</p>

<ul>
<li> <p><strong>Center:</strong> <code>NA</code> or <code>.partial</code> values are divided and added to the beginning and
end of the series to "Center" the moving average.
This is common for de-noising operations. See also <code style="white-space: pre;">⁠[smooth_vec()]⁠</code> for LOESS without NA values.
</p>
</li>
<li> <p><strong>Left:</strong> <code>NA</code> or <code>.partial</code> values are added to the end to shift the series to the Left.
</p>
</li>
<li> <p><strong>Right:</strong> <code>NA</code> or <code>.partial</code> values are added to the beginning to shif the series to the Right. This is common in
Financial Applications such as moving average cross-overs.
</p>
</li>
</ul>
<p><strong>Partial Values</strong>
</p>

<ul>
<li>
<p> The advantage to using <code>.partial</code> values vs <code>NA</code> padding is that
the series can be filled (good for time-series de-noising operations).
</p>
</li>
<li>
<p> The downside to partial values is that the partials can become less stable
at the regions where incomplete windows are used.
</p>
</li>
</ul>
<p>If instability is not desirable for de-noising operations, a suitable alternative
is <code>smooth_vec()</code>, which implements local polynomial regression.
</p>


<h3>Value</h3>

<p>A numeric vector
</p>


<h3>References</h3>


<ul><li> <p><a href="https://slider.r-lib.org/">Slider R Package</a> by Davis Vaughan
</p>
</li></ul>
<h3>See Also</h3>

<p>Modeling and More Complex Rolling Operations:
</p>

<ul>
<li> <p><code>step_slidify()</code> - Roll apply for <code>tidymodels</code> modeling
</p>
</li>
<li> <p><code>tk_augment_slidify()</code> - Add many rolling columns group-wise
</p>
</li>
<li> <p><code>slidify()</code> - Turn any function into a rolling function. Great for
rolling cor, rolling regression, etc.
</p>
</li>
<li>
<p> For more complex rolling operations, check out the <code>slider</code> R package.
</p>
</li>
</ul>
<p>Vectorized Transformation Functions:
</p>

<ul>
<li>
<p> Box Cox Transformation: <code>box_cox_vec()</code>
</p>
</li>
<li>
<p> Lag Transformation: <code>lag_vec()</code>
</p>
</li>
<li>
<p> Differencing Transformation: <code>diff_vec()</code>
</p>
</li>
<li>
<p> Rolling Window Transformation: <code>slidify_vec()</code>
</p>
</li>
<li>
<p> Loess Smoothing Transformation: <code>smooth_vec()</code>
</p>
</li>
<li>
<p> Fourier Series: <code>fourier_vec()</code>
</p>
</li>
<li>
<p> Missing Value Imputation for Time Series: <code>ts_impute_vec()</code>
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">library(dplyr)
library(ggplot2)

# Training Data
FB_tbl &lt;- FANG %&gt;%
    filter(symbol == "FB") %&gt;%
    select(symbol, date, adjusted)

# ---- FUNCTION FORMAT ----
# - The `.f = mean` function is used. Argument `na.rm = TRUE` is passed as ...
FB_tbl %&gt;%
    mutate(adjusted_30_ma = slidify_vec(
        .x      = adjusted,
        .period = 30,
        .f      = mean,
        na.rm   = TRUE,
        .align  = "center")) %&gt;%
        ggplot(aes(date, adjusted)) +
        geom_line() +
        geom_line(aes(y = adjusted_30_ma), color = "blue", na.rm = TRUE)

# ---- FORMULA FORMAT ----
# - Anonymous function `.f = ~ mean(., na.rm = TRUE)` is used
FB_tbl %&gt;%
    mutate(adjusted_30_ma = slidify_vec(
        .x      = adjusted,
        .period = 30,
        .f      = ~ mean(., na.rm = TRUE),
        .align  = "center")) %&gt;%
        ggplot(aes(date, adjusted)) +
        geom_line() +
        geom_line(aes(y = adjusted_30_ma), color = "blue", na.rm = TRUE)

# ---- PARTIAL VALUES ----
# - set `.partial = TRUE`
FB_tbl %&gt;%
    mutate(adjusted_30_ma = slidify_vec(
        .x       = adjusted,
        .f       = ~ mean(., na.rm = TRUE),
        .period  = 30,
        .align   = "center",
        .partial = TRUE)) %&gt;%
        ggplot(aes(date, adjusted)) +
        geom_line() +
        geom_line(aes(y = adjusted_30_ma), color = "blue")

# ---- Loess vs Moving Average ----
# - Loess: Using `.degree = 0` to make less flexible. Comparable to a moving average.

FB_tbl %&gt;%
    mutate(
        adjusted_loess_30 = smooth_vec(adjusted, period = 30, degree = 0),
        adjusted_ma_30    = slidify_vec(adjusted, .f = mean,
                                           .period = 30, .partial = TRUE)
    ) %&gt;%
    ggplot(aes(date, adjusted)) +
    geom_line() +
    geom_line(aes(y = adjusted_loess_30), color = "red") +
    geom_line(aes(y = adjusted_ma_30), color = "blue") +
    labs(title = "Loess vs Moving Average")



</code></pre>


</div>