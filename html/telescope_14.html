<div class="container">

<table style="width: 100%;"><tr>
<td>sampleUniNormMixture</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Telescoping sampling of a Bayesian finite univariate Gaussian mixture where a prior
on the number of components K is specified.</h2>

<h3>Description</h3>


<ul>
<li>
<p> The MCMC scheme is implemented as suggested in Frühwirth-Schnatter et al (2021).
</p>
</li>
<li>
<p> The priors on the model parameters are specified as in Frühwirth-Schnatter et al (2021),
see the vignette for details and notation.
</p>
</li>
<li>
<p> The parametrizations of the gamma and inverse gamma distribution are used as in
Frühwirth-Schnatter et al (2021), see also the vignette.
</p>
</li>
</ul>
<h3>Usage</h3>

<pre><code class="language-R">sampleUniNormMixture(
  y,
  S,
  mu,
  sigma2,
  eta,
  c0,
  g0,
  G0,
  C0_0,
  b0,
  B0,
  M,
  burnin,
  thin,
  Kmax,
  G = c("MixDynamic", "MixStatic"),
  priorOnK,
  priorOnWeights,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A numeric matrix; containing the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>A numeric matrix; containing the initial cluster
assignments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>A numeric matrix; containing the initial cluster-specific
mean values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2</code></td>
<td>
<p>A numeric matrix; containing the initial cluster-specific
variance values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta</code></td>
<td>
<p>A numeric vector; containing the initial cluster sizes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c0</code></td>
<td>
<p>A numeric vector; hyperparameter of the prior on <code class="reqn">\sigma^2_k</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g0</code></td>
<td>
<p>A numeric vector; hyperparameter of the prior on <code class="reqn">\sigma^2_k</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>G0</code></td>
<td>
<p>A numeric vector; hyperparameter of the prior on <code class="reqn">\sigma^2_k</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C0_0</code></td>
<td>
<p>A numeric vector; initial value of hyperparameter <code class="reqn">C_0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b0</code></td>
<td>
<p>A numeric vector; hyperparameter of the prior on <code class="reqn">\mu_k</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B0</code></td>
<td>
<p>A numeric vector; hyperparameter of the prior on <code class="reqn">\mu_k</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>A numeric scalar; specifying the number of recorded
iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>A numeric scalar; specifying the number of burn-in
iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>
<p>A numeric scalar; specifying the thinning used for the
iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Kmax</code></td>
<td>
<p>A numeric scalar; the maximum number of components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>
<p>A character string; either <code>"MixDynamic"</code> or <code>"MixStatic"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>priorOnK</code></td>
<td>
<p>A named list; providing the prior on the number of
components K, see <code>priorOnK_spec()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>priorOnWeights</code></td>
<td>
<p>A named list; providing the prior on the mixture weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>A logical; indicating if some intermediate clustering
results should be printed.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A named list containing:
</p>

<ul>
<li> <p><code>"Mu"</code>: sampled component means.
</p>
</li>
<li> <p><code>"Eta"</code>: sampled weights.
</p>
</li>
<li> <p><code>"S"</code>: sampled assignments.
</p>
</li>
<li> <p><code>"Nk"</code>: number of observations assigned to the different components, for each iteration.
</p>
</li>
<li> <p><code>"K"</code>: sampled number of components.
</p>
</li>
<li> <p><code>"Kplus"</code>: number of filled, i.e., non-empty components, for each iteration.
</p>
</li>
<li> <p><code>"e0"</code>: sampled Dirichlet parameter of the prior on the weights (if <code class="reqn">e_0</code> is random).
</p>
</li>
<li> <p><code>"alpha"</code>: sampled Dirichlet parameter of the prior on the weights (if <code class="reqn">\alpha</code> is random).
</p>
</li>
<li> <p><code>"acc"</code>: logical vector indicating acceptance in the Metropolis-Hastings step when sampling either <code class="reqn">e_0</code> or <code class="reqn">\alpha</code>.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">if (requireNamespace("mclust", quietly = TRUE)) {
    data("acidity", package = "mclust")
    y &lt;- acidity
    
    N &lt;- length(y)
    r &lt;- 1
    
    Mmax &lt;- 200
    thin &lt;- 1
    burnin &lt;- 100
    M &lt;- Mmax/thin
    Kmax &lt;- 50  
    Kinit &lt;- 10
    
    G &lt;- "MixStatic" 
    priorOnE0 &lt;- priorOnE0_spec("e0const", 0.01)
    priorOnK &lt;- priorOnK_spec("Pois_1", 50)
    
    R &lt;- diff(range(y))
    c0 &lt;- 2 + (r-1)/2
    C0 &lt;- diag(c(0.02*(R^2)), nrow = r)
    g0 &lt;- 0.2 + (r-1) / 2
    G0 &lt;- diag(10/(R^2), nrow = r)
    B0 &lt;- diag((R^2), nrow = r)
    b0 &lt;- as.matrix((max(y) + min(y))/2, ncol = 1)  
    
    cl_y &lt;- kmeans(y, centers = Kinit, nstart = 100)
    S_0 &lt;- cl_y$cluster
    mu_0 &lt;- t(cl_y$centers)
    eta_0 &lt;- rep(1/Kinit, Kinit)
    sigma2_0 &lt;- array(0, dim = c(1, 1, Kinit))
    sigma2_0[1, 1, ] &lt;- 0.5 * C0

    result &lt;- sampleUniNormMixture(
        y, S_0, mu_0, sigma2_0, eta_0,
        c0, g0, G0, C0, b0, B0,
        M, burnin, thin, Kmax,
        G, priorOnK, priorOnE0)
    
    K &lt;- result$K
    Kplus &lt;- result$Kplus  
    
    plot(seq_along(K), K, type = "l", ylim = c(0, max(K)),
         xlab = "iteration", main = "",
         ylab = expression("K" ~ "/" ~ K["+"]), col = 1)
    lines(seq_along(Kplus), Kplus, col = 2)
    legend("topright", legend = c("K", expression(K["+"])),
           col = 1:2, lty = 1, box.lwd = 0)
}

</code></pre>


</div>