<div class="container">

<table style="width: 100%;"><tr>
<td>TWLsample</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Main function to obtain posterior samples from a TWL model.</h2>

<h3>Description</h3>

<p>Main function to obtain posterior samples from a TWL model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">TWLsample(full_dat_mat, full_dat, alpha_re = 7, beta_re = 0.4,
  num_its = 5000, num_all_clus = 30, output_every = 20, manip = TRUE,
  sav_inter = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>full_dat_mat</code></td>
<td>
<p>list of matrices of the different data types.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>full_dat</code></td>
<td>
<p>list of data.tables with a single column labelled 'nam', denoting sample annotation.  A consistent naming convention of samples must be used across data types.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha_re</code></td>
<td>
<p>Hyperparameter for the dirichlet prior model within each data type, influencing sparsity of clusterings.  A smaller number encourages fewer clusters.    Defaults to 7 and should be chosen as a function of sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_re</code></td>
<td>
<p>Hyperparameter for the dirichlet prior model across datatypes within each sample, influencing the degree to which  each data type's sample cluster labels affect those of the other data types.  Defaults to 0.4 and should be chosen as a function of the total number of data types being integrated in the analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_its</code></td>
<td>
<p>Number of iterations.  Defaults to 5000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_all_clus</code></td>
<td>
<p>Ceiling on the number of clusters.  Defaults to 30.  Should be chosen as some factor greater (for example, 5), than maximum number of hypothesized clusters in the data types.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output_every</code></td>
<td>
<p>Frequency of sampling log statistics, reporting mixing, cluster distribution, and proportion of cluster sharing across data types.  Defaults to once every 20 iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>manip</code></td>
<td>
<p>TRUE/FALSE for whether likelihood manipulation should be used to increase mixing in situations where cluster means are far from one another in Euclidean distance.  This should not influence identified clusters nor parameters associated with them.  Defaults to TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sav_inter</code></td>
<td>
<p>A logical indicating whether a temporary file of the samples should be written out in the working directory every 50 iterations.  Allows for restarts when sampling is interrupted, and defaults to FALSE.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of lists of data.tables.  The list length is the number of iterations.  The length of each element is the number of data types.  The data.tables have 2 columns, sample annotation called ‘nam’ and cluster assignment called 'clus'.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(data_and_output)
## Not run: clus_save &lt;- TWLsample(misaligned_mat,misaligned,output_every=50,num_its=5000,manip=FALSE)
outpu_new &lt;- pairwise_clus(clus_save,BURNIN=2000)

## End(Not run)
post_analy_cor(outpu_new,c("title1","title2","title3","title4","title5"),
tempfile(),ords='none') 
clus_labs &lt;- post_analy_clus(outpu_new,clus_save,c(2:6),rep(0.6,5),c("title1","title2",
"title3","title4","title5"),tempfile())
output_nest &lt;- cross_dat_analy(clus_save,4900)
</code></pre>


</div>