<div class="container">

<table style="width: 100%;"><tr>
<td>EM_FCtemplateICA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>EM Template ICA</h2>

<h3>Description</h3>

<p>EM Algorithm for FC Template ICA Model
</p>


<h3>Usage</h3>

<pre><code class="language-R">EM_FCtemplateICA(
  template_mean,
  template_var,
  template_FC,
  prior_params = c(0.001, 0.001),
  BOLD,
  AS_0,
  maxiter = 100,
  miniter = 3,
  epsilon = 0.001,
  Gibbs_nsamp = 1000,
  Gibbs_nburn = 50,
  Gibbs_nchain = 10,
  eps_inter = NULL,
  verbose
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>template_mean</code></td>
<td>
<p>(<code class="reqn">V \times Q</code> matrix) mean maps for each IC in template,
where <code class="reqn">Q</code> is the number of ICs, <code class="reqn">V=nvox</code> is the number of data locations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>template_var</code></td>
<td>
<p>(<code class="reqn">V \times Q</code> matrix) between-subject variance maps for each IC in template</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>template_FC</code></td>
<td>
<p>(list) Parameters of functional connectivity template</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior_params</code></td>
<td>
<p>Alpha and beta parameters of IG prior on tau^2 (error variance)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BOLD</code></td>
<td>
<p>(<code class="reqn">V \times T</code> matrix) preprocessed fMRI data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AS_0</code></td>
<td>
<p>(list) initial guess at latent variables: A (<code class="reqn">TxQ</code> mixing matrix),
and S (<code class="reqn">QxV</code> matrix of spatial ICs)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>Maximum number of EM iterations. Default: <code>100</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>miniter</code></td>
<td>
<p>Minimum number of EM iterations. Default: <code>3</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>Smallest proportion change in log-posterior between iterations.
Default: <code>0.001</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gibbs_nsamp</code></td>
<td>
<p>the number of Gibbs posterior samples of A and S to output after burn-in</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gibbs_nburn</code></td>
<td>
<p>the number of Gibbs posterior samples of A and S to throw away before saving</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gibbs_nchain</code></td>
<td>
<p>the number of simultaneous Gibbs chains to run</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps_inter</code></td>
<td>
<p>Intermediate values of epsilon at which to save results (used
to assess benefit of more stringent convergence rules). Default:
<code>NULL</code> (do not save). These values should be in decreasing order
(larger to smaller error) and all values should be between zero and
<code>epsilon</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>If <code>TRUE</code>, display progress of algorithm. Default: <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>EM_FCtemplateICA</code> implements the expectation-maximization
(EM) algorithm for the functional connectivity (FC) template ICA model
</p>


<h3>Value</h3>

<p>A list of computed values, including the final parameter estimates.
</p>


</div>