<div class="container">

<table style="width: 100%;"><tr>
<td>partial.mk.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Partial Mann-Kendall Trend Test</h2>

<h3>Description</h3>

<p>Performs a partial Mann-Kendall Trend Test
</p>


<h3>Usage</h3>

<pre><code class="language-R">partial.mk.test(x, y, alternative = c("two.sided", "greater", "less"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a "vector" or "ts" object that contains the variable,
which is tested for trend (i.e. correlated with time)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a "vector" or "ts" object that contains the variable,
which effect on "x" is partialled out</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>character, the alternative method; defaults to
"two.sided"</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>According to Libiseller and Grimvall (2002), the test statistic
for <code>x</code> with its covariate <code>y</code> is
</p>
<p style="text-align: center;"><code class="reqn">
z = \frac{S_x - r_{xy} S_y}{\left[ \left( 1 - r_{xy}^2 \right)
n \left(n - 1 \right) \left(2 n + 5 \right) / 18 \right]^{0.5}}</code>
</p>

<p>where the correlation <code class="reqn">r</code> is calculated as:
</p>
<p style="text-align: center;"><code class="reqn">
r_{xy} = \frac{\sigma_{xy}}
{n \left(n - 1\right) \left(2 n + 5 \right) / 18}
</code>
</p>

<p>The conditional covariance between <code class="reqn">x</code> and <code class="reqn">y</code> is
</p>
<p style="text-align: center;"><code class="reqn">
\sigma_{xy} = \frac{1}{3}
\left[K + 4 \sum_{j=1}^n R_{jx} R_{jy} -
n \left(n + 1 \right) \left(n + 1 \right) \right]</code>
</p>

<p>with
</p>
<p style="text-align: center;"><code class="reqn">
K = \sum_{1 \le i &lt; j \le n} \mathrm{sgn} \left\{ \left( x_j - x_i \right)
\left( y_j - y_i \right) \right\}</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">
R_{jx} = \left\{ n + 1 + \sum_{i=1}^n
\mathrm{sgn} \left( x_j - x_i \right) \right\} / 2</code>
</p>



<h3>Value</h3>

<p>A list with class "htest"
</p>
<table>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>a character string indicating the chosen test
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>

<p>a character string giving the name(s) of the data
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>

<p>the value of the test statistic
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>

<p>the Mann-Kendall score S, the variance varS and the correlation
between x and y
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>

<p>a character string describing the alternative hypothesis
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>

<p>the p-value of the test
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null.value</code></td>
<td>

<p>the null hypothesis
</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Current Version is for complete observations only.
The test statistic is not corrected for ties.
</p>


<h3>References</h3>

<p>Libiseller, C. and Grimvall, A., (2002).
Performance of partial Mann-Kendall tests for trend detection in the
presence of covariates. Environmetrics 13, 71â€“84,
<a href="https://doi.org/10.1002/env.507">doi:10.1002/env.507</a>.
</p>


<h3>See Also</h3>

<p><code>partial.cor.trend.test</code>,
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(maxau)
s &lt;- maxau[,"s"]; Q &lt;- maxau[,"Q"]
partial.mk.test(s,Q)

</code></pre>


</div>