<div class="container">

<table style="width: 100%;"><tr>
<td>pe.sasieni</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fits Proportional excess hazards model with fixed offsets</h2>

<h3>Description</h3>

<p>Fits proportional excess hazards model. The Sasieni proportional excess risk
model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pe.sasieni(
  formula = formula(data),
  data = parent.frame(),
  id = NULL,
  start.time = 0,
  max.time = NULL,
  offsets = 0,
  Nit = 50,
  detail = 0,
  n.sim = 500
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula object, with the response on the left of a ‘~’
operator, and the terms on the right.  The response must be a survival
object as returned by the ‘Surv’ function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data.frame with the variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>gives the number of individuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start.time</code></td>
<td>
<p>starting time for considered time-period.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.time</code></td>
<td>
<p>stopping considered time-period if different from 0.
Estimates thus computed from [0,max.time] if max.time&gt;0. Default is max of
data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offsets</code></td>
<td>
<p>fixed offsets giving the mortality.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nit</code></td>
<td>
<p>number of itterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>detail</code></td>
<td>
<p>if detail is one, prints iteration details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.sim</code></td>
<td>
<p>number of simulations, 0 for no simulations.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The models are written using the survival modelling given in the survival
package.
</p>
<p>The program assumes that there are no ties, and if such are present random
noise is added to break the ties.
</p>


<h3>Value</h3>

<p>Returns an object of type "pe.sasieni".  With the following
arguments: </p>
<table>
<tr style="vertical-align: top;">
<td><code>cum</code></td>
<td>
<p>baseline of Cox model excess risk.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.cum</code></td>
<td>
<p>pointwise variance estimates for estimated cumulatives.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>estimate of relative risk terms of model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.gamma</code></td>
<td>
<p>variance estimates for gamma.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ut</code></td>
<td>
<p>score process for
Cox part of model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D2linv</code></td>
<td>
<p>The inverse of the second derivative.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>score</code></td>
<td>
<p>final score</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test.Prop</code></td>
<td>
<p>re-sampled absolute supremum
values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval.Prop</code></td>
<td>
<p>p-value based on resampling.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Thomas Scheike
</p>


<h3>References</h3>

<p>Martinussen and Scheike, Dynamic Regression Models for Survival
Data, Springer Verlag (2006).
</p>
<p>Sasieni, P.D., Proportional excess hazards, Biometrika (1996), 127–41.
</p>
<p>Cortese, G. and Scheike, T.H., Dynamic regression hazards models for
relative survival (2007), submitted.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(mela.pop)
out&lt;-pe.sasieni(Surv(start,stop,status==1)~age+sex,mela.pop,
id=1:205,Nit=10,max.time=7,offsets=mela.pop$rate,detail=0,n.sim=100)
summary(out)

ul&lt;-out$cum[,2]+1.96*out$var.cum[,2]^.5
ll&lt;-out$cum[,2]-1.96*out$var.cum[,2]^.5
plot(out$cum,type="s",ylim=range(ul,ll))
lines(out$cum[,1],ul,type="s"); lines(out$cum[,1],ll,type="s")
# see also prop.excess function

</code></pre>


</div>