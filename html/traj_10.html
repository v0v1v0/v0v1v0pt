<div class="container">

<table style="width: 100%;"><tr>
<td>Step1Measures</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute Measures for Identifying Patterns of Change in Longitudinal
Data</h2>

<h3>Description</h3>

<p><code>Step1Measures</code> computes up to 18 measures for each
longitudinal trajectory. See Details for the list of measures.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Step1Measures(
  Data,
  Time = NULL,
  ID = FALSE,
  measures = c(1:17),
  midpoint = NULL,
  cap.outliers = FALSE
)

## S3 method for class 'trajMeasures'
print(x, ...)

## S3 method for class 'trajMeasures'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Data</code></td>
<td>
<p>a matrix or data frame in which each row contains the longitudinal
data (trajectories).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Time</code></td>
<td>
<p>either <code>NULL</code>, a vector or a matrix/data frame of the same dimension
as <code>Data</code>. If a vector, matrix or data frame is supplied, its entries
are assumed to be measured at the times of the corresponding cells in
<code>Data</code>. When set to <code>NULL</code> (the default), the times are assumed
equidistant.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ID</code></td>
<td>
<p>logical. Set to <code>TRUE</code> if the first columns of <code>Data</code> and
<code>Time</code> corresponds to an <code>ID</code> variable identifying the
trajectories. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>measures</code></td>
<td>
<p>a vector containing the numerical identifiers of the measures
to compute. The default, 1:17, corresponds to
measures 1-17 and thus excludes the measures which require specifying a
midpoint.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>midpoint</code></td>
<td>
<p>specifies which column of <code>Time</code> to use as the midpoint
in measure 18. Can be <code>NULL</code>, an integer or a vector of integers of length
the number of rows in <code>Time</code>. The default is <code>NULL</code>, in which case the
midpoint is the time closest to the median of the Time vector specific to
each trajectory.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cap.outliers</code></td>
<td>
<p>logical. If <code>TRUE</code>, extreme values of the measures will be capped. If <code>FALSE</code>, only the infinite values will be capped. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>object of class <code>trajMeasures</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>object of class <code>trajMeasures</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Each trajectory must have a minimum of 3 observations otherwise it
will be omitted from the analysis.
</p>
<p>The 18 measures and their numerical identifiers are listed below. Please
refer to the vignette for the specific formulas used to compute them.
</p>

<ol>
<li>
<p>  Maximum<br></p>
</li>
<li>
<p>  Range (max - min)<br></p>
</li>
<li>
<p>  Mean value<br></p>
</li>
<li>
<p>  Standard deviation<br></p>
</li>
<li>
<p>  Slope of the linear model<br></p>
</li>
<li>  <p><code class="reqn">R^2</code>: Proportion of variance explained by the linear model<br></p>
</li>
<li>
<p>  Curve length (total variation)<br></p>
</li>
<li>
<p>  Rate of intersection with the mean<br></p>
</li>
<li>
<p>  Proportion of time spent above the mean<br></p>
</li>
<li>
<p>  Minimum  of the first derivative<br></p>
</li>
<li>
<p>  Maximum of the first derivative<br></p>
</li>
<li>
<p>  Mean of the first derivative<br></p>
</li>
<li>
<p>  Standard deviation of the first derivative<br></p>
</li>
<li>
<p>  Minimum  of the second derivative<br></p>
</li>
<li>
<p>  Maximum of the second derivative<br></p>
</li>
<li>
<p>  Mean of the second derivative<br></p>
</li>
<li>
<p>  Standard deviation of the second derivative<br></p>
</li>
<li>
<p>  Later change/Early change<br></p>
</li>
</ol>
<p>If 'cap.outliers' is set to <code>TRUE</code>, or if some measures are infinite as a result of division by 0, Nishiyama's improved Chebychev bound for continuous distributions
is used to determine extreme values for each measure, corresponding to
a 0.3% probability threshold. Extreme values beyond the threshold are then capped
to the 0.3% probability threshold (see vignette for more details). If applicable, the values which
would be of the form 0/0 are set to 1.
</p>


<h3>Value</h3>

<p>An object of class <code>trajMeasures</code>; a list containing the values
of the measures, a table of the outliers which have been capped, as well as
a curated form of the function's arguments.
</p>


<h3>References</h3>

<p>Leffondre K, Abrahamowicz M, Regeasse A, Hawker GA, Badley EM,
McCusker J, Belzile E. Statistical measures were proposed for identifying
longitudinal patterns of change in quantitative health indicators. J Clin
Epidemiol. 2004 Oct;57(10):1049-62. doi: 10.1016/j.jclinepi.2004.02.012.
PMID: 15528056.
</p>
<p>Nishiyama T, Improved Chebyshev inequality: new probability bounds with
known supremum of PDF, arXiv:1808.10770v2 stat.ME
https://doi.org/10.48550/arXiv.1808.10770
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data("trajdata")
trajdata.noGrp &lt;- trajdata[, -which(colnames(trajdata) == "Group")] #remove the Group column

m1 = Step1Measures(trajdata.noGrp, ID = TRUE, measures = 18, midpoint = NULL)
m2 = Step1Measures(trajdata.noGrp, ID = TRUE, measures = 18, midpoint = 3)

identical(m1$measures, m2$measures)

## End(Not run)

</code></pre>


</div>