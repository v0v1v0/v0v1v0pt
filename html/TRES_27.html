<div class="container">

<table style="width: 100%;"><tr>
<td>TPRsim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate simulation data for tensor predictor regression (TPR)</h2>

<h3>Description</h3>

<p>This function is used to generate simulation data used in tensor prediction regression.
</p>


<h3>Usage</h3>

<pre><code class="language-R">TPRsim(p, r, u, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>The dimension of predictor, a vector in the form of <code class="reqn">(p_1,\cdots, p_m)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>The dimension of response, a scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>The structural dimension of envelopes at each mode, a vector with the same length as p.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The sample size.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The tensor predictor regression model is of the form,
</p>
<p style="text-align: center;"><code class="reqn">Y = B_{(m+1)}vec(X) + \epsilon</code>
</p>

<p>where response <code class="reqn">Y \in R^{r}</code>, predictor <code class="reqn">X \in R^{p_1\times \cdots\times p_m}</code>, <code class="reqn">B \in \in R^{p_1 \times\cdots\times p_m \times r}</code> and the error term is multivariate normal distributed. The predictor is tensor normal distributed,
</p>
<p style="text-align: center;"><code class="reqn">X\sim TN(0;\Sigma_1,\dots,\Sigma_m)</code>
</p>

<p>According to the tensor envelope structure, we have
</p>
<p style="text-align: center;"><code class="reqn">B = [\Theta; \Gamma_1,\ldots, \Gamma_m, I_p],</code>
</p>

<p style="text-align: center;"><code class="reqn">\Sigma_k = \Gamma_k \Omega_k \Gamma_k^{T}+ \Gamma_{0k} \Omega_{0k} \Gamma_{0k}^T,</code>
</p>

<p>for some <code class="reqn">\Theta \in R^{u_1 \times\cdots\times u_m \times p}</code>, <code class="reqn">\Omega_k \in R^{u_k \times u_k}</code> and <code class="reqn">\Omega_{0k} \in \in R^{(p_k - u_k) \times (p_k - u_k)}</code>, <code class="reqn">k=1,\ldots,m</code>.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The predictor of dimension <code class="reqn">p_1\times \cdots\times p_m \times n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The response of dimension <code class="reqn">r\times n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gamma</code></td>
<td>
<p>A list of envelope subspace basis of dimension <code class="reqn">p_k \times u_k, \ k=1,\ldots,m</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>The tensor coefficients of dimension <code class="reqn">p_1\times \cdots\times p_m \times r</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>A lists of estimated covariance matrices at each mode for the tensor predictors, i.e., <code class="reqn">\Sigma_1,\dots, \Sigma_m</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p, r, u</code></td>
<td>
<p>The input <code>p,r,u</code>.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The length of <code>p</code> must match that of <code>u</code>, and each element of <code>u</code> must be less than the corresponding element in <code>p</code>.
</p>


<h3>References</h3>

<p>Zhang, X. and Li, L., 2017. Tensor envelope partial least-squares regression. Technometrics, 59(4), pp.426-436.
</p>


<h3>See Also</h3>

<p><code>TPR.fit, TRRsim</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">p &lt;- c(10, 10, 10)
u &lt;- c(1, 1, 1)
r &lt;- 5
n &lt;- 200
dat &lt;- TPRsim(p = p, r = r, u = u, n = n)
x &lt;- dat$x
y &lt;- dat$y
fit_std &lt;- TPR.fit(x, y, method="standard")

</code></pre>


</div>