<div class="container">

<table style="width: 100%;"><tr>
<td>interp.loess</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Lowess 2-d interpolation onto a uniform grid </h2>

<h3>Description</h3>

<p>Use the <code>loess</code> function to interpolate the
two-dimensional <code>x</code>, <code>y</code>, and <code>z</code> data onto a uniform grid.  The output
produced is an object directly usable by the plotting functions
<code>persp</code>, <code>image</code>,
and <code>contour</code>, etc.
</p>
<p>This function is designed as an alternative to the
<code>interp</code> functions from the <span class="pkg">akima</span>
library.
</p>


<h3>Usage</h3>

<pre><code class="language-R">interp.loess(x, y, z, gridlen = c(40,40), span = 0.1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> Vector of <code>X</code> spatial input locations </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p> Vector of <code>Y</code> spatial input locations </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p> Vector of <code>Z</code> responses interpreted as
<code>Z = f(X,Y)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gridlen</code></td>
<td>
<p> Size of the interpolated grid to be produced in x and y.
The default of <code>gridlen = c(40,40)</code> causes a <code>40 * 40</code>
grid of <code>X</code>, <code>Y</code>, and <code>Z</code> values to be computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>span</code></td>
<td>
<p> Kernel span argument to the <code>loess</code>
function with default setting <code>span = 0.1</code> set significantly lower than the
the <code>loess</code> default – see note below.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> Further arguments to be passed to the
<code>loess</code> function</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Uses <code>expand.grid</code> function to produce a uniform
grid of size <code>gridlen</code> with domain equal to the rectangle implied
by <code>X</code> and <code>Y</code>.  Then, a <code>loess</code> a smoother
is fit to the data <code>Z = f(X,Y)</code>.  Finally,
<code>predict.loess</code> is used to  predict onto the grid.
</p>


<h3>Value</h3>

<p>The output is a list compatible with the 2-d plotting functions
<code>persp</code>, <code>image</code>,
and <code>contour</code>, etc.
</p>
<p>The list contains...
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x </code></td>
<td>
<p>Vector of with <code>length(x) == gridlen</code> of increasing
<code>X</code> grid locations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y </code></td>
<td>
<p>Vector of with <code>length(y) == gridlen</code> of increasing
<code>Y</code> grid locations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z </code></td>
<td>
<p><code>matrix</code> of interpolated responses <code>Z = f(X,Y)</code>
where <code>z[i,j]</code> contains an estimate of <code>f(x[i],y[j])</code></p>
</td>
</tr>
</table>
<h3>Note</h3>

 
<p>As mentioned above, the default <code>span = 0.1</code> parameter is 
significantly smaller that the default <code>loess</code> setting.
This asserts a tacit assumption that
the input is densely packed and that the noise in <code>z</code>'s is small.  
Such should be the case when the data are output from a <span class="pkg">tgp</span> regression –
this function was designed specifically for this situation.
For data that is random or sparse, simply choose higher setting,
e.g., the default <code>loess</code> setting of <code>span =
  0.75</code>, or a more intermediate setting of <code>span = 0.5</code> as in the example below</p>


<h3>Author(s)</h3>

 
<p>Robert B. Gramacy, <a href="mailto:rbg@vt.edu">rbg@vt.edu</a>, and
Matt Taddy, <a href="mailto:mataddy@amazon.com">mataddy@amazon.com</a>
</p>


<h3>References</h3>

<p><a href="https://bobby.gramacy.com/r_packages/tgp/">https://bobby.gramacy.com/r_packages/tgp/</a>
</p>


<h3>See Also</h3>

 <p><code>interp</code>, <code>loess</code>,
<code>persp</code>, <code>image</code>, <code>contour</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># random data
ed &lt;- exp2d.rand()

# higher span = 0.5 required because the data is sparse
# and was generated randomly
ed.g &lt;- interp.loess(ed$X[,1], ed$X[,2], ed$Z, span=0.5)

# perspective plot
persp(ed.g)
</code></pre>


</div>