<div class="container">

<table style="width: 100%;"><tr>
<td>predict.nlar</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Predict method for objects of class ‘<code>nlar</code>’.</h2>

<h3>Description</h3>

<p>Forecasting a non-linear model object of general class ‘<code>nlar</code>’,
including ‘<code>setar</code>’ and ‘<code>star</code>’.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'nlar'
predict(
  object,
  newdata,
  n.ahead = 1,
  type = c("naive", "MC", "bootstrap", "block-bootstrap"),
  nboot = 100,
  ci = 0.95,
  block.size = 3,
  boot1Zero = TRUE,
  seed = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of class ‘<code>nlar</code>’; generated by
<code>setar()</code> or <code>lstar()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>Optional. A new data frame to predict from.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.ahead</code></td>
<td>
<p>An integer specifying the number of forecast steps.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Type of forecasting method used. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nboot</code></td>
<td>
<p>The number of replications for type MC or bootstrap.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>
<p>The forecast confidence interval (available only with types MC and
bootstrap).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>block.size</code></td>
<td>
<p>The block size when the block-bootstrap is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot1Zero</code></td>
<td>
<p>Whether the first innovation for MC/bootstrap should be set
to zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>optional, the seed for the random generation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to the internal ‘<code>oneStep</code>’ function. 
Mainly argument ‘<code>thVar</code>’ if an external threshold variable was provided</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The forecasts are obtained recursively from the estimated model.  Given that
the models are non-linear, ignoring the residuals in the 2- and more steps
ahead forecasts leads to biased forecasts (so-called naive).  Different
resampling methods, averaging <code>n.boot</code> times over future residuals, are
available:
</p>
 <dl>
<dt>naive</dt>
<dd>
<p>No residuals</p>
</dd> <dt>MC</dt>
<dd>
<p>Monte-Carlo method, where
residuals are taken from a normal distribution, with a standard deviation equal to the
residuals sd. </p>
</dd> <dt>bootstrap</dt>
<dd>
<p>Residuals are resampled from the empirical
residuals from the model.</p>
</dd> <dt>block-bootstrap</dt>
<dd>
<p>Same as bootstrap, but
residuals are resampled in block, with size <code>block.size</code></p>
</dd> </dl>
<p>The <code>MC</code> and <code>bootstrap</code> methods correspond to equations 3.90 and
3.91 of Franses and van Dijk (2000, p. 121).  The bootstrap/MC is initiated
either from the first forecast, <code>n.ahead</code>=1 (set with <code>boot1zero</code>
to TRUE), or from the second only.
</p>
<p>When the forecast method is based on resampling, forecast intervals are
available. These are obtained simply as empirical <code>ci</code> quantiles of the
resampled forecasts (cf Method 2 in Franses and van Dijk, 2000, p. 122).
</p>


<h3>Value</h3>

<p>A ‘<code>ts</code>’ object, or, in the case of MC/bootstrap, a list
containing the prediction (pred) and the forecast standard errors
(<code>se</code>).
</p>


<h3>Author(s)</h3>

<p>Matthieu Stigler
</p>


<h3>References</h3>

<p>Non-linear time series models in empirical finance, Philip Hans
Franses and Dick van Dijk, Cambridge: Cambridge University Press (2000).
</p>


<h3>See Also</h3>

<p>The model fitting functions <code>setar</code>,
<code>lstar</code>. 
</p>
<p>A more sophisticated predict function, allowing to do sub-sample rolling
predictions: <code>predict_rolling</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">

x.train &lt;- window(log10(lynx), end = 1924)
x.test &lt;- window(log10(lynx), start = 1925)


### Use different forecasting methods:
mod.set &lt;- setar(x.train, m=2, thDelay=0)
pred_setar_naive &lt;- predict(mod.set, n.ahead=10)
pred_setar_boot &lt;- predict(mod.set, n.ahead=10, type="bootstrap", n.boot=200)
pred_setar_Bboot &lt;- predict(mod.set, n.ahead=10, type="block-bootstrap", n.boot=200)
pred_setar_MC &lt;- predict(mod.set, n.ahead=10, type="bootstrap", n.boot=200)

## Plot to compare results:
pred_range &lt;- range(pred_setar_naive, pred_setar_boot$pred, pred_setar_MC$pred, na.rm=TRUE)
plot(x.test, ylim=pred_range, main="Comparison of forecasts methods from same SETAR")
lines(pred_setar_naive, lty=2, col=2)
lines(pred_setar_boot$pred, lty=3, col=3)
lines(pred_setar_Bboot$pred, lty=4, col=4)
lines(pred_setar_MC$pred, lty=5, col=5)

legLabels &lt;- c("Observed", "Naive F", "Bootstrap F","Block-Bootstrap F", "MC F")
legend("bottomleft", leg=legLabels, lty=1:5, col=1:5)

</code></pre>


</div>