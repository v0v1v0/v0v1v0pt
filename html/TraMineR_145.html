<div class="container">

<table style="width: 100%;"><tr>
<td>seqpcplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Parallel coordinate plot for sequence data</h2>

<h3>Description</h3>

<p>A decorated parallel coordinate plot to render the order of the
successive elements in sequences. The sequences are displayed as
jittered frequency-weighted parallel lines.
The plot is also embedded as the <code>type="pc"</code> option of the
<code>seqplot</code> function and serves as plot
method for <code>eseq</code> and <code>seqelist</code> objects.
</p>


<h3>Usage</h3>

<pre><code class="language-R">seqpcplot(seqdata, group = NULL, weights = NULL, cex = 1, lwd = 1/4,
  cpal = NULL, grid.scale = 1/5, ltype = "unique",
  embedding = "most-frequent", lorder = NULL , lcourse = "upwards",
  filter = NULL, hide.col = "grey80", alphabet = NULL,
  missing = "auto", order.align = "first", main = "auto", xlab = NULL,
  ylab = NULL, xaxis = TRUE, yaxis = TRUE, axes = "all", xtlab = NULL,
  cex.lab = 1, rows = NA, cols = NA, plot = TRUE, seed = NULL,
  weighted = TRUE, with.missing = TRUE,
  title, cex.plot, ...)

seqpcfilter(method = c("minfreq", "cumfreq", "linear"), level = 0.05)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>seqdata</code></td>
<td>
<p>The sequence data. Either an event sequence
object of class <code>seqelist</code> (see
<code>seqecreate</code>) or a state sequence object of class
<code>stslist</code> (see <code>seqdef</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>a vector (numeric or factor) of group memberships
of length equal the number of
sequences. When specified, one plot is generated for each
different membership value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>a numeric vector of weights of length equal the number
of sequences. When <code>NULL</code>, the <code>weights</code> are taken from
the <code>seqdata</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p>Plotting text and symbols magnification. See <code>par</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>expansion factor for line widths. The expansion is
relative to the size of the squared symbols.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cpal</code></td>
<td>
<p>color palette vector for line coloring.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid.scale</code></td>
<td>
<p>Expansion factor for the translation zones.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ltype</code></td>
<td>
<p>the type of sequence that is drawn. Either <code>"unique"</code>
to render unique patterns or <code>"non-embeddable"</code> to render
non-embeddable sequences.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>embedding</code></td>
<td>
<p>The method for embedding sequences embeddable in
multiple non-embeddable sequences. Either <code>"most-frequent"</code>
(default) or <code>"uniformly"</code>. Relevant only with <code>ltype =
      "non-embeddable"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lorder</code></td>
<td>
<p>line ordering. Either <code>"background"</code> or
<code>"foreground"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lcourse</code></td>
<td>
<p>Method to connect simultaneous elements with the
preceding and following ones. Either <code>"upwards"</code> (default) or
<code>"downwards"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filter</code></td>
<td>
<p>list of line coloring options. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hide.col</code></td>
<td>
<p>Color for sequences filtered-out by the
<code>filter</code> specification.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alphabet</code></td>
<td>
<p>a vector of response levels in the order they should
appear on the y-axis. This argument is solely relevant for
<code>seqelist</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>missing</code></td>
<td>
<p>character. Whether and how missing values should be
displayed. Available are <code>"auto"</code>, <code>"show"</code> and
<code>"hide"</code>. If <code>"auto"</code>, the plot will show missings only if
present. <code>"hide"</code> will fade out missings and <code>"show"</code> will
always show missings. If <code>with.missing=FALSE</code>,
<code>missing</code> is turned into <code>"hide"</code>. If <code>with.missing=TRUE</code>
and <code>missing="hide"</code>, <code>missing</code> is turned into <code>"auto"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order.align</code></td>
<td>
<p>Aligning method. For aligning on order positions use either <code>"first"</code> (default) or
<code>"last"</code>. Option <code>"first"</code> numbers the positions from the beginning
while <code>"last"</code> numbers them from the end. With <code>order.align = "time"</code>, the elements in the
sequences are aligned on their rounded timestamps.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>title for the graphic. Default <code>"auto"</code> prints default titles. Set as <code>NULL</code> to
suppress the title.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>label for the x-axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>label for the y-axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xaxis</code></td>
<td>
<p>logical: Should x-axis be plotted?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yaxis</code></td>
<td>
<p>logical: Should y-axis be plotted?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axes</code></td>
<td>
<p>if set as <code>"all"</code> (default value) x-axes are drawn
for each plot in the graphic. If set as <code>"bottom"</code> and
<code>group</code> is used, axes are drawn only under the plots at
the bottom of the graphic area. If <code>FALSE</code>, no x-axis is drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xtlab</code></td>
<td>
<p>labels for the x-axis ticks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.lab</code></td>
<td>
<p>x and y labels magnification. See <code>par</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rows,cols</code></td>
<td>
<p>integers. Number of rows and columns of the plot panel.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical. Should the plot be displayed? Set as <code>FALSE</code> to retrieve the <code>seqpcplot</code>
object without plotting it.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>integer. Start seed value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weighted</code></td>
<td>
<p>logical. Should weights be accounted for? Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>with.missing</code></td>
<td>
<p>logical. Should we care about possible missings? Default is <code>TRUE</code>. See also the
<code>missing</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>character string. Defines the filtering
function. Available are <code>"minfreq"</code>, <code>"cumfreq"</code> and
<code>"linear"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>numeric scalar between 0 and 1. The frequency threshold
for the filtering methods <code>"minfreq"</code> and <code>"cumfreq"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>Deprecated. Use <code>main</code> instead.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.plot</code></td>
<td>
<p>Deprecated. Use <code>cex.lab</code> instead.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments to be passed to other methods, such as graphical
parameters (see <code>par</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For plots by groups specified with the <code>group</code> argument, plotted
line widths and point sizes reflect relative frequencies within
group.
</p>
<p>The <code>filter</code> argument serves to specify filters to gray less
interesting patterns. The filtered-out patterns are displayed in the
<code>hide.col</code> color. The <code>filter</code> argument expects a list with
at least elements <code>type</code> and <code>value</code>. The following types
are implemented:
</p>
<p>Type <code>"sequence"</code>: colors a specific pattern, for example assign<br><code>filter = list(type = "sequence", value = "(Leaving
  Home,Union)-(Child)")</code>.
</p>
<p>Type <code>"subsequence"</code>: colors patterns which include a specific
subsequence, for example<br><code>filter = list(type =
  "subsequence", value = "(Child)-(Marriage)")</code> .
</p>
<p>Type <code>"value"</code>: gradually colors the patterns according to the
numeric vector (of length equal to the number of sequences) provided as
<code>"value"</code> element in the list. You can give something like
<code>filter = list(type = "value", value = c(0.2, 1, ...))</code> or
provide the distances to the medoid as <code>value</code> vector for
example.
</p>
<p>Type <code>"function"</code>: colors the patterns depending on the values
returned by a [0,1] valued function of the frequency x of the
pattern. Three native functions can be used: <code>"minfreq"</code>,
<code>"cumfreq"</code> and <code>"linear"</code>. Use
<code>filter = list(type = "function", value = "minfreq", level = 0.05)</code>
to color patterns with a
support of at least 5% (within group). Use
<br><code>filter = list(type = "function", value = "cumfreq", level = 0.5)</code>
to highlight the 50% most
frequent patterns (within group). Or, use
<code>filter = list(type="function", value="linear")</code>
to use a linear gradient for the
color intensity (the most frequent trajectory gets
100% intensity). Other user-specified functions can be provided by
giving something like
<br><code>filter = list(type="function", value=function(x, arg1, arg2) {return(x/max(x) * arg1/arg2)},</code>
<code>arg1 = 1, arg2 = 1)</code>. This latter function adjusts gradually the color intensity
of patterns according to the frequency of the pattern.
</p>
<p>The function <code>seqpcfilter</code> is a convenience function for type
<code>"function"</code>. The three examples above can be imitated by
<code>seqpcfilter("minfreq", 0.05)</code>,
<code>seqpcfilter("cumfreq", 0.5)</code> and <code>seqpcfilter("linear")</code>.
</p>
<p>If a numeric scalar is assigned to <code>filter</code>, the <code>"minfreq"</code>
filter is used.
</p>


<h3>Value</h3>

<p>An object of <code>class</code> <code>"seqpcplot"</code>
with various information necessary for constructing the plot,
e.g. coordinates. There is a <code>summary</code> method for such
objects.
</p>


<h3>Author(s)</h3>

<p>Reto Bürgin (with Gilbert Ritschard for the help page)</p>


<h3>References</h3>

<p>Bürgin, R. and G. Ritschard (2014), A decorated parallel coordinate plot for categorical longitudinal
data, <em>The American Statistician</em> 68(2), 98-103.
</p>


<h3>See Also</h3>

 <p><code>seqplot</code>, <code>seqdef</code>, <code>seqecreate</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
## ================
## plot biofam data
## ================

data(biofam)
lab &lt;- c("Parent","Left","Married","Left+Marr","Child","Left+Child",
         "Left+Marr+Child","Divorced")

## plot state sequences in STS representation
## ==========================================

## creating the weighted state sequence object.
biofam.seq &lt;- seqdef(data = biofam[,10:25], labels = lab,
                     weights = biofam$wp00tbgs)

## select the first 20 weighted sequences (sum of weights = 18)
biofam.seq &lt;- biofam.seq[1:20, ]

par(mar=c(4,8,2,2))
seqpcplot(seqdata = biofam.seq, order.align = "time")

## .. or
seqplot(seqdata = biofam.seq, type = "pc", order.align = "time")

## Distinct successive states (DSS)
## ==========================================

seqplot(seqdata = biofam.seq, type = "pc", order.align = "first")

## .. or (equivalently)

biofam.DSS &lt;- seqdss(seqdata = biofam.seq) # prepare format
seqpcplot(seqdata = biofam.DSS)

## plot event sequences
## ====================

biofam.eseq &lt;- seqecreate(biofam.seq, tevent = "state") # prepare data

## plot the time in the x-axis
seqpcplot(seqdata = biofam.eseq, order.align = "time", alphabet = lab)

## ordering of events
seqpcplot(seqdata = biofam.eseq, order.align = "first", alphabet = lab)

## ... or
plot(biofam.eseq, order.align = "first", alphabet = lab)

## additional arguments
## ====================

## non-embeddable sequences
seqpcplot(seqdata = biofam.eseq, ltype = "non-embeddable",
          order.align = "first", alphabet = lab)

## align on last event
par(mar=c(4,8,2,2))
seqpcplot(seqdata = biofam.eseq, order.align = "last", alphabet = lab)

## use group variables
seqpcplot(seqdata = biofam.eseq, group = biofam$sex[1:20],
          order.align = "first", alphabet = lab)

## color patterns (Parent)-(Married) and (Parent)-(Left+Marr+Child)
par(mfrow = c(1, 1))
seqpcplot(seqdata = biofam.eseq,
          filter = list(type = "sequence",
                          value=c("(Parent)-(Married)",
                                  "(Parent)-(Left+Marr+Child)")),
          alphabet = lab, order.align = "first")

## color subsequence pattern (Parent)-(Left)
seqpcplot(seqdata = biofam.eseq,
          filter = list(type = "subsequence",
                          value = "(Parent)-(Left)"),
          alphabet = lab, order.align = "first")

## color sequences over 10% (within group) (function method)
seqpcplot(seqdata = biofam.eseq,
          filter = list(type = "function",
                        value = "minfreq",
                        level = 0.1),
          alphabet = lab, order.align = "first", seed = 1)

## .. same result using the convenience functions
seqpcplot(seqdata = biofam.eseq,
          filter = 0.1,
          alphabet = lab, order.align = "first", seed = 1)

seqpcplot(seqdata = biofam.eseq,
          filter = seqpcfilter("minfreq", 0.1),
          alphabet = lab, order.align = "first", seed = 1)

## highlight the 50% most frequent sequences
seqpcplot(seqdata = biofam.eseq,
          filter = list(type = "function",
                          value = "cumfreq",
                          level = 0.5),
          alphabet = lab, order.align = "first", seed = 2)

## .. same result using the convenience functions
seqpcplot(seqdata = biofam.eseq,
          filter = seqpcfilter("cumfreq", 0.5),
          alphabet = lab, order.align = "first", seed = 2)

## linear gradient
seqpcplot(seqdata = biofam.eseq,
          filter = list(type = "function",
                          value = "linear"),
          alphabet = lab, order.align = "first", seed = 2)

seqpcplot(seqdata = biofam.eseq,
          filter = seqpcfilter("linear"),
          alphabet = lab, order.align = "first", seed = 1)



</code></pre>


</div>