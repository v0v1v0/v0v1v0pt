<div class="container">

<table style="width: 100%;"><tr>
<td>metropolis</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Metropolis-Hastings sampler for location estimation for archival and satellite tag </h2>

<h3>Description</h3>

<p>These functions provide a direct implementation of the Metropolis-Hastings algorithm, for
calculating marginal posterior (locations and full-track estimates)
properties using Markov Chain Monte Carlo. The
sampler is written completely in <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>, vectorized to be as fast as possible. The sampler can
include likelihood functions for large data records (including light and water temperature), as
well as <em>mask</em> functions for simpler rejection sources. Behavioural constraints are
implemented using a red/black update, so that location estimates <em>X</em> and <em>Z</em> may
be estimated in an efficient manner. The parameter estimates may be cached and later
queried arbitrarily.
</p>


<h3>Usage</h3>

<pre><code class="language-R">metropolis(model, iters = 1000, thin = 10, start.x = NULL, start.z = NULL)

metropolis0(model, iters = 1000, thin = 10, start.x = NULL, start.z =
NULL)


</code></pre>


<h3>Arguments</h3>


<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p> model for estimation, such as one created by <code>solar.model</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iters</code></td>
<td>
<p> number of iterations to run</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>
<p> number of iterations to thin by </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start.x</code></td>
<td>
<p> starting points for the primary locations  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start.z</code></td>
<td>
<p> starting points for the intermediate locations
(midpoints between the <code>start.x</code> points is a good first guess </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>metropolis0</code> is a slightly different version of <code>metropolis</code>
that enables an initialization step, required to find parameter estimates that are
consistent with any masks used. It is difficult to make this step more elegant, and so
we live with the two versions.
</p>
<p>In terms of the estimates, X's have <code>m</code> records with <code>n</code> parameters, where <code>m</code>
is the number of data records in time (twilights for archival tags, Argos estimates for satellite
tags) and <code>n</code> is at least x-coordinate, y-coordinate and maybe k-attenuation for light.
Z's have <code>m-1</code> records with 2 parameters for 'x' and 'y' (which are usually Longitude and
Latitude). These parameters may be increased or changed, they are tied only to the likelihood
functions used, not the sampler itself. Also, coordinate transformations may be used inside the model
and likelihood functions, in order to use an appropriate map projection. Solar calculations rely on
lon/lat and so this step does slow down light level geo-location.
</p>


<h3>Value</h3>

<p>A MCM <em>Chain</em> stored as a list containing
</p>
<table>
<tr style="vertical-align: top;">
<td><code>model </code></td>
<td>
<p>The model object used by the sampler</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x </code></td>
<td>
<p>The last <code>iters</code> X-samples accepted, stored as an <code>c(m, n, iters)</code> array </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z </code></td>
<td>
<p>The last <code>iters</code> Z-samples accepted, stored as an <code>c(m - 1, 2, iters)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>last.x </code></td>
<td>
<p>The last accepted X-sample, stored as a <code>c(m, n)</code> matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>last.z </code></td>
<td>
<p>The last accepted Z-sample, stored as a <code>c(m, 2)</code> matrix</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Michael D. Sumner and Simon Wotherspoon</p>


<h3>References</h3>

<p>Sumner, Wotherspoon and Hindell (2009). Bayesian Estimation of Animal Movement from Archival and Satellite Tags, PLoS ONE. <a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0007324">https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0007324</a></p>


<h3>See Also</h3>

<p><code>solar.model</code>, <code>satellite.model</code> </p>


</div>