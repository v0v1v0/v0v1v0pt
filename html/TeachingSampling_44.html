<div class="container">

<table style="width: 100%;"><tr>
<td>S.STSI</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Stratified sampling applying SI design in all strata</h2>

<h3>Description</h3>

<p>Draws a simple random sample without replacement of size <code class="reqn">n_h</code> in stratum <code class="reqn">h</code> of size <code class="reqn">N_h</code></p>


<h3>Usage</h3>

<pre><code class="language-R">S.STSI(S, Nh, nh)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>Vector identifying the membership to the strata of each unit in the population</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nh</code></td>
<td>
<p>Vector of stratum sizes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nh</code></td>
<td>
<p>Vector of sample size in each stratum</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The selected sample is drawn according to a selection-rejection (list-sequential) algorithm in each stratum</p>


<h3>Value</h3>

<p>The function returns a vector of size <code class="reqn">n=n_1+\cdots+n_H</code>. Each element of this vector indicates the unit that was selected.</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hagutierrezro@gmail.com">hagutierrezro@gmail.com</a></p>


<h3>References</h3>

<p>Sarndal, C-E. and Swensson, B. and Wretman, J. (1992), <em>Model Assisted Survey Sampling</em>. Springer.<br>
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas.
</p>


<h3>See Also</h3>

<p><code>E.STSI</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">############
## Example 1
############
# Vector U contains the label of a population of size N=5
U &lt;- c("Yves", "Ken", "Erik", "Sharon", "Leslie")
# Vector Strata contains an indicator variable of stratum membership 
Strata &lt;- c("A", "A", "A", "B", "B")
Strata
# The stratum sizes
Nh &lt;- c(3,2)
# Then sample size in each stratum
nh &lt;- c(2,1)
# Draws a stratified simple random sample without replacement of size n=3
sam &lt;- S.STSI(Strata, Nh, nh)
sam
# The selected sample is
U[sam]

############
## Example 2
############
# Uses the Lucy data to draw a stratified random sample
#  accordind to a SI design in each stratum
data(Lucy)
attach(Lucy)
# Level is the stratifying variable
summary(Level)
# Defines the size of each stratum
N1&lt;-summary(Level)[[1]]
N2&lt;-summary(Level)[[2]]
N3&lt;-summary(Level)[[3]]
N1;N2;N3
Nh &lt;- c(N1,N2,N3)
# Defines the sample size at each stratum
n1&lt;-70
n2&lt;-100
n3&lt;-200
nh&lt;-c(n1,n2,n3)
# Draws a stratified sample
sam &lt;- S.STSI(Level, Nh, nh)
# The information about the units in the sample is stored in an object called data
data &lt;- Lucy[sam,]
data
dim(data)
</code></pre>


</div>