<div class="container">

<table style="width: 100%;"><tr>
<td>nnf_embedding_bag</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Embedding_bag</h2>

<h3>Description</h3>

<p>Computes sums, means or maxes of <code>bags</code> of embeddings, without instantiating the
intermediate embeddings.
</p>


<h3>Usage</h3>

<pre><code class="language-R">nnf_embedding_bag(
  input,
  weight,
  offsets = NULL,
  max_norm = NULL,
  norm_type = 2,
  scale_grad_by_freq = FALSE,
  mode = "mean",
  sparse = FALSE,
  per_sample_weights = NULL,
  include_last_offset = FALSE,
  padding_idx = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>input</code></td>
<td>
<p>(LongTensor) Tensor containing bags of indices into the embedding matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>
<p>(Tensor) The embedding matrix with number of rows equal to the
maximum possible index + 1, and number of columns equal to the embedding size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offsets</code></td>
<td>
<p>(LongTensor, optional) Only used when <code>input</code> is 1D. <code>offsets</code>
determines the starting index position of each bag (sequence) in <code>input</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_norm</code></td>
<td>
<p>(float, optional) If given, each embedding vector with norm
larger than <code>max_norm</code> is renormalized to have norm <code>max_norm</code>.
Note: this will modify <code>weight</code> in-place.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>norm_type</code></td>
<td>
<p>(float, optional) The <code>p</code> in the <code>p</code>-norm to compute for the
<code>max_norm</code> option. Default <code>2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale_grad_by_freq</code></td>
<td>
<p>(boolean, optional) if given, this will scale gradients
by the inverse of frequency of the words in the mini-batch. Default <code>FALSE</code>.                                            Note: this option is not supported when <code>mode="max"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode</code></td>
<td>
<p>(string, optional) <code>"sum"</code>, <code>"mean"</code> or <code>"max"</code>. Specifies
the way to reduce the bag. Default: 'mean'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sparse</code></td>
<td>
<p>(bool, optional) if <code>TRUE</code>, gradient w.r.t. <code>weight</code> will be a
sparse tensor. See Notes under <code>nn_embedding</code> for more details regarding
sparse gradients. Note: this option is not supported when <code>mode="max"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>per_sample_weights</code></td>
<td>
<p>(Tensor, optional) a tensor of float / double weights,
or NULL to indicate all weights should be taken to be 1. If specified,
<code>per_sample_weights</code> must have exactly the same shape as input and is treated
as having the same <code>offsets</code>, if those are not <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include_last_offset</code></td>
<td>
<p>(bool, optional) if <code>TRUE</code>, the size of offsets is
equal to the number of bags + 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>padding_idx</code></td>
<td>
<p>(int, optional) If given, pads the output with the embedding
vector at <code>padding_idx</code> (initialized to zeros) whenever it encounters the index.</p>
</td>
</tr>
</table>
</div>