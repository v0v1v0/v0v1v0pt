<div class="container">

<table style="width: 100%;"><tr>
<td>rejection-samplers</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Custom uniform rejection samplers</h2>

<h3>Description</h3>

<p>These functions create rejection samplers, and uniform manifold
samplers based on them, using user-provided parameterization and Jacobian
functions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">make_rejection_sampler(
  parameterization,
  jacobian,
  min_params,
  max_params,
  max_jacobian
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>parameterization</code></td>
<td>
<p>A function that takes parameter vector arguments and
returns a matrix of coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jacobian</code></td>
<td>
<p>A function that takes parameter vector arguments and returns
a vector of Jacobian determinants.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_params, max_params</code></td>
<td>
<p>(Optionally named) vectors of minimum and
maximum values of the parameters, used for uniform sampling.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_jacobian</code></td>
<td>
<p>An (ideally sharp) upper bound on the Jacobian
determinant.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The rejection sampling technique of Diaconis, Holmes, and
Shahshahani (2013) uses a parameterized embedding from a parameter space to
a coordinate space and relies on a formula for its jacobian determinant.
The <code>parameterization</code> must be a function that takes vector arguments of
equal length and returns a coordinate matrix of the same number of rows.
The <code>jacobian</code> must be a function that takes the same arguments and returns
a scalar value. The parameters must range from their respective minima
<code>min_params</code> to their respective maxima <code>max_params</code>. <code>max_jacobian</code> must
be provided, though it may be larger than the theoretical maximum of the
jacobian determinant.
</p>


<h3>References</h3>

<p>P Diaconis, S Holmes, and M Shahshahani (2013) Sampling from a Manifold.
<em>Advances in Modern Statistical Theory and Applications: A Festschrift in
honor of Morris L. Eaton</em>, 102â€“125. <a href="https://doi.org/10.1214/12-IMSCOLL1006">doi:10.1214/12-IMSCOLL1006</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(47569L)

# parameterization and Jacobian for Klein bottle tube embedding
klein_parameterization &lt;- function(theta, phi) {
  cbind(
    w = (1 + .5 * cos(theta)) * cos(phi),
    x = (1 + .5 * cos(theta)) * sin(phi),
    y = .5 * sin(theta) * cos(phi/2),
    z = .5 * sin(theta) * sin(phi/2)
  )
}
klein_jacobian &lt;- function(theta, phi) {
  unname(.5 * sqrt((1 + .5 * cos(theta)) ^ 2 + (.5 * .5 * sin(theta)) ^ 2))
}
# custom sampler based on these functions
klein_sampler &lt;- make_rejection_sampler(
  klein_parameterization,
  klein_jacobian,
  max_params = c(theta = 2*pi, phi = 2*pi),
  max_jacobian = klein_jacobian(cbind(theta = 0))
)
# compare custom sampler to `sample_klein_tube()`
pairs(klein_sampler(n = 360), asp = 1, pch = 19, cex = .5)
pairs(sample_klein_tube(n = 360, ar = 2), asp = 1, pch = 19, cex = .5)
</code></pre>


</div>