<div class="container">

<table style="width: 100%;"><tr>
<td>taba.matrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Robust Correlation Matrix</h2>

<h3>Description</h3>

<p>Calculates a correlation, distance, and p-value matrix using one of the
specified robust methods Taba linear or Taba rank correlation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">taba.matrix(x, y = NULL, ..., method = c("taba","tabarank","tabwil","tabwilrank"),
            alternative = c("less", "greater", "two.sided"),
            omega)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A numeric vector of length greater than 2 must be same length as all other vectors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A numeric vector of length greater than 2 must be same length as all other vectors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Numeric vector(s) of length equal to x and y. May be of class matrix
or data.frame, whose columns will be compared and whose column's length must be of
equal length to x and y. Not one vector or column name can be "x" or "y."</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>A character string of <code>"taba"</code>, <code>"tabarank"</code>, <code>"tabwil"</code>, or
<code>"tabwilrank"</code> determining if one wants to calculate Taba linear, Taba rank
(monotonic), TabWil, or TabWil rank correlation, respectively. If no method is specified,
the function will output Taba Linear correlation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>Character string specifying the alternative hypothesis must be one
of <strong><code>"less"</code></strong> for negative association, <code>"greater"</code> for
positive association, or <code>"two.sided"</code> for difference in association.
If the alternative is not specified, the function will default to a two sided test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omega</code></td>
<td>
<p>Numeric allowing the user to alter the tuning constant. If one is not specified,
the function will default to 0.45 for Taba and Taba rank, and 0.1 for TabWil and TabWil rank.
Range is between 0 and 1.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function uses Taba linear, Taba rank (monotonic), TabWil, or TabWil rank correlation to
calculate the association of two or more numeric vectors. Numeric vectors under <code>...</code>
are combined colomn-wise with x and y. When inserting a single matrix x, the function will
calculate the correlation matix using the columns of matrix x. <br>
Matricies or data frames with numeric cells can be inserted in <code>...</code>, whereby
each column in the matrix or data frame will be treated as a different vector
for comparison. Columns must all have different names from each other. No vector
or column should be named "x" or "y," as these refer to the first two vectors respectively,
if inserted as a vector or matrix with no name. Missing values in any of the vectors
are deleted row-wise. <br>
The default for this function is a two sided test using Taba linear partial correlation,
with the tuning constant <code>omega</code> equal to 0.45.
</p>


<h3>Value</h3>

<p>This function returns the robust association
between two or more numeric vectors, as a matrix; the distance matrix, as type dist;
and a p-value matrix corresponding to the correlation matrix.
</p>


<h3>References</h3>

<p>Tabatabai, M., Bailey, S., Bursac, Z. et al. An introduction to new robust linear
and monotonic correlation coefficients. BMC Bioinformatics 22, 170 (2021). https://doi.org/10.1186/s12859-021-04098-4
<br><br>doi: <a href="https://doi.org/10.1186/s12859-021-04098-4">10.1186/s12859-021-04098-4</a>
</p>


<h3>See Also</h3>

<p><code>taba</code> for calculating Taba linear or Taba rank (monotonic) correlations
<br><code>taba.test</code> for testing Taba linear or Taba rank (monotonic) correlations
<br><code>taba.gpartial</code> for generalized partial correlations
<br><code>taba.partial</code> for partial and semipartial correlations
</p>


<h3>Examples</h3>

<pre><code class="language-R">x = rnorm(100)
y = rnorm(100)
z1 = rnorm(100)
z2 = rnorm(100)
z3 = rnorm(100)
Z = cbind(z1,z3)
colnames(Z) = c("A","B")
taba.matrix(x, y, z1, z2, z3, method = "tabarank")
taba.matrix(x, y, z2, Z, alternative = "less", omega = 0.4)
taba.matrix(Z, method = "tabarank")
</code></pre>


</div>