<div class="container">

<table style="width: 100%;"><tr>
<td>TukeyC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
The TukeyC Test for Single Experiments
</h2>

<h3>Description</h3>

<p>These are methods for objects of class <code>formula</code>, <code>lm</code>, <code>aov</code>, <code>aovlist</code> and <code>lmerMod</code> for single, factorial, split-plot and split-split-plot experiments.
</p>


<h3>Usage</h3>

<pre><code class="language-R">TukeyC(x,...)

## S3 method for class 'formula'
TukeyC(formula,
       data            = NULL,
       which           = NULL,
       fl1             = NULL,
       fl2             = NULL,
       error           = NULL,
       sig.level       = .05,
       round           = 2,
       adjusted.pvalue = 'none',
       ...)

## S3 method for class 'lm'
TukeyC(x,
       which           = NULL,
       fl1             = NULL,
       fl2             = NULL,
       error           = NULL,
       sig.level       = .05,
       round           = 2,
       adjusted.pvalue = 'none',
       ...)

## S3 method for class 'aovlist'
TukeyC(x,
       which           = NULL,
       fl1             = NULL,
       fl2             = NULL,
       error           = NULL,
       sig.level       = .05,
       round           = 2,
       adjusted.pvalue = 'none',
       ...)

## S3 method for class 'lmerMod'
TukeyC(x,
       which           = NULL,
       fl1             = NULL,
       fl2             = NULL,
       error           = NULL,
       sig.level       = .05,
       round           = 2,
       adjusted.pvalue = 'none',
       ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x,formula</code></td>
<td>
<p>A <code>formula</code>, <code>lm</code>, <code>aov</code>, <code>aovlist</code> and <code>lmerMod</code> class object. Objects of the <code>formula</code> class follow â€œresponse variable ~ predicted variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A object of the <code>data.frame</code> class. Use only objects of <code>formula</code> class.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>The name of the treatment to be used in the comparison.
The name must be inside quoting marks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fl1</code></td>
<td>
<p>A vector of length 1 giving the level of the first factor in nesting order tested.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fl2</code></td>
<td>
<p>A vector of length 1 giving the level of the second factor in nesting order tested.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>error</code></td>
<td>
<p>The error to be considered. If from experiment at split plot or split-split plot pay attention! See details!</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig.level</code></td>
<td>
<p>Level of Significance used in the TukeyC algorithm to create
the groups of means. The default value is 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>round</code></td>
<td>
<p>Integer indicating the number of decimal places.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjusted.pvalue</code></td>
<td>
<p>Method for adjusting p values (see <code>p.adjust</code> to more details). The possible values are: <code>"holm"</code>, <code>"hochberg"</code>, <code>"hommel"</code>, <code>"bonferroni"</code>, <code>"BH"</code>, <code>"BY"</code>, <code>"fdr"</code> and <code>"none"</code>. The default is <code>"none"</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Potential further arguments (required by generic).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>TukeyC</code> returns an object of class <code>TukeyC</code> 
containing the groups of means plus other
necessary variables for summary and plot.
</p>
<p>The generic functions <code>summary</code> and <code>plot</code> are used to obtain and
print a summary and a plot of the results.
</p>
<p>The error arguments may be used whenever the user want a specific error other than the experimental error. At the split plot and split-split plot experiment, combination of error may be specified with "/" in the sequence of the <code>which</code> argument. For example, a object of <code>aovlist</code> class, a possible combination would be <code>error = 'Within/blk:plot'</code> at case block split plot experiment with <code>which = 'subplot:plot'</code> argument.
</p>


<h3>Value</h3>

<p>The function <code>TukeyC</code> returns a list of the class <code>TukeyC</code> with the slots:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Result</code></td>
<td>
<p>A <code>data.frame</code> storing the result of Tukey test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sig.level</code></td>
<td>
<p>A scalar giving the level of significance of the test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Diff_Prob</code></td>
<td>
<p>A <code>matrix</code> at the lower diagonal with p-values and upper diagonal with means differences.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MSD</code></td>
<td>
<p>A <code>matrix</code> with minimum significance differences by Tukey methodology. If balanced data, then all values are equal.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jose Claudio Faria (<a href="mailto:joseclaudio.faria@gmail.com">joseclaudio.faria@gmail.com</a>)<br>
Enio Jelihovschi (<a href="mailto:eniojelihovs@gmail.com">eniojelihovs@gmail.com</a>)<br>
Ivan Bezerra Allaman (<a href="mailto:ivanalaman@gmail.com">ivanalaman@gmail.com</a>)
</p>


<h3>References</h3>

<p>Miller, R.G. (1981) <em>Simultaneous Statistical Inference</em>. Springer.
</p>
<p>Ramalho M.A.P, Ferreira D.F and Oliveira A.C. (2000) <em>Experimentacao em Genetica
e Melhoramento de Plantas</em>. Editora UFLA.
</p>
<p>Steel, R.G., Torrie, J.H and Dickey D.A. (1997) <em>Principles and procedures of statistics:
a biometrical approach</em>. Third Edition.
</p>
<p>Yandell, B.S. (1997) <em>Practical Data Analysis for Designed Experiments</em>. 
Chapman and Hall.
</p>


<h3>Examples</h3>

<pre><code class="language-R">##
## Examples:Randomized Complete Block Design (RCBD)
## More details: demo(package='TukeyC')
##

## The parameters can be: formula, aov, lm, aovlist and lmerMod

data(RCBD)

## From: formula
tk1 &lt;- with(RCBD,
            TukeyC(y ~ blk + tra,
                   data=dfm,
                   which='tra'))
summary(tk1)

## From: merMod
## This class is specific of the lme4 package.
## Not run: 
  if(require(lme4)){
    lmer1 &lt;- with(RCBD,
                  lmer(y ~ (1|blk) + tra,
                       data=dfm))

    tk2 &lt;-  TukeyC(lmer1,
                   which='tra')
    summary(tk2)
  }

## End(Not run)
##
## Example: Latin Squares Design (LSD)
## More details: demo(package='TukeyC')
##

data(LSD)

## From: formula
tk3 &lt;- with(LSD,
            TukeyC(y ~ rows + cols + tra,
                   data=dfm,
                   which='tra'))
summary(tk3)

## From: aov
av1 &lt;- with(LSD,
            aov(y ~ rows + cols + tra,
                data=dfm))

tk4 &lt;- TukeyC(av1,
              which='tra')
summary(tk4)

## From: lm
lm1 &lt;- with(LSD,
            lm(y ~ rows + cols + tra,
               data=dfm))

tk5 &lt;- TukeyC(lm1,
              which='tra')
summary(tk5)

##
## Example: Factorial Experiment (FE)
## More details: demo(package='TukeyC')
##

data(FE)
## From: formula
## Main factor: N
tk6 &lt;- with(FE,
            TukeyC(y ~ blk + N*P*K,
                   data=dfm,
                   which='N'))
summary(tk6)

## Nested: p1/N
# From: formula
n_tk1 &lt;- with(FE,
              TukeyC(y ~ blk + N*P*K,
                     data=dfm,
                     which='P:N',
                     fl1=1))
summary(n_tk1) 

## Nested: p2/N
# From: lm
lm2 &lt;- with(FE,
            lm(y ~ blk + N*P*K, 
               dfm))

n_tk2 &lt;- with(FE,
              TukeyC(lm2,
                     which='P:N',
                     fl1=2))
summary(n_tk2) 

## Nested: n1/P
# From: aov
av2 &lt;- with(FE,
            aov(y ~ blk + N*P*K,
                dfm))

n_tk3 &lt;- with(FE,
              TukeyC(av2,
                     which='N:P',
                     fl1=1))
summary(n_tk3) 

# From: merMod
## Not run: 
  if(require(lme4)){
    lmer2 &lt;- with(FE,
                  lmer(y ~ (1|blk) + N*P*K,
                       dfm))

    n_tk4 &lt;- with(FE,
                  TukeyC(lmer2,
                         which='N:P',
                         fl1=1))
    summary(n_tk4)
  }

## End(Not run)

##
## Example: Split-plot Experiment (SPET)
## More details: demo(package='TukeyC')
##
data(SPET)

## From lm
lm3 &lt;- with(SPET,
            lm(y ~ blk*tra + tra*year,
               dfm))

# crotgrantiana/year
sp_tk1 &lt;- TukeyC(lm3,
                 which='tra:year',
                 fl1=1)
summary(sp_tk1) 

# year1/tra
# It is necessary to set year error with trat error in the order of the "which" argument.
# It is necessary to inform how to combinate the errors
sp_tk2 &lt;-  TukeyC(lm3,
                  which='year:tra',
                  error='Residuals/blk:tra',
                  fl1=1)
summary(sp_tk2)

# From merMod
# Onty tra
## Not run: 
  if(require(lme4)){
    lmer3 &lt;- with(SPET,
                  lmer(y ~ blk + (1|blk:tra) + tra*year,
                       dfm))

    # comparison only tra
    sp_tk3 &lt;- TukeyC(lmer3,
                     which = 'tra',
                     error = 'blk:tra')
    summary(sp_tk3)

    # year1/tra
    sp_tk4 &lt;- TukeyC(lmer3,
                     which='year:tra',
                     error='Residual/blk:tra',
                     fl1=1)
    summary(sp_tk4)
  }

## End(Not run)

## Example: Split-split-plot Experiment (SSPE)
## More details: demo(package='TukeyC')
##

data(SSPE)
## From: formula
## Main factor: P
## It is necessary to inform the appropriate error for the test
ssp_tk1 &lt;- with(SSPE,
                TukeyC(y ~ blk + P*SP*SSP + Error(blk/P/SP),
                       data=dfm,
                       which='P',
                       error='blk:P'))
summary(ssp_tk1)

## Main factor: SP
## It is necessary to inform the appropriate error for the test
ssp_tk2 &lt;- with(SSPE,
                TukeyC(y ~ blk + P*SP*SSP + Error(blk/P/SP),
                       data=dfm,
                       which='SP',
                       error='blk:P:SP'))
summary(ssp_tk2)

## Main factor: SSP
ssp_tk3 &lt;- with(SSPE,
                TukeyC(y ~ blk + P*SP*SSP + Error(blk/P/SP),
                       data=dfm,
                       which='SSP'))
summary(ssp_tk3)

## From: aov
## Main factor: SSP
av3 &lt;- with(SSPE,
            aov(y ~ blk + P*SP*SSP + Error(blk/P/SP),
                data=dfm))

ssp_tk4 &lt;- TukeyC(av3,
                  which='SSP')
summary(ssp_tk4)

## Nested: p1/SP
## It is necessary to inform the appropriate error for the test
ssp_tk5 &lt;- TukeyC(av3,
                  which='P:SP',
                  error='blk:P:SP',
                  fl1=1)
summary(ssp_tk5)

## Nested: p1/SSP
ssp_tk6 &lt;- TukeyC(av3,
                  which='P:SSP',
                  fl1=1)
summary(ssp_tk6)

## Nested: p1/sp1/SSP
## Testing SSP inside of level one of P and level one of SP
ssp_tk7 &lt;- TukeyC(av3,
                  which='P:SP:SSP',
                  fl1=1,
                  fl2=1)
summary(ssp_tk7)

## Nested: p2/sp1/SSP
ssp_tk8 &lt;- TukeyC(av3,
                  which='P:SP:SSP',
                  fl1=2,
                  fl2=1)
summary(ssp_tk8)

## Nested: sp1/P
## It is necessary to inform the appropriate error for the test
ssp_tk9 &lt;- TukeyC(av3,
                  which='SP:P',
                  error='blk:P:SP/blk:P',
                  fl1=1)

summary(ssp_tk9)

## Nested: ssp1/SP
ssp_tk10 &lt;- TukeyC(av3,
                   which='SSP:SP',
                   error='Within/blk:P:SP',
                   fl1=1)
summary(ssp_tk10)

## Nested: ssp1/sp1/P
## It is necessary to inform the appropriate error for the test
ssp_tk11 &lt;- TukeyC(av3,
                   which='SSP:SP:P',
                   error='Within/blk:P:SP/blk:P',
                   fl1=1,
                   fl2=1)
summary(ssp_tk11)

## UNBALANCED DATA
## The average are adjusted by "Least-Square-Means" methodology.
## From: formula
data(CRD2)

uCRD2 &lt;- CRD2$dfm
uCRD2[c(3, 5, 10, 44, 45), 3] &lt;- NA

utk1 &lt;-  TukeyC(y ~ x,
                data=uCRD2,
                which='x')
summary(utk1)

## From: lm
ulm1 &lt;- lm(y ~ x,
           data=uCRD2)

utk2 &lt;- TukeyC(ulm1,
               which='x')
summary(utk2)


## Factorial Experiments
## Nested: p1/N
# From: lm

uFE &lt;- FE$dfm
uFE[c(3, 6, 7, 20, 31, 32), 5] &lt;- NA

ulm2 &lt;- lm(y ~ blk + N*P*K,
           uFE)

## Nested: p1/N
utk3 &lt;- TukeyC(ulm2,
               data=uFE,
               which='P:N',
               fl1=1)
summary(utk3) 

## Nested: p2/n2/K
utk4 &lt;- TukeyC(ulm2,
               data=uFE,
               which='P:N:K',
               fl1=2,
               fl2=2)
summary(utk4) 
</code></pre>


</div>