<div class="container">

<table style="width: 100%;"><tr>
<td>median.multiPhylo</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Median of a set of trees</h2>

<h3>Description</h3>

<p>Calculate the single binary tree that represents the geometric median –
an "average" – of a forest of tree topologies.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'multiPhylo'
median(
  x,
  na.rm = FALSE,
  Distance = ClusteringInfoDistance,
  index = FALSE,
  breakTies = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Object of class <code>multiPhylo</code> containing phylogenetic trees.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm, ...</code></td>
<td>
<p>Unused; included for consistency with default function..</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Distance</code></td>
<td>
<p>Function to calculate distances between each pair
of trees in <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index</code></td>
<td>
<p>Logical: if <code>TRUE</code>, return the index of the median tree(s);
if <code>FALSE</code>, return the tree itself.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breakTies</code></td>
<td>
<p>Logical: if <code>TRUE</code>, return a single tree with the minimum
score; if <code>FALSE</code>, return all tied trees.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The geometric median is the tree that exhibits the shortest average distance
from each other tree topology in the set.
It represents an "average" of a set of trees, though note that an unsampled
tree may be closer to the geometric "centre of gravity" of the input set –
such a tree would not be considered.
</p>
<p>The result will depend on the metric chosen to calculate distances between
tree topologies. In the absence of a natural metric of tree topologies,
the default choice is <code>ClusteringInfoDistance()</code> – which discards
branch length information.
If specifying a different function, be sure that it returns a difference,
rather than a similarity.
</p>


<h3>Value</h3>

<p><code>median()</code> returns an object of class <code>phylo</code>
corresponding to the geometric median of a set of trees:
that is, the tree whose average distance from all other trees in the set
is lowest.
If multiple trees tie in their average distance, the first will be returned,
unless <code>breakTies = FALSE</code>, in which case an object of class <code>multiPhylo</code>
containing all such trees will be returned.
</p>


<h3>Author(s)</h3>

<p><a href="https://orcid.org/0000-0001-5660-1727">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>


<h3>See Also</h3>

<p>Consensus methods:
<code>ape::consensus()</code>,
<code>TreeTools::ConsensusWithout()</code>
</p>
<p>Other tree space functions: 
<code>Islands()</code>,
<code>MSTSegments()</code>,
<code>MapTrees()</code>,
<code>MappingQuality()</code>,
<code>SpectralEigens()</code>,
<code>cluster-statistics</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library("TreeTools", quietly = TRUE)
tenTrees &lt;- as.phylo(1:10, nTip = 8)

# Default settings:
median(tenTrees)

# Robinson-Foulds distances include ties:
median(tenTrees, Distance = RobinsonFoulds, breakTies = FALSE)

# Be sure to use a distance function, rather than a similarity:
NyeDistance &lt;- function(...) NyeSimilarity(..., similarity = FALSE)
median(tenTrees, Distance = NyeDistance)

# To analyse a list of trees that is not of class multiPhylo:
treeList &lt;- lapply(1:10, as.phylo, nTip = 8)
class(treeList)
median(structure(treeList, class = "multiPhylo"))
</code></pre>


</div>