<div class="container">

<table style="width: 100%;"><tr>
<td>TPidm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Transition probabilities for the illness-death model
</h2>

<h3>Description</h3>

<p>This function computes the transition probability matrix for the illness-death model, by using the Aalen-Johansen technique (suitable for Markov models) or alternatively a non-Markovian estimator. It creates a ‘TPidm’ object.
</p>


<h3>Usage</h3>

<pre><code class="language-R">TPidm(data, s, t = "last", cov = NULL, CI = TRUE, level = 0.95, 
ci.transformation = "linear", method = "NM")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>A data.frame including at least four columns named <code>time1</code>, <code>event1</code>, <code>Stime</code> and <code>event</code>, which correspond to disease free survival time, disease free survival indicator, time to death or censoring, and death indicator, respectively.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>

<p>The current time for the transition probabilities to be computed; <code>s=0</code> reports the occupation probabilities.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>

<p>The future time for the transition probabilities to be computed. Default is “last” which means the largest time among the uncensored entry times for the intermediate state and the final absorbing state.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov</code></td>
<td>

<p>A categorical variable for the optional by-group analysis; this variable must be a <code>factor</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI</code></td>
<td>

<p>If <code>TRUE</code> (default), confidence intervals are computed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>

<p>Level of confidence intervals. Default is <code>0.95</code> (corresponding to 95 %).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci.transformation</code></td>
<td>

<p>Transformation applied to compute confidence intervals. Possible choices are “linear”, “log”, “log-log” and “cloglog”. Default is “linear”.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>The method used to compute the transition probabilities. Possible options are “AJ” (Aalen-Johansen) or “NM” (non-Markovian). Default is “NM”.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If s = 0 this function TPidm reports the state occupation probabilities at time t. For s &gt; 0, the transition probabilities are provided. The default method “NM” computes the estimator proposed by de Uña-Álvarez and Meira-Machado (2015), which is consistent regardless the Markov assumption. To fit a Markovian transition probability matrix, use the “AJ” method. Note that the Aalen-Johansen occupation probabilities are consistent even when the process is non-Markov (Datta and Satten, 2001), but this is not true for the Aalen-Johansen transition probabilities (Meira-Machado et al., 2006). If <code>CI</code> is <code>TRUE</code> (default), TPidm calculates the estimated variance and the confidence intervals by using the plug-in variance described in Balboa and de Uña-Álvarez (2018) (method = “NM”), or the standard formulas for Markovian processes (method = “AJ”, see Andersen et al., 1993).
</p>


<h3>Value</h3>

<p>An object of class ‘TPidm’. It is a list containing the following objects:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>s </code></td>
<td>
<p>The user-supplied current time for the transition probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t </code></td>
<td>
<p>The user-supplied future time for the transition probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method </code></td>
<td>
<p>The method used to compute the transition probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>times </code></td>
<td>
<p>The uncensored entry times for the intermediate state and the final absorbing state which fall between s and t.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probs </code></td>
<td>
<p>A matrix with transition probability estimates <code class="reqn">P_{ij}</code>(s,t) for the user-supplied (s, t) and each possible transition from state i (rows) to state j (columns). If <code>CI</code> is <code>TRUE</code> (default), it includes confidence limits and variances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>all.probs </code></td>
<td>
<p>An array with transition probability estimates <code class="reqn">P_{ij}</code>(s, <code class="reqn">t_{k}</code>) for each possible transition, evaluated at all the event times <code class="reqn">t_{k}</code> falling between s and t. If <code>CI</code> is <code>TRUE</code> (default), it includes confidence limits and variances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.trans </code></td>
<td>
<p>Possible transitions among the states. If s = 0, possible transitions are “1 1”, “1 2” and “1 3”; if s &gt; 0 possible transitions are “1 1”, “1 2”, “1 3”, “2 2” and “2 3”.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI </code></td>
<td>
<p>A logical value chosen by the user.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci.transformation </code></td>
<td>
<p>Transformation chosen by the user to compute the confidence intervals.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>If <code>time1=Stime</code> and <code>event1=event=1</code>, the function <code>TPidm</code> assumes that a direct transition from the initial state to the final absorbing state has occurred. That is, zero sojourn times are not allowed for the intermediate state (replacing the zeros by a small positive amount is a way to introduce such cases).
</p>
<p>If <code>cov</code> is specified, the main function provides estimations of transition probabilities for each level of the covariate. 
</p>


<h3>References</h3>

<p>Andersen P. K., Borgan O., Gill R. D. and Keiding N. (1993). Statistical models based on counting processes. Springer Series in Statistics. New York, NY: Springer.
</p>
<p>Datta S. and Satten G. A. (2001). Validity of the Aalen-Johansen estimators of the stage occupation probabilities and Nelson-Aalen estimators of integrated transition hazards for non-Markov models. <em>Statistics and Probability Letters</em> <b>55(4)</b>, 403–411.
</p>
<p>de Uña-Álvarez J. and Meira-Machado L. (2015). Nonparametric estimation of transition probabilities in a non-Markov illness-death model: a comparative study. <em>Biometrics</em> <b>71</b>, 364–375.
</p>
<p>Meira-Machado L. F., de Uña-Álvarez J. and Cadarso-Suárez C. (2006). Nonparametric estimation of transition probabilities in a non-Markov illness-death model. <em>Lifetime Data Anal</em> <b>12(3)</b>, 325–344.
</p>
<p>Balboa-Barreiro V., de Uña-Álvarez J. (2018). Estimation of Transition Probabilities for the Illness-Death Model: Package <code>TP.idm</code>. <em>Journal of Statistical Software</em> <b>83(10)</b>, 1–19.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(colonTP)

# create a TPidm object with s = 0, t = "last" (default),
# CI = TRUE (default) and method = "AJ":
aj0ci &lt;- TPidm(colonTP, s = 0, method = "AJ")
plot(aj0ci) # plotting all occupation probabilities

#or
# create a TPidm object with s = 365, t = "last" (default),
# CI = FALSE and method = "NM" (default):
nm365 &lt;- TPidm(colonTP, s = 365, CI=FALSE)
summary(nm365) # summarizing the results

# or
# create a TPidm object with cov = "rx":
nm365cov &lt;- TPidm(colonTP, s = 365, t = 1095, cov = "rx", CI=FALSE)
summary(nm365cov) # summarizing the results
</code></pre>


</div>