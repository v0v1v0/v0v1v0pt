<div class="container">

<table style="width: 100%;"><tr>
<td>fittestWavelet</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Automatic prediction with wavelet transform</h2>

<h3>Description</h3>

<p>The function automatically applies a maximal overlap discrete wavelet
transform to a provided univariate time series. The resulting components of
the decomposed series are used as base for predicting and returning the next
n consecutive values of the provided univariate time series using also
automatically fitted models (<code>ets</code> or <code>arima</code>). It
also evaluates fitness and prediction accuracy of the produced models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fittestWavelet(
  timeseries,
  timeseries.test = NULL,
  h = 1,
  filters = c("haar", "d4", "la8", "bl14", "c6"),
  n.levels = NULL,
  maxlevel = NULL,
  boundary = "periodic",
  model = c("ets", "arima"),
  conf.level = 0.95,
  na.action = stats::na.omit,
  rank.by = c("MSE", "NMSE", "MAPE", "sMAPE", "MaxError", "AIC", "AICc", "BIC",
    "logLik", "errors", "fitness"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>timeseries</code></td>
<td>
<p>A vector or univariate time series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timeseries.test</code></td>
<td>
<p>A vector or univariate time series containing a
continuation for <code>timeseries</code> with actual values. It is used as a
testing set and base for calculation of prediction error measures. Ignored
if <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>Number of consecutive values of the time series to be predicted. If
<code>h</code> is <code>NULL</code>, the number of consecutive values to be predicted is
assumed to be equal to the length of <code>timeseries.test</code>. Required when
<code>timeseries.test</code> is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filters</code></td>
<td>
<p>A vector containing character strings indicating which
wavelet filter to use in the decomposition. If <code>length(filters)&gt;1</code>, the
wavelet transform filter used for generating the return of the function is
automatically selected. If <code>NULL</code>, all supported filters are considered
for automatic selection. See 'Details'. For more details on all the
supported filters and corresponding character strings see
<code>wt.filter</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.levels</code></td>
<td>
<p>An integer specifying the level of the decomposition. If
<code>NULL</code>, the level of the wavelet decomposition returned by the function
is automatically selected within the interval <code>1:maxlevel</code>. See
'Details'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxlevel</code></td>
<td>
<p>A numeric integer value corresponding to the maximal level
of candidate wavelet decompositions to be produced and evaluated. If
<code>NULL</code>, <code>maxlevel</code> is set as
<code>floor(log(((nobs-1)/(L-1))+1)/log(2))</code>, where
<code>nobs=length(timeseries)</code> and <code>L</code> is the length of the wavelet and
scaling filters. See <code>modwt</code> and
<code>wt.filter</code>. Ignored if <code>n.levels</code> is provided.
See 'Details'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boundary</code></td>
<td>
<p>Character string. Indicates which boundary method to use.
See <code>modwt</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Character string. Indicates which model is to be used for
fitting and prediction of the components of the decomposed series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>Confidence level for prediction intervals. See the
<code>forecast</code> function of the <code>forecast</code> package. 
~~Describe <code>na.action</code> here~~</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>A function for treating missing values in <code>timeseries</code>
and <code>timeseries.test</code>. The default function is <code>na.omit</code>,
which omits any missing values found in <code>timeseries</code> or
<code>timeseries.test</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rank.by</code></td>
<td>
<p>Character string. Criteria used for ranking candidate
decompositions/models/predictions generated during parameter selection. See
'Details'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to the modeling functions. 
~~Describe <code>na.action</code> here~~</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function produces a maximal overlap discrete wavelet transform of
<code>timeseries</code>. It performs a time series decomposition of level
<code>n.levels</code> using the wavelet filter <code>filters</code>. See the
<code>modwt</code> function. Each component series resulting from
the decomposition (<code>n.levels</code> wavelet coefficients series and
<code>n.levels</code> scaling coefficients series) is separately used as base for
model fitting and prediction. If <code>model="arima"</code>, arima models are used
and automatically fitted using the <code>auto.arima</code>
function. If <code>model="ets"</code>, the function fits
<code>[forecast]ets</code> models. The set of predictions for all component
series are then reversed transformed in order to produce the next <code>h</code>
consecutive values of the provided univariate time series in
<code>timeseries</code>. See the <code>imodwt</code> function.
</p>
<p>If <code>length(filters)&gt;1</code> or <code>filters=NULL</code>, it is automatically
selected. For that, a set of candidate wavelet decompositions with different
options of filters is generated and used for model fitting and prediction.
Also, if <code>n.levels</code> is <code>NULL</code>, it is automatically set as a value
within the interval <code>1:maxlevel</code> (if <code>maxlevel</code> is not provided,
it is calculated according to the wavelet filter based on code from
<code>modwt</code>). For that, candidate decompositions are
specified with different levels. The options of filter and/or level of
decomposition which generate the best ranked model fitness/predictions
acoording to the criteria in <code>rank.by</code> are selected.
</p>
<p>The ranking criteria in <code>rank.by</code> may be set as a prediction error
measure (such as <code>MSE</code>, <code>NMSE</code>, <code>MAPE</code>,
<code>sMAPE</code> or <code>MAXError</code>), or as a fitness criteria
(such as <code>AIC</code>, <code>AICc</code>, <code>BIC</code> or
<code>logLik</code>). In the former case, the candidate wavelet
decompositions are used for time series prediction and the error measures
are calculated by means of a cross-validation process. In the latter case,
the component series of the candidate decompositions are modeled and model
fitness criteria are calculated based on all observations in
<code>timeseries</code>. In particular, the fitness criteria calculated for
ranking the candidate decomposition correspond to the model produced for the
<code>n.levels</code>th scaling coefficients series as it can be considered the
main component of a decomposition of level <code>n.levels</code> (Conejo,2005).
</p>
<p>If <code>rank.by</code> is set as <code>"errors"</code> or <code>"fitness"</code>, the
candidate decompositions are ranked by all the mentioned prediction error
measures or fitness criteria, respectively. The wheight of the ranking
criteria is equally distributed. In this case, a <code>rank.position.sum</code>
criterion is produced for ranking the candidate decompositions. The
<code>rank.position.sum</code> criterion is calculated as the sum of the rank
positions of a decomposition (1 = 1st position = better ranked model, 2 =
2nd position, etc.) on each calculated ranking criteria.
</p>


<h3>Value</h3>

<p>A list with components: </p>
<table>
<tr style="vertical-align: top;">
<td><code>WT</code></td>
<td>
<p>An object of class
<code>modwt</code> containing the wavelet transformed/decomposed
time series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>The level of wavelet decomposition provided or
automatically selected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filter</code></td>
<td>
<p>A character string indicating the
(provided or automatically selected) wavelet filter used in the
decomposition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AICc</code></td>
<td>
<p>Numeric value of the computed AICc criterion of
the fitted model for the <code>level</code>th scaling coefficients series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AIC</code></td>
<td>
<p>Numeric value of the computed AIC criterion of the fitted model
for the <code>level</code>th scaling coefficients series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BIC</code></td>
<td>
<p>Numeric
value of the computed BIC criterion of the fitted model for the
<code>level</code>th scaling coefficients series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logLik</code></td>
<td>
<p>Numeric value of
the computed log-likelihood of the fitted model for the <code>level</code>th
scaling coefficients series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred</code></td>
<td>
<p>A list with the components
<code>mean</code>, <code>lower</code> and <code>upper</code>, containing the predictions based
on the best evaluated decomposition and the lower and upper limits for
prediction intervals, respectively. All components are time series. See the
<code>forecast</code> function in the <code>forecast</code> package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MSE</code></td>
<td>
<p>Numeric value of the resulting MSE error of prediction. Require
<code>timeseries.test</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NMSE</code></td>
<td>
<p>Numeric value of the resulting NMSE
error of prediction. Require <code>timeseries.test</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MAPE</code></td>
<td>
<p>Numeric
value of the resulting MAPE error of prediction. Require
<code>timeseries.test</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sMAPE</code></td>
<td>
<p>Numeric value of the resulting sMAPE
error of prediction. Require <code>timeseries.test</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MaxError</code></td>
<td>
<p>Numeric value of the maximal error of prediction. Require
<code>timeseries.test</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rank.val</code></td>
<td>
<p>Data.frame with the fitness or
prediction accuracy criteria computed based on all candidate decompositions
ranked by <code>rank.by</code>. It has the attribute <code>"ranked.wt"</code>, which is
a list of <code>modwt</code> objects containing all the candidate
decompositions, also ranked by <code>rank.by</code>. Only provided if
<code>filters</code> or <code>n.levels</code> were automatically selected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rank.by</code></td>
<td>
<p>Ranking criteria used for ranking candidate decompositions
and producing <code>rank.val</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Rebecca Pontes Salles
</p>


<h3>References</h3>

<p>A. J. Conejo, M. A. Plazas, R. Espinola, A. B. Molina, Day-ahead
electricity price forecasting using the wavelet transform and ARIMA models,
IEEE Transactions on Power Systems 20 (2005) 1035-1042.
</p>
<p>T. Joo, S. Kim, Time series forecasting based on wavelet filtering, Expert
Systems with Applications 42 (2015) 3868-3874.
</p>
<p>C. Stolojescu, I. Railean, S. M. P. Lenca, A. Isar, A wavelet based
prediction method for time series. In Proceedings of the 2010 International
Conference Stochastic Modeling Techniques and Data Analysis, Chania, Greece
(pp. 8-11) (2010). 
</p>


<h3>See Also</h3>

<p><code>fittestEMD</code>, <code>fittestMAS</code> ~
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(CATS)

fW &lt;- fittestWavelet(CATS[,1],h=20,model="arima")

#plot wavelet transform/decomposition
plot(fW$WT)


</code></pre>


</div>