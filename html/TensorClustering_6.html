<div class="container">

<table style="width: 100%;"><tr>
<td>tune_u_joint</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Tuning envelope dimension jointly by BIC in TEMM.</h2>

<h3>Description</h3>

<p>Tuning envelope dimension jointly by BIC in TEMM.</p>


<h3>Usage</h3>

<pre><code class="language-R">tune_u_joint(u_candi, K, X, iter.max = 500, stop = 0.001, trueY = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>u_candi</code></td>
<td>
<p>A list of length <code>M</code> containing candidate envelope dimension for each mode.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>Number of clusters, greater than or equal to <code>2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>The tensor for clustering, should be array type, the last dimension is the sample size <code>n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter.max</code></td>
<td>
<p>Maximum number of iterations. Default value is <code>500</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stop</code></td>
<td>
<p>Convergence threshold of relative change in cluster means. Default value is <code>1e-3</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trueY</code></td>
<td>
<p>A vector of true cluster labels of each observation. Default value is NULL.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>tune_u_joint</code> function searches over all the combinations of <code class="reqn">u\equiv(u_1,\dots,u_M)</code> in the neighborhood of <code class="reqn">\widetilde{u}</code>, <code class="reqn">\mathcal{N}(\widetilde u)=\{u:\ \max(1,\widetilde u_m-2) \leq u_m \leq \min(\widetilde u_m+2,p_m),\ m=1,\dots,M\}</code>, that minimizes	
</p>
<p style="text-align: center;"><code class="reqn">\mathrm{BIC}(u) = -2\sum_{i=1}^{n}\log(\sum_{k=1}^{K}\widehat{\pi}_k^u f_k(\mathbf{X}_i;\widehat{\bm{\theta}}^u)) + \log(n)\cdot K_u.</code>
</p>

<p>In the above BIC, <code class="reqn">K_u=(K-1)\prod_{m=1}^M u_m + \sum_{m=1}^{M}p_m(p_m+1)/2</code> is the total number of parameters in TEMM, <code class="reqn">\widehat{\pi}_k^u</code> and <code class="reqn">\widehat{\bm{\theta}}^{u}</code> are the estimated parameters with envelope dimension fixed at <code class="reqn">u</code>. The <code>tune_u_joint</code> function intrinsically selects the initial point and return the optimal estimated labels.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>opt.u</code></td>
<td>
<p>Optimal envelope dimension selected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opt.id</code></td>
<td>
<p>Estimated labels fitted by TEMM with the optimal envelope dimension.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opt.Mu</code></td>
<td>
<p>Estimated cluster means fitted by TEMM with the optimal envelope dimension.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bic</code></td>
<td>
<p>BIC value.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Kai Deng, Yuqing Pan, Xin Zhang and Qing Mai</p>


<h3>References</h3>

<p>Deng, K. and Zhang, X. (2021). Tensor Envelope Mixture Model for Simultaneous Clustering and Multiway Dimension Reduction. <em>Biometrics</em>.
</p>


<h3>See Also</h3>

<p><code>TEMM</code>, <code>tune_u_sep</code></p>


<h3>Examples</h3>

<pre><code class="language-R">  A = array(c(rep(1,20),rep(2,20))+rnorm(40),dim=c(2,2,10))
  mytune = tune_u_joint(u_candi=list(1:2,1:2),K=2,A)
</code></pre>


</div>