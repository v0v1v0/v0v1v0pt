<div class="container">

<table style="width: 100%;"><tr>
<td>temp.cont</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>TempCont: Temporal contributions on trends using mixed models</h2>

<h3>Description</h3>

<p>When using temporal data, linear models provide parameter estimates that help to understand how, for instance, interannual variability in a response variable is affected by a predictor. However, if the response variable and the predictors present trends, things get a bit more tricky. This methodology is aimed at estimating the effect of the trend in the predictors on the observed trend of the response variable. To do so, our package first calculates the observed trend of the response (slope estimate ± standard error of the slope) in the data data using GLMMs with random slopes and temporal autocorrelation structure (ARMA, p = 1, q = 0). Then it calculates the trend predicted by the model provided by the user and the trend predicted by the same model but maintaining the predictor of interest constant (i.e., using the median values per grouping level, while all other predictors change according to the observations). The difference between the temporal predictions for the whole model and the temporal predictions of the model when one variable is controlled is the average temporal contribution of that predictor to the trend in the response variable. The difference between all individual temporal contributions and the observed trend (should be calculated separately) should considered to be unknown contributions. Finally, the package also calculates the average sensitivities of the response variable to predictor changes by dividing the temporal contributions by the trends of the predictor variables. All errors are calculated using the error-propagation method. See Fernández-Martínez et al., 2017 and 2019 for further information on the methodology.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  temp.cont(model, driver, random, timevar="year", plot=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Fitted "lme" model. I must be a mixed model with gaussian distribution, and it is advisable to control for temporal autocorrelation at lag 1 (e.g., corCAR1())</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>driver</code></td>
<td>
<p>Driver of interest. It must be a continous variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random</code></td>
<td>
<p>Grouping factor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>if <code>TRUE</code>, plot the data and the predictions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timevar</code></td>
<td>
<p>name of the time variable.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A data.frame with the following variables for each driver variable. Row names correspon to the the name of the variable.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>mod.slope</code></td>
<td>
<p>Trend of the response variable predicted by the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mod.slope.se</code></td>
<td>
<p>Standard error of mod.slope.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mod.slope.t</code></td>
<td>
<p>t-value of mod.slope</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mod.slope.p</code></td>
<td>
<p>P-value of mod.slope</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>temp.contr</code></td>
<td>
<p>Temporal contribution of the predictor</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>temp.contr.se</code></td>
<td>
<p>Standard error of temp.contr</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>temp.contr.t</code></td>
<td>
<p>t-value of temp.contr</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>temp.contr.p</code></td>
<td>
<p>P-value of temp.contr</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred.trend</code></td>
<td>
<p>Trend of the predictor</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred.trend.se</code></td>
<td>
<p>Standard error of pred.trend</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred.trend.t</code></td>
<td>
<p>t-value of pred.trend</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred.trend.p</code></td>
<td>
<p>P-value of pred.trend</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sensit</code></td>
<td>
<p>Trend sensitivity of the response variable to the predictor</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sensit.se</code></td>
<td>
<p>Standard error of sensit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sensit.t</code></td>
<td>
<p>t-value of sensit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sensit.p</code></td>
<td>
<p>P-value of sensit</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Marcos Fernández-Martínez, Joan Maspons</p>


<h3>References</h3>

<p>Fernández-Martínez et al., 2017. "Atmospheric deposition, CO2, and change in the land carbon sink".  Scientific Reports <b>7</b>:9632.
</p>
<p>Fernández-Martínez et al., 2019. "Global trends in carbon sinks and their relationships with CO2 and temperature".  Nature Climate Change <b>9</b>:73–79.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  library (nlme)
  data(tempcont_data)
  mod &lt;- lme(trolls ~ bushes + temperature  + rainfall + drought + gremlins +
              orcs + warlocks, data=tempcont_data, random=~1|cave,
              correlation=corCAR1(form=~year|cave), method="ML")
  summary(mod)

  temp.cont(model = mod, driver="temperature", random="cave")

  # Warning: long runtime (&gt; 20 seconds)
  temp.cont(model = mod, random="cave")
</code></pre>


</div>