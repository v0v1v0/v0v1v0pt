<div class="container">

<table style="width: 100%;"><tr>
<td>select_Millar</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Millar's selectivity model</h2>

<h3>Description</h3>

<p>This model estimates the selecitvity of different gears from experimental
catches.
</p>


<h3>Usage</h3>

<pre><code class="language-R">select_Millar(
  param,
  x0 = NULL,
  rtype = "norm.loc",
  rel.power = NULL,
  plot = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>A list with following parameters: vector with midlengths of size classes
(<code>midLengths</code>), vector with meshSizes in increasing order (<code>meshSizes</code>),
and a matrix with the number of individuals caught with each sized mesh
(<code>CatchPerNet_mat</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x0</code></td>
<td>
<p>A string of initial values for the parameters to be optimized over when applying the
function <code>optim</code>. When rtype = "norm.loc", "norm.sca", or "lognorm", initial values
may be ommitted (<code>x0 = NULL</code>), and starting vallues will be estimated using the earlier approach of
Millar and Holst (1997).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rtype</code></td>
<td>
<p>A character string indicating which method for estimating selection curves
should be used:
<code>"norm.loc"</code> for a normal curve with common spread,
<code>"norm.sca"</code> for a normal curve with variable spread,
<code>"lognorm"</code> for a lognormal curve,
<code>"binorm.sca"</code> for a bi-normal curve,
<code>"bilognorm"</code> for a bi-lognormal curve,
<code>"tt.logistic"</code> for a control and logistic curve</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rel.power</code></td>
<td>
<p>A string indicating the relative power of different meshSizes,
must have same length as <code>meshSizes</code> (Default: <code>rel.power = NULL</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical; should a plot be printed?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Model adapted from the selectivity functions provided by Prof. Dr. Russell Millar
(https://www.stat.auckland.ac.nz/~millar/). In the deviance plot open circles correspond to negative,
closed to positive residuals. The size of the circles is proportional to the square of the residuals.
To assess the model fit by the deviance plot it requires some experience, in general the pattern should
be random and the sizes not too big. Please refer to Millar's publications and other publications for
comparison. The model can produce errors if the starting values (<code>x0</code>) for the optim
function are not realistic. Please be aware that if the method is changed the outcoming parameters
can greatly vary. Simliarly the starting values have to be adapted when changing the method (<code>rtype</code>).
</p>


<h3>Source</h3>

<p>https://www.stat.auckland.ac.nz/~millar/selectware/
</p>


<h3>References</h3>

<p>Millar, R. B., Holst, R., 1997. Estimation of gillnet and hook selectivity
using log-linear models. <em>ICES Journal of Marine Science: Journal du Conseil</em>,
54(3):471-477
</p>
<p>Holt, S. J. 1963. A method for determining gear selectivity and its application.
<em>ICNAF Special Publication</em>, 5: 106-115.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(haddock)

output &lt;- select_Millar(haddock, x0 = c(-10,0.3,0),
   rtype = "tt.logistic")

plot(output, plotlens=seq(25,35,0.1), deviance_plot = FALSE)
legend("topleft",c("Control","Experimental"), lty=1:2, col=1:2)


# Gillnet
data(gillnet)

# Using inital estimates from old method
select_Millar(gillnet, x0 = NULL, rtype = "norm.loc")$value
select_Millar(gillnet, x0 = NULL, rtype = "norm.sca")$value
select_Millar(gillnet, x0 = NULL, rtype = "lognorm")$value

# Two rtypes which require starting values
select_Millar(gillnet, x0 = c(55,4,65,4,3), rtype="binorm.sca")
select_Millar(gillnet, x0 = c(4,0.2,4.2,0.1,2), rtype="bilognorm")

# Calculation with finer length resolution
output &lt;- select_Millar(gillnet, x0 = NULL, rtype = "lognorm")
plot(output, plotlens=seq(40,90,0.1))

# Use alternate plot settings
output &lt;- select_Millar(gillnet, x0 = NULL, rtype = "lognorm")
ncolor &lt;- length(output$meshSizes)
plot(output, plotlens=seq(40,90,0.1), deviance_plot = FALSE,
 lty=1, col=rainbow(ncolor))
legend("topleft", col=rainbow(ncolor), legend=output$meshSizes,
 lty=1, title="Mesh size [cm]")

 # deviance plot only
 plot(output, plotlens=seq(40,90,0.1), selectivity_plot = FALSE)


# Stacked trammel net
# The data come from two experiments using different mesh sizes
# This analysis assumes common retention curve in both experiments.
# Note that summary function does not produce residual plot
# since lengths are not unique
data(trammelnet)

output &lt;- select_Millar(trammelnet, x0 = c(25,4),
   rtype="norm.loc", rel.power = rep(1,6))

plot(output,plotlens=seq(10,40,0.1))

</code></pre>


</div>