<div class="container">

<table style="width: 100%;"><tr>
<td>compute_breakpoints</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute Breakpoints Based on Sorting Variable</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt="[Experimental]"></a>
</p>
<p>This function computes breakpoints based on a specified sorting. It can
optionally filter the data by exchanges before computing the breakpoints.
The function requires either the number of portfolios to be created or
specific percentiles for the breakpoints, but not both. The function also
optionally handles cases where the sorting variable clusters on the edges,
by assigning all extreme values to the edges and attempting to compute
equally populated breakpoints with the remaining values.
</p>


<h3>Usage</h3>

<pre><code class="language-R">compute_breakpoints(
  data,
  sorting_variable,
  breakpoint_options,
  data_options = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame containing the dataset for breakpoint computation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sorting_variable</code></td>
<td>
<p>A string specifying the column name in <code>data</code> to be
used for determining breakpoints.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breakpoint_options</code></td>
<td>
<p>A named list of breakpoint_options for the breakpoints. The
arguments include
</p>

<ul>
<li> <p><code>n_portfolios</code> An optional integer specifying the number of equally
sized portfolios to create. This parameter is mutually exclusive with
<code>percentiles</code>.
</p>
</li>
<li> <p><code>percentiles</code> An optional numeric vector specifying the percentiles for
determining the breakpoints of the portfolios. This parameter is mutually
exclusive with <code>n_portfolios</code>.
</p>
</li>
<li> <p><code>breakpoint_exchanges</code> An optional character vector specifying exchange
names to filter the data before computing breakpoints. Exchanges must be
stored in a column named <code>exchange</code> in <code>data</code>. If <code>NULL</code>, no filtering is
applied.
</p>
</li>
<li> <p><code>smooth_bunching</code> An optional logical parameter specifying if to
attempt smoothing non-extreme portfolios if the sorting variable bunches on
the extremes (TRUE, the default), or not (FALSE). In some cases, smoothing
will not result in equal-sized portfolios off the edges due to multiple
clusters. If sufficiently large bunching is detected, <code>percentiles</code> is
ignored and equally-spaced portfolios are returned for these cases with a
warning.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data_options</code></td>
<td>
<p>A named list of data_options with characters, indicating the column names
required to run this function. The required column names identify dates. Defaults to <code>exchange = exchange</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A vector of breakpoints of the desired length.
</p>


<h3>Note</h3>

<p>This function will stop and throw an error if both <code>n_portfolios</code> and
<code>percentiles</code> are provided or if neither is provided. Ensure that you only
use one of these parameters.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data &lt;- data.frame(
  id = 1:100,
  exchange = sample(c("NYSE", "NASDAQ"), 100, replace = TRUE),
  market_cap = 1:100
)

compute_breakpoints(data, "market_cap", breakpoint_options(n_portfolios = 5))
compute_breakpoints(
  data, "market_cap",
  breakpoint_options(percentiles = c(0.2, 0.4, 0.6, 0.8), breakpoint_exchanges = c("NYSE"))
 )

</code></pre>


</div>