<div class="container">

<table style="width: 100%;"><tr>
<td>TVAR.sim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulation of a multivariate Threshold Autoregressive model (TVAR)</h2>

<h3>Description</h3>

<p>Simulate a multivariate Threshold VAR (TVAR)
</p>


<h3>Usage</h3>

<pre><code class="language-R">TVAR.sim(
  B,
  Thresh,
  nthresh = 1,
  n = 200,
  lag = 1,
  include = c("const", "trend", "none", "both"),
  thDelay = 1,
  mTh = 1,
  starting = NULL,
  innov = rmnorm(n, varcov = varcov),
  varcov = diag(1, nrow(B)),
  show.parMat = FALSE,
  ...
)

TVAR.boot(
  TVARobject,
  innov,
  seed,
  boot.scheme = c("resample", "wild1", "wild2", "check"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>Matrix of coefficients to simulate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Thresh</code></td>
<td>
<p>The threshold value(s). Vector of length nthresh</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nthresh</code></td>
<td>
<p>number of threshold (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Number of observations to create when type="simul"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lag</code></td>
<td>
<p>Number of lags to include in each regime</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include</code></td>
<td>
<p>Type of deterministic regressors to include. NOT WORKING
PROPERLY CURRENTLY if not const</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thDelay</code></td>
<td>
<p>'time delay' for the threshold variable (as multiple of
embedding time delay d) PLEASE NOTE that the notation is currently different
to univariate models in tsDyn. The left side variable is taken at time t, and
not t+1 as in univariate cases.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mTh</code></td>
<td>
<p>combination of variables with same lag order for the transition
variable. Either a single value (indicating which variable to take) or a
combination</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>starting</code></td>
<td>
<p>Starting values (matrix of dimension lag x k). If not given,
set to zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>innov</code></td>
<td>
<p>Innovations used for simulation. Should be matrix of dim n x k.
By default multivariate normal. For the bootstrap case <code>TVAR.boot</code>, residuals are
resampled if argument is missing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varcov</code></td>
<td>
<p>Variance-covariance matrix for the innovations. By default
identity matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.parMat</code></td>
<td>
<p>Logical. Should the parameter matrix be shown? Useful to
understand how to give right input</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to the underlying (un-exported)
<code>TVAR.gen</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TVARobject</code></td>
<td>
<p>Object of class <code>TVAR</code> generated by function
<code>TVAR</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Optional. Seed for the random resampling function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot.scheme</code></td>
<td>
<p>The bootstrap scheme.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function offers the possibility to generate series following a TVAR.
</p>
<p>By giving a matrix of coefficients, on can only simulate a VAR (nthresh=0) or
TVAR (nthresh=1 or 2). One can have a specification with constant (default),
trend, both or none (see arg include). Order in parameters is include/lags
(VECM) and include/lags/include/lags for TVECM, hence, a matrix for a TVECM
with 3 regimes, a const and a 2 lags would have 2 lines and 2*(1+4) columns.
The innovations can be given by the user (a matrix of dim nxk, here n does
not include the starting values!), by default it uses a multivariate normal
distribution, with covariance matrix specified by varcov. The starting values
(of dim lags x k) can be given. The user should take care for their choice,
since it is not sure that the simulated values will cross the threshold even
once.
</p>
<p>The matrix ‘B’ has to be in the form: constant, trend, lags, then
repeated if many regimes. In case of uncertainty, using
<code>who.parMat=TRUE</code> will print the matrix as interpreted by the function,
helping the user to feed the right input.
</p>
<p>For the bootstrap, the function resamples data from a given TVAR model generated by
<code>TVAR</code>, returning the resampled data. 
A residual recursive bootstrap is used, where one uses either a simple
resampling, or the Wild bootstrap, either with a normal distribution (wild1) or
inverting the sign randomly (wild2)
</p>


<h3>Value</h3>

<p>A matrix with the simulated/bootstrapped series.
</p>


<h3>Author(s)</h3>

<p>Matthieu Stigler
</p>


<h3>See Also</h3>

<p><code>TVAR</code> to estimate the TVAR.  Similar <code>TVECM.sim</code> and <code>TVECM.boot</code> for <code>TVECM</code>, 
<code>VAR.sim</code> and <code>VAR.boot</code> for VAR models estimated with <code>lineVar</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">

## TVAR.sim: Simulation of a TVAR with 1 threshold
B &lt;- rbind(c(0.11928245, 1.00880447, -0.009974585, -0.089316, 0.95425564, 0.02592617),
        c(0.25283578, 0.09182279,  0.914763741, -0.0530613, 0.02248586, 0.94309347))
colnames(B) &lt;- paste(rep(c("Const", "Lag_1_var1", "Lag_1_var2"), 2), c("Low", "High"), sep="_")
sim &lt;- TVAR.sim(B=B,nthresh=1,n=500, mTh=1, Thresh=5, starting=matrix(c(5.2, 5.5), nrow=1))

#estimate the new serie
TVAR(sim, lag=1, dummyToBothRegimes=TRUE)






## TVAR.boot: Bootstrap a TVAR with two threshold (three regimes)
data(zeroyld)
serie &lt;- zeroyld
mod &lt;- TVAR(data=serie,lag=1, nthresh=1)
TVAR.boot(mod)
</code></pre>


</div>