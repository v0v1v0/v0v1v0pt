<div class="container">

<table style="width: 100%;"><tr>
<td>nn_multilabel_margin_loss</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multilabel margin loss</h2>

<h3>Description</h3>

<p>Creates a criterion that optimizes a multi-class multi-classification
hinge loss (margin-based loss) between input <code class="reqn">x</code> (a 2D mini-batch <code>Tensor</code>)
and output <code class="reqn">y</code> (which is a 2D <code>Tensor</code> of target class indices).
For each sample in the mini-batch:
</p>


<h3>Usage</h3>

<pre><code class="language-R">nn_multilabel_margin_loss(reduction = "mean")
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>reduction</code></td>
<td>
<p>(string, optional): Specifies the reduction to apply to the output:
<code>'none'</code> | <code>'mean'</code> | <code>'sum'</code>. <code>'none'</code>: no reduction will be applied,
<code>'mean'</code>: the sum of the output will be divided by the number of
elements in the output, <code>'sum'</code>: the output will be summed.</p>
</td>
</tr></table>
<h3>Details</h3>

<p style="text-align: center;"><code class="reqn">
  \mbox{loss}(x, y) = \sum_{ij}\frac{\max(0, 1 - (x[y[j]] - x[i]))}{\mbox{x.size}(0)}
</code>
</p>

<p>where <code class="reqn">x \in \left\{0, \; \cdots , \; \mbox{x.size}(0) - 1\right\}</code>, \
<code class="reqn">y \in \left\{0, \; \cdots , \; \mbox{y.size}(0) - 1\right\}</code>, \
<code class="reqn">0 \leq y[j] \leq \mbox{x.size}(0)-1</code>, \
and <code class="reqn">i \neq y[j]</code> for all <code class="reqn">i</code> and <code class="reqn">j</code>.
<code class="reqn">y</code> and <code class="reqn">x</code> must have the same size.
</p>
<p>The criterion only considers a contiguous block of non-negative targets that
starts at the front.
This allows for different samples to have variable amounts of target classes.
</p>


<h3>Shape</h3>


<ul>
<li>
<p> Input: <code class="reqn">(C)</code> or <code class="reqn">(N, C)</code> where <code>N</code> is the batch size and <code>C</code>
is the number of classes.
</p>
</li>
<li>
<p> Target: <code class="reqn">(C)</code> or <code class="reqn">(N, C)</code>, label targets padded by -1 ensuring same shape as the input.
</p>
</li>
<li>
<p> Output: scalar. If <code>reduction</code> is <code>'none'</code>, then <code class="reqn">(N)</code>.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">if (torch_is_installed()) {
loss &lt;- nn_multilabel_margin_loss()
x &lt;- torch_tensor(c(0.1, 0.2, 0.4, 0.8))$view(c(1, 4))
# for target y, only consider labels 4 and 1, not after label -1
y &lt;- torch_tensor(c(4, 1, -1, 2), dtype = torch_long())$view(c(1, 4))
loss(x, y)
}
</code></pre>


</div>