<div class="container">

<table style="width: 100%;"><tr>
<td>sts_forecast</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Construct predictive distribution over future observations</h2>

<h3>Description</h3>

<p>Given samples from the posterior over parameters, return the predictive
distribution over future observations for num_steps_forecast timesteps.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sts_forecast(
  observed_time_series,
  model,
  parameter_samples,
  num_steps_forecast
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>observed_time_series</code></td>
<td>
<p><code>float</code> <code>tensor</code> of shape
<code style="white-space: pre;">⁠concat([sample_shape, model.batch_shape, [num_timesteps, 1]])⁠</code> where
<code>sample_shape</code> corresponds to i.i.d. observations, and the trailing <code style="white-space: pre;">⁠[1]⁠</code>
dimension may (optionally) be omitted if <code>num_timesteps &gt; 1</code>. May
optionally be an instance of <code>sts_masked_time_series</code>, which includes
a mask <code>tensor</code> to specify timesteps with missing observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>An instance of <code>StructuralTimeSeries</code> representing a
time-series model. This represents a joint distribution over
time-series and their parameters with batch shape <code style="white-space: pre;">⁠[b1, ..., bN]⁠</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameter_samples</code></td>
<td>
<p><code>list</code> of <code>tensors</code> representing posterior samples
of model parameters, with shapes
<code style="white-space: pre;">⁠list(tf$concat(list(list(num_posterior_draws), param&lt;1&gt;$prior$batch_shape, param&lt;1&gt;$prior$event_shape), list(list(num_posterior_draws), param&lt;2&gt;$prior$batch_shape, param&lt;2&gt;$prior$event_shape), ... ) )⁠</code>
for all model parameters.
This may optionally also be a named list mapping parameter names to <code>tensor</code> values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_steps_forecast</code></td>
<td>
<p>scalar <code>integer</code> <code>tensor</code> number of steps to forecast</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>forecast_dist a <code>tfd_mixture_same_family</code> instance with event shape
<code>list(num_steps_forecast, 1)</code> and batch shape <code>tf$concat(list(sample_shape, model$batch_shape))</code>, with
<code>num_posterior_draws</code> mixture components.
</p>


<h3>See Also</h3>

<p>Other sts-functions: 
<code>sts_build_factored_surrogate_posterior()</code>,
<code>sts_build_factored_variational_loss()</code>,
<code>sts_decompose_by_component()</code>,
<code>sts_decompose_forecast_by_component()</code>,
<code>sts_fit_with_hmc()</code>,
<code>sts_one_step_predictive()</code>,
<code>sts_sample_uniform_initial_state()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
observed_time_series &lt;-
  rep(c(3.5, 4.1, 4.5, 3.9, 2.4, 2.1, 1.2), 5) +
  rep(c(1.1, 1.5, 2.4, 3.1, 4.0), each = 7) %&gt;%
  tensorflow::tf$convert_to_tensor(dtype = tensorflow::tf$float64)
day_of_week &lt;- observed_time_series %&gt;% sts_seasonal(num_seasons = 7)
local_linear_trend &lt;- observed_time_series %&gt;% sts_local_linear_trend()
model &lt;- observed_time_series %&gt;%
  sts_sum(components = list(day_of_week, local_linear_trend))
states_and_results &lt;- observed_time_series %&gt;%
  sts_fit_with_hmc(
    model,
    num_results = 10,
    num_warmup_steps = 5,
    num_variational_steps = 15)
samples &lt;- states_and_results[[1]]
preds &lt;- observed_time_series %&gt;%
  sts_forecast(model,
               parameter_samples = samples,
               num_steps_forecast = 50)
predictions &lt;- preds %&gt;% tfd_sample(10)


</code></pre>


</div>