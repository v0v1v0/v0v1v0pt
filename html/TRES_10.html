<div class="container">

<table style="width: 100%;"><tr>
<td>oneD_bic</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Envelope dimension selection based on 1D-BIC</h2>

<h3>Description</h3>

<p>This function selects envelope subspace dimension using 1D-BIC proposed by Zhang, X., &amp; Mai, Q. (2018). The constrained optimization in the 1D algorithm is based on the line search algorithm for optimization on manifold. The algorithm is developed by Wen and Yin (2013) and the Matlab version is in the Matlab package <span class="pkg">OptM</span>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">oneD_bic(M, U, n, C = 1, maxdim = 10, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>The <code class="reqn">p</code>-by-<code class="reqn">p</code> positive definite matrix <code class="reqn">M</code> in the envelope objective function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>U</code></td>
<td>
<p>The <code class="reqn">p</code>-by-<code class="reqn">p</code> positive semi-definite matrix <code class="reqn">U</code> in the envelope objective function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>The constant defined in 1D-BIC criterion, the default value is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxdim</code></td>
<td>
<p>The maximum dimension to consider, <code>maxdim</code> is smaller than <code class="reqn">p</code>, the default value is 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional user-defined arguments for the line search algorithm:
</p>

<ul>
<li> <p><code>maxiter</code>: The maximal number of iterations.
</p>
</li>
<li> <p><code>xtol</code>: The convergence tolerance for the relative changes of the consecutive iterates <code class="reqn">w</code>, e.g., <code class="reqn">||w^{(k)} - w^{(k-1)}||_F/\sqrt{p}</code>
</p>
</li>
<li> <p><code>gtol</code>: The convergence tolerance for the gradient of Lagrangian, e.g., <code class="reqn">||G^{(k)} - w^{(k)} (G^{(t)})^T w^{(t)}||_F</code>
</p>
</li>
<li> <p><code>ftol</code>: The convergence tolerance for relative changes of the consecutive objective function values <code class="reqn">F</code>, e.g., <code class="reqn">|F^{(k)} - F^{(k-1)}|/(1+|F^{(k-1)}|)</code>. Usually, <code>max{xtol, gtol} &gt; ftol</code>
</p>
</li>
</ul>
<p>The default values are: <code>maxiter=500; xtol=1e-08; gtol=1e-08; ftol=1e-12.</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The objective function <code class="reqn">F(w)</code> and its gradient <code class="reqn">G(w)</code> in line search algorithm are:
</p>
<p style="text-align: center;"><code class="reqn">F(w)=\log|w^T M_k w|+\log|w^T(M_k+U_k)^{-1}w|</code>
</p>

<p style="text-align: center;"><code class="reqn">G(w) = dF/dw = 2 (w^T M_k w)^{-1} M_k w + 2 (w^T (M_k + U_k)^{-1} w)^{-1}(M_k + U_k)^{-1} w</code>
</p>

<p>See Cook, R. D., &amp; Zhang, X. (2016) for more details of the 1D algorithm.
</p>
<p>The 1D-BIC criterion is defined as
</p>
<p style="text-align: center;"><code class="reqn">I(k) = \sum_{j=1}^k \phi_j(\hat{w}_j) + Ck\log(n)/n, \quad k = 0,1, \ldots, p,</code>
</p>

<p>where <code class="reqn">C &gt; 0</code> is a constant, <code class="reqn">\hat{w}</code> is the 1D solver, the function <code class="reqn">\phi_j</code> is the individual objective function solved by 1D algorithm, <code class="reqn">n</code> is the sample size. Then the selected dimension <code class="reqn">u</code> is the one yielding the smallest 1D-BIC <code class="reqn">I(k)</code>. See Zhang, X., &amp; Mai, Q. (2018) for more details.
</p>
<p>As suggested by Zhang, X., &amp; Mai, Q. (2018), the number <code class="reqn">C</code> should be set to its default value <code class="reqn">C = 1</code> when there is no additional model assumption or prior information. However, if additional model assumption or prior information are known, C should be set such that <code class="reqn">Ck</code> best matches the degree-of-freedom or total number of free parameters of the model or estimation procedure. For example, in TRR model where the predictor design matrix is of dimension <code class="reqn">p \times n</code>, <code class="reqn">C</code> should be set as <code class="reqn">p</code>. See Zhang, X., &amp; Mai, Q. (2018) for more details.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>bicval</code></td>
<td>
<p>The BIC values for different envelope dimensions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>The dimension selected which corresponds to the smallest BIC values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gamma</code></td>
<td>
<p>The estimation of envelope subspace basis.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Zhang, X. and Mai, Q., 2018. Model-free envelope dimension selection. Electronic Journal of Statistics, 12(2), pp.2193-2216.
</p>
<p>Wen, Z. and Yin, W., 2013. A feasible method for optimization with orthogonality constraints. Mathematical Programming, 142(1-2), pp.397-434.
</p>


<h3>See Also</h3>

<p><code>OptM1D, MenvU_sim</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">##simulate two matrices M and U with an envelope structure
data &lt;- MenvU_sim(p = 20, u = 5, wishart = TRUE, n = 200)
M &lt;- data$M
U &lt;- data$U
bic &lt;- oneD_bic(M, U, n = 200)
## visualization
plot(1:10, bic$bicval, type="o", xlab="Envelope Dimension", ylab="BIC values",
main="Envelope Dimension Selection")

</code></pre>


</div>