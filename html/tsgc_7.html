<div class="container">

<table style="width: 100%;"><tr>
<td>forecast_peak</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Returns forecast of number of periods until peak given
<code>KFAS::KFS</code> output.</h2>

<h3>Description</h3>

<p>Since Harvey and Kattuman (2021) show that </p>
<p style="text-align: center;"><code class="reqn">g_{y,t+\ell|T}
= \exp\{\delta_{T|T}+\ell \gamma_{T|T}\}+\gamma_{T|T},</code>
</p>
<p> we can compute the
<code class="reqn">\ell</code> for which <code class="reqn">g_{y,t}=0</code> and then will fall below zero. This
<code class="reqn">\ell</code> is given by
</p>
<p style="text-align: center;"><code class="reqn">\ell = \frac{\ln(-\gamma_{T|T})-\delta_{T|T}}{\gamma_{T|T}}.</code>
</p>
<p> This is
predicated on <code class="reqn">\gamma_{T|T}&lt;0</code>, else there is super-exponential growth
and no peak in sight. Of course, it only makes sense to investigate an
upcoming peak for <code class="reqn">g_{y,T|T}&gt;0</code> (when cases are growing). The estimates
of <code class="reqn">\delta_{T|T}</code> and <code class="reqn">\gamma_{T|T}</code> are extracted from the
<code>KFS</code> object passed to the function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">forecast_peak(kfs_out)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>kfs_out</code></td>
<td>
<p>The <code>KFAS::KFS</code> object for which the forecast peak is to
be calculated. This would be the <code>output</code> element of a model estimated
in the <code>SSModelDynamicGompertz</code> or <code>SSModelDynamic</code></p>
</td>
</tr></table>
<h3>Value</h3>

<p>Forecast of number of periods until peak.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(tsgc)
data(gauteng,package="tsgc")
idx.est &lt;- zoo::index(gauteng) &lt;= as.Date("2020-07-06")

res &lt;- SSModelDynamicGompertz$new(Y = gauteng[idx.est], q = 0.005)$estimate()

forecast_peak(res$output)

</code></pre>


</div>