<div class="container">

<table style="width: 100%;"><tr>
<td>soil_temperature_function</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Core Function for Calculating Soil Temperature</h2>

<h3>Description</h3>

<p>This function is called to calculate soil temperature as in Beckman et al. (1973). Parameters are passed as a list to facilitating solving the equations. This function is not intended to be called directly. The energy balance equations are from Porter et al. (1973) and Kingsolver (1979)
</p>


<h3>Usage</h3>

<pre><code class="language-R">soil_temperature_function(j, T_so, params)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>j</code></td>
<td>
<p><code>numeric</code> the number of the iteration of running the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T_so</code></td>
<td>
<p><code>numeric</code> the initial soil temperature profile in C.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>
<p><code>list</code> containing the following param, which are described or calculated in <code>soil_temperature</code>: <code>SSA, epsilon_so, k_so, c_so, dz, z_r, z0, S, T_a, u, rho_a, rho_so, c_a, TimeIn, dt, shade</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Soil temperature profile as a <code>list</code>.
</p>


<h3>Author(s)</h3>

<p>Joseph Grigg
</p>


<h3>References</h3>

<p>Beckman WA, Mitchell JW, Porter WP (1973).
“Thermal Model for Prediction of a Desert Iguana's Daily and Seasonal Behavior.”
<em>Journal of Heat Transfer</em>, <b>95</b>(2), 257-262.
doi: <a href="https://doi.org/10.1115/1.3450037">10.1115/1.3450037</a>.<br><br> Kingsolver JG (1979).
“Thermal and hydric aspects of environmental hetergeneity in the pitcher plant mosquito.”
<em>Ecological Monographs</em>, <b>49</b>, 357-376.<br><br> Porter WP, Mitchell JW, Bekman A, DeWitt CB (1973).
“Behavioral implications of mechanistic ecology: thermal and behavioral modeling of desert ectotherms and their microenvironments.”
<em>Oecologia</em>, <b>13</b>, 1-54.
</p>


<h3>See Also</h3>

<p>Other soil temperature functions: 
<code>soil_conductivity()</code>,
<code>soil_specific_heat()</code>,
<code>soil_temperature_equation()</code>,
<code>soil_temperature_integrand()</code>,
<code>soil_temperature()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  set.seed(123)
  temp_vector       &lt;- runif(96, min = -10, max = 10)
  wind_speed_vector &lt;- runif(96, min = 0, max = 0.4)
  time_vector       &lt;- rep(1:24, 4)
  solrad_vector     &lt;- rep(c(rep(0, 6), 
                             seq(10, 700, length.out = 6), 
                             seq(700, 10, length.out = 6), 
                             rep(0, 6)),
                           4)
  params            &lt;- list(SSA        = 0.7, 
                            epsilon_so = 0.98, 
                            k_so       = 0.293, 
                            c_so       = 800, 
                            dz         = 0.05, 
                            z_r        = 1.5, 
                            z0         = 0.02, 
                            S          = solrad_vector, 
                            T_a        = temp_vector, 
                            u          = wind_speed_vector, 
                            rho_a      = 1.177, 
                            rho_so     = 1620,
                            c_a        = 1006, 
                            TimeIn     = time_vector, 
                            dt         = 60 * 60, 
                            shade      = FALSE)

soil_temperature_function(j      = 1, 
                          T_so   = rep(20,13), 
                          params = params)



</code></pre>


</div>