<div class="container">

<table style="width: 100%;"><tr>
<td>downstream</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Retrieve the downstream taxa for a given taxon name or ID.</h2>

<h3>Description</h3>

<p>This function uses a while loop to continually collect children taxa down
to the taxonomic rank that you specify in the <code>downto</code> parameter. You
can get data from ITIS (itis), GBIF (gbif), NCBI (ncbi), WORMS (worms),
or BOLD (bold). There is no method exposed by these four
services for getting taxa at a specific taxonomic rank, so we do it
ourselves here.
</p>


<h3>Usage</h3>

<pre><code class="language-R">downstream(...)

## Default S3 method:
downstream(
  sci_id,
  db = NULL,
  downto = NULL,
  intermediate = FALSE,
  rows = NA,
  x = NULL,
  ...
)

## S3 method for class 'tsn'
downstream(sci_id, db = NULL, downto = NULL, intermediate = FALSE, ...)

## S3 method for class 'gbifid'
downstream(
  sci_id,
  db = NULL,
  downto = NULL,
  intermediate = FALSE,
  limit = 100,
  start = NULL,
  ...
)

## S3 method for class 'uid'
downstream(sci_id, db = NULL, downto = NULL, intermediate = FALSE, ...)

## S3 method for class 'wormsid'
downstream(sci_id, db = NULL, downto = NULL, intermediate = FALSE, ...)

## S3 method for class 'boldid'
downstream(sci_id, db = NULL, downto = NULL, intermediate = FALSE, ...)

## S3 method for class 'ids'
downstream(sci_id, db = NULL, downto = NULL, intermediate = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further args passed on to <code>itis_downstream()</code>,
<code>gbif_downstream()</code>, <code>ncbi_downstream()</code>,
<code>worms_downstream()</code>, or <code>bold_downstream()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sci_id</code></td>
<td>
<p>Vector of taxa names (character) or IDs (character or numeric)
to query.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>db</code></td>
<td>
<p>character; database to query. One or more of <code>itis</code>, <code>gbif</code>,
<code>ncbi</code>, <code>worms</code>, or <code>bold</code>. Note that each taxonomic  data source has
their own identifiers, so that if you provide the wrong <code>db</code> value for
the identifier
you could get a result, but it will likely be wrong (not what you were
expecting). If using ncbi, we recommend getting an API key; see
taxize-authentication</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>downto</code></td>
<td>
<p>What taxonomic rank to go down to. One of: 'superkingdom',
'kingdom', 'subkingdom','infrakingdom','phylum','division','subphylum',
'subdivision','infradivision', 'superclass','class','subclass','infraclass',
'superorder','order','suborder','infraorder','superfamily','family',
'subfamily','tribe','subtribe','genus','subgenus','section','subsection',
'species group','species','subspecies','variety','form','subvariety','race',
'stirp', 'morph','aberration','subform', 'unspecified', 'no rank'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intermediate</code></td>
<td>
<p>(logical) If <code>TRUE</code>, return a list of length two
with target taxon rank names, with additional list of data.frame's of
intermediate taxonomic groups. Default: <code>FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rows</code></td>
<td>
<p>(numeric) Any number from 1 to infinity. If the default NA, all
rows are considered. Note that this parameter is ignored if you pass in a
taxonomic id of any of the acceptable classes: tsn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Deprecated, see <code>sci_id</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>limit</code></td>
<td>
<p>Number of records to return. Applies to gbif only.
default: 100. max: 1000. use in combination with the <code>start</code> parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>Record number to start at. Applies to gbif only. default: 0.
use in combination with the <code>limit</code> parameter</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A named list of data.frames with the downstream names of every
supplied taxa. You get an NA if there was no match in the database.
</p>


<h3>Authentication</h3>

<p>See taxize-authentication for help on authentication
</p>


<h3>bold</h3>

<p>BEWARE: <code>db="bold"</code> scrapes the BOLD website, so may be unstable. That is,
one day it may work, and the next it may fail. Open an issue if you
encounter an error: https://github.com/ropensci/taxize/issues
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Plug in taxon IDs
downstream(125732, db = 'worms', downto = 'species')
downstream(3451, db = 'bold', downto = 'species')

if (interactive()) {

# Plug in taxon names
downstream("Apis", db = 'ncbi', downto = 'species')
downstream("Apis", db = 'itis', downto = 'species')
downstream("Apis", db = 'bold', downto = 'species')
downstream("Gadus", db = 'worms', downto = 'species')
downstream(c("Apis","Epeoloides"), db = 'itis', downto = 'species')
downstream("Ursus", db = 'gbif', downto = 'species')
downstream(get_gbifid("Ursus"), db = 'gbif', downto = 'species')

# Many taxa
sp &lt;- names_list("genus", 3)
downstream(sp, db = 'itis', downto = 'species')
downstream(sp, db = 'gbif', downto = 'species')

# Both data sources
ids &lt;- get_ids("Apis", db = c('gbif','itis'))
downstream(ids, downto = 'species')
## same result
downstream(get_ids("Apis", db = c('gbif','itis')), downto = 'species')

# Collect intermediate names
## itis
downstream('Bangiophyceae', db="itis", downto="genus")
downstream('Bangiophyceae', db="itis", downto="genus", intermediate=TRUE)
downstream(get_tsn('Bangiophyceae'), downto="genus")
downstream(get_tsn('Bangiophyceae'), downto="genus", intermediate=TRUE)

# Use the rows parameter
## note how in the second function call you don't get the prompt
downstream("Poa", db = 'gbif', downto="species")
downstream("Poa", db = 'gbif', downto="species", rows=1)

# use curl options
res &lt;- downstream("Apis", db = 'gbif', downto = 'species', verbose = TRUE)

# Pagination
# GBIF limits queries to a maximum of 1000 records per request, so if
# there's more than 1000, use the start parameter
# Piper, taxonKey = 3075433
z1 &lt;- downstream(3075433, db = 'gbif', downto = "species", limit=1000)
z2 &lt;- downstream(3075433, db = 'gbif', downto = "species", limit=1000,
  start=1000)
z3 &lt;- downstream(3075433, db = 'gbif', downto = "species", limit=1000,
  start=2000)
z4 &lt;- downstream(3075433, db = 'gbif', downto = "species", limit=1000,
  start=3000)
NROW(rbind(z1[[1]], z2[[1]], z3[[1]], z4[[1]]))
}
## End(Not run)
</code></pre>


</div>