<div class="container">

<table style="width: 100%;"><tr>
<td>tamaanify</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Function for Parsing <span class="pkg">TAM</span> Input
</h2>

<h3>Description</h3>

<p>This function parses a so called <code>tammodel</code> which is a
string used for model estimation in <span class="pkg">TAM</span>.
The function is based on the <span class="pkg">lavaan</span> syntax and operates
at the extension <code>lavaanify.IRT</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tamaanify(tammodel, resp, tam.method=NULL, doparse=TRUE )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tammodel</code></td>
<td>

<p>String for model definition following the rules described in Details and
in Examples.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resp</code></td>
<td>

<p>Item response dataset
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tam.method</code></td>
<td>

<p>One of the <span class="pkg">TAM</span> methods <code>tam.mml</code>, <code>tam.mml.2pl</code>
or <code>tam.mml.3pl</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>doparse</code></td>
<td>
<p>Optional logical indicating whether <code>lavmodel</code>
should be parsed for <code>DO</code> statements.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The model syntax <code>tammodel</code> consists of several sections.
Some of them are optional. <br></p>
<p><code>ANALYSIS:</code> <br>
Possible model types are unidimensional and multidimensional
item response models (<code>TYPE="TRAIT"</code>), latent class models
(<code>"LCA"</code>), located latent class models (<code>"LOCLCA"</code>;
e.g. Formann, 1989; Bartolucci, 2007),
ordered latent class models (<code>"OLCA"</code>; only works for
dichotomous item responses; e.g. Hoijtink, 1997; Shojima, 2007) and
mixture distribution models (<code>"MIXTURE"</code>; e.g. von Davier, 2007). <br></p>
<p><code>LAVAAN MODEL:</code> <br>
For specification of the syntax, see <code>lavaanify.IRT</code>. <br></p>
<p><code>MODEL CONSTRAINT:</code> <br>
Linear constraints can be specified by using conventional
specification in <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> syntax. All terms must be combined
with the <code>+</code> operator. Equality constraints are
set by using the <code>==</code> operator as in <span class="pkg">lavaan</span>. <br></p>
<p><code>ITEM TYPE:</code> <br>
The following item types can be defined: Rasch model (<code>Rasch</code>),
the 2PL model (<code>2PL</code>), partial credit model (<code>PCM</code>)
and the generalized partial credit model (<code>GPCM</code>).
</p>
<p>The item intercepts can also be smoothed for the <code>PCM</code>
and the <code>GPCM</code> by using a Fourier basis proposed by
Thissen, Cai and Bock (2010). For an item with a maximum
of score of <code class="reqn">K</code>, a smoothed partial credit model
is requested by <code>PCM(kk)</code> where <code>kk</code> is an
integer between 1 and <code class="reqn">K</code>. With <code>kk</code>=1, only a linear
function is used. The subsequent integers correspond to
Fourier functions with decreasing periods.
See Example 2, Model 7 of the <code>tamaan</code>
function. <br></p>
<p><code>PRIOR:</code> <br>
Possible prior distributions: Normal distribution <code>N(mu,sd)</code>,
truncated normal distribution <code>TN(mu,sd,low,upp)</code> and
Beta distribution <code>Beta(a,b)</code>.
Parameter labels and prior specification must be separated
by <code>~</code>.<br></p>


<h3>Value</h3>

<p>A list with following (optional) entries
which are used as input in one of the <span class="pkg">TAM</span> functions
<code>tam.mml</code>, <code>tam.mml.2pl</code> or
<code>tam.mml.3pl</code>:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>tammodel</code></td>
<td>
<p>Model input for <span class="pkg">TAM</span></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tammodel.dfr</code></td>
<td>
<p>Processed <code>tammodel</code> input</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ANALYSIS</code></td>
<td>
<p>Syntax specified in <code>ANALYSIS</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ANALYSIS.list</code></td>
<td>
<p>Parsed specifications in <code>ANALYSIS</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LAVAANMODEL</code></td>
<td>
<p>Syntax specified in <code>LAVAAN MODEL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lavpartable</code></td>
<td>
<p>Parameter table processed by the
syntax in <code>LAVAAN MODEL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>items</code></td>
<td>
<p>Informations about items: Number of categories,
specified item response function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxcat</code></td>
<td>
<p>Maximum number of categories</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ITEMTYPE</code></td>
<td>
<p>Syntax specified in <code>ITEM TYPE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MODELCONSTRAINT</code></td>
<td>
<p>Syntax specified in <code>MODEL CONSTRAINT</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MODELCONSTRAINT.dfr</code></td>
<td>
<p>Processed syntax in <code>MODEL CONSTRAINT</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modelconstraint.thresh</code></td>
<td>
<p>Processed data frame for model constraint of thresholds</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modelconstraint.loading</code></td>
<td>
<p>Processed data frame for loadings</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resp</code></td>
<td>
<p>Data set for usage</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Used <span class="pkg">TAM</span> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>Design matrix A</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q</code></td>
<td>
<p>Design matrix for loadings</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q.fixed</code></td>
<td>
<p>Fixed values in <code class="reqn">Q</code> matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B.fixed</code></td>
<td>
<p>Matrix with fixed item loadings
(used for <code>tam.mml.2pl</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>Processed design matrix for loadings when there
are model constraints for loadings</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variance.fixed</code></td>
<td>
<p>Matrix for specification of fixed values
in covariance matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est.variance</code></td>
<td>
<p>Logical indicating whether variance should
be estimated (<code>tam.mml.2pl</code>)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta.k</code></td>
<td>
<p>Theta design matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>E</code></td>
<td>
<p>Design matrix E</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>notA</code></td>
<td>
<p>Logical indicating whether <code class="reqn">A</code> matrix is defined</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gammaslope.fixed</code></td>
<td>
<p>Fixed <code>gammaslope</code> parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gammaslope.prior</code></td>
<td>
<p>Prior distributions for <code>gammaslope</code> parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xsi.fixed</code></td>
<td>
<p>Fixed <code class="reqn">\xi</code> parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xsi.prior</code></td>
<td>
<p>Prior distributions for <code class="reqn">\xi</code> parameters</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Bartolucci, F. (2007). A class of multidimensional IRT models for testing
unidimensionality and clustering items.
<em>Psychometrika, 72</em>, 141-157.
<a href="https://doi.org/10.1007/s11336-005-1376-9">doi:10.1007/s11336-005-1376-9</a>
</p>
<p>Formann, A. K. (1989). Constrained latent class models: Some further
applications. <em>British Journal of Mathematical and Statistical
Psychology, 42</em>, 37-54.
<a href="https://doi.org/10.1111/j.2044-8317.1989.tb01113.x">doi:10.1111/j.2044-8317.1989.tb01113.x</a>
</p>
<p>Hojtink, H., &amp; Molenaar, I. W. (1997). A multidimensional item response model:
Constrained latent class analysis using the Gibbs sampler and posterior
predictive checks. <em>Psychometrika, 62</em>(2), 171-189.
<a href="https://doi.org/10.1007/BF02295273">doi:10.1007/BF02295273</a>
</p>
<p>Thissen, D., Cai, L., &amp; Bock, R. D. (2010).
The nominal categories item response model.
In M. L. Nering &amp; Ostini, R. (Eds.).
<em>Handbook of Polytomous Item Response Models</em>
(pp. 43-75). New York: Routledge.
</p>
<p>Shojima, K. (2007). <em>Latent rank theory: Estimation of item reference
profile by marginal maximum likelihood method with EM algorithm</em>.
DNC Research Note 07-12.
</p>
<p>von Davier, M. (2007). <em>Mixture distribution diagnostic models</em>.
ETS Research Report ETS RR-07-32. Princeton, ETS.
<a href="https://doi.org/10.1002/j.2333-8504.2007.tb02074.x">doi:10.1002/j.2333-8504.2007.tb02074.x</a>
</p>


<h3>See Also</h3>

<p>See <code>tamaan</code> for more examples. Other examples
are included in <code>tam.mml</code> and <code>tam.mml.3pl</code>.
</p>
<p><code>lavaanify.IRT</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 

#############################################################################
# EXAMPLE 1: Examples dichotomous data data.read
#############################################################################

library(sirt)
data(data.read,package="sirt")
dat &lt;- data.read

#*********************************************************************
#*** Model 1: 2PL estimation with some fixed parameters and
#             equality constraints
tammodel &lt;- "
LAVAAN MODEL:
  F2=~ C1__C2 + 1.3*C3 + C4
  F1=~ A1__B1
  # fixed loading of 1.4 for item B2
  F1=~ 1.4*B2
  F1=~ B3
  F1 ~~ F1
  F2 ~~ F2
  F1 ~~ F2
  B1 | 1.23*t1 ; A3 | 0.679*t1
  A2 | a*t1 ; C2 | a*t1 ; C4 | a*t1
  C3 | x1*t1 ; C1 | x1*t1
ITEM TYPE:
  A1__A3 (Rasch) ;
  A4 (2PL) ;
  B1__C4 (Rasch) ;
    "
# process model
out &lt;- TAM::tamaanify( tammodel, resp=dat)
# inspect some output
out$method          # used TAM function
out$lavpartable     # lavaan parameter table

#*********************************************************************
#*** Model 2: Latent class analysis with three classes
tammodel &lt;- "
ANALYSIS:
  TYPE=LCA;
  NCLASSES(3);   # 3 classes
  NSTARTS(5,20); # 5 random starts with 20 iterations
LAVAAN MODEL:
  F=~ A1__C4
    "
# process syntax
out &lt;- TAM::tamaanify( tammodel, resp=dat)
str(out$E)     # E design matrix for estimation with tam.mml.3pl function

#*********************************************************************
#*** Model 3: Linear constraints for item intercepts and item loadings
tammodel &lt;- "
LAVAAN MODEL:
  F=~ lam1__lam10*A1__C2
  F ~~ F
  A1 | a1*t1
  A2 | a2*t1
  A3 | a3*t1
  A4 | a4*t1
  B1 | b1*t1
  B2 | b2*t1
  B3 | b3*t1
  C1 | t1
MODEL CONSTRAINT:
  # defined parameters
  # only linear combinations are permitted
  b2==1.3*b1 + (-0.6)*b3
  a1==q1
  a2==q2 + t
  a3==q1 + 2*t
  a4==q2 + 3*t
  # linear constraints for loadings
  lam2==1.1*lam1
  lam3==0.9*lam1 + (-.1)*lam0
  lam8==lam0
  lam9==lam0
    "
# parse syntax
mod1 &lt;- TAM::tamaanify( tammodel, resp=dat)
mod1$A          # design matrix A for intercepts
mod1$L[,1,]     # design matrix L for loadings

## End(Not run)

#############################################################################
# EXAMPLE 2: Examples polytomous data data.Students
#############################################################################

library(CDM)
data( data.Students, package="CDM")
dat &lt;- data.Students[,3:13]

#*********************************************************************
#*** Model 1: Two-dimensional generalized partial credit model
tammodel &lt;- "
LAVAAN MODEL:
  FA=~ act1__act5
  FS=~ sc1__sc4
  FA ~~ 1*FA
  FS ~~ 1*FS
  FA ~~ FS
  act1__act3 | t1
  sc2 | t2
    "
out &lt;- TAM::tamaanify( tammodel, resp=dat)
out$A    # design matrix for item intercepts
out$Q    # loading matrix for items

#*********************************************************************
#*** Model 2: Linear constraints

# In the following syntax, linear equations for multiple constraints
# are arranged over multiple lines.
tammodel &lt;- "
  LAVAAN MODEL:
    F=~ a1__a5*act1__act5
    F ~~ F
  MODEL CONSTRAINT:
      a1==delta +
                tau1
      a2==delta
      a3==delta + z1
      a4==1.1*delta +
              2*tau1
                + (-0.2)*z1
  "
# tamaanify model
res &lt;- TAM::tamaanify( tammodel, dat )
res$MODELCONSTRAINT.dfr
res$modelconstraint.loading
</code></pre>


</div>