<div class="container">

<table style="width: 100%;"><tr>
<td>SPR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Subtree pruning and rearrangement (SPR)</h2>

<h3>Description</h3>

<p>Perform one <abbr><span class="acronym">SPR</span></abbr> rearrangement on a tree
</p>


<h3>Usage</h3>

<pre><code class="language-R">SPR(tree, edgeToBreak = NULL, mergeEdge = NULL)

SPRMoves(tree, edgeToBreak = integer(0))

## S3 method for class 'phylo'
SPRMoves(tree, edgeToBreak = integer(0))

## S3 method for class 'matrix'
SPRMoves(tree, edgeToBreak = integer(0))

SPRSwap(
  parent,
  child,
  nEdge = length(parent),
  nNode = nEdge/2L,
  edgeToBreak = NULL,
  mergeEdge = NULL
)

RootedSPR(tree, edgeToBreak = NULL, mergeEdge = NULL)

RootedSPRSwap(
  parent,
  child,
  nEdge = length(parent),
  nNode = nEdge/2L,
  edgeToBreak = NULL,
  mergeEdge = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>A tree of class <code>phylo</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edgeToBreak</code></td>
<td>
<p>the index of an edge to bisect, generated randomly if not specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mergeEdge</code></td>
<td>
<p>the index of an edge on which to merge the broken edge.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parent</code></td>
<td>
<p>Integer vector corresponding to the first column of the edge
matrix of a tree of class <code>phylo</code>, i.e. <code>tree$edge[, 1]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>child</code></td>
<td>
<p>Integer vector corresponding to the second column of the edge
matrix of a tree of class <code>phylo</code>, i.e. <code>tree$edge[, 2]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nEdge</code></td>
<td>
<p>(optional) integer specifying the number of edges of a tree of
class <code>phylo</code>, i.e. <code>dim(tree$edge)[1]</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nNode</code></td>
<td>
<p>(optional) Number of nodes.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Equivalent to <code>kSPR()</code> in the <span class="pkg">phangorn</span> package, but faster.
Note that rearrangements that only change the position of the root WILL be returned by
<code>SPR</code>.  If the position of the root is irrelevant (as in Fitch parsimony, for example)
then this function will occasionally return a functionally equivalent topology.
<code>RootIrrelevantSPR</code> will search tree space more efficiently in these cases.
Branch lengths are not (yet) supported.
</p>
<p>All nodes in a tree must be bifurcating; ape::collapse.singles and
ape::multi2di may help.
</p>


<h3>Value</h3>

<p>This function returns a tree in <code>phyDat</code> format that has undergone one <abbr><span class="acronym">SPR</span></abbr> iteration.
</p>
<p><code>TBRMoves()</code> returns a list of all trees one SPR move away from
<code>tree</code>, with edges and nodes in preorder, rooted on the first-labelled tip.
</p>
<p>a list containing two elements, corresponding in turn to the
rearranged parent and child parameters
</p>
<p>a list containing two elements, corresponding in turn to the rearranged parent and child parameters
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>SPRSwap()</code>: faster version that takes and returns parent and child parameters
</p>
</li>
<li> <p><code>RootedSPR()</code>: Perform <abbr><span class="acronym">SPR</span></abbr> rearrangement, retaining position of root
</p>
</li>
<li> <p><code>RootedSPRSwap()</code>: faster version that takes and returns parent and child parameters
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Martin R. Smith
</p>


<h3>References</h3>

<p>The <abbr><span class="acronym">SPR</span></abbr> algorithm is summarized in
Felsenstein J (2004).
<em>Inferring phylogenies</em>.
Sinauer Associates, Sunderland, Massachusetts.
</p>


<h3>See Also</h3>


<ul><li> <p><code>RootedSPR()</code>: useful when the position of the root node should be retained.
</p>
</li></ul>
<p>Other tree rearrangement functions: 
<code>NNI()</code>,
<code>TBR()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">{
tree &lt;- ape::rtree(20, br=FALSE)
SPR(tree)
}
</code></pre>


</div>