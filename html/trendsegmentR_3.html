<div class="container">

<table style="width: 100%;"><tr>
<td>TGUW</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Tail-Greedy Unbalanced Wavelet (TGUW) transformation of a vector</h2>

<h3>Description</h3>

<p>Performs the bottom-up unbalanced wavelet decomposition. This function is used inside <code>trendsegment</code>.
Details of the TGUW transformation can be found in H. Maeng and P. Fryzlewicz (2023), Detecting linear trend changes in data sequences.
</p>


<h3>Usage</h3>

<pre><code class="language-R">TGUW(x, p = 0.04)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An input vector to be decomposed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Proportion of all possible remaining merges which specifies the number of merges allowed in a single pass over the data. The default is 0.04.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the followings:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The original input vector <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The length of <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>twotogether</code></td>
<td>
<p>A vector indicating locations of the detail coefficients returned by Type 3 merges (merging two sets of paired smooth coefficients). This is used in <code>thresholding</code> to apply the "two together" rule which makes both detail coefficients (paired by a Type 3 merge) survived if at least one of their size is over threshold.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>merging.hist</code></td>
<td>
<p>An array of dimension 4 by 3 by <code>n</code>-2 which has the full record of the <code>n</code>-2 merges in the TGUW transformation. Each matrix contains the information of each merge. The first row shows the indices of merged smooth coefficients in increasing order and the second row gives the value of detail filter coefficients which is the weight vector for computing the corresponding detail coefficient. The third row shows the (detail coefficient, first smooth coefficient, second smooth coefficient) obtained by an orthonormal transform. The fourth row gives the balancedness of merging. If it is Type 1 merging (three initial smooth coefficients) then the fourth row is always (1/3, 1/3, 1/3). In Type 2 and Type 3 mergings, the values depend on the ratio of the length of the left and right wings to the entire merged region and only first two components of the fourth row are filled with the corresponding ratios (sum to 1) but the third one is left as NA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ts.coeffs</code></td>
<td>
<p>The transformed <code>x</code> by the TGUW transformation.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Hyeyoung Maeng <a href="mailto:hyeyoung.maeng@durham.ac.uk">hyeyoung.maeng@durham.ac.uk</a>, Piotr Fryzlewicz <a href="mailto:p.fryzlewicz@lse.ac.uk">p.fryzlewicz@lse.ac.uk</a>
</p>


<h3>See Also</h3>

<p><code>trendsegment</code>, <code>thresholding</code>, <code>invTGUW</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">x &lt;- c(1:10, rep(5,9))
n &lt;- length(x)
x &lt;- x + rnorm(n)
tguwfit &lt;- TGUW(x)
tguwfit
</code></pre>


</div>