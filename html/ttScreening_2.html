<div class="container">

<table style="width: 100%;"><tr>
<td>irwsva.build2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Adjusted irwsva.build which builds surrogate variables from gene expression data
</h2>

<h3>Description</h3>

<p>This function is directly modified from the original irwsva.build() in the SVA package. It was noticed that under certain circumstances a subscript out of bounds error would occur while running the SVA function. Therefore, this modified code has a single line altered that conditionally uses the generic singular decomposition, svd(), instead of fast singular decomposition, fast.svd().
</p>


<h3>Usage</h3>

<pre><code class="language-R">irwsva.build2(dat, mod, mod0 = NULL, n.sv, B = 5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>

<p>A m CpG sites by n subjects matrix of methylation data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mod</code></td>
<td>

<p>A n by k model matrix corresponding to the primary model fit (see model.matrix)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mod0</code></td>
<td>

<p>A n by k0 model matrix corresponding to the null model to be compared to mod.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.sv</code></td>
<td>

<p>The number of surrogate variables to construct.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>

<p>The number of iterations of the algorithm to perform.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See http://www.bioconductor.org/packages/release/bioc/manuals/sva/man/sva.pdf
</p>


<h3>Value</h3>



<table>
<tr style="vertical-align: top;">
<td><code>sv</code></td>
<td>
<p>A n by n.sv matrix where each column is a distinct surrogate variable.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pprob.gam  </code></td>
<td>
<p>A vector with the posterior probability estimates that each row is affected by
dependence.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pprob.b</code></td>
<td>
<p>A vector with the posterior probabiliity estimates that each row is affected by
the variables in mod, but not in mod0.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.sv</code></td>
<td>
<p>The number of suggorate variables estimated.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>sva Vignette http://www.biostat.jhsph.edu/~jleek/sva/
</p>


<h3>Author(s)</h3>

<p>Original irwsva.build: Jeffrey T. Leek &lt;jleek@jhsph.edu&gt;, John Storey jstorey@princeton.edu
</p>


<h3>References</h3>

<p>Original sva:
Leek JT and Storey JD. (2008) A general framework for multiple testing dependence.Proceedings of the National Academy of Sciences, 105: 18718-18723.
</p>
<p>Leek JT and Storey JD. (2007) Capturing heterogeneity in gene expression studies by surrogate variable analysis. PLoS Genetics, 3: e161.
</p>


</div>