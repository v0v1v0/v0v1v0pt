<div class="container">

<table style="width: 100%;"><tr>
<td>specify_ode</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Specify Ordinary Differential Equation (ODE)</h2>

<h3>Description</h3>

<p>Define compiled code for ordinary differential equation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">specify_ode(code, fname = NULL, pname = c("dy", "x", "y", "p"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>code</code></td>
<td>
<p>string with the body of the function definition (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fname</code></td>
<td>
<p>Optional name of the exported C++ function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pname</code></td>
<td>
<p>Vector of variable names (results, inputs, states, parameters)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The model (<code>code</code>) should be specified as the body of of C++ function.
The following variables are defined bye default (see the argument <code>pname</code>)
</p>

<dl>
<dt>dy</dt>
<dd>
<p>Vector with derivatives, i.e. the rhs of the ODE (the result).</p>
</dd>
<dt>x</dt>
<dd>
<p>Vector with the first element being the time, and the following
elements additional exogenous input variables,</p>
</dd>
<dt>y</dt>
<dd>
<p>Vector with the dependent variable</p>
</dd>
<dt>p</dt>
<dd>
<p>Parameter vector</p>
</dd>
</dl>
<p><code class="reqn">y'(t) = f_{p}(x(t), y(t))</code>
All variables are treated as Armadillo (http://arma.sourceforge.net/) vectors/matrices.
</p>
<p>As an example consider the <em>Lorenz Equations</em>
<code class="reqn">\frac{dx_{t}}{dt} = \sigma(y_{t}-x_{t})</code>
<code class="reqn">\frac{dy_{t}}{dt} = x_{t}(\rho-z_{t})-y_{t}</code>
<code class="reqn">\frac{dz_{t}}{dt} = x_{t}y_{t}-\beta z_{t}</code>
</p>
<p>We can specify this model as
<code>ode &lt;- 'dy(0) = p(0)*(y(1)-y(0));
      dy(1) = y(0)*(p(1)-y(2));
      dy(2) = y(0)*y(1)-p(2)*y(2);'</code>
<code>dy &lt;- specify_ode(ode)</code>
</p>
<p>As an example of model with exogenous inputs consider the following ODE:
<code class="reqn">y'(t) = \beta_{0} + \beta_{1}y(t) + \beta_{2}y(t)x(t) + \beta_{3}x(t)\cdot t</code>
This could be specified as
<code>mod &lt;- 'double t = x(0);
              dy = p(0) + p(1)*y + p(2)*x(1)*y + p(3)*x(1)*t;'</code>
<code>dy &lt;- specify_ode(mod)</code>##'
</p>


<h3>Value</h3>

<p>pointer (externalptr) to C++ function
</p>


<h3>Author(s)</h3>

<p>Klaus KÃ¤hler Holst
</p>


<h3>See Also</h3>

<p>solve_ode
</p>


</div>