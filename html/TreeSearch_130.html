<div class="container">

<table style="width: 100%;"><tr>
<td>IWScore</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate the parsimony score of a tree given a dataset</h2>

<h3>Description</h3>

<p><code>TreeLength()</code> uses the Morphy library (Brazeau et al. 2017)
to calculate a parsimony score for a tree, handling inapplicable data
according to the algorithm of Brazeau et al. (2019).
Trees may be scored using equal weights, implied weights
(Goloboff 1993), or profile parsimony
(Faith and Trueman 2001).
</p>


<h3>Usage</h3>

<pre><code class="language-R">IWScore(tree, dataset, concavity = 10L, ...)

TreeLength(tree, dataset, concavity = Inf)

## S3 method for class 'phylo'
TreeLength(tree, dataset, concavity = Inf)

## S3 method for class 'numeric'
TreeLength(tree, dataset, concavity = Inf)

## S3 method for class 'list'
TreeLength(tree, dataset, concavity = Inf)

## S3 method for class 'multiPhylo'
TreeLength(tree, dataset, concavity = Inf)

Fitch(tree, dataset)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>A tree of class <code>phylo</code>, a list thereof (optionally of class
<code>multiPhylo</code>), or an integer – in which case <code>tree</code> random trees will be
uniformly sampled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataset</code></td>
<td>
<p>A phylogenetic data matrix of <span class="pkg">phangorn</span> class
<code>phyDat</code>, whose names correspond to the labels of any accompanying tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>concavity</code></td>
<td>
<p>Determines the degree to which extra steps beyond the first
are penalized.  Specify a numeric value to use implied weighting
(Goloboff 1993); <code>concavity</code> specifies <em>k</em> in
<em>k</em> / <em>e</em> + <em>k</em>. A value of 10 is recommended;
TNT sets a default of 3, but this is too low in some circumstances
(Goloboff et al. 2018; Smith 2019).
Better still explore the sensitivity of results under a range of
concavity values, e.g. <code>k = 2 ^ (1:7)</code>.
Specify <code>Inf</code> to weight each additional step equally.
Specify <code>"profile"</code> to employ profile parsimony (Faith and Trueman 2001).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>unused; allows additional parameters specified within ... to be
received by the function without throwing an error.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>TreeLength()</code> returns a numeric vector containing the score for
each tree in <code>tree</code>.
</p>


<h3>Author(s)</h3>

<p>Martin R. Smith (using Morphy C library, by Martin Brazeau)
</p>


<h3>References</h3>

<p>Brazeau MD, Guillerme T, Smith MR (2019).
“An algorithm for morphological phylogenetic analysis with inapplicable data.”
<em>Systematic Biology</em>, <b>68</b>(4), 619–631.
<a href="https://doi.org/10.1093/sysbio/syy083">doi:10.1093/sysbio/syy083</a>.<br><br> Brazeau MD, Smith MR, Guillerme T (2017).
“MorphyLib: a library for phylogenetic analysis of categorical trait data with inapplicability.”
<a href="https://doi.org/10.5281/zenodo.815372">doi:10.5281/zenodo.815372</a>.<br><br> Faith DP, Trueman JWH (2001).
“Towards an inclusive philosophy for phylogenetic inference.”
<em>Systematic Biology</em>, <b>50</b>(3), 331–350.
<a href="https://doi.org/10.1080/10635150118627">doi:10.1080/10635150118627</a>.<br><br> Goloboff PA (1993).
“Estimating character weights during tree search.”
<em>Cladistics</em>, <b>9</b>(1), 83–91.
<a href="https://doi.org/10.1111/j.1096-0031.1993.tb00209.x">doi:10.1111/j.1096-0031.1993.tb00209.x</a>.<br><br> Goloboff PA, Torres A, Arias JS (2018).
“Weighted parsimony outperforms other methods of phylogenetic inference under models appropriate for morphology.”
<em>Cladistics</em>, <b>34</b>(4), 407–437.
<a href="https://doi.org/10.1111/cla.12205">doi:10.1111/cla.12205</a>.<br><br> Smith MR (2019).
“Bayesian and parsimony approaches reconstruct informative trees from simulated morphological datasets.”
<em>Biology Letters</em>, <b>15</b>(2), 20180632.
<a href="https://doi.org/10.1098/rsbl.2018.0632">doi:10.1098/rsbl.2018.0632</a>.
</p>


<h3>See Also</h3>


<ul>
<li>
<p> Conduct tree search using <code>MaximizeParsimony()</code> (command line),
<code>EasyTrees()</code> (graphical user interface), or <code>TreeSearch()</code>
(custom optimality criteria).
</p>
</li>
<li>
<p> See score for each character: <code>CharacterLength()</code>.
</p>
</li>
</ul>
<p>Other tree scoring: 
<code>CharacterLength()</code>,
<code>LengthAdded()</code>,
<code>MinimumLength()</code>,
<code>MorphyTreeLength()</code>,
<code>TaxonInfluence()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("inapplicable.datasets")
tree &lt;- TreeTools::BalancedTree(inapplicable.phyData[[1]])
TreeLength(tree, inapplicable.phyData[[1]])
TreeLength(tree, inapplicable.phyData[[1]], concavity = 10)
TreeLength(tree, inapplicable.phyData[[1]], concavity = "profile")
TreeLength(5, inapplicable.phyData[[1]])
</code></pre>


</div>