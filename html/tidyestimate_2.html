<div class="container">

<table style="width: 100%;"><tr>
<td>estimate_score</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Infer tumor purity using the ESTIMATE algorithm</h2>

<h3>Description</h3>

<p>Infer tumor purity by using single-sample gene-set-enrichment-analysis with
stromal and immune cell signatures.
</p>


<h3>Usage</h3>

<pre><code class="language-R">estimate_score(df, is_affymetrix)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>a <code>data.frame</code> of expression data, where columns are tumors
and rows are genes. Gene names must be in the first column, and in the form
of HGNC symbols.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>is_affymetrix</code></td>
<td>
<p>logical. Is the expression data from an Affymetrix
array?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>ESTIMATE (and this tidy implementation) infers tumor infiltration using two
gene sets: a stromal signature, and an immune signature (see
<code>tidyestimate::gene_sets</code>).
</p>
<p>Enrichment scores for each sample are calculated using an implementation of
single sample Gene Set Enrichment Analysis (ssGSEA). Briefly, expression is
ranked on a per-sample basis, and the density and distribution of gene
signature 'hits' is determined. An enrichment of hits at the top of the
expression ranking confers a positive score, while an enrichment of hits at
the bottom of the expression ranking confers a negative score.
</p>
<p>An 'ESTIMATE' score is calculated by adding the stromal and immune scores
together.
</p>
<p>For Affymetrix arrays, an equation to convert an ESTIMATE score to a
prediction of tumor purity has been developed by Yoshihara et al. (see
references). It takes the approximate form of:
</p>
<p style="text-align: center;"><code class="reqn">purity = cos(0.61 + 0.00015 * ESTIMATE)</code>
</p>

<p>Values have been rounded to two significant figures for display purposes.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> with sample names, as well as scores for stromal,
immune, and ESTIMATE scores per tumor. If <code>is_affymetrix = TRUE</code>,
purity scores as well.
</p>
<p>Purity scores can be interpreted absolutely: a purity of 0.9 means that tumor
is likely 90
available (such as in RNAseq), ESTIMATE scores can only be interpreted
relatively: a sample that has a lower ESTIMATE score than another in one
study can be regarded as more pure than another, but its absolute purity
cannot be inferred, nor can purity across other studies be inferred.
</p>


<h3>References</h3>

<p>Barbie et al. (2009) &lt;doi:10.1038/nature08460&gt;
</p>
<p>Yoshihara et al. (2013) &lt;doi:10.1038/ncomms3612&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R">filter_common_genes(ov, id = "hgnc_symbol", tidy = FALSE, tell_missing = TRUE, find_alias = TRUE) |&gt; 
  estimate_score(is_affymetrix = TRUE)
</code></pre>


</div>