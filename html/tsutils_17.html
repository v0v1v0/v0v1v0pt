<div class="container">

<table style="width: 100%;"><tr>
<td>theta</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Theta method</h2>

<h3>Description</h3>

<p>Estimate Theta method.
</p>
<p>Forecast with fitted Theta method.
</p>
<p>Produce a plot of the fitted Theta method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">theta(
  y,
  m = NULL,
  sign.level = 0.05,
  cost0 = c("MSE", "MdSE", "MAE", "MdAE"),
  cost2 = c("MSE", "MdSE", "MAE", "MdAE"),
  costs = c("MSE", "MdSE", "MAE", "MdAE"),
  multiplicative = c("multiplicative", "additive", "auto"),
  cma = NULL,
  outliers = NULL
)

## S3 method for class 'theta'
forecast(object, h = NULL, ...)

## S3 method for class 'theta'
plot(x, thetalines = c(TRUE, FALSE), ...)

theta.thief(y, h = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>input time series. Can be <code>ts</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>seasonal period. If <code>y</code> is a <code>ts</code> object then the default is its frequency.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sign.level</code></td>
<td>
<p>significance level for trend and seasonality tests.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cost0</code></td>
<td>
<p>cost function of theta0 line. Can be:
</p>

<ul>
<li> <p><code>"MSE"</code>: mean squared error.
</p>
</li>
<li> <p><code>"MdSE"</code>: median squared error.
</p>
</li>
<li> <p><code>"MAE"</code>: mean absolute error.
</p>
</li>
<li> <p><code>"MdAE"</code>: median absolute error.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cost2</code></td>
<td>
<p>cost function of theta2 line. Same options as <code>cost0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>costs</code></td>
<td>
<p>cost function of seasonal element. Same options as <code>cost0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>multiplicative</code></td>
<td>
<p>type of seasonal decomposition. This can be <code>"multiplicative"</code>, <code>"additive"</code> or <code>"auto"</code>. If <code>y</code> contains non-positive values then this is forced to <code>"additive"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cma</code></td>
<td>
<p>input precalculated level/trend for the analysis. Use <code>NULL</code> to estimate internally.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outliers</code></td>
<td>
<p>provide vector of location of observations that are considered outliers (see <code>residout</code>). These will be considered in the estimation of theta0. For no outliers use <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>object of class <code>theta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>forecast horizon. If <code>h</code> is <code>NULL</code>, then the horizon is set equal to the the seasonal frequency.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments passed to functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>object of class <code>theta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thetalines</code></td>
<td>
<p>if <code>TRUE</code>, then theta lines are included in the plot.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This implementation of the Theta method tests automatically for seasonality and trend. Seasonal decomposition can be done either additively or multiplicatively and the seasonality is treated as a pure seasonal model. The various Theta components can be optimised using different cost functions. The originally proposed Theta method always assumed multiplicative seasonality and presence of trend, while all theta lines were optimised using MSE and seasonality was estimated using classical decomposition.
</p>


<h3>Value</h3>

<p>An object of class <code>theta</code>, containing:
</p>

<ul>
<li> <p><code>"method"</code>: "Theta".
</p>
</li>
<li> <p><code>"y"</code>: the input time series.
</p>
</li>
<li> <p><code>"m"</code>: seasonal periods.
</p>
</li>
<li> <p><code>"exist"</code>: Statistical testing results, <code>exist[1]</code> is the result for trend, <code>exist[2]</code> is for season.
</p>
</li>
<li> <p><code>"multiplicative"</code>: If <code>TRUE</code>, then seasonality is modelled multiplicatively.
</p>
</li>
<li> <p><code>"theta0"</code>: fitted theta0 line values.
</p>
</li>
<li> <p><code>"theta2"</code>: fitted theta2 line values.
</p>
</li>
<li> <p><code>"season"</code>: fitted season values.
</p>
</li>
<li> <p><code>"x.out"</code>: modelled outliers.
</p>
</li>
<li> <p><code>"cost"</code>: cost functions for theta0, theta2 and season components.
</p>
</li>
<li> <p><code>"a"</code>: SES parameters of theta2.
</p>
</li>
<li> <p><code>"b"</code>: regression parameters of theta0.
</p>
</li>
<li> <p><code>"p"</code>: coefficients of outliers from theta0 and theta2 estimation.
</p>
</li>
<li> <p><code>"g"</code>: pure seasonal exponential smoothing parameters.
</p>
</li>
<li> <p><code>"fitted"</code>: fitted values.
</p>
</li>
<li> <p><code>"residuals"</code>: in-sample residuals.
</p>
</li>
<li> <p><code>"MSE"</code>: in-sample Mean Squared Error.
</p>
</li>
</ul>
<h3>Functions</h3>


<ul><li> <p><code>theta.thief()</code>: Wrapper function to use Theta with <code>thief</code>.
</p>
</li></ul>
<h3>Author(s)</h3>

<p>Nikolaos Kourentzes, <a href="mailto:nikolaos@kourentzes.com">nikolaos@kourentzes.com</a>.
</p>


<h3>References</h3>


<ul>
<li>
<p> The original Theta method was proposed by: Assimakopoulos, V., &amp; Nikolopoulos, K. (2000). The theta model: a decomposition approach to forecasting. International journal of forecasting, 16(4), 521-530. See details in how the implementation here differs.
</p>
</li>
<li>
<p> The THieF forecasting methodology used for <code>theta.thief</code> is proposed by: Athanasopoulos, G., Hyndman, R. J., Kourentzes, N., &amp; Petropoulos, F. (2017). Forecasting with temporal hierarchies. European Journal of Operational Research, 262(1), 60-74.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">fit &lt;- theta(referrals)
plot(fit)

forecast.theta(fit,h=12) # Or simply use forecast(fit)

## Not run: 
library(thief)
thief(referrals,forecastfunction=theta.thief)

## End(Not run)

</code></pre>


</div>