<div class="container">

<table style="width: 100%;"><tr>
<td>plot.ithresh</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot diagnostics an ithresh object</h2>

<h3>Description</h3>

<p><code>plot</code> method for class <code>"ithresh"</code>.  Produces an extreme value
threshold diagnostic plot based on an analysis performed by
<code>ithresh</code>.  Can also be used to produce a plot of
the posterior sample generated by <code>ithresh</code> for a particular
training threshold.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'ithresh'
plot(
  x,
  y,
  ...,
  which_v = NULL,
  prob = TRUE,
  top_scale = TRUE,
  add_legend = FALSE,
  legend_pos = "topleft",
  which_u = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>"ithresh"</code>, a result of a call to
<code>ithresh</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Not used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed on to <code>matplot</code>
and/or <code>legend</code> and/or <code>axis</code>.
If <code>which_u</code> is supplied then these arguments are passed to
<code>plot.evpost</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which_v</code></td>
<td>
<p>A numeric scalar or vector.
</p>
<p>If <code>which_u</code> is not supplied (a threshold diagnostic plot is
required) <code>which_v</code> specifies the validation thresholds, that
is, the components of <code>x$v_vec</code>, to include in the plot.
</p>
<p>If <code>which_u</code> is supplied (a plot of a posterior sample for a given
threshold is required) then <code>which_v</code> is a numeric scalar
that indicates which element of <code>object$v_vec</code> is used in selecting
a single threshold (if <code>which_u = "best"</code>).
Note: the default, <code>which_v = 1</code> gives the <em>lowest</em> of the
validation thresholds in <code>object$v_vec</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>A logical scalar.  If <code>TRUE</code> then the levels of thresholds
are represented by the proportion of observations that lie below a
threshold.  If <code>prob = FALSE</code> then the values of the thresholds are
used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>top_scale</code></td>
<td>
<p>A logical scalar indicating Whether or not to add a scale
to the top horizontal axis.  If this is added it gives the threshold on
the scale not chosen by <code>prob</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add_legend</code></td>
<td>
<p>A logical scalar indicating whether or not to add a
legend to the plot.  If <code>method = "cv"</code> then the legend gives the
levels of the validation thresholds.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend_pos</code></td>
<td>
<p>The position of the legend (if required) specified using
the argument <code>x</code> in <code>legend</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which_u</code></td>
<td>
<p>Either a character scalar or a numeric scalar.
If <code>which_u</code> is supplied then <code>plot.evpost</code>
is used to produce a plot of the posterior sample generated using
a particular training threshold. By default a scatter plot of the posterior
sample of Generalized Pareto parameters is produced.
</p>
<p>If <code>which_u = "best"</code> then the training threshold achieving the largest
measure of predictive performance in <code>object$pred_perf</code>, based
on the validation threshold selected using <code>which_v</code>, is used.
See <code>summary.ithresh</code> to print the best thresholds for each
validation threshold.
</p>
<p>Otherwise, <code>which_u</code> is a numeric scalar that selects training
threshold <code>x$u_vec[which_u]</code>.  Therefore, <code>which_u</code> must
be an integer in <code>1, ..., length(x$u_vec)</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Produces plots of the <em>threshold weights</em>, defined in
equation (14) of Northrop et al. (2017) against training threshold.  A line
is produced for each of the validation thresholds chosen in <code>which_v</code>.
The result is a plot like those in the top row of Figure 7 in
Northrop et al. (2017).
</p>
<p>It is possible that a curve on the plot may be incomplete.  This indicates
that, for a particular threshold level, a measure of predictive
performance is <code>-Inf</code>. This occurs when an observation in the data
lies above the estimated upper end point of the predictive distribution
produced when this observation is removed.
</p>


<h3>Value</h3>

<p>If <code>which_u</code> is supplied then the object with which
<code>plot.evpost</code> was called is returned (invisibly).
Otherwise, a list is returned (again invisibly) with two components.
<code>x</code> is a vector containing the coordinates plotted on the
(lower) horizontal axis.
<code>y</code> is an <code>length(u_vec)</code> by <code>n_v</code> matrix of
<em>threshold weights</em> obtained by normalising the columns of the
matrix <code>pred_perf</code> returned by <code>ithresh</code>.
See equation (14) of Northrop et al. (2017).
</p>


<h3>See Also</h3>

<p><code>ithresh</code> for threshold selection in the i.i.d. case
based on leave-one-out cross-validation.
</p>
<p><code>summary.ithresh</code> Summarizing measures of threshold
predictive performance.
</p>
<p><code>print.ithresh</code> Prints the threshold weights.
</p>
<p><code>predict.ithresh</code> for predictive inference for the
largest value observed in N years.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># [Smoother plots result from making n larger than the default n = 1000.]

# Threshold diagnostic plot
u_vec_gom &lt;- quantile(gom, probs = seq(0, 0.9, by = 0.05))
gom_cv &lt;- ithresh(data = gom, u_vec = u_vec_gom, n_v = 3)
plot(gom_cv, lwd = 2, add_legend = TRUE, legend_pos = "topleft")
mtext("significant wave height / m", side = 3, line = 2.5)

# Plot of Generalized Pareto posterior sample at the best threshold
# (based on the lowest validation threshold)
plot(gom_cv, which_u = "best")
# See which threshold was used
summary(gom_cv)

# Plot of Generalized Pareto posterior sample at the highest threshold
n_u &lt;- length(u_vec_gom)
plot(gom_cv, which_u = n_u, points_par = list(pch = 20, col = "grey"))
</code></pre>


</div>