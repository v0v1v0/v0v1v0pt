<div class="container">

<table style="width: 100%;"><tr>
<td>VB_FCtemplateICA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>VB_FCtemplateICA</h2>

<h3>Description</h3>

<p>VB Algorithm for FC Template ICA Model
</p>


<h3>Usage</h3>

<pre><code class="language-R">VB_FCtemplateICA(
  template_mean,
  template_var,
  template_FC,
  method_FC = c("VB1", "VB2"),
  nsamp_u = 10000,
  CI_FC = 0.95,
  return_FC_samp = FALSE,
  prior_params = c(0.001, 0.001),
  BOLD,
  TR = NULL,
  A0,
  S0,
  S0_var,
  maxiter = 100,
  miniter = 3,
  epsilon = 0.001,
  usePar = TRUE,
  PW = FALSE,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>template_mean</code></td>
<td>
<p>(<code class="reqn">V \times Q</code> matrix) mean maps for each IC in the
template, where <code class="reqn">Q</code> is the number of ICs, and <code class="reqn">V=nvox</code> is the number
of data locations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>template_var</code></td>
<td>
<p>(<code class="reqn">V \times Q</code> matrix) between-subject variance maps
for each IC in the template.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>template_FC</code></td>
<td>
<p>(list) Parameters of functional connectivity template.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method_FC</code></td>
<td>
<p>Variational Bayes (VB) method for FC template ICA model:
<code>"VB1"</code> (default) uses a conjugate Inverse-Wishart prior for the cor(A);
<code>"VB2"</code> draws samples from p(cor(A)) to emulate the population distribution
using a combination of Cholesky, SVD, and random pivoting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsamp_u</code></td>
<td>
<p>For VB1, the number of samples to generate from u ~ Gamma, where
A is Gaussian conditional on u. Default: <code>10000</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI_FC</code></td>
<td>
<p>Level of posterior credible interval to construct for each FC element.
Default: <code>0.95</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return_FC_samp</code></td>
<td>
<p>Should the FC samples (<code class="reqn">QxQxK</code>) be returned, where K
is the number of posterior samples generated? May be a large object.  For VB1,
K is equal to nsamp_u. For VB2, K is equal to the number of samples from p(G)
contained in template_FC.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior_params</code></td>
<td>
<p>Alpha and beta parameters of IG prior on <code class="reqn">\tau^2</code>
(error variance). Default: <code>0.001</code> for both.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BOLD</code></td>
<td>
<p>(<code class="reqn">V \times T</code> matrix) preprocessed fMRI data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A0, S0, S0_var</code></td>
<td>
<p>Initial guesses at latent variables: <code>A</code> (<code class="reqn">TxQ</code>
mixing matrix), <code>S</code> (<code class="reqn">QxV</code> matrix of spatial ICs), and
variance matrix <code>S0_var</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>Maximum number of VB iterations. Default: <code>100</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>miniter</code></td>
<td>
<p>Minimum number of VB iterations. Default: <code>3</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>Smallest proportion change in parameter estimates between iterations.
Default: <code>0.001</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>usePar</code></td>
<td>
<p>Parallelize the computation? Default: <code>FALSE</code>. Can be the
number of cores to use or <code>TRUE</code>, which will use the number available minus two.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PW</code></td>
<td>
<p>Prewhiten to account for residual autocorrelation?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>If <code>TRUE</code>, display progress of algorithm. Default: <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of computed values, including the final parameter estimates.
</p>


</div>