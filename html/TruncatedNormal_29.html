<div class="container">

<table style="width: 100%;"><tr>
<td>tmvt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multivariate truncated Student distribution</h2>

<h3>Description</h3>

<p>Density, distribution function and random generation for the multivariate truncated Student distribution
with location vector <code>mu</code>, scale matrix <code>sigma</code>, lower truncation limit
<code>lb</code>, upper truncation limit <code>ub</code> and degrees of freedom <code>df</code>.
</p>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x, q</code></td>
<td>
<p>vector or matrix of quantiles</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>number of replications for the (quasi)-Monte Carlo scheme</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>logical; if <code>TRUE</code>, probabilities and density are given on the log scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>vector of location parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>scale matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>degrees of freedom</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lb</code></td>
<td>
<p>vector of lower truncation limits</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ub</code></td>
<td>
<p>vector of upper truncation limits</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>string, either of <code>mc</code> or <code>qmc</code> for Monte Carlo and quasi Monte Carlo, respectively</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check</code></td>
<td>
<p>logical, if <code>TRUE</code> (default), check that the scale matrix <code>sigma</code> is positive definite and symmetric.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments, currently ignored</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The truncation limits can include infinite values. The Monte Carlo (<code>type = "mc"</code>) uses a sample of size <code>B</code>, while the
qausi Monte Carlo (<code>type = "qmc"</code>) uses a pointset of size <code>ceiling(n/12)</code> and estimates the relative error using 12 independent randomized QMC estimators.
</p>
<p><code>pmvt</code> computes an estimate and a deterministic upper bound of the distribution function of the multivariate normal distribution.
Infinite values for vectors <code class="reqn">u</code> and <code class="reqn">l</code> are accepted. The Monte Carlo method uses sample size <code class="reqn">n</code>: the larger <code class="reqn">n</code>, the smaller the relative error of the estimator.
</p>


<h3>Value</h3>

<p><code>dtmvt</code> gives the density, <code>ptmvt</code> gives the distribution function, <code>rtmvt</code> generate random deviates.
</p>


<h3>Usage</h3>

<pre>
dtmvt(x, mu, sigma, df, lb, ub, type = c("mc", "qmc"), log = FALSE, B = 1e4)
ptmvt(q, mu, sigma, df, lb, ub, type = c("mc", "qmc"), log = FALSE, B = 1e4)
rtmvt(n, mu, sigma, df, lb, ub)
pmvt(mu, sigma, df, lb = -Inf, ub = Inf, type = c("mc", "qmc"), B = 1e4)</pre>


<h3>Author(s)</h3>

<p>Leo Belzile, R port from Matlab code by Z. I. Botev
</p>


<h3>References</h3>

<p>Z. I. Botev and P. L'Ecuyer (2015), Efficient probability estimation
and simulation of the truncated multivariate Student-t distribution,
Proceedings of the 2015 Winter Simulation Conference, pp. 380-391
</p>


<h3>Examples</h3>

<pre><code class="language-R">d &lt;- 4; lb &lt;- rep(0, d)
mu &lt;- runif(d)
sigma &lt;- matrix(0.5, d, d) + diag(0.5, d)
samp &lt;- rtmvt(n = 10, mu = mu, sigma = sigma, df = 2, lb = lb)
loglik &lt;- dtmvt(samp, mu = mu, sigma = sigma, df = 2, lb = lb, log = TRUE)
cdf &lt;- ptmvt(samp, mu = mu, sigma = sigma, df = 2, lb = lb, log = TRUE, type = "q")
</code></pre>


</div>