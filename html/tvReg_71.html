<div class="container">

<table style="width: 100%;"><tr>
<td>tvGLS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Time-Varying Generalised Least Squares</h2>

<h3>Description</h3>

<p><code>tvGLS</code> estimates time-varying coefficients of SURE using the kernel smoothing GLS.
</p>
<p><code>tvGLS</code> is used to estimate time-varying coefficients SURE using the kernel smoothing
generalised least square.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tvGLS(x, ...)

## S3 method for class 'list'
tvGLS(
  x,
  y,
  z = NULL,
  ez = NULL,
  bw,
  Sigma = NULL,
  R = NULL,
  r = NULL,
  est = c("lc", "ll"),
  tkernel = c("Triweight", "Epa", "Gaussian"),
  ...
)

## S3 method for class 'matrix'
tvGLS(
  x,
  y,
  z = NULL,
  ez = NULL,
  bw,
  Sigma = NULL,
  R = NULL,
  r = NULL,
  est = c("lc", "ll"),
  tkernel = c("Triweight", "Epa", "Gaussian"),
  ...
)

## S3 method for class 'tvsure'
tvGLS(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object used to select a method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments passed to specific methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>A vector with the smoothing variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ez</code></td>
<td>
<p>(optional) A scalar or vector with the smoothing values. If 
values are not included then the vector <code>z</code> is used instead.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw</code></td>
<td>
<p>A numeric vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>An array.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>A matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>A numeric vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est</code></td>
<td>
<p>The nonparametric estimation method, one of "lc" (default) for linear constant
or "ll" for local linear.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tkernel</code></td>
<td>
<p>A character, either "Triweight" (default), "Epa" or "Gaussian" kernel function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The classical GLS estimator must be modified to generate a set of coefficients changing over time.
The <code>tvGLS</code> finds a GLS estimate at a given point in time <em>t</em> using the data near by.
The size of the data window used is given by the bandwidth. The closest a point is to <em>t</em>,
the larger is its effect on the estimation which is given by the kernel. In this programme,
the three possible kernels are the Triweight, Epanechnikov and Gaussian. As in the classical GLS, the covariance
matrix is involved in the estimation formula. If this matrix is NULL or the identity, then the
program returns the OLS estimates for time-varying coefficients.
</p>
<p>Note, that unless with the tvSURE, the tvGLS may run with one common bandwidth for all
equations or with a different bandwidths for each equation.
</p>


<h3>Value</h3>

<p><code>tvGLS</code> returns a list containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>An array of dimension obs x nvar x neq (obs = number of observations, nvar = number of variables
in each equation, neq = number of equations in the system) with the time-varying coefficients estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted</code></td>
<td>
<p>A matrix of dimension obs x neq with the fitted values from the estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>A matrix of dimension obs x neq with the residuals from the estimation.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">data(FF5F)
x &lt;- list()
## SMALL/LoBM porfolios time-varying three factor model
x[[1]] &lt;- cbind(rep (1, 314), FF5F[, c("NA.Mkt.RF", "NA.SMB",  "NA.HML", "NA.RMW", "NA.CMA")])
x[[2]] &lt;- cbind(rep (1, 314), FF5F[, c("JP.Mkt.RF", "JP.SMB",  "JP.HML", "JP.RMW", "JP.CMA")])
x[[3]] &lt;- cbind(rep (1, 314), FF5F[, c("AP.Mkt.RF", "AP.SMB",  "AP.HML", "AP.RMW", "AP.CMA")])
x[[4]] &lt;- cbind(rep (1, 314), FF5F[, c("EU.Mkt.RF", "EU.SMB",  "EU.HML", "EU.RMW", "EU.CMA")])
##Returns
y &lt;- cbind(FF5F$NA.SMALL.LoBM, FF5F$JP.SMALL.LoBM, FF5F$AP.SMALL.LoBM, 
FF5F$EU.SMALL.LoBM) 
##Excess returns
y &lt;- y - cbind(FF5F$NA.RF, FF5F$JP.RF, FF5F$AP.RF, FF5F$EU.RF)
##I fit the data with one bandwidth for each equation
FF5F.fit &lt;- tvGLS(x = x, y = y, bw = c(1.03, 0.44, 0.69, 0.31))

</code></pre>


</div>