<div class="container">

<table style="width: 100%;"><tr>
<td>chi</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Measures of extremal dependence</h2>

<h3>Description</h3>

<p>Compute measures of extremal dependence for 2 variables.
</p>


<h3>Usage</h3>

<pre><code class="language-R">chi(data, nq = 100, qlim = NULL, alpha = 0.05, trunc = TRUE)

## S3 method for class 'chi'
summary(object, ...)

## S3 method for class 'summary.chi'
print(x, digits=3, ...)

## S3 method for class 'chi'
print(x, ...)

## S3 method for class 'chi'
plot(x, show=c("Chi"=TRUE,"ChiBar"=TRUE), lty=1,
cilty=2, col=1, spcases=TRUE, cicol=1, xlim=c(0, 1), ylimChi =
c(-1, 1), ylimChiBar = c(-1, 1), mainChi = "Chi", mainChiBar =
"Chi Bar", xlab = "Quantile", ylabChi =
expression(chi(u)), ylabChiBar = expression(bar(chi)(u)),
ask, ...)

## S3 method for class 'chi'
ggplot(data=NULL, mapping, xlab = "Quantile", 
ylab=c("ChiBar" = expression(bar(chi)(u)), "Chi" = expression(chi(u))),
main=c("ChiBar" = "Chi Bar",       "Chi" = "Chi"),
xlim = c(0, 1), ylim =list("Chi" = c(-1, 1),"ChiBar" = c(-1, 1)),
ptcol="blue",fill="orange",show=c("ChiBar"=TRUE,"Chi"=TRUE),
spcases = TRUE,plot., ..., environment)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A matrix containing 2 numeric columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nq</code></td>
<td>
<p>The number of quantiles at which to evaluate the dependence
measures.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qlim</code></td>
<td>
<p>The minimum and maximum quantiles at which to do the evaluation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The size of the confidence interval to be used. Defaults to
<code>alpha = 0.05</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trunc</code></td>
<td>
<p>Logical flag indicating whether the estimates should be
truncated at their theoretical bounds.  Defaults to <code>trunc = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x, object</code></td>
<td>
<p>An object of class <code>chi</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>Number of digits for printing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show</code></td>
<td>
<p>Logical, of length 2, names "Chi" and "ChiBar".  Defaults to<br><code>c("Chi" = TRUE, "ChiBar" = TRUE)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty, cilty, col, cicol</code></td>
<td>
<p>Line types and colours for the the estimated
quantities and their confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim, ylimChi, ylimChiBar</code></td>
<td>
<p>Limits for the axes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mainChi, mainChiBar</code></td>
<td>
<p>Main titles for the plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylabChi, ylabChiBar</code></td>
<td>
<p>Axis labels for the plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mapping, ylab, main, ylim, ptcol, fill, environment</code></td>
<td>
<p>Arguments to ggplot methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spcases</code></td>
<td>
<p>Whether or not to plot special cases of perfect (positive and
negative) dependence and indpenendence. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.</code></td>
<td>
<p>whether to plot to active graphics device.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ask</code></td>
<td>
<p>Whether or not to ask before reusing the graphics device.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed to methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Computes the functions chi and chi-bar described by Coles, Heffernan and
Tawn (1999). The limiting values of these functions as the quantile
approaches 1 give an empirical measure of the type and strength of tail
dependendce exhibited by the data.
</p>
<p>A limiting value of ChiBar equal to 1 indicates Asymptotic Dependence, in
which case the limiting value of Chi gives a measure of the strength of
dependence in this class.  A limiting value of ChiBar of less than 1
indicates Asymptotic Independence in which case Chi is irrelevant and the
limiting value of ChiBar gives a measure of the strength of dependence.
</p>
<p>The plot and ggplot methods show the ChiBar and Chi functions.  In the case of the
confidence interval for ChiBar excluding the value 1 for all of the largest
quantiles, the plot of the Chi function is shown in grey.
</p>


<h3>Value</h3>

<p>An object of class <code>chi</code> containing the following.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>chi</code></td>
<td>
<p>Values of chi and their estimated upper and lower confidence
limits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chibar </code></td>
<td>
<p>Values of chibar and their estimated upper and lower
confidence limits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quantile</code></td>
<td>
<p>The quantiles at which chi and chi-bar
were evaluated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chiulb, chibarulb</code></td>
<td>
<p>Upper and lower bounds for chi and
chi-bar.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>When the data contain ties, the values of chi and chibar are
calculated by assigning distinct ranks to tied values using the <code>rank</code>
function with argument <code>ties.method = "first"</code>.  This results in the
values of chi and chibar being sensitive to the order in which the tied
values appear in the data.
</p>
<p>The code is a fairly simple reorganization of code written by Janet E.
Heffernan and Alec Stephenson and which appears in the <code>chiplot</code>
function in the <code>evd</code> package.
</p>


<h3>Author(s)</h3>

<p>Janet E. Heffernan, Alec Stephenson, Harry Southworth
</p>


<h3>References</h3>

<p>S. Coles, J. E. Heffernan and J. A. Tawn, Dependence measures
for extreme values analyses, Extremes, 2, 339 â€“ 365, 1999.
</p>
<p>A. G. Stephenson. evd: Extreme Value Distributions, R News, 2, 2002.
</p>


<h3>See Also</h3>

<p><code>MCS</code>, <code>rank</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">

D &lt;- liver[liver$dose == "D",]
chiD &lt;- chi(D[, 5:6])
par(mfrow=c(1,2))
ggplot(chiD)

A &lt;- liver[liver$dose == "A",]
chiA &lt;- chi(A[, 5:6])
# here the limiting value of chi bar(u) lies away from one so the chi plot is
# not relevant and is plotted in grey
ggplot(chiA) 



</code></pre>


</div>