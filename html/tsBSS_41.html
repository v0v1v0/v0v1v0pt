<div class="container">

<table style="width: 100%;"><tr>
<td>lbtest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Modified Ljung-Box Test and Volatility Clustering Test for Time Series.
</h2>

<h3>Description</h3>

<p>Modified Ljung-Box test and volatility clustering test for time series. Time series can be univariate or multivariate. The modified Ljung-Box test checks whether there is linear autocorrelation in the time series. The volatility clustering test checks whether the time series has squared autocorrelation, which would indicate a presence of volatility clustering.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lbtest(X, k, type = c("squared", "linear"))

## S3 method for class 'lbtest'
print(x, digits = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A numeric vector/matrix or a univariate/multivariate time series object of class <code>ts</code>, <code>xts</code> or <code>zoo</code>. Missing values are not allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>A vector of lags.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>The type of the autocorrelation test. Options are Modified Ljung-Box test (<code>"linear"</code>) or volatility clustering test (<code>"squared"</code>) autocorrelation. Default is <code>"squared"</code>.</p>
</td>
</tr>
</table>
<p>In methods for class 'lbtest' only:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class lbtest</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>The number of digits when printing an object of class lbtest. Default is 3</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed to or from methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Assume all the individual time series <code class="reqn">X_i</code> in <code class="reqn">\bf X</code> with <code class="reqn">T</code> observations are scaled to have variance 1.
</p>
<p>Then the modified Ljung-Box test statistic for testing the existence of linear autocorrelation in <code class="reqn">X_i</code> (<code>option = "linear"</code>) is
</p>
<p style="text-align: center;"><code class="reqn">T \sum_{j \in k} \left(\sum_{t=1}^T (X_{it} X_{i, t + j})/(T - j)\right)^2/V_{j}.</code>
</p>

<p>Here  
</p>
<p style="text-align: center;"><code class="reqn">V_{j} = \sum_{t=1}^{n-j}\frac{x_t^2 x_{t+j}^2}{n-j} + 2 \sum_{k=1}^{n-j-1} \frac{n-k}{n} \sum_{s=1}^{n-k-j}\frac{x_s x_{s+j }x_{s+k} x_{s+k+j}}{n-k-j}.</code>
</p>

<p>where <code class="reqn">t = 1, \ldots, n - j</code>, <code class="reqn">k = 1, \ldots, n - j - 1</code> and <code class="reqn">s = 1, \ldots, n - k - j</code>.
</p>
<p>The volatility clustering test statistic (<code>option = "squared"</code>) is
</p>
<p style="text-align: center;"><code class="reqn">T \sum_{j \in k} \left(\sum_{t=1}^T (X_{it}^2 X_{i, t + j}^2)/(T - j) - 1\right)^2</code>
</p>

<p>Test statistic related to each time series <code class="reqn">X_i</code> is then compared to <code class="reqn">\chi^2</code>-distribution with <code>length(k)</code> degrees of freedom, and the corresponding p-values are produced. Small p-value indicates the existence of autocorrelation.
</p>


<h3>Value</h3>

<p>A list of class 'lbtest' containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>TS</code></td>
<td>
<p>The values of the test statistic for each component of X as a vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_val</code></td>
<td>
<p>The p-values based on the test statistic for each component of X as a vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xname</code></td>
<td>
<p>The name of the data used as a character string.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varnames</code></td>
<td>
<p>The names of the variables used as a character string vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>The lags used for testing the serial autocorrelation as a vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>The total number of lags used for testing the serial autocorrelation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>The type of the autocorrelation test.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Markus Matilainen, Jari Miettinen
</p>


<h3>References</h3>

<p>Miettinen, M., Matilainen, M., Nordhausen, K. and Taskinen, S. (2020), <em>Extracting Conditionally Heteroskedastic Components Using Independent Component Analysis</em>, Journal of Time Series Analysis, 41, 293â€“311.
</p>


<h3>See Also</h3>

<p><code>FixNA</code>, <code>gFOBI</code>, <code>gJADE</code>, <code>vSOBI</code>, <code>gSOBI</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">if(require("stochvol")) {
n &lt;- 10000
s1 &lt;- svsim(n, mu = -10, phi = 0.95, sigma = 0.1)$y
s2 &lt;- rnorm(n)
S &lt;- cbind(s1, s2)

lbtest(S, 1:3, type = "squared")
# First p-value should be very close to zero, as there exists stochastic volatility
}
</code></pre>


</div>