<div class="container">

<table style="width: 100%;"><tr>
<td>gridFiltration</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Persistence Diagram of a function over a Grid
</h2>

<h3>Description</h3>

<p>The function <code>gridFiltration</code> computes the Persistence Diagram of a filtration of sublevel sets (or superlevel sets) of a function evaluated over a grid of points in arbitrary dimension <code>d</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gridFiltration(
    X = NULL, FUN = NULL, lim = NULL, by = NULL, FUNvalues = NULL,
    maxdimension = max(NCOL(X), length(dim(FUNvalues))) - 1,
    sublevel = TRUE, printProgress = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>an <code class="reqn">n</code> by <code class="reqn">d</code> matrix of coordinates, used by the function <code>FUN</code>, where <code class="reqn">n</code> is the number of points stored in <code>X</code> and <code class="reqn">d</code> is the dimension of the space. NULL if this option is not used. The default value is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FUN</code></td>
<td>

<p>a function whose inputs are 1) an <code class="reqn">n</code> by <code class="reqn">d</code> matrix of coordinates <code>X</code>, 2) an <code class="reqn">m</code> by <code class="reqn">d</code> matrix of coordinates <code>Grid</code>, 3) an optional smoothing parameter, and returns a numeric vector of length <code class="reqn">m</code>. For example see <code>distFct</code>,  <code>kde</code>, and <code>dtm</code>  which compute the distance function, the kernel density estimator and the distance to measure, over a grid of points using the input <code>X</code>. Note that <code>Grid</code> is not an input of <code>gridFiltration</code>, but is automatically computed by the function using <code>lim</code>, and <code>by</code>. NULL if this option is not used. The default value is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lim</code></td>
<td>

<p>a <code class="reqn">2</code> by <code class="reqn">d</code> matrix, where each column specifying the range of each dimension of the grid, over which the function <code>FUN</code> is evaluated. NULL if this option is not used. The default value is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by</code></td>
<td>

<p>either a number or a vector of length <code class="reqn">d</code> specifying space between points of the grid in each dimension. If a number is given, then same space is used in each dimension. NULL if this option is not used. The default value is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FUNvalues</code></td>
<td>

<p>an <code class="reqn">m1 * m2 * ... * md</code> array of function values over <code class="reqn">m1 * m2 * ... * md</code> grid, where <code class="reqn">mi</code> is the number of scales of grid on <code class="reqn">ith</code> dimension. NULL if this option is not used. The default value is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxdimension</code></td>
<td>

<p>a number that indicates the maximum dimension of the homological features to compute: <code>0</code> for connected components, <code>1</code> for loops, <code>2</code> for voids and so on. The default value is <code class="reqn">d - 1</code>, which is (dimension of embedding space - 1).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sublevel</code></td>
<td>

<p>a logical variable indicating if the Persistence Diagram should be computed for sublevel sets (<code>TRUE</code>) or superlevel sets (<code>FALSE</code>) of the function. The default value is <code>TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>printProgress</code></td>
<td>

<p>if <code>TRUE</code> a progress bar is printed. The default value is <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>additional parameters for the function <code>FUN</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If the values of <code>X</code>, <code>FUN</code> are set, then <code>FUNvalues</code> should be <code>NULL</code>. In this case, <code>gridFiltration</code> evaluates the function <code>FUN</code> over a grid. If the value of <code>FUNvalues</code> is set, then <code>X</code>, <code>FUN</code> should be <code>NULL</code>. In this case, <code>FUNvalues</code> is used as function values over the grid.
</p>
<p>Once function values are either computed or given, <code>gridFiltration</code> constructs a filtration by triangulating the grid and considering the simplices determined by the values of the function of dimension up to <code>maxdimension+1</code>.
</p>


<h3>Value</h3>

<p>The function <code>gridFiltration</code> returns a list with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>cmplx</code></td>
<td>

<p>a list representing the complex. Its i-th element represents the vertices of i-th simplex.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>values</code></td>
<td>

<p>a vector representing the filtration values. Its i-th element represents the filtration value of i-th simplex.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>increasing</code></td>
<td>

<p>a logical variable indicating if the filtration values are in increasing order (<code>TRUE</code>) or in decreasing order (<code>FALSE</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coordinates</code></td>
<td>

<p>only if both <code>lim</code> and <code>by</code> are not <code>NULL</code>: a matrix representing the coordinates of vertices. Its i-th row represents the coordinate of i-th vertex.
</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The user can decide to use either the C++ library <a href="https://project.inria.fr/gudhi/software/">GUDHI</a>, <a href="https://www.mrzv.org/software/dionysus/">Dionysus</a>, or <a href="https://bitbucket.org/phat-code/phat/">PHAT</a>. See references.
</p>
<p>Since dimension of simplicial complex from grid points in <code class="reqn">R^d</code> is up to <code class="reqn">d</code>, homology of dimension <code class="reqn">\ge d</code> is trivial. Hence setting <code>maxdimension</code> with values <code class="reqn">\ge d</code> is equivalent to <code>maxdimension=d-1</code>.
</p>


<h3>Author(s)</h3>

<p>Brittany T. Fasy, Jisu Kim, and Fabrizio Lecci
</p>


<h3>References</h3>

<p>Fasy B, Lecci F, Rinaldo A, Wasserman L, Balakrishnan S, Singh A (2013). "Statistical Inference For Persistent Homology." (arXiv:1303.7117). Annals of Statistics.
</p>
<p>Morozov D (2007). "Dionysus, a C++ library for computing persistent homology." <a href="https://www.mrzv.org/software/dionysus/">https://www.mrzv.org/software/dionysus/</a>
</p>
<p>Bauer U, Kerber M, Reininghaus J (2012). "PHAT, a software library for persistent homology." <a href="https://bitbucket.org/phat-code/phat/">https://bitbucket.org/phat-code/phat/</a>
</p>


<h3>See Also</h3>

<p><code>summary.diagram</code>, <code>plot.diagram</code>,
<code>distFct</code>, <code>kde</code>, <code>kernelDist</code>, <code>dtm</code>,
<code>alphaComplexDiag</code>, <code>alphaComplexDiag</code>, <code>ripsDiag</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># input data
n &lt;- 10
XX &lt;- circleUnif(n)

## Ranges of the grid
Xlim &lt;- c(-1, 1)
Ylim &lt;- c(-1, 1)
lim &lt;- cbind(Xlim, Ylim)
by &lt;- 1

#Distance Function Diagram of the sublevel sets
FltGrid &lt;- gridFiltration(
  XX, distFct, lim = lim, by = by, sublevel = TRUE, printProgress = TRUE) 

</code></pre>


</div>