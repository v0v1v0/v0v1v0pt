<div class="container">

<table style="width: 100%;"><tr>
<td>fmri_pval_comparison_2d</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>2D comparison visualization between the p-values</h2>

<h3>Description</h3>

<p>a plot arrangement method, which uses <code>gridExtra</code> to combine multiple 
2D plots of the fMRI data together. This can bring convenience for users to compare 
the result of different statistical tests based on the p values they provide
</p>


<h3>Usage</h3>

<pre><code class="language-R">fmri_pval_comparison_2d(
  pval_ls,
  pval_name_ls,
  axis_i_lses,
  hemody_data = NULL,
  mask,
  p_threshold = 0.05,
  legend_show = TRUE,
  method = "scale_p",
  color_pal = "YlOrRd",
  multi_pranges = TRUE,
  mask_width = 1.5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pval_ls</code></td>
<td>
<p>a list. Each element is a 3D array of p-values data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval_name_ls</code></td>
<td>
<p>a list with the element as name for the p-values data provided in 'pval_ls'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis_i_lses</code></td>
<td>
<p>a list with 3 numeric elements or a list of lists. If the elements are numeric, 
they would specify indices of slice for the three direction. 
If any direction of the slice need not to be shown, make it as NULL for that element. 
If elements are lists, each list provides specified cuts for corresponding 3D p-values data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hemody_data</code></td>
<td>
<p>a parameter to have the plot with/without hemodynamic contour. The default is NULL to make the plot 
without hemodynamic contour, otherwise assign a 3D array of the hemodynamic data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mask</code></td>
<td>
<p>a 3D nifti or 3D array of data to show the shell of the brain</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_threshold</code></td>
<td>
<p>NULL or a numeric value that can be selected randomly below 0.05 to 
drop all p-values above the threshold. If 'low5_percent' method is used, 
make 'p_threshold' as NULL. The default is 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend_show</code></td>
<td>
<p>a logical parameter to specify whether the final plot has legend
for all the subplots or the shared legend for all the subplots. The default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a string that represents method for the plot. 
There are 3 options: 'min_max', 'scale_p' and 'low5_percent'. The default is 'scale_p'. 
'min_max' is to draw plot based on the color scale of the minimum and maximum of the p-values; 
'scale_p' is to draw the plot with fixed color scale for fixed range of p-values; 
'low5_percent' is to draw the plot for the smallest 5 percent of p-values
when all the p-values are not significant</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color_pal</code></td>
<td>
<p>the name of the color palettes provided by <code>RColorBrewer</code> The default is "YlOrRd".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>multi_pranges</code></td>
<td>
<p>an option under 'scale_p' method to decide whether there are at most 9 colors 
in the legend for the ranges of p-values, or at most 4 colors. 
The default is TRUE, choosing the larger number of colors for the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mask_width</code></td>
<td>
<p>a numeric value to specify the width of mask contour. The default is 1.5.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>fmri_pval_comparison_2d</code> is used to combine and compare the 2D plots for different 3D arrays of p-values.
The plots in each row are generated by one specific 3D p value data. 
The first column of the integrated plot specifies the name of the 3D p value data (for generation of 
the plots in that row). The rest of the three columns are the plots from sagittal, coronal and 
axial view for each 3D p value data.
</p>


<h3>Value</h3>

<p>a combination plot arranged by <code>gridExtra</code>
</p>


<h3>Author(s)</h3>

<p>SOCR team &lt;<a href="http://socr.umich.edu/people/">http://socr.umich.edu/people/</a>&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R"># sample 3D data of mask provided by the package
dim(mask)
# sample 3D p value provided by the package
dim(phase2_pval)
dim(phase3_pval)


fmri_pval_comparison_2d(list(phase2_pval, phase3_pval), 
                        list('phase2_pval', 'phase3_pval'),
                        list(list(40, 26, 33), list(40, 26, 33)), 
                        hemody_data = NULL, 
                        mask = mask, p_threshold = 0.05, 
                        legend_show = FALSE, method = 'scale_p',
                        color_pal = "YlOrRd", multi_pranges=TRUE)
                  
</code></pre>


</div>