<div class="container">

<table style="width: 100%;"><tr>
<td>seqCompare</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>BIC and Likelihood ratio test for comparing two groups</h2>

<h3>Description</h3>

<p>Functions <code>seqCompare</code> and <code>dissCompare</code> compute the likelihood ratio test (LRT) and Bayesian Information Criterion (BIC) difference for comparing two groups within each of a series of sets. <code>seqCompare</code> compares two groups of sequences. <code>dissCompare</code> is more general and compares any two groups of data represented by a pairwise dissimilarity matrix. Functions <code>seqBIC</code> and <code>seqLRT</code> are aliases of <code>seqCompare</code> that return only the <code class="reqn">\Delta</code>BIC or the LRT.
</p>


<h3>Usage</h3>

<pre><code class="language-R">seqCompare(seqdata, seqdata2=NULL, group=NULL, set=NULL,
    s=100, seed=36963, stat="all", squared="LRTonly",
    weighted=TRUE, opt=NULL, BFopt=NULL, method, ...)

dissCompare(diss, group, set=NULL,
    s=100, seed=36963, stat="all", squared="LRTonly",
    weighted=TRUE, weights=NULL, BFopt=NULL)

seqLRT(seqdata, seqdata2=NULL, group=NULL, set=NULL, s=100,
    seed=36963, squared="LRTonly", weighted=TRUE, opt=NULL,
    BFopt=NULL, method, ...)

seqBIC(seqdata, seqdata2=NULL, group=NULL, set=NULL, s=100,
    seed=36963, squared="LRTonly", weighted=TRUE, opt=NULL,
    BFopt=NULL, method, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>seqdata</code></td>
<td>
<p>Either a state sequence object of class <code>stslist</code> created with <code>seqdef</code> or a list of state sequence objects, e.g., <code>list(cohort1.seq,cohort2.seq,cohort3.seq)</code>.


</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seqdata2</code></td>
<td>
<p>Either a state sequence object of class <code>stslist</code> or a list of state sequence objects. Must be <code>NULL</code> when <code>group</code> is not <code>NULL</code>. If not <code>NULL</code>, must be of same type than <code>seqdata</code>. See details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diss</code></td>
<td>
<p>Matrix or distance object. Symmetric pairwise dissimilarities.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>Vector of length equal to number of sequences in <code>seqdata</code>. A dichotomous grouping variable. See details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>set</code></td>
<td>
<p>Vector of length equal to number of sequences in <code>seqdata</code>. Variable defining the sets. See details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>Integer. Default 100. The size of random samples of sequences. When 0, no sampling is done.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Integer. Default 36963. Using the same seed number guarantees the same results
each time. Set <code>s=NULL</code> if you don't want to set a seed.
The random generator can be chosen with <code>RNGkind</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stat</code></td>
<td>
<p>String. The requested statistics. One of <code>"LRT"</code>, <code>"BIC"</code>, or <code>"all"</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>squared</code></td>
<td>
<p>Logical. Should squared distances be used? Can also be <code>"LRTonly"</code>, in which case the distances to the centers are computed using non-squared distances and LRT is computed with squared distances.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weighted</code></td>
<td>
<p>Logical or String. Should weights be taken into account when available? Can also be <code>"by.group"</code>, in which case weights are used and normalized to respect group sizes.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>Vector of length equal to number of row of <code>diss</code>. Case weights. If <code>NULL</code> weights are set as <code>rep(1, nrow(diss))</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opt</code></td>
<td>
<p>Integer or <code>NULL</code>. Either 1 or 2. Computation option. When 1, the distance matrix is computed successively for each pair of samples of size s. When 2, the distances are computed only once for each pair of sets of observed sequences and the distances for the samples are extracted from that matrix. When <code>NULL</code> (default), 1 is chosen when the sum of sizes of the two groups is larger than 2*s and 2 otherwise.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BFopt</code></td>
<td>
<p>Integer or <code>NULL</code>. Either 1 or 2. Applies only when BIC is computed on multiple samples. When 1 the displayed Bayes Factor (BF) is the averaged BF. When 2, the displayed BF is obtained from the averaged BIC. When <code>NULL</code> both BFs are displayed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>String. Method for computing sequence distances. See documentation for <code>seqdist</code>. Additional arguments may be required depending on the method chosen.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to <code>seqdist</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>group</code> and <code>set</code> arguments can only be used when <code>seqdata</code> is an <code>stslist</code> object (a state sequence object).
</p>
<p>When <code>seqdata</code> and <code>seqdata2</code> are both provided, the LRT and Delta BIC statistics are computed for comparing these two sets. In that case both <code>group</code> and <code>set</code> should be left at their default <code>NULL</code> value.
</p>
<p>When <code>seqdata</code> is a list of <code>stslist</code> objects, <code>seqdata2</code> must be a list of the same number of <code>stslist</code> objects.
</p>
<p>The default option <code>squared="LRTonly"</code> corresponds to the initial proposition of Liao and Fasang (2021). With that option, the distances to the virtual center are obtained from the pairwise non-squared dissimilarities and the resulting distances to the virtual center are  squared when computing the LRT (which is in turn used to compute <code class="reqn">\Delta</code>BIC). With <code>squared=FALSE</code>, non-squared distances are used in both cases, and with <code>squared=TRUE</code>, squared distances are used in both cases.
</p>
<p>The computation is based on the pairwise distances between the sequences. The <code>opt</code> argument permits to choose between two strategies. With <code>opt=1</code>, the matrix of distances is computed successively for each pair of samples of size s. When <code>opt=2</code>, the matrix of distances is computed once for the observed sequences and the distances for the samples are extracted from that matrix. Option 2 is often more efficient, especially for distances based on spells. It may be slower for methods such as OM or LCS when the number of observed sequences becomes large.
</p>


<h3>Value</h3>

<p>Function <code>seqLRT</code> (and seqCompare with the default <code>"LRT"</code> stat value) outputs a matrix with two columns, <var>LRT</var> and <var>p.value</var>.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>LRT</code></td>
<td>
<p>This is the likelihood ratio test statistic for comparing the two groups.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>This is the upper tail probability associated with the LRT.
</p>
</td>
</tr>
</table>
<p>Function <code>seqBIC</code> (and <code>seqLRT</code> with the <code>"BIC"</code> stat value) outputs a matrix with two columns, <code>Delta BIC</code> and <code>BF</code>.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Delta BIC</code></td>
<td>
<p>This is the difference between BIC values of the model that does not distinguish the two groups and the model taking account of the distinction.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Bayes Factor</code></td>
<td>
<p>This is the Bayes factor associated with the BIC difference.
</p>
</td>
</tr>
</table>
<p><code>seqCompare</code> and <code>dissCompare</code> with <code>stat="all"</code> return a matrix with all four indicators.
</p>
<p>When <code>set=NULL</code>, the matrix has a single row. Otherwise, there is one row per distinct <code>set</code> value.
</p>


<h3>Author(s)</h3>

<p>Tim Liao and Gilbert Ritschard</p>


<h3>References</h3>

<p>Tim F. Liao &amp; Anette E. Fasang (2021). "Comparing Groups of Life Course Sequences Using the Bayesian Information Criterion and the Likelihood Ratio Test.‚Äù <em>Sociological Methodology</em>, 55 (1), 44-85. <a href="https://doi.org/10.1177/0081175020959401">doi:10.1177/0081175020959401</a>.
</p>


<h3>See Also</h3>

<p><code>dissassoc</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## biofam data set
data(biofam)
biofam.lab &lt;- c("Parent", "Left", "Married", "Left+Marr",
                "Child", "Left+Child", "Left+Marr+Child", "Divorced")
alph &lt;- seqstatl(biofam[10:25])
## To illustrate, we use only a sample of 150 cases
set.seed(10)
biofam &lt;- biofam[sample(nrow(biofam),150),]
biofam.seq &lt;- seqdef(biofam, 10:25, alphabet=alph, labels=biofam.lab)

## Defining the grouping variable
lang &lt;- as.vector(biofam[["plingu02"]])
lang[is.na(lang)] &lt;- "unknown"
lang &lt;- factor(lang)

## Chronogram by language group
seqdplot(biofam.seq, group=lang)

## Extracting the sequence subsets by language
lev &lt;- levels(lang)
l &lt;- length(lev)
seq.list &lt;- list()
for (i in 1:l){
  seq.list[[i]] &lt;- biofam.seq[lang==lev[i],]
}

seqCompare(list(seq.list[[1]]),list(seq.list[[2]]), stat="all", method="OM", sm="CONSTANT")
seqBIC(biofam.seq, group=biofam$sex, method="HAM")
seqLRT(biofam.seq, group=biofam$sex, set=lang, s=80, method="HAM")

</code></pre>


</div>