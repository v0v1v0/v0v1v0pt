<div class="container">

<table style="width: 100%;"><tr>
<td>sub.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>sub.test function
This function calculates the simulated p-value of comparing the trend in subsamples from two independent samples.</h2>

<h3>Description</h3>

<p>sub.test function
This function calculates the simulated p-value of comparing the trend in subsamples from two independent samples.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sub.test(sam1, sam2, fn.rep2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sam1, </code></td>
<td>
<p>the first sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sam2, </code></td>
<td>
<p>the second sample</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fn.rep2</code></td>
<td>
<p>the total number of bootstrap repetitions needed for calculating the simulated p-value.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>critical.value the critical value of the test based on the alpha level provided
</p>
<p>chi-stat the chisqure type test statistics value from the sample provided.
</p>
<p>pvalue the simulated p-value.
</p>


<h3>References</h3>

<p>Wang, Y., Stapleton, A. E., &amp; Chen, C. (2018). Two-sample nonparametric stochastic order inference with an application in plant physiology. Journal of Statistical Computation and Simulation, 88(14), 2668-2683.
</p>


<h3>Examples</h3>

<pre><code class="language-R">attach(seedwt.multi.subsample)
Lev.TN&lt;-levels(TreatmentName);
Lev.Line&lt;-levels(Line);
n&lt;-dim(seedwt.multi.subsample)[1];
level.show=c(1:8);fn.rep3=10^2;
line.name&lt;-Lev.Line[1]; t1.name&lt;-Lev.TN[1];t2.name&lt;-Lev.TN[3];
### To compare the GA treatment and the PACGA treatment from line B73
par(mfrow=c(1,2))
idx&lt;-subset((TreatmentName==t1.name)*(Line==line.name)*(1:n),Env %in% level.show)
idx2&lt;-subset((TreatmentName==t2.name)*(Line==line.name)*(1:n),Env %in% level.show)
boxplot(seedwt[idx]~Env[idx],xlab="ENV levels",ylab=paste('seedwt from',t1.name),
         ylim=c(0,12),cex.lab=1.5,cex.axis=1.8);
boxplot(seedwt[idx2]~Env[idx2], xlab="ENV levels",ylab=paste('seedwt from',t2.name),
         cex.lab=1.5,cex.axis=1.8);
mtext( paste ("Line Name:",line.name), side = 3,outer = TRUE, cex = 2.2,line = -3)
temp.sw1&lt;-seedwt[idx];lab&lt;-Env[idx]; uni.lab&lt;-unique(lab)
sam.1&lt;-lapply(1:length(uni.lab), function(x) temp.sw1[lab==uni.lab[x]])
temp.sw2&lt;-seedwt[idx2];lab2&lt;-Env[idx2]; uni.lab2&lt;-unique(lab2)
sam.2&lt;-lapply(1:length(uni.lab2), function(x) temp.sw2[lab2==uni.lab2[x]])
print(paste("working with line ",line.name,'and treatment',t1.name ,'vs',t2.name ))
resu&lt;-sub.test(sam.1,sam.2,fn.rep2=fn.rep3);
dev.off()
## This will show a similar result as the first experiment of section 5 in the paper.
</code></pre>


</div>