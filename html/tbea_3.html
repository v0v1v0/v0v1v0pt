<div class="container">

<table style="width: 100%;"><tr>
<td>concatNexus</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>concatNexus: Function for concatenation of nexus matrices both morphological and molecular</h2>

<h3>Description</h3>

<p>concatNexus: Function for concatenation of nexus matrices both morphological and molecular
</p>


<h3>Usage</h3>

<pre><code class="language-R">concatNexus(
  matrices = NULL,
  pattern,
  path,
  filename,
  morpho = FALSE,
  morphoFilename = NULL,
  sumFilename
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>matrices</code></td>
<td>
<p>A vector of type 'character' with paths to the nexus alignments or their file names. If <code>morphoFilename</code> is non-null, either the path to the morphological partition or its file name must be included too. The default is NULL and it must be defined if none of <code>pattern</code> and <code>path</code> are included.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pattern</code></td>
<td>
<p>A vector of type 'character' and length one containing the text pattern to identify the alignments of interest. It would be tipically be some suffix and/or file extension (see examples).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>path</code></td>
<td>
<p>A vector of type 'character' and length one pointing to the directory where the matrices are located. It is used in combination with <code>pattern</code> in order to build a path to each matrix file (see examples).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filename</code></td>
<td>
<p>A vector of type 'character' and length one with the file name (or path and file name) for the concatenated output matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>morpho</code></td>
<td>
<p>A vector of type 'logical' and length one indicating whether a morphological matrix is included in the concatenation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>morphoFilename</code></td>
<td>
<p>A vector of type 'character' and length one with the file name or path to the morphological nexus matrix. Needed if <code>morpho = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sumFilename</code></td>
<td>
<p>A vector of type 'character' and length one with the file name or path to the summary information of partition start and end positions. Useful for specifying concatenated analyses in MrBayes where each partition in the matrix might have its own substitution model.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function will concatenate matrices in nexus format (mandatory) and write to the disk the output and summary information on the partitions. It requires that the input matrices all share the same taxa in the same positions.
</p>


<h3>Value</h3>

<p>This function writes to the disk two files, one with the concatenated matrix and one with the summary information on partition positions in the complete matrix.
</p>


<h3>Author(s)</h3>

<p>Gustavo A. Ballen
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Concatenate all the matrices in a given path,
# ending with the pattern 'aligned.nex', including a morphological matrix
# also defined with a pattern
## Not run: 
path &lt;- "sequences"
pattern &lt;- "aligned.nex$"

concatNexus(matrices = NULL, pattern = pattern,
            filename = paste(path, "concatenatedMolmorph.nexus", sep = "/"),
            path = path, 
            morpho = TRUE,
            morphoFilename = paste(path, grep(pattern = "morfologia",
                                              x = dir(path, pattern), value = TRUE),
                                   sep = "/"),
            sumFilename = "partitions.txt")

## End(Not run)
# Concatenate arbitrary matrices in the working directory,
# including a morphological matrix, return a concatenated file in the same dir
## Not run: 
concatNexus(matrices = c("coi.nex", "rag1.nex", "cytb.nex", "morphology.nex"),
            filename = "concatenatedMolmorph.nexus", 
            morpho = TRUE,
            morphoFilename = "morphology.nex",
            sumFilename = "partitions.txt")

## End(Not run)
</code></pre>


</div>