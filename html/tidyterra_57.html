<div class="container">

<table style="width: 100%;"><tr>
<td>geom_spat_contour</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot <code>SpatRaster</code> contours</h2>

<h3>Description</h3>

<p>These geoms create contours of <code>SpatRaster</code> objects.  To specify a valid
surface, you should specify the layer on <code>aes(z = layer_name)</code>, otherwise all
the layers would be consider for creating contours. See also <strong>Facets</strong>
section.
</p>
<p>The underlying implementation is based on <code>ggplot2::geom_contour()</code>.
</p>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt="[Experimental]"></a> <code>geom_spatraster_contour_text()</code> creates
labeled contours and it is implemented on top of <code>isoband::isolines_grob()</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">geom_spatraster_contour(
  mapping = NULL,
  data,
  ...,
  maxcell = 5e+05,
  bins = NULL,
  binwidth = NULL,
  breaks = NULL,
  na.rm = TRUE,
  show.legend = NA,
  inherit.aes = TRUE
)

geom_spatraster_contour_text(
  mapping = NULL,
  data,
  ...,
  maxcell = 5e+05,
  bins = NULL,
  binwidth = NULL,
  breaks = NULL,
  size.unit = "mm",
  label_format = scales::label_number(),
  label_placer = isoband::label_placer_minmax(),
  na.rm = TRUE,
  show.legend = NA,
  inherit.aes = TRUE
)

geom_spatraster_contour_filled(
  mapping = NULL,
  data,
  ...,
  maxcell = 5e+05,
  bins = NULL,
  binwidth = NULL,
  breaks = NULL,
  na.rm = TRUE,
  show.legend = NA,
  inherit.aes = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mapping</code></td>
<td>
<p>Set of aesthetic mappings created by <code>ggplot2::aes()</code>. See
<strong>Aesthetics</strong> specially in the use of <code>fill</code> aesthetic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A <code>SpatRaster</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments passed on to <code>layer()</code>'s <code>params</code> argument. These
arguments broadly fall into one of 4 categories below. Notably, further
arguments to the <code>position</code> argument, or aesthetics that are required
can <em>not</em> be passed through <code>...</code>. Unknown arguments that are not part
of the 4 categories below are ignored.
</p>

<ul>
<li>
<p> Static aesthetics that are not mapped to a scale, but are at a fixed
value and apply to the layer as a whole. For example, <code>colour = "red"</code>
or <code>linewidth = 3</code>. The geom's documentation has an <strong>Aesthetics</strong>
section that lists the available options. The 'required' aesthetics
cannot be passed on to the <code>params</code>. Please note that while passing
unmapped aesthetics as vectors is technically possible, the order and
required length is not guaranteed to be parallel to the input data.
</p>
</li>
<li>
<p> When constructing a layer using
a <code style="white-space: pre;">⁠stat_*()⁠</code> function, the <code>...</code> argument can be used to pass on
parameters to the <code>geom</code> part of the layer. An example of this is
<code>stat_density(geom = "area", outline.type = "both")</code>. The geom's
documentation lists which parameters it can accept.
</p>
</li>
<li>
<p> Inversely, when constructing a layer using a
<code style="white-space: pre;">⁠geom_*()⁠</code> function, the <code>...</code> argument can be used to pass on parameters
to the <code>stat</code> part of the layer. An example of this is
<code>geom_area(stat = "density", adjust = 0.5)</code>. The stat's documentation
lists which parameters it can accept.
</p>
</li>
<li>
<p> The <code>key_glyph</code> argument of <code>layer()</code> may also be passed on through
<code>...</code>. This can be one of the functions described as
key glyphs, to change the display of the layer in the legend.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxcell</code></td>
<td>
<p>positive integer. Maximum number of cells to use for
the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bins</code></td>
<td>
<p>Number of contour bins. Overridden by <code>breaks</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binwidth</code></td>
<td>
<p>The width of the contour bins. Overridden by <code>bins</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>
<p>One of:
</p>

<ul>
<li>
<p> Numeric vector to set the contour breaks
</p>
</li>
<li>
<p> A function that takes the range of the data and binwidth as input
and returns breaks as output. A function can be created from a formula
(e.g. ~ fullseq(.x, .y)).
</p>
</li>
</ul>
<p>Overrides <code>binwidth</code> and <code>bins</code>. By default, this is a vector of length
ten with <code>pretty()</code> breaks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>If <code>TRUE</code>, the default, missing values are silently removed. If
<code>FALSE</code>, missing values are removed with a warning.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.legend</code></td>
<td>
<p>logical. Should this layer be included in the legends?
<code>NA</code>, the default, includes if any aesthetics are mapped.
<code>FALSE</code> never includes, and <code>TRUE</code> always includes.
It can also be a named logical vector to finely select the aesthetics to
display.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inherit.aes</code></td>
<td>
<p>If <code>FALSE</code>, overrides the default aesthetics, rather
than combining with them.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size.unit</code></td>
<td>
<p>How the <code>size</code> aesthetic is interpreted: as millimetres
(<code>"mm"</code>, default), points (<code>"pt"</code>), centimetres (<code>"cm"</code>), inches (<code>"in"</code>),
or picas (<code>"pc"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label_format</code></td>
<td>
<p>One of:
</p>

<ul>
<li> <p><code>NULL</code> for no labels. This produced the same result than
<code>geom_spatraster_contour()</code>.
</p>
</li>
<li>
<p> A character vector giving labels (must be same length as the breaks
produced by <code>bins</code>, <code>binwidth</code>, or <code>breaks</code>).
</p>
</li>
<li>
<p> A function that takes the breaks as input and returns labels as output,
as the default setup (<code>scales::label_number()</code>).
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label_placer</code></td>
<td>
<p>Function that controls how labels are placed along
the isolines. Uses <code>label_placer_minmax()</code> by default.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <a href="https://CRAN.R-project.org/package=ggplot2"><span class="pkg">ggplot2</span></a> layer
</p>


<h3>
<a href="https://CRAN.R-project.org/package=terra"><span class="pkg">terra</span></a> equivalent</h3>

<p><code>terra::contour()</code>
</p>


<h3>Aesthetics</h3>

<p><code>geom_spatraster_contour()</code> / <code>geom_spatraster_contour_text()</code> understands
the following aesthetics:
</p>

<ul>
<li> <p><code>alpha</code>
</p>
</li>
<li> <p><code>colour</code>
</p>
</li>
<li> <p><code>group</code>
</p>
</li>
<li> <p><code>linetype</code>
</p>
</li>
<li> <p><code>linewidth</code>
<code>geom_spatraster_contour_text()</code> understands also:
</p>
</li>
<li> <p><code>size</code>
</p>
</li>
<li> <p><code>label</code>
</p>
</li>
<li> <p><code>family</code>
</p>
</li>
<li> <p><code>fontface</code>
</p>
</li>
</ul>
<p>Additionally, <code>geom_spatraster_contour_filled()</code> understands also the
following aesthetics, as well as the ones listed above:
</p>

<ul>
<li> <p><code>fill</code>
</p>
</li>
<li> <p><code>subgroup</code>
</p>
</li>
</ul>
<p>Check <code>ggplot2::geom_contour()</code> for more info on contours and
<code>vignette("ggplot2-specs", package = "ggplot2")</code> for an overview of the
aesthetics.
</p>


<h3>Computed variables</h3>

<p>These geom computes internally some variables that are available for use as
aesthetics, using (for example) <code style="white-space: pre;">⁠aes(color = after_stat(&lt;computed&gt;))⁠</code> (see
<code>ggplot2::after_stat()</code>).
</p>

<ul>
<li> <p><code>after_stat(lyr)</code>: Name of the layer.
</p>
</li>
<li> <p><code>after_stat(level)</code>: Height of contour. For contour lines, this is numeric
vector that represents bin boundaries. For contour bands, this is an
ordered factor that represents bin ranges.
</p>
</li>
<li> <p><code>after_stat(nlevel)</code>: Height of contour, scaled to maximum of 1.
</p>
</li>
<li> <p><code>after_stat(level_low)</code>, <code>after_stat(level_high)</code>,
<code>after_stat(level_mid)</code>: (contour bands only) Lower and upper bin
boundaries for each band, as well the mid point between the boundaries.
</p>
</li>
</ul>
<h3>Dropped variables</h3>


<ul><li> <p><code>z</code>: After contouring, the <code>z</code> values of individual data points are no
longer available.
</p>
</li></ul>
<h3>Coords</h3>

<p>When the <code>SpatRaster</code> does not present a crs (i.e.,
<code>terra::crs(rast) == ""</code>) the geom does not make any assumption on the
scales.
</p>
<p>On <code>SpatRaster</code> that have a crs, the geom uses <code>ggplot2::coord_sf()</code> to
adjust the scales. That means that also the
<strong><code>SpatRaster</code> may be reprojected</strong>.
</p>


<h3>Facets</h3>

<p>You can use <code> facet_wrap(~lyr)</code> for creating a faceted plot by each layer of
the <code>SpatRaster</code> object. See <code>ggplot2::facet_wrap()</code> for details.
</p>


<h3>See Also</h3>

<p><code>ggplot2::geom_contour()</code>.
</p>
<p>The <a href="https://CRAN.R-project.org/package=metR"><span class="pkg">metR</span></a> package also provides a set of alternative functions:
</p>

<ul>
<li> <p><code>metR::geom_contour2()</code>.
</p>
</li>
<li> <p><code>metR::geom_text_contour()</code> and <code>metR::geom_label_contour()</code>.
</p>
</li>
<li> <p><code>metR::geom_contour_tanaka()</code>.
</p>
</li>
</ul>
<p>Other <a href="https://CRAN.R-project.org/package=ggplot2"><span class="pkg">ggplot2</span></a> utils:
<code>autoplot.Spat</code>,
<code>fortify.Spat</code>,
<code>geom_spatraster()</code>,
<code>geom_spatraster_rgb()</code>,
<code>ggspatvector</code>,
<code>stat_spat_coordinates()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">

library(terra)

# Raster
f &lt;- system.file("extdata/volcano2.tif", package = "tidyterra")
r &lt;- rast(f)

library(ggplot2)

ggplot() +
  geom_spatraster_contour(data = r)


# Labelled
ggplot() +
  geom_spatraster_contour_text(
    data = r, breaks = c(110, 130, 160, 190),
    color = "grey10", family = "serif"
  )


ggplot() +
  geom_spatraster_contour(
    data = r, aes(color = after_stat(level)),
    binwidth = 1,
    linewidth = 0.4
  ) +
  scale_color_gradientn(
    colours = hcl.colors(20, "Inferno"),
    guide = guide_coloursteps()
  ) +
  theme_minimal()

# Filled with breaks
ggplot() +
  geom_spatraster_contour_filled(data = r, breaks = seq(80, 200, 10)) +
  scale_fill_hypso_d()

# Both lines and contours
ggplot() +
  geom_spatraster_contour_filled(
    data = r, breaks = seq(80, 200, 10),
    alpha = .7
  ) +
  geom_spatraster_contour(
    data = r, breaks = seq(80, 200, 2.5),
    color = "grey30",
    linewidth = 0.1
  ) +
  scale_fill_hypso_d()


</code></pre>


</div>