<div class="container">

<table style="width: 100%;"><tr>
<td>sim.bd.taxa.age</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>sim.bd.taxa.age: Simulating birth-death trees with a given age on a fixed number of extant taxa.</h2>

<h3>Description</h3>

<p>sim.bd.taxa.age simulates trees on n species with a (i) fixed time since origin or (ii) fixed time since the most recent common ancestor of the sampled species under the constant rate birth-death process. The method allows for incomplete sampling, i.e. each extant tip from a complete tree is included with a fixed probability. The tree is conditioned to have n tips after sampling and a fixed time since origin or since the most recent common ancestor of the sampled species.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim.bd.taxa.age(n, numbsim, lambda, mu, frac = 1, age, mrca = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Number of extant sampled tips.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numbsim</code></td>
<td>
<p>Number of trees to simulate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Speciation rate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>Extinction rate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frac</code></td>
<td>
<p> Each tip is included into the final tree with probability frac.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>age</code></td>
<td>
<p>The time since origin / most recent common ancestor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mrca</code></td>
<td>
<p>If mrca = FALSE: The time since the origin of the process. If mrca = TRUE: The time since the most recent common ancestor of the sampled species.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table><tr style="vertical-align: top;">
<td><code>treearray </code></td>
<td>
<p>Array of numbsim trees with n&gt;1 tips with a given age. The extinct lineages are not included.</p>
</td>
</tr></table>
<h3>Note</h3>

<p>The algorithm is fast for the critical process, lambda=mu.
</p>


<h3>Author(s)</h3>

<p>Tanja Stadler </p>


<h3>References</h3>

<p>T. Stadler: On incomplete sampling under birth-death models and connections to the sampling-based coalescent.
J. Theo. Biol. (2009) 261: 58-66.</p>


<h3>See Also</h3>

<p>sim.bd.age, sim.rateshift.taxa, sim.gsa.taxa, birthdeath.tree 
</p>


<h3>Examples</h3>

<pre><code class="language-R">n&lt;-10
lambda &lt;- 2.0
mu &lt;- 0.5
frac &lt;-0.6
numbsim&lt;-2
age&lt;-2

##
# Simulating numbsim reconstructed trees with n sampled species under a
# birth-death process with speciation rate lambda, extinction rate mu,
# sampling probability frac, and time age since origin:

sim.bd.taxa.age(n, numbsim, lambda, mu, frac, age, mrca = FALSE)

# Simulating numbsim reconstructed trees with n sampled species under a
# birth-death process with speciation rate lambda, extinction rate mu,
# sampling probability frac, and time age since the most recent 
# common ancestor of the extant sampled species:

sim.bd.taxa.age(n, numbsim, lambda, mu, frac, age, mrca = TRUE)

</code></pre>


</div>