<div class="container">

<table style="width: 100%;"><tr>
<td>seqdiff</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Position-wise discrepancy analysis between groups of sequences</h2>

<h3>Description</h3>

<p>The function analyses how the differences between groups of sequences evolve along the positions. It runs a sequence of  discrepancy analyses on sliding windows.
</p>


<h3>Usage</h3>

<pre><code class="language-R">seqdiff(seqdata, group, cmprange = c(0, 1),
  seqdist.args = list(method = "LCS", norm = "auto"), with.missing = FALSE,
  weighted = TRUE, squared = FALSE, seqdist_arg)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>seqdata</code></td>
<td>
<p>a state sequence object created with the <code>seqdef</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>The group variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cmprange</code></td>
<td>
<p>Vector of two integers: Time range of the sliding windows. Comparison at <code class="reqn">t</code> is computed on the window (<code class="reqn">t + </code><code>cmprange[1]</code>, <code class="reqn">t + </code><code>cmprange[2]</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seqdist.args</code></td>
<td>
<p>List of arguments passed to <code>seqdist</code> for computing the distances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>with.missing</code></td>
<td>
<p>Logical. If <code>TRUE</code>, missing values are considered as an additional state. If <code>FALSE</code> subsequences with missing values are removed from the analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weighted</code></td>
<td>
<p>Logical. If <code>TRUE</code>, <code>seqdiff</code> uses the weights specified in <code>seqdata</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>squared</code></td>
<td>
<p>Logical. If <code>TRUE</code> the dissimilarities are squared for computing the discrepancy.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seqdist_arg</code></td>
<td>
<p>Deprecated. Use <code>seqdist.args</code> instead.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function analyses how the part of discrepancy explained by the <code>group</code> variable evolves along the position axis. It runs successively discrepancy analyses within a sliding time-window of range <code>cmprange</code>). At
each position <code class="reqn">t</code>, the method uses <code>seqdist</code> to compute a distance matrix over the time-window (<code class="reqn">t + </code><code>cmprange[1]</code>, <code class="reqn">t + </code><code>cmprange[2]</code>) and then derives the explained discrepancy on that window with <code>dissassoc</code>.
</p>
<p>There are print and plot methods for the returned value.</p>


<h3>Value</h3>

<p>A <code>seqdiff</code> object, with the following items:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>stat</code></td>
<td>
<p>A <code>data.frame</code> with five statistics (Pseudo F, Pseudo Fbf, Pseudo R2, Bartlett, 
and Levene) for each time stamp of the sequence
(see <code>dissassoc</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>discrepancy</code></td>
<td>
<p>A <code>data.frame</code> with, at each time position <code class="reqn">t</code>, the discrepancy within the whole set of sequences and within each group (defined by the <code>group</code> variable).</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Matthias Studer (with Gilbert Ritschard for the help page)</p>


<h3>References</h3>

<p>Studer, M., G. Ritschard, A. Gabadinho and N. S. Müller (2011). Discrepancy analysis of state sequences, <em>Sociological Methods and Research</em>, Vol. 40(3), 471-510, <a href="https://doi.org/10.1177/0049124111415372">doi:10.1177/0049124111415372</a>.
</p>
<p>Studer, M., G. Ritschard, A. Gabadinho and N. S. Müller (2010)
Discrepancy analysis of complex objects using dissimilarities.
In F. Guillet, G. Ritschard, D. A. Zighed and H. Briand (Eds.),
<em>Advances in Knowledge Discovery and Management</em>,
Studies in Computational Intelligence, Volume 292, pp. 3-19. Berlin: Springer.
</p>
<p>Studer, M., G. Ritschard, A. Gabadinho and N. S. Müller (2009)
Analyse de dissimilarités par arbre d'induction. In EGC 2009,
<em>Revue des Nouvelles Technologies de l'Information</em>, Vol. E-15, pp. 7-18.
</p>


<h3>See Also</h3>

<p><code>dissassoc</code> to analyse the association of the <code>group</code> variable with the whole sequence</p>


<h3>Examples</h3>

<pre><code class="language-R">## Define a state sequence object
data(mvad)
## First 12 months of first 100 trajectories
mvad.seq &lt;- seqdef(mvad[1:100, 17:28])

## Position-wise discrepancy analysis using
##  centered sliding windows of length 5.
mvad.diff &lt;- seqdiff(mvad.seq, group=mvad$gcse5eq[1:100], cmprange=c(-2,2))
print(mvad.diff)
plot(mvad.diff, stat=c("Pseudo R2", "Levene"))
plot(mvad.diff, stat="discrepancy")
</code></pre>


</div>