<div class="container">

<table style="width: 100%;"><tr>
<td>colPlaLab_inv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generation of the rooted binary tree corresponding to a given Colijn-Plazzotta rank</h2>

<h3>Description</h3>

<p>This function generates the unique rooted binary tree <code class="reqn">T</code> (in phylo
format) that corresponds to the given Colijn-Plazzotta rank <code class="reqn">CP(T)</code>. It
is the inverse function of colPlaLab(). <br><br><code>colPlaLab()</code>:
For a given rooted binary tree <code class="reqn">T</code>, <code class="reqn">CP(T)</code> is recursively defined as
<code class="reqn">CP(T)=1</code> if <code class="reqn">T</code> consists of only one vertex and otherwise
<code class="reqn">CP(T)=\frac{1}{2}\cdot CP(T_1)\cdot(CP(T_1)-1)+CP(T_2)+1</code> with
<code class="reqn">CP(T_1) \geq CP(T_2)</code> being the
ranks of the two pending subtrees rooted at the children of the root of <code class="reqn">T</code>.
The rank <code class="reqn">CP(T)</code> of <code class="reqn">T</code> corresponds to its position in the
lexicographically sorted list of (<code class="reqn">i,j</code>): (1),(1,1),(2,1),(2,2),(3,1),... <br><br><code>colPlaLab_inv()</code>:
For a given rank <code class="reqn">CP</code> the corresponding tree <code class="reqn">T</code> can be reconstructed
by starting from one vertex <code class="reqn">\rho</code> (labelled <code class="reqn">CP</code>) and recursively
splitting vertices whose labels <code class="reqn">h</code> are greater than 1 into two children with the labels:
</p>
<p style="text-align: center;"><code class="reqn">i=\left\lceil\frac{1+\sqrt{8\cdot h-7}}{2}\right\rceil-1</code>
</p>
<p> and
</p>
<p style="text-align: center;"><code class="reqn">j=h-\frac{i\cdot(i-1)}{2}-1</code>
</p>

<p>until there are no more vertices to split. <br>
For <code class="reqn">CP=1</code> the function returns the smallest possible tree in the
phylo format: the tree consisting of a single edge.<br><br>
Note that problems can arise for extremely high input values (&gt;10e+18). <br><br>
For details on the Colijn-Plazzotta rank, see 
also Chapter 21 in "Tree balance indices: a comprehensive survey" (https://doi.org/10.1007/978-3-031-39800-1_21).
</p>


<h3>Usage</h3>

<pre><code class="language-R">colPlaLab_inv(rank)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>rank</code></td>
<td>
<p>An integer denoting the Colijn-Plazzotta rank of the sought tree.</p>
</td>
</tr></table>
<h3>Value</h3>

<p><code>colPlaLab_inv</code> returns the unique rooted binary tree for the given rank.
</p>


<h3>Author(s)</h3>

<p>Sophie Kersting
</p>


<h3>References</h3>

<p>C. Colijn and G. Plazzotta. A Metric on Phylogenetic Tree Shapes. Systematic Biology, 67(1):113-126,2018. doi: 10.1093/sysbio/syx046.
</p>
<p>N. A. Rosenberg. On the Colijn-Plazzotta numbering scheme for unlabeled binary rooted trees. Discrete Applied Mathematics, 291:88-98, 2021. doi: 10.1016/j.dam.2020.11.021.
</p>


<h3>Examples</h3>

<pre><code class="language-R">colPlaLab_inv(22)

</code></pre>


</div>