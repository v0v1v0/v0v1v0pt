<div class="container">

<table style="width: 100%;"><tr>
<td>gpdFit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Parameter estimation for the Generalized Pareto Distribution (GPD)</h2>

<h3>Description</h3>

<p>Fits exceedances above a chosen threshold to the Generalized Pareto model. Various estimation procedures can be used,
including maximum likelihood, probability weighted moments, and maximum product spacing. It also allows
generalized linear modeling of the parameters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gpdFit(data, threshold = NA, nextremes = NA, npp = 365,
  method = c("mle", "mps", "pwm"), information = c("expected",
  "observed"), scalevars = NULL, shapevars = NULL, scaleform = ~1,
  shapeform = ~1, scalelink = identity, shapelink = identity,
  start = NULL, opt = "Nelder-Mead", maxit = 10000, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data should be a numeric vector from the GPD.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>A threshold value or vector of the same length as the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nextremes</code></td>
<td>
<p>Number of upper extremes to be used (either this or the threshold must be given, but not both).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npp</code></td>
<td>
<p>Length of each period (typically year). Is used in return level estimation. Defaults to 365.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Method of estimation - maximum likelihood (mle), maximum product spacing (mps), and
probability weighted moments (pwm). Uses mle by default. For pwm, only the stationary model can be fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>information</code></td>
<td>
<p>Whether standard errors should be calculated via observed or expected (default) information. For probability
weighted moments, only expected information will be used if possible. For non-stationary models, only observed
information is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scalevars, shapevars</code></td>
<td>
<p>A dataframe of covariates to use for modeling of the each parameter. Parameter
intercepts are automatically handled by the function. Defaults to NULL for the stationary model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaleform, shapeform</code></td>
<td>
<p>An object of class ‘formula’ (or one that can be coerced into that class), specifying the model
of each parameter. By default, assumes stationary (intercept only) model. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scalelink, shapelink</code></td>
<td>
<p>A link function specifying the relationship between the covariates and each parameter. Defaults to
the identity function. For the stationary model, only the identity link should be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>Option to provide a set of starting parameters to optim; a vector of scale and shape, in that order. Otherwise,
the routine attempts to find good starting parameters. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opt</code></td>
<td>
<p>Optimization method to use with optim.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>Number of iterations to use in optimization, passed to optim. Defaults to 10,000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to pass to optim.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The base code for finding probability weighted moments is taken from the R package evir. See citation.
In the stationary case (no covariates), starting parameters for mle and mps estimation are the probability weighted moment estimates.
In the case where covariates are used, the starting intercept parameters are the probability weighted moment estimates from the
stationary case and the parameters based on covariates are initially set to zero. For non-stationary parameters, the
first reported estimate refers to the intercept term. Covariates are centered and scaled automatically to speed up optimization,
and then transformed back to original scale. <br>
Formulas for generalized linear modeling of the parameters should be given in the form '~ var1 + var2 + <code class="reqn">\cdots</code>'. Essentially,
specification here is the same as would be if using function ‘lm’ for only the right hand side of the equation. Interactions,
polynomials, etc. can be handled as in the ‘formula’ class. <br>
Intercept terms are automatically handled by the function. By default, the link functions are the identity function and
the covariate dependent scale parameter estimates are forced to be positive. For some link function <code class="reqn">f(\cdot)</code> and for
example, scale parameter <code class="reqn">\sigma</code>, the link is written as <code class="reqn">\sigma = f(\sigma_1 x_1 + \sigma_2 x_2 + \cdots + \sigma_k x_k)</code>. <br>
Maximum likelihood estimation and maximum product spacing estimation can be used in all cases. Probability weighted moments
can only be used for stationary models.
</p>


<h3>Value</h3>

<p>A class object ‘gpdFit’ describing the fit, including parameter estimates and standard errors.
</p>


<h3>References</h3>

<p>Brian Bader, Jun Yan. "eva: Extreme Value Analysis with Goodness-of-Fit Testing." R package version (2016)
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Fit data using the three different estimation procedures
set.seed(7)
x &lt;- rgpd(2000, loc = 0, scale = 2, shape = 0.2)
## Set threshold at 4
mle_fit &lt;- gpdFit(x, threshold = 4, method = "mle")
pwm_fit &lt;- gpdFit(x, threshold = 4, method = "pwm")
mps_fit &lt;- gpdFit(x, threshold = 4, method = "mps")
## Look at the difference in parameter estimates and errors
mle_fit$par.ests
pwm_fit$par.ests
mps_fit$par.ests

mle_fit$par.ses
pwm_fit$par.ses
mps_fit$par.ses

## A linear trend in the scale parameter
set.seed(7)
n &lt;- 300
x2 &lt;- rgpd(n, loc = 0, scale = 1 + 1:n / 200, shape = 0)

covs &lt;- as.data.frame(seq(1, n, 1))
names(covs) &lt;- c("Trend1")

result1 &lt;- gpdFit(x2, threshold = 0, scalevars = covs, scaleform = ~ Trend1)

## Show summary of estimates
result1

</code></pre>


</div>