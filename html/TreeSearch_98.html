<div class="container">

<table style="width: 100%;"><tr>
<td>RearrangeEdges</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Rearrange edges of a phylogenetic tree</h2>

<h3>Description</h3>

<p><code>RearrangeEdges()</code> performs the specified edge rearrangement on a matrix
that corresponds to the edges of a phylogenetic tree, returning the score of
the new tree.
Will generally be called from within a tree search function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">RearrangeEdges(
  parent,
  child,
  dataset,
  TreeScorer = MorphyLength,
  EdgeSwapper,
  scoreToBeat = TreeScorer(parent, child, dataset, ...),
  iter = "?",
  hits = 0L,
  verbosity = 0L,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>parent</code></td>
<td>
<p>Integer vector corresponding to the first column of the edge
matrix of a tree of class <code>phylo</code>, i.e. <code>tree$edge[, 1]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>child</code></td>
<td>
<p>Integer vector corresponding to the second column of the edge
matrix of a tree of class <code>phylo</code>, i.e. <code>tree$edge[, 2]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataset</code></td>
<td>
<p>Third argument to pass to <code>TreeScorer</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TreeScorer</code></td>
<td>
<p>function to score a given tree.
The function will be passed three parameters, corresponding to the
<code>parent</code> and <code>child</code> entries of a tree's edge list, and a dataset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EdgeSwapper</code></td>
<td>
<p>a function that rearranges a parent and child vector,
and returns a list with modified vectors; for example <code>SPRSwap()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scoreToBeat</code></td>
<td>
<p>Double giving score of input tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>iteration number of calling function, for reporting to user only.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hits</code></td>
<td>
<p>Integer giving number of times the input tree has already been hit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbosity</code></td>
<td>
<p>Numeric specifying level of detail to display in console:
larger numbers provide more verbose feedback to the user.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to pass to <code>TreeScorer()</code>, e.g. <code style="white-space: pre;">⁠dataset = ⁠</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>RearrangeTree()</code> performs one tree rearrangement of a
specified type, and returns the score of the tree (with the given dataset).
It also reports the number of times that this score was hit in the
current function call.
</p>


<h3>Value</h3>

<p>This function returns a list with two to four elements, corresponding to a binary tree:
- 1. Integer vector listing the parent node of each edge;
- 2. Integer vector listing the child node of each edge;
- 3. Score of the tree;
- 4. Number of times that score has been hit.
</p>


<h3>Author(s)</h3>

<p>Martin R. Smith
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("Lobo", package="TreeTools")
tree &lt;- TreeTools::NJTree(Lobo.phy)
edge &lt;- tree$edge
parent &lt;- edge[, 1]
child &lt;- edge[, 2]
dataset &lt;- PhyDat2Morphy(Lobo.phy)
RearrangeEdges(parent, child, dataset, EdgeSwapper = RootedNNISwap)
# Remember to free memory:
dataset &lt;- UnloadMorphy(dataset)
</code></pre>


</div>