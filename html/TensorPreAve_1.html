<div class="container">

<table style="width: 100%;"><tr>
<td>bs_cor_rank</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bootstrap Rank Estimation.</h2>

<h3>Description</h3>

<p>Function to estimate the rank of the core tensor by Bootstrapped Correlation Thresholding.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bs_cor_rank(X, initial_direction, r_range = NULL, C_range = NULL, B = 50)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A 'Tensor' object defined in package <span class="pkg">rTensor</span> with <code class="reqn">K+1</code> modes. Mode-1 should correspond to the time mode.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial_direction</code></td>
<td>
<p>Direction corresponds to the strongest factors, written in a list of <code class="reqn">K</code> vectors. This can be obtained from the iterative projection procedure by using function <code>iter_proj</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r_range</code></td>
<td>
<p>Approximate range of <code class="reqn">r_k</code> (number of factors) to search from, written in a list of <code class="reqn">K</code> vectors (e.g. <code>z = list(c(1,10),c(1,10))</code> for <code class="reqn">K = 2</code>). Default range is 1 to 10 for all modes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C_range</code></td>
<td>
<p>The range of constant C for calculating threshold. Default is <code>seq(0,100,0.1)</code>, and set to be automatically tuned as data-driven.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>Number of bootstrap samples. Default is 50. Can be set as 10 to save time when dimension is large.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Input a tensor time series and estimated directions corresponding to the strongest factors, return the estimated rank of core tensor.
</p>


<h3>Value</h3>

<p>A vector of length <code class="reqn">K</code>, indicating estimated number of factors in each mode.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Example of real data set
set.seed(10)
Q_PRE = pre_est(value_weight_tensor)
Q_PROJ = iter_proj(value_weight_tensor, initial_direction = Q_PRE)
bs_rank = bs_cor_rank(value_weight_tensor, Q_PROJ)
bs_rank


# Example using generated data
K = 2
T = 100
d = c(40,40)
r = c(2,2)
re = c(2,2)
eta = list(c(0,0),c(0,0))
u = list(c(-2,2),c(-2,2))
set.seed(10)
Data_test = tensor_data_gen(K,T,d,r,re,eta,u)
X = Data_test$X
Q_PRE = pre_est(X)
Q_PROJ = iter_proj(X, initial_direction = Q_PRE)
bs_rank = bs_cor_rank(X, Q_PROJ)
bs_rank

</code></pre>


</div>