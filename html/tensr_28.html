<div class="container">

<table style="width: 100%;"><tr>
<td>multiway_takemura</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate a truncated multiway Takemura estimator.</h2>

<h3>Description</h3>

<p>This function will 'average' Bayes rules given random rotations of the data
array. This 'averaged' estimator has lower risk than the uniformly minimum
risk equivariant estimator under a product group of lower triangular
matrices. Truncated multiway Takemura's estimator is not equivariant with
respect to this product group of lower triangular matrices, but it is an
equivariant randomized estimator with respect to a product group of
orthogonal matrices.
</p>


<h3>Usage</h3>

<pre><code class="language-R">multiway_takemura(X, ortho_max = 2, mcmc_itermax = 1000,
  start_identity = FALSE, print_mcmc = FALSE, mode_rep = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>An array. This is the data array.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ortho_max</code></td>
<td>
<p>An integer. The number of 'averagings' to perform.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcmc_itermax</code></td>
<td>
<p>An integer. The number of iterations each MCMC should
perform using <code>equi_mcmc</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start_identity</code></td>
<td>
<p>Should each MCMC start their covariance matrices at the
identity (TRUE) or at the sample covariance matrices (FALSE)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print_mcmc</code></td>
<td>
<p>Should the output of the MCMC be printed to the screen
(TRUE) or not (FALSE)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode_rep</code></td>
<td>
<p>A vector of integers. Which mode(s) are considered iid
observations? Default is none.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function will (1) randomly rotate <code>X</code> along every mode, then (2) it
will calculate the uniformly minimum risk equivariant estimator using
<code>equi_mcmc</code>, then (3) it will 'average' these estimates.
</p>


<h3>Value</h3>

<p><code>B</code> A list of the truncated multiway Takemura's estimators for
each component covariance matrix. Not their Cholesky square roots.
</p>
<p><code>b</code> Truncated multiway Takemura's estimator for the total variation
parameter. The 'variance' form, not the 'standard devation' form.
</p>


<h3>Author(s)</h3>

<p>David Gerard.
</p>


<h3>References</h3>

<p>Gerard, D., &amp; Hoff, P. (2015). Equivariant minimax
dominators of the MLE in the array normal model.
<em>Journal of Multivariate Analysis</em>, 137, 32-49.
<a href="https://doi.org/10.1016/j.jmva.2015.01.020">https://doi.org/10.1016/j.jmva.2015.01.020</a>
<a href="http://arxiv.org/pdf/1408.0424.pdf">http://arxiv.org/pdf/1408.0424.pdf</a>
</p>


<h3>See Also</h3>

<p><code>equi_mcmc</code>, <code>random_ortho</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Simulate data.
p &lt;- c(5, 5, 5)
X &lt;- array(stats::rnorm(prod(p)), dim = p)
multi_out &lt;- multiway_takemura(X, mode_rep = 3)
multi_out$b
trim(multi_out$B[[1]])
trim(multi_out$B[[2]])
trim(multi_out$B[[3]])
</code></pre>


</div>