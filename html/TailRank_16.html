<div class="container">

<table style="width: 100%;"><tr>
<td>tailRankPower</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Power of the tail-rank test</h2>

<h3>Description</h3>

<p>Compute the significance level and the power of a tail-rank test.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tailRankPower(G, N1, N2, psi, phi, conf = 0.95,
              model=c("bb", "betabinom", "binomial"))
tailRankCutoff(G, N1, N2, psi, conf,
               model=c("bb", "betabinom", "binomial"),
               method=c('approx', 'exact'))
                           
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>
<p>An integer; the number of genes being assessed as potnetial
biomarkers. Statistically, the number of hypotheses being tested.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N1</code></td>
<td>
<p>An integer; the number of "train" or "healthy" samples used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N2</code></td>
<td>
<p>An integer; the number of "test" or "cancer" samples used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi</code></td>
<td>
<p>A real number between 0 and 1; the desired specificity of
the test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>A real number between 0 and 1; the sensitivity that one
would like to be able to detect, conditional on the specificity.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf</code></td>
<td>
<p>A real number between 0 and 1; the confidence level of the
results. Can be obtained by subtracting the family-wise Type I error
from 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>A character string that determines whether significance
and power are computed based on a binomial or a beta-binomial (bb)
model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>A character string; either "exact" or "approx". The
deafult is to use a Bonferroni approximation.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A power estimate for the tail-rank test can be obtained as follows.
First, let X ~ Binom(N,p) denote a binomial random variable. Under the
null hypotheis that cancer is not different from normal, we let
<code class="reqn">p = 1 - \psi</code> be the expected  proportion of successes in a test of
whether the value exceeds the psi-th quantile.  Now let
</p>
<p style="text-align: center;"><code class="reqn">\alpha = P(X &gt; x,| N, p)</code>
</p>

<p>be one such binomial measurement.  When we make <code class="reqn">G</code> independent
binomial measurements, we take
</p>
<p style="text-align: center;"><code class="reqn">conf = P(all\ G\ of\ the\ X's \le x | N, p).</code>
</p>

<p>(In our paper on the tail-rank statistic, we write everything in terms
of <code class="reqn">\gamma = 1 - conf</code>.) Then we have
</p>
<p style="text-align: center;"><code class="reqn">conf = P(X \le x | N, p)^G = (1 - alpha)^G.</code>
</p>

<p>Using a Bonferroni-like approximation, we can take
</p>
<p style="text-align: center;"><code class="reqn">conf ~= 1 - \alpha*G.</code>
</p>

<p>Solving for <code class="reqn">\alpha</code>, we find that
</p>
<p style="text-align: center;"><code class="reqn">\alpha ~= (1-conf)/G.</code>
</p>

<p>So, the cutoff that ensures that in multiple experiments, each looking
at <code class="reqn">G</code> genes in <code class="reqn">N</code> samples, we have confidence level <code class="reqn">conf</code>
(or significance level <code class="reqn">\gamma = 1 - conf</code>) of no false positives is
computed by the function <code>tailRankCutoff</code>.
</p>
<p>The final point to note is that the quantiles are also defined
in terms of <code class="reqn">q = 1 - \alpha</code>, so there are lots of disfiguring "1's"
in the implementation.
</p>
<p>Now we set <code class="reqn">M</code> to be the significance cutoff using the procedure
detailed above.  A gene with sensitivity <code class="reqn">\phi</code> gets detected if the
observed number of cases above the threshold is greater than or equal to
<code class="reqn">M</code>. The <code>tailRankPower</code> function implements formula (1.3) of
our paper on the tail-rank test.
</p>


<h3>Value</h3>

<p><code>tailRankCutoff</code> returns an integer that is the
maximum expected value of the tail rank statistic under the null
hypothesis.
</p>
<p><code>tailRankPower</code> returns a real numbe between 0 and 1
that is the power of the tail-rank test to detect a marker with
true sensitivity equal to <code class="reqn">phi</code>.
</p>


<h3>Author(s)</h3>

<p>Kevin R. Coombes &lt;krc@silicovore.com&gt;</p>


<h3>See Also</h3>

<p><code>TailRankTest</code>,
<code>tailRankPower</code>,
<code>biomarkerPowerTable</code>,
<code>matrixMean</code>,
<code>toleranceBound</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">psi.0 &lt;- 0.99
confide &lt;- rev(c(0.8, 0.95, 0.99))
nh &lt;- 20
ng &lt;- c(100, 1000, 10000, 100000)
ns &lt;- c(10, 20, 50, 100, 250, 500)
formal.cut &lt;- array(0, c(length(ns), length(ng), length(confide)))
for (i in 1:length(ng)) {
  for (j in 1:length(ns)) {
    formal.cut[j, i, ] &lt;- tailRankCutoff(ng[i], nh, ns[j], psi.0, confide)
  }
}
dimnames(formal.cut) &lt;- list(ns, ng, confide)
formal.cut

phi &lt;- seq(0.1, 0.7, by=0.1)
N &lt;- c(10, 20, 50, 100, 250, 500)
pows &lt;- matrix(0, ncol=length(phi), nrow=length(N))
for (ph in 1:length(phi)) {
  pows[, ph] &lt;-  tailRankPower(10000, nh, N, 0.95, phi[ph], 0.9)
}
pows &lt;- data.frame(pows)
dimnames(pows) &lt;- list(as.character(N), as.character(round(100*phi)))
pows
</code></pre>


</div>