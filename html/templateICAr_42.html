<div class="container">

<table style="width: 100%;"><tr>
<td>LL2_kappa</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute part of kappa log-likelihood</h2>

<h3>Description</h3>

<p>Compute part of log-likelihood involving kappa (or kappa_q) for numerical optimization
</p>


<h3>Usage</h3>

<pre><code class="language-R">LL2_kappa(
  kappa,
  Amat,
  Fmat,
  Gmat,
  GFinvG,
  OplusW,
  u,
  v,
  C1 = 1/(4 * pi),
  Q = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>kappa</code></td>
<td>
<p>Value of kappa for which to compute log-likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Amat</code></td>
<td>
<p>Mesh projection matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Fmat</code></td>
<td>
<p>Matrix used in computation of SPDE precision</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gmat</code></td>
<td>
<p>Matrix used in computation of SPDE precision</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GFinvG</code></td>
<td>
<p>Matrix used in computation of SPDE precision</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>OplusW</code></td>
<td>
<p>Sparse matrix containing estimated values of RHS of trace in part 2 of log-likelihood. In common smoothness model, represents the sum over q=1,...,Q.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>Vector needed for part 3 of log-likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>Vector needed for part 3 of log-likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C1</code></td>
<td>
<p>For the unit variance case, <code class="reqn">\tau^2 = C1/\kappa^2</code>, where <code class="reqn">C1 = 1/(4\pi)</code> when <code class="reqn">\alpha=2</code>, <code class="reqn">\nu=1</code>, <code class="reqn">d=2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q</code></td>
<td>
<p>Equal to the number of ICs for the common smoothness model, or NULL for the IC-specific smoothness model</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is the function to be maximized in order to determine the MLE for <code class="reqn">\kappa</code> or the <code class="reqn">\kappa_q</code>'s in the M-step of the EM algorithm in spatial
template ICA.  In the model where <code class="reqn">\kappa_q</code> can be different for each IC <code class="reqn">q</code>, the optimization function factorizes over the <code class="reqn">\kappa_q</code>'s.  This function computes
the value of the part of the optimization function pertaining to one of the <code class="reqn">\kappa_q</code>'s.
</p>


<h3>Value</h3>

<p>Value of log-likelihood at logkappa
</p>


</div>