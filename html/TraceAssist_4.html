<div class="container">

<table style="width: 100%;"><tr>
<td>TraceAssist</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Aggregation of structured sign series for trace regression (ASSIST)</h2>

<h3>Description</h3>

<p>Main function for fitting the nonparametric trace regression. The algorithm uses a learning reduction approach to estimate the nonparametric trace regression via ASSIST.
</p>


<h3>Usage</h3>

<pre><code class="language-R">TraceAssist(X,y,X_new=NULL,r,sparse_r,sparse_c,H=10,lambda=0,rho.ini=0.1,min,max)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A list of matrix-valued predictors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A vector of response variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X_new</code></td>
<td>
<p>A list of new matrices in the test data. <code>X_new = NULL</code> returns fitted values in the training data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>The rank of sign representable function to be fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sparse_r</code></td>
<td>
<p>The number of zero rows in coefficient matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sparse_c</code></td>
<td>
<p>The number of zero columns in coefficient matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>
<p>Resoution parameter that controls the number of classifiers to aggregate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Lagrangian multiplier.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho.ini</code></td>
<td>
<p>Initial step size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min</code></td>
<td>
<p>Minimum value of the response variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max</code></td>
<td>
<p>Maximum value of the response variables.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The returned object is a list of components.
</p>
<p><code>B_est</code> - An array that collects a series of coefficient matrices for the classifiers used in the algorithm.
</p>
<p><code>fitted</code> - The predicted responses in the test data.
</p>
<p><code>sign_fitted</code> - A matrix that collects a series of predicted signs for the classifiers used in the algorithm.
</p>


<h3>References</h3>

<p>Lee, C., Li, L., Zhang, H., and Wang, M. (2021). Nonparametric Trace Regression via Sign Series Representation. <em>arXiv preprint arXiv:2105.01783</em>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">######### Generate matrices in the training data ################
X = list()
for(i in 1:10){
 X[[i]] = matrix(runif(4,-1,1),nrow = 2,ncol = 2)
}

######### Generate coefficient matrix ###########################
B = runif(2,-1,1)%*%t(runif(2,-1,1))

######### Generate response variables ###########################
y = NULL;signal = NULL
for(i in 1:10){
 signal = c(signal,sum(X[[i]]*B))
 y = c(y,sum(X[[i]]*B)+rnorm(1,sd = 0.1))
}


######### Run ASSIST ############################################
res =TraceAssist(X,y,r = 1,sparse_r = 0,sparse_c = 0,min = min(y),max = max(y))
mean(abs(res$fitted-signal))


######### Generate new matrices in the test data ################
X_new = list()
for(i in 1:10){
  X_new[[i]] = matrix(runif(4,-1,1),nrow = 2,ncol = 2)
}

######### Generate response variables from X_new ################
y_new = NULL
for(i in 1:10){
  y_new = c(y_new,sum(X_new[[i]]*B))
}

######### Run ASSIST #############################################
res =TraceAssist(X,y,X_new,r = 1,sparse_r = 0,sparse_c = 0,min = min(y),max = max(y))
mean(abs(res$fitted-y_new))

</code></pre>


</div>