<div class="container">

<table style="width: 100%;"><tr>
<td>rank_factors_est</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Rank and Factor Loadings Estimation</h2>

<h3>Description</h3>

<p>The complete procedure to estimate both rank and factor loading matrices simultaneously for a tensor time series.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rank_factors_est(
  X,
  proj_N = 30,
  r_range = NULL,
  C_range = NULL,
  M0 = 200,
  M = 5,
  B = 50,
  eigen_j = NULL,
  input_r = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A 'Tensor' object defined in package <span class="pkg">rTensor</span> with <code class="reqn">K+1</code> modes. Mode-1 should correspond to the time mode.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>proj_N</code></td>
<td>
<p>Number of iterations for iterative projection. Default is 30.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r_range</code></td>
<td>
<p>Approximate range of <code class="reqn">r_k</code> (number of factors) to search from, written in a list of <code class="reqn">K</code> vectors (e.g. <code>z = list(c(1,10),c(1,10))</code> for <code class="reqn">K = 2</code>). Default range is 1 to 10 for all modes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C_range</code></td>
<td>
<p>The range of constant C for calculating threshold. Default is <code>seq(0,100,0.1)</code>, Default is <code>seq(0,100,0.1)</code>, and set to be automatically tuned as data-driven.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M0</code></td>
<td>
<p>Number of random samples to generate in pre-averaging procedure. Default is 200.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>Number of chosen samples for pre-averaging. Usually can be set as constants (5 or 10) or 2.5 percents of <code>M0</code>. Default is 5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>Number of bootstrap samples for estimating rank of core tensor by bootstrapped correlation thresholding. Default is 50. Can be set as 10 when dimension is large.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eigen_j</code></td>
<td>
<p>The j-th eigenvalue to calculate eigenvalue-ratio for a randomly chosen sample, written as a vector of length <code class="reqn">K</code>. Default is <code class="reqn">d_k/2</code> for all modes. Can be manually tuned using function <code>pre_eigenplot</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>input_r</code></td>
<td>
<p>The rank of core tensor if it is already know, written as a vector of length <code class="reqn">K</code>. If no input, it will be estimated. Default is <code>NULL</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Input a tensor time series and return the estimated factor loading matrices and rank of core tensor.
</p>


<h3>Value</h3>

<p>A list containing the following: <br><code>rank</code>: A vector of <code class="reqn">K</code> elements, indicating the estimated number of factors in each mode <br><code>loadings</code>: A list of <code class="reqn">K</code> estimated factor loading matrices.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Example of real data set
set.seed(10)
results = rank_factors_est(value_weight_tensor)
results


# Example using generated data
K = 2
T = 100
d = c(40,40)
r = c(2,2)
re = c(2,2)
eta = list(c(0,0),c(0,0))
u = list(c(-2,2),c(-2,2))
set.seed(10)
Data_test = tensor_data_gen(K,T,d,r,re,eta,u)
X = Data_test$X
results = rank_factors_est(X)
results

</code></pre>


</div>