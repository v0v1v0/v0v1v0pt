<div class="container">

<table style="width: 100%;"><tr>
<td>twingp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>A Fast Global-Local Gaussian Process Approximation</h2>

<h3>Description</h3>

<p>A Fast Global-Local Gaussian Process Approximation
</p>


<h3>Usage</h3>

<pre><code class="language-R">twingp(
  x,
  y,
  x_test,
  nugget = TRUE,
  twins = 5,
  g_num = NULL,
  l_num = NULL,
  v_num = NULL,
  num_threads = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p><code>n * d</code> numeric matrix representing the training features</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p><code>n * 1</code> response vector corresponding to <code>x</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_test</code></td>
<td>
<p><code>t * d</code> numeric matrix representing the <code>t</code> testing locations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nugget</code></td>
<td>
<p>Boolean indicating if a nugget to model observation noise is included in the model, the default is <code>True</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>twins</code></td>
<td>
<p>Number of twinning samples computed to identify the best set of global points, the default is <code>5</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g_num</code></td>
<td>
<p>Number of global points included in the model, the default is <code>min(50 * d, max(sqrt(n), 10 * d))</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l_num</code></td>
<td>
<p>Number of local points included in the model, the default is <code>max(25, 3 * d)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v_num</code></td>
<td>
<p>Number of validation points, the default is <code>2 * g_num</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_threads</code></td>
<td>
<p>Number of threads for parallel computation, the default is all available threads</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>We employ a combined global-local approach in building the Gaussian process approximation. Our framework uses a subset-of-data approach where the subset is a union of a set of global points designed to capture the global trend in the data, and a set of local points specific to a given testing location. We use <code>Twinning</code> (Vakayil and Joseph, 2022) to identify the set of global points. The local points are identified as the nearest neighbors to the testing location. The correlation function is also modeled as a combination of a global, and a local kernel. For further details on the methodology, please refer to Vakayil and Joseph (2024).
</p>


<h3>Value</h3>

<p>A list of two <code>t * 1</code> vectors <code>mu</code>, and <code>sigma</code> representing the mean prediction and associated standard error corresponding to <code>x_test</code>
</p>


<h3>References</h3>

<p>Vakayil, A., &amp; Joseph, V. R. (2024). A Global-Local Approximation Framework for Large-Scale Gaussian Process Modeling. Technometrics, 66(2), 295-305.
</p>
<p>Vakayil, A., &amp; Joseph, V. R. (2022). Data Twinning. Statistical Analysis and Data Mining: The ASA Data Science Journal, 15(5), 598-610.
</p>


<h3>Examples</h3>

<pre><code class="language-R">grlee12 = function(x) {
  term1 = sin(10 * pi * x) / (2 * x)
  term2 = (x - 1)^4
  y = term1 + term2
  return(y)
}

x = matrix(seq(0.5, 2.5, length=500), ncol=1)
y = apply(x, 1, grlee12) + rnorm(nrow(x)) * 0.1
x_test = matrix(seq(0.5, 2.5, length=2000), ncol=1)
y_test = apply(x_test, 1, grlee12)

result = twingp(x, y, x_test, num_threads=2)
rmse = sqrt(mean((y_test - result$mu)^2))

</code></pre>


</div>