<div class="container">

<table style="width: 100%;"><tr>
<td>sele_rank</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Rank selection</h2>

<h3>Description</h3>

<p>Estimate the Tucker rank of tensor decomposition based on BIC criterion. The choice of BIC
aims to balance between the goodness-of-fit for the data and the degree of freedom in the population model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sele_rank(
  tsr,
  X_covar1 = NULL,
  X_covar2 = NULL,
  X_covar3 = NULL,
  rank_range,
  niter = 10,
  cons = "non",
  lambda = 0.1,
  alpha = 1,
  solver = "CG",
  dist,
  initial = c("random", "QR_tucker")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tsr</code></td>
<td>
<p>response tensor with 3 modes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X_covar1</code></td>
<td>
<p>side information on first mode</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X_covar2</code></td>
<td>
<p>side information on second mode</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X_covar3</code></td>
<td>
<p>side information on third mode</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rank_range</code></td>
<td>
<p>a matrix containing rank candidates on each row</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niter</code></td>
<td>
<p>max number of iterations if update does not convergence</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cons</code></td>
<td>
<p>the constraint method, "non" for without constraint, "vanilla" for global scale down at each iteration,
</p>
<p>"penalty" for adding log-barrier penalty to object function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>penalty coefficient for "penalty" constraint</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>max norm constraint on linear predictor</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>solver</code></td>
<td>
<p>solver for solving object function when using "penalty" constraint, see "details"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>
<p>distribution of response tensor, see "details"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial</code></td>
<td>
<p>initialization of the alternating optimiation, "random" for random initialization, "QR_tucker" for deterministic initialization using tucker decomposition</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For rank selection, recommend using non-constraint version.
</p>
<p>Constraint <code>penalty</code> adds log-barrier regularizer to
general object function (negative log-likelihood). The main function uses solver in function "optim" to
solve the objective function. The "solver" passes to the argument "method" in function "optim".
</p>
<p><code>dist</code> specifies three distributions of response tensor: binary, poisson and normal distributions.
</p>


<h3>Value</h3>

<p>a list containing the following:
</p>
<p><code>rank</code> a vector with selected rank with minimal BIC
</p>
<p><code>result</code>  a matrix containing rank candidate and its loglikelihood and BIC on each row
</p>


<h3>Examples</h3>

<pre><code class="language-R">seed=24
dist='binary'
data=sim_data(seed, whole_shape = c(20,20,20),
core_shape=c(3,3,3),p=c(5,5,5),dist=dist, dup=5, signal=4)
rank_range = rbind(c(3,3,3),c(3,3,2),c(3,2,2),c(2,2,2),c(3,2,3))
re = sele_rank(data$tsr[[1]],data$X_covar1,data$X_covar2,data$X_covar3,
 rank_range = rank_range,niter=10,cons = 'non',dist = dist,initial = "random")
</code></pre>


</div>