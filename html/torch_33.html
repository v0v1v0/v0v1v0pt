<div class="container">

<table style="width: 100%;"><tr>
<td>dataloader</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Data loader. Combines a dataset and a sampler, and provides
single- or multi-process iterators over the dataset.</h2>

<h3>Description</h3>

<p>Data loader. Combines a dataset and a sampler, and provides
single- or multi-process iterators over the dataset.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dataloader(
  dataset,
  batch_size = 1,
  shuffle = FALSE,
  sampler = NULL,
  batch_sampler = NULL,
  num_workers = 0,
  collate_fn = NULL,
  pin_memory = FALSE,
  drop_last = FALSE,
  timeout = -1,
  worker_init_fn = NULL,
  worker_globals = NULL,
  worker_packages = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dataset</code></td>
<td>
<p>(Dataset): dataset from which to load the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>batch_size</code></td>
<td>
<p>(int, optional): how many samples per batch to load
(default: <code>1</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shuffle</code></td>
<td>
<p>(bool, optional): set to <code>TRUE</code> to have the data reshuffled
at every epoch (default: <code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampler</code></td>
<td>
<p>(Sampler, optional): defines the strategy to draw samples from
the dataset. If specified, <code>shuffle</code> must be False. Custom samplers can be
created with <code>sampler()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>batch_sampler</code></td>
<td>
<p>(Sampler, optional): like sampler, but returns a batch of
indices at a time. Mutually exclusive with <code>batch_size</code>,
<code>shuffle</code>, <code>sampler</code>, and <code>drop_last</code>. Custom samplers can be created with
<code>sampler()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_workers</code></td>
<td>
<p>(int, optional): how many subprocesses to use for data
loading. 0 means that the data will be loaded in the main process.
(default: <code>0</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>collate_fn</code></td>
<td>
<p>(callable, optional): merges a list of samples to form a mini-batch.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pin_memory</code></td>
<td>
<p>(bool, optional): If <code>TRUE</code>, the data loader will copy tensors
into CUDA pinned memory before returning them.  If your data elements
are a custom type, or your <code>collate_fn</code> returns a batch that is a custom type
see the example below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drop_last</code></td>
<td>
<p>(bool, optional): set to <code>TRUE</code> to drop the last incomplete batch,
if the dataset size is not divisible by the batch size. If <code>FALSE</code> and
the size of dataset is not divisible by the batch size, then the last batch
will be smaller. (default: <code>FALSE</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timeout</code></td>
<td>
<p>(numeric, optional): if positive, the timeout value for collecting a batch
from workers. -1 means no timeout. (default: <code>-1</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>worker_init_fn</code></td>
<td>
<p>(callable, optional): If not <code>NULL</code>, this will be called on each
worker subprocess with the worker id (an int in <code style="white-space: pre;">⁠[1, num_workers]⁠</code>) as
input, after seeding and before data loading. (default: <code>NULL</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>worker_globals</code></td>
<td>
<p>(list or character vector, optional) only used when
<code>num_workers &gt; 0</code>. If a character vector, then objects with those names are
copied from the global environment to the workers. If a named list, then
this list is copied and attached to the worker global environment. Notice
that the objects are copied only once at the worker initialization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>worker_packages</code></td>
<td>
<p>(character vector, optional) Only used if <code>num_workers &gt; 0</code>
optional character vector naming packages that should be loaded in
each worker.</p>
</td>
</tr>
</table>
<h3>Parallel data loading</h3>

<p>When using <code>num_workers &gt; 0</code> data loading will happen in parallel for each
worker. Note that batches are taken in parallel and not observations.
</p>
<p>The worker initialization  process happens in the following order:
</p>

<ul><li> <p><code>num_workers</code> R sessions are initialized.
</p>
</li></ul>
<p>Then in each worker we perform the following actions:
</p>

<ul>
<li>
<p> the <code>torch</code> library is loaded.
</p>
</li>
<li>
<p> a random seed is set both using <code>set.seed()</code> and using <code>torch_manual_seed</code>.
</p>
</li>
<li>
<p> packages passed to the <code>worker_packages</code> argument are loaded.
</p>
</li>
<li>
<p> objects passed trough the <code>worker_globals</code> parameters are copied into the
global environment.
</p>
</li>
<li>
<p> the <code>worker_init</code> function is ran with an <code>id</code> argument.
</p>
</li>
<li>
<p> the dataset fetcher is copied to the worker.
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>dataset()</code>, <code>sampler()</code>
</p>


</div>