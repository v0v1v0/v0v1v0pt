<div class="container">

<table style="width: 100%;"><tr>
<td>stFit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit the remote effects spatial process (RESP) model</h2>

<h3>Description</h3>

<p>Fit the remote effects spatial process (RESP) model
</p>


<h3>Usage</h3>

<pre><code class="language-R">stFit(
  stData = NULL,
  priors,
  maxIt,
  X = stData$X,
  Y = stData$Y,
  Z = stData$Z,
  coords.s = stData$coords.s,
  coords.r = stData$coords.r,
  rw.initsd = NULL,
  returnll = T,
  miles = T,
  C = 1,
  alpha = 0.44,
  localOnly = F,
  varying = F,
  remoteOnly = F,
  coords.knots
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>stData</code></td>
<td>
<p>Object with class 'stData' containing data needed to fit this 
model. The data need only be manually entered if not using a stData object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>priors</code></td>
<td>
<p>A list containing parameters for the prior distributions. The
list needs to contain the following values
</p>

<dl>
<dt>beta</dt>
<dd>
<p> list(Lambda=matrix) specifying the prior covariance matrix
for the local effects if varying==F, otherwise 
list(Psi=matrix, nu=double) specifying the Inverse wishart prior 
distribution for the spatially varying coefficient process if 
varying==T. </p>
</dd>
<dt>cov.s</dt>
<dd>
<p> list(smoothness=double, range=c(min, max), 
variance=c(shape, rate), nugget=c(shape, rate)) </p>
</dd>
<dt>cov.r</dt>
<dd>
<p> list(smoothness=double, range=c(min, max), 
variance=c(shape, rate), nugget=c(shape, rate)) </p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxIt</code></td>
<td>
<p>number of iterations to run the MCMC chain for</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>[ns, p, nt] array of design matrices with local covariates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>[ns, nt] matrix with response data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>[nr, nt] matrix with remote covariates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coords.s</code></td>
<td>
<p>matrix with coordinates where responses were 
observed (lon, lat)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coords.r</code></td>
<td>
<p>matrix with coordinates where remote covariates
were observed (lon, lat)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rw.initsd</code></td>
<td>
<p>A list containing initial standard deviation parameters for
the MCMC parameters requiring random walk updates
</p>

<dl>
<dt>cov.s</dt>
<dd>
<p> list(range=double, nugget=double) </p>
</dd>
<dt>cov.r</dt>
<dd>
<p> list(range=double, variance=double, nugget=double) </p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnll</code></td>
<td>
<p>TRUE to compute the model log-likelihood at each iteration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>miles</code></td>
<td>
<p>TRUE if covariance matrix distances should be in miles, FALSE 
for kilometers</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>scaling factor used in adapting random walk proposal variances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>target acceptance rate for random walk proposals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>localOnly</code></td>
<td>
<p>TRUE to fit the model without the teleconnection effects
(typically for evaluating impact of teleconnection effects)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varying</code></td>
<td>
<p>(depreceated) TRUE to fit the model with spatially varying local coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remoteOnly</code></td>
<td>
<p>TRUE to fit the model without local effects.  This will 
fit a local intercept, but will not incorporate local covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coords.knots</code></td>
<td>
<p>matrix with coordinates where remote teleconnections
will be based (lon, lat)</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">library(dplyr)
library(foreach)
library(itertools)

set.seed(2018)

data("coprecip")
data("coprecip.fit")
attach(coprecip)

coprecip.fit = stFit(stData = coprecip, priors = coprecip.fit$priors, 
                     maxIt = 10, coords.knots = coprecip.fit$coords.knots)
</code></pre>


</div>