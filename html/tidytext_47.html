<div class="container">

<table style="width: 100%;"><tr>
<td>stm_tidiers</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Tidiers for Structural Topic Models from the stm package</h2>

<h3>Description</h3>

<p>Tidy topic models fit by the stm package. The arguments and return values
are similar to <code>lda_tidiers()</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'STM'
tidy(
  x,
  matrix = c("beta", "gamma", "theta", "frex", "lift"),
  log = FALSE,
  document_names = NULL,
  ...
)

## S3 method for class 'estimateEffect'
tidy(x, ...)

## S3 method for class 'estimateEffect'
glance(x, ...)

## S3 method for class 'STM'
augment(x, data, ...)

## S3 method for class 'STM'
glance(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An STM fitted model object from either <code>stm::stm()</code> or
<code>stm::estimateEffect()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>matrix</code></td>
<td>
<p>Which matrix to tidy:
</p>

<ul>
<li>
<p> the beta matrix (per-term-per-topic, default)
</p>
</li>
<li>
<p> the gamma/theta matrix (per-document-per-topic); the stm package calls
this the theta matrix, but other topic modeling packages call this gamma
</p>
</li>
<li>
<p> the FREX matrix, for words with high frequency and exclusivity
</p>
</li>
<li>
<p> the lift matrix, for words with high lift
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>Whether beta/gamma/theta should be on a log scale, default FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>document_names</code></td>
<td>
<p>Optional vector of document names for use with
per-document-per-topic tidying</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Extra arguments for tidying, such as <code>w</code> as used in
<code>stm::calcfrex()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>For <code>augment</code>, the data given to the stm function, either
as a <code>dfm</code> from quanteda or as a tidied table with "document" and
"term" columns</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>tidy</code> returns a tidied version of either the beta, gamma, FREX, or
lift matrix if called on an object from <code>stm::stm()</code>, or a tidied version of
the estimated regressions if called on an object from <code>stm::estimateEffect()</code>.
</p>
<p><code>glance</code> returns a tibble with exactly one row of model summaries.
</p>
<p><code>augment</code> must be provided a data argument, either a
<code>dfm</code> from quanteda or a table containing one row per original
document-term pair, such as is returned by tdm_tidiers, containing
columns <code>document</code> and <code>term</code>. It returns that same data with an additional
column <code>.topic</code> with the topic assignment for that document-term combination.
</p>


<h3>See Also</h3>

<p><code>lda_tidiers()</code>, <code>stm::calcfrex()</code>, <code>stm::calclift()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(dplyr)
library(ggplot2)
library(stm)
library(janeaustenr)

austen_sparse &lt;- austen_books() %&gt;%
    unnest_tokens(word, text) %&gt;%
    anti_join(stop_words) %&gt;%
    count(book, word) %&gt;%
    cast_sparse(book, word, n)
topic_model &lt;- stm(austen_sparse, K = 12, verbose = FALSE)

# tidy the word-topic combinations
td_beta &lt;- tidy(topic_model)
td_beta

# Examine the topics
td_beta %&gt;%
    group_by(topic) %&gt;%
    slice_max(beta, n = 10) %&gt;%
    ungroup() %&gt;%
    ggplot(aes(beta, term)) +
    geom_col() +
    facet_wrap(~ topic, scales = "free")

# high FREX words per topic
tidy(topic_model, matrix = "frex")

# high lift words per topic
tidy(topic_model, matrix = "lift")

# tidy the document-topic combinations, with optional document names
td_gamma &lt;- tidy(topic_model, matrix = "gamma",
                 document_names = rownames(austen_sparse))
td_gamma

# using stm's gardarianFit, we can tidy the result of a model
# estimated with covariates
effects &lt;- estimateEffect(1:3 ~ treatment, gadarianFit, gadarian)
glance(effects)
td_estimate &lt;- tidy(effects)
td_estimate

</code></pre>


</div>