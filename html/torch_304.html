<div class="container">

<table style="width: 100%;"><tr>
<td>nn_multilabel_soft_margin_loss</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multi label soft margin loss</h2>

<h3>Description</h3>

<p>Creates a criterion that optimizes a multi-label one-versus-all
loss based on max-entropy, between input <code class="reqn">x</code> and target <code class="reqn">y</code> of size
<code class="reqn">(N, C)</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">nn_multilabel_soft_margin_loss(weight = NULL, reduction = "mean")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>
<p>(Tensor, optional): a manual rescaling weight given to each
class. If given, it has to be a Tensor of size <code>C</code>. Otherwise, it is
treated as if having all ones.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reduction</code></td>
<td>
<p>(string, optional): Specifies the reduction to apply to the output:
<code>'none'</code> | <code>'mean'</code> | <code>'sum'</code>. <code>'none'</code>: no reduction will be applied,
<code>'mean'</code>: the sum of the output will be divided by the number of
elements in the output, <code>'sum'</code>: the output will be summed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For each sample in the minibatch:
</p>
<p style="text-align: center;"><code class="reqn">
  loss(x, y) = - \frac{1}{C} * \sum_i y[i] * \log((1 + \exp(-x[i]))^{-1})
+ (1-y[i]) * \log\left(\frac{\exp(-x[i])}{(1 + \exp(-x[i]))}\right)
</code>
</p>

<p>where <code class="reqn">i \in \left\{0, \; \cdots , \; \mbox{x.nElement}() - 1\right\}</code>,
<code class="reqn">y[i] \in \left\{0, \; 1\right\}</code>.
</p>


<h3>Shape</h3>


<ul>
<li>
<p> Input: <code class="reqn">(N, C)</code> where <code>N</code> is the batch size and <code>C</code> is the number of classes.
</p>
</li>
<li>
<p> Target: <code class="reqn">(N, C)</code>, label targets padded by -1 ensuring same shape as the input.
</p>
</li>
<li>
<p> Output: scalar. If <code>reduction</code> is <code>'none'</code>, then <code class="reqn">(N)</code>.
</p>
</li>
</ul>
</div>