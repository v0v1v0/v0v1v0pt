<div class="container">

<table style="width: 100%;"><tr>
<td>sentrip</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sensitivity analysis for a triples match in an observational study</h2>

<h3>Description</h3>

<p>This function parallels [sensitivityfull::senfm()] for full matches.
However, this function does not force the scores used for the test to be
Huber's M-statistic. Instead, scores should be calculated ahead of time
and then entered here. Performs either a randomization test or the
corresponding Rosenbaum sensitivity analysis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sentrip(scores, treated1, gamma = 1, alternative = "greater")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>scores</code></td>
<td>
<p>A matrix of scores. Rows correspond to matched triples and
the three columns correspond to the three units in the match. The first unit
is the one treated unit if 'treated1 == TRUE' or the one control unit if
'treated1 == FALSE'. The other two columns contain the remaining two units in
the match. These are control units if 'treated1 == TRUE' or treated units if
'treated1 == FALSE'. This can easily be created from the triples match using
the [formattrip()] function with 'type == "wide"'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>treated1</code></td>
<td>
<p>A logical vector with length equal to the number of triples.
'TRUE' if there is only one treated unit in the matched triple; 'FALSE' if
there are two treated units and only one control unit.
This can easily be created from the triples match using
the [formattrip()] function with 'type == "wide"'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>The sensitivity parameter <code class="reqn">\Gamma \geq 1</code>. Setting <code class="reqn">\Gamma = 1</code>
performs a randomization test that assumes ignorable treatment assignment
given the matched triples</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>One of 'greater', 'less' or 'both'. 'greater' implies the
alternative hypothesis is that the treatment has a positive effect on the scores,
'less' implies the alternative hypothesis is that the treatment has a negative
effect on the scores, and 'both' conducts a two-sided hypothesis test</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Named list with 5 elements: 'pval' is the upper bound on the one or two-sided
P-value depending on 'alternative', 'deviate' is the deviate that was compared to the
Normal distribution to produce pval, 'statistic' is the value of the statistic
that is the sum of scores among treated units, 'expectation' is the maximum
expectation of this statistic for the given <code class="reqn">\Gamma</code>, and 'variance' is the
maximum variance of this statistic among treatment assignments that achieve the maximum
expectation
</p>


<h3>See Also</h3>

<p>sensitivityfull::senfm for more details, especially for the interpretation
of the 'expectation' and 'variance' components of the output and relevant references.
</p>
<p>formattrip for easily creating inputs to this function.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Generate some data
set.seed(246)
n &lt;- 30
x &lt;- rnorm(n, 0, 3)
nt &lt;- floor(n * 0.5)
nc &lt;- n - nt
z &lt;- c(rep(1, nt), rep(0, nc))
# Create a distance matrix, everything in one stratum
dist &lt;- dist_mahal(data.frame(x = x), z, rep(1, n))[[1]]
# Create the triples match
triplesm &lt;- triples_st(cost = dist, z = z, solver = "rlemon")
# Create an outcome
y &lt;- 1:40
# Give the outcome some random unit names
names(y) &lt;- sample(1:40)
# Reformat the triples match
ywide &lt;- formattrip(m = triplesm, y = y, type = "wide")
# Turn the outcome into scores, in this case aberrant ranks
ab &lt;- aberrantscores(ywide$ymat, 15, cutoff_dir = "less", tau = 0, treated1 = NULL)
# Conduct a one-sided hypothesis test with a bias of gamma = 1.25
sentrip(scores = ab, treated1 = ywide$treated1, gamma = 1.25, alternative = "greater")
</code></pre>


</div>