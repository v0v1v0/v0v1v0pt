<div class="container">

<table style="width: 100%;"><tr>
<td>TrajAngles</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Turning angles of a Trajectory</h2>

<h3>Description</h3>

<p>Calculates the step angles (in radians) of each segment, either relative to
the previous segment or relative to the specified compass direction.
</p>


<h3>Usage</h3>

<pre><code class="language-R">TrajAngles(trj, lag = 1, compass.direction = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>trj</code></td>
<td>
<p>the trajectory whose angles are to be calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lag</code></td>
<td>
<p>Angles between every lag'th segment are calculated. Only applies
to non-directed walks, i.e. <code>compass.direction</code> is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>compass.direction</code></td>
<td>
<p>If not <code>NULL</code>, step angles are calculated
relative to this angle (in radians), otherwise they are calculated relative
to the previous step angle.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Note that since turning angles are circular quantities, i.e. 360° == 0°, it
is incorrect to treat them as linear quantities. In particular, do not
calculate arithmetic means or standard deviations of turning angles. See
Batschelet, (1981) for a detailed explanation and techniques for dealing with
circular quantities.
</p>
<p>The turning angle before and after every zero-length segment will be
<code>NA</code>, since the angle of a zero-length segment is undefined. This
behaviour began in <code>trajr</code> version 1.5.0 (or development version
1.4.0.9000). Prior to this fix, the angle of a zero-length segment was
assumed to be 0, which led to incorrect turning angles being returned. One
approach to dealing with zero-length segments is to simply remove them from
the trajectory. See <code>TrajFromTrjPoints</code> for a means to achieve this.
</p>


<h3>Value</h3>

<p>Step angles in radians, normalised so that <code>-pi &lt; angle &lt;= pi</code>.
If <code>compass.direction</code> is <code>NULL</code> (the default), the returned
vector will have length <code>nrow(trj) - 2</code>, i.e. one angle for every pair
of adjacent segments. If <code>compass.direction</code> is not <code>NULL</code>, the
returned vector will have length <code>nrow(trj) - 1</code>, i.e. one angle for
every segment.
</p>


<h3>References</h3>

<p>Batschelet, E. (1981). Circular statistics in biology. ACADEMIC PRESS, 111
FIFTH AVE., NEW YORK, NY 10003, 1981, 388.
</p>


<h3>See Also</h3>

<p><code>TrajStepLengths</code>,
<code>TrajMeanVectorOfTurningAngles</code>,
<code>TrajFromTrjPoints</code>
</p>


</div>