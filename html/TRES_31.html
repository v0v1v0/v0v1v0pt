<div class="container">

<table style="width: 100%;"><tr>
<td>TRRdim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Envelope dimension selection for tensor response regression (TRR)</h2>

<h3>Description</h3>

<p>This function uses the 1D-BIC criterion proposed by Zhang, X., &amp; Mai, Q. (2018) to select envelope dimensions in tensor response regression. Refer to <code>oneD_bic</code> for more details.
</p>


<h3>Usage</h3>

<pre><code class="language-R">TRRdim(x, y, C = NULL, maxdim = 10, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The predictor matrix of dimension <code class="reqn">p \times n</code>. Vector of length <code class="reqn">n</code> is acceptable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The response tensor instance with dimension <code class="reqn">r_1\times r_2\times\cdots\times r_m \times n</code>, where <code class="reqn">n</code> is the sample size. Array with the same dimensions and matrix with dimension <code class="reqn">r\times n</code> are acceptable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>The parameter passed to <code>oneD_bic</code>. Default is <code>nrow(x) = p</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxdim</code></td>
<td>
<p>The maximum envelope dimension to be considered. Default is 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to <code>oneD_bic</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See <code>oneD_bic</code> for more details on the definition of 1D-BIC criterion and on the arguments <code class="reqn">C</code> and the additional arguments.
</p>
<p>Let <code class="reqn">B</code> denote the estimated envelope with the selected dimension <code>u</code>, then the prediction is <code class="reqn">\hat{Y}_i = B \bar{\times}_{(m+1)} X_i</code> for each observation. And the mean squared error is defined as <code class="reqn">1/n\sum_{i=1}^n||Y_i-\hat{Y}_i||_F^2</code>, where <code class="reqn">||\cdot||_F</code> denotes the Frobenius norm.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>bicval</code></td>
<td>
<p>The minimal BIC values for each mode.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>The optimal envelope subspace dimension <code class="reqn">(u_1, u_2,\cdots,u_m).</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mse</code></td>
<td>
<p>The prediction mean squared error using the selected envelope basis.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Li, L. and Zhang, X., 2017. Parsimonious tensor response regression. Journal of the American Statistical Association, 112(519), pp.1131-1146.
</p>
<p>Zhang, X. and Mai, Q., 2018. Model-free envelope dimension selection. Electronic Journal of Statistics, 12(2), pp.2193-2216.
</p>


<h3>See Also</h3>

<p><code>oneD_bic</code>, <code>TRRsim</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># The dimension of response
r &lt;- c(10, 10, 10)
# The envelope dimensions u.
u &lt;- c(2, 2, 2)
# The dimension of predictor
p &lt;- 5
# The sample size
n &lt;- 100

# Simulate the data with TRRsim.
dat &lt;- TRRsim(r = r, p = p, u = u, n = n)
x &lt;- dat$x
y &lt;- dat$y

TRRdim(x, y) # The estimated envelope dimensions are the same as u.

## Use dataset bat. (time-consuming)

data("bat")
x &lt;- bat$x
y &lt;- bat$y
# check the dimension of y
dim(y)
# use 32 as the maximal envelope dimension
TRRdim(x, y, maxdim=32)


</code></pre>


</div>