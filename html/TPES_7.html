<div class="container">

<table style="width: 100%;"><tr>
<td>TPES_purity</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Tumor Purity Estimation using SNVs</h2>

<h3>Description</h3>

<p>TPES_purity function estimates tumor purity.
</p>


<h3>Usage</h3>

<pre><code class="language-R">TPES_purity(ID, SEGfile, SNVsReadCountsFile, ploidy, RMB = 0.47,
  maxAF = 0.55, minCov = 10, minAltReads = 5, minSNVs = 10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ID</code></td>
<td>
<p>Sample ID. Must be the same ID as in SEGfile, SNVsReadCountsFile and ploidy.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SEGfile</code></td>
<td>
<p>A standard SEG file (segmented data). It is a data frame object that lists
loci and associated numeric values. The header must be compatible with the standard format
defined by the Broad Institute. For more information please visit
<a href="https://software.broadinstitute.org/software/igv/SEG">SEG file format</a>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SNVsReadCountsFile</code></td>
<td>
<p>A standard MAF (Mutation Annotation Format) file.
It is a data frame object containing the read counts data of somatic
single nucleotide variants (SNVs) loci. The header must contains at least informations about the chromosme
that harbors the SNV ("chr" column), the position of the SNV (defined by the "start" and "end" columns),
the sample ID ("sample" column) and finally the informations about the reference and alternative base
counts ("ref.count" and    "alt.count" columns, respectively). For more information please visit
<a href="https://software.broadinstitute.org/software/igv/MutationAnnotationFormat">MAF file format</a>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ploidy</code></td>
<td>
<p>A data frame containing the ploidy status of a sample. It must contain at
least the sample ID ("sample" column) and the ploidy status ("ploidy" column).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RMB</code></td>
<td>
<p>The Reference Mapping Bias value. The reference genome contains only one allele
at any given locus, so reads that carry a non-reference allele are less likely to be mapped
during alignment; this causes a shift from 0.5. It can be
estimated as: <code class="reqn">1 - medAF</code>, where medAF is the median value of the allelic fraction of the
sample's germline heterozygous SNPs. Default is set to 0.47. For more informations see: PMID: 19808877.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxAF</code></td>
<td>
<p>The filter on the allelic fraction (AF) distribution of SNVs. This is necessary to be sure to keep
only heterozygous SNVs. Clonal and subclonal SNVs, which have an AF greater than maxAF, will be removed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minCov</code></td>
<td>
<p>The minimum coverage for a SNV to be retained.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minAltReads</code></td>
<td>
<p>The minimum coverage for the alternative base of a SNV to be retained.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minSNVs</code></td>
<td>
<p>The minimum number of SNVs required to make a purity call.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>TPES returns a data.frame object with one row per sample and the following columns:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>sample</code></td>
<td>
<p>The sample ID;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>purity</code></td>
<td>
<p>The sample purity estimated by TPES;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>purity.min</code></td>
<td>
<p>The sample minimum purity estimated by TPES;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>purity.max</code></td>
<td>
<p>The sample maximum purity estimated by TPES;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.segs</code></td>
<td>
<p>The number of copy number neutral segments used by TPES;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.SNVs</code></td>
<td>
<p>The number of SNVs used by TPES;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RMB</code></td>
<td>
<p>The Reference Mapping Bias value used to estimate the tumor purity;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BandWidth</code></td>
<td>
<p>The smoothing bandwidth value of the <code>density</code> function chosen by TPES.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>Reports if the run was successful; otherwise provides debugging information.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">## Compute tumor purity for samples "TCGA-A8-A0A7" and "TCGA-HT-8564"
## https://cancergenome.nih.gov/
## Please copy and paste the following lines:
library(TPES)
TPES_purity(ID = "TCGA-A8-A0A7", SEGfile = TCGA_A8_A0A7_seg,
SNVsReadCountsFile = TCGA_A8_A0A7_maf, ploidy = TCGA_A8_A0A7_ploidy,
RMB = 0.47, maxAF = 0.55, minCov = 10, minAltReads = 5, minSNVs = 10)

TPES_purity(ID = "TCGA-HT-8564", SEGfile = TCGA_HT_8564_seg,
SNVsReadCountsFile = TCGA_HT_8564_maf, ploidy = TCGA_HT_8564_ploidy,
RMB = 0.47, maxAF = 0.55, minCov = 10, minAltReads = 5, minSNVs = 10)

</code></pre>


</div>