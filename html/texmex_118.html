<div class="container">

<table style="width: 100%;"><tr>
<td>egp3RangeFit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate the EGP3 distribution power parameter over a range of thresholds</h2>

<h3>Description</h3>

<p>Estimate extended generalized Pareto distribution power parameter over a
range of values, using maximum (penalized) likelihood.
</p>


<h3>Usage</h3>

<pre><code class="language-R">egp3RangeFit(data, umin=quantile(data, .05), umax=quantile(data,
.95), nint = 10, penalty = "gaussian", priorParameters = NULL, alpha=0.05)
## S3 method for class 'egp3RangeFit'
print(x, ...)
## S3 method for class 'egp3RangeFit'
plot(x, xlab = "Threshold", ylab = "kappa", main = NULL, addNexcesses=TRUE, log.="", ...)
## S3 method for class 'egp3RangeFit'
ggplot(data, mapping, xlab = "Threshold", ylab = expression(kappa),
main=NULL,fill="orange", col="blue",addNexcesses=TRUE, textsize=4, ..., environment)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>The data vector to be modelled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>umin</code></td>
<td>
<p>The minimum threshold above which to estimate the parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>umax</code></td>
<td>
<p>The maximum threshold above which to estimate the parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nint</code></td>
<td>
<p>The number of thresholds at which to perform the estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty</code></td>
<td>
<p>The type of penalty to be used in the maximum penalized
likelihood estimation. Should be either "gaussian" or "none". Defaults to
"gaussian".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>priorParameters</code></td>
<td>
<p>Parameters to be used for the penalty function.  See
the help for <code>evm</code> for more informaiton.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>100(1 - alpha)% confidence intervals will be plotted with the
point estimates. Defaults to <code>alpha = 0.05</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Argument to the <code>print</code> functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>Label for the x-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>Label for the y-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>The main title.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>textsize</code></td>
<td>
<p>Size of text for annotation showing number of threshold excesses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>addNexcesses</code></td>
<td>
<p>Annotate top axis with numbers of threshold excesses
arising with the corresponding values of threshold on the bottom axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.</code></td>
<td>
<p>Argument passed through to <code>plot</code>. Can take values "x" for
plotting the x-axis on the log scale, "y" for plotting the y-axis on the log
scale, "xy" for both, or "" (the default) for neither.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mapping, fill, col, environment</code></td>
<td>
<p>Arguments to ggplot method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments to <code>plot</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Papastathopoulos and Tawn present 3 extended versions of the generalized
Pareto distribution. Using the <code>egp3</code> texmex family object, the power
parameter in the EGP3 distribution is estimated on the log scale, a
confidence interval is calculated and the result is transformed back to the
scale of the power parameter and returned to the user.
</p>
<p>When the power paramer, kappa, is equal to 1, the EPG3 distribution is
identical to the generalized Pareto distribution. Therefore, the plot of the
estimated parameter over a range of thresholds provides a diagnostic for
threshold selection: the lowest value of kappa whose confidence interval
includes 1 is suggested as the threshold for generalized Pareto modelling.
</p>
<p>If lower thresholds are used and the EGP3 distribution itself is used for
modelling, some care should be taken to ensure the model provides a
reasonable degree of fit to the data. Limited experience suggests that such
models seldom fit well and the main value of the EGP3 distribution is as a
diagnostic for threshold selection as described here.
</p>
<p>Note this function does not extend to assessing model fit when there are
covariates included in the model.
</p>


<h3>Author(s)</h3>

<p>Harry Southworth
</p>


<h3>References</h3>

<p>I. Papastathopoulos and J. A. Tawn, Extended generalized Pareto
modles for tail estimation, Journal of Statistical Planning and Inference,
143, 131 â€“ 143, 2013
</p>


<h3>See Also</h3>

<p><code>evm</code>, <code>gpdRangeFit</code>, <code>mrl</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
 # because of the time it takes to run
erf &lt;- egp3RangeFit(rain)
plot(erf)
ggplot(erf)


</code></pre>


</div>