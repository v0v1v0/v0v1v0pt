<div class="container">

<table style="width: 100%;"><tr>
<td>tipaCosinor</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Use cosinor regression to estimate the phase shift induced by a stimulus
during a circadian time-course.</h2>

<h3>Description</h3>

<p>Calculate the phase shift based on fitting sine curves to waveform data
before and after the stimulus, accounting for possible period changes and for
the point in the circadian cycle at which the stimulus occurred. This
function will work best for measurements whose rhythms are approximately
sinusoidal, or at least smoothly increasing and decreasing. If your data are
not sinusoidal, you can first define the phase reference points and then use
<code>tipaPhaseRef()</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tipaCosinor(
  time,
  y,
  stimOnset,
  stimDuration = 0,
  periodGuess = 24,
  trend = TRUE,
  shortcut = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>Vector of time values for the full time-course.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Vector of measurements (e.g., bioluminescence) for the full
time-course.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stimOnset</code></td>
<td>
<p>Time at which the stimulus started.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stimDuration</code></td>
<td>
<p>Duration of the stimulus and any transients. Data between
<code>stimOnset</code> and <code>stimOnset + stimDuration</code> will be ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>periodGuess</code></td>
<td>
<p>Approximate period of the oscillations (in the same units
used in <code>time</code>), used as initial value in fitting the sine curves.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trend</code></td>
<td>
<p>Model a long-term trend in the cosinor fit for each epoch. Uses
a natural cubic spline with 4 degrees of freedom. It is strongly
recommended to keep as <code>TRUE</code>. If set to <code>FALSE</code>, the function may give an
error or give completely invalid results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shortcut</code></td>
<td>
<p>Calculate phase shift using the standard TIPA procedure or
using a shortcut based on the phases of the sine curve fits. The two
methods give exactly the same result.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>phaseShift</code></td>
<td>
<p>Estimated phase shift in circadian hours. Negative values
correspond to a delay, positive values an advance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epochInfo</code></td>
<td>
<p>Dataframe containing information about the sine curve fits
for each epoch: period (in the same units used in <code>time</code>), phase (in
radians), and root mean square error (in the same units as <code>y</code>). If the RMS
errors pre-stimulus and post-stimulus are substantially different, then the
stimulus may have induced a change in the waveform and thus phase shift
estimates may be invalid.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>tipaPhaseRef()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Time-course data from multiple (simulated) experiments
getTimecourseFile = function() {
  system.file('extdata', 'timecourses.csv', package = 'tipa')}
df = read.csv(getTimecourseFile(), stringsAsFactors = FALSE)

resultList = lapply(sort(unique(df$expId)), function(ii) {
  time = df$time[df$expId == ii]
  y = df$intensity[df$expId == ii]
  tipaCosinor(time, y, stimOnset = 0)})

phaseShifts = sapply(resultList, function(r) r$phaseShift)

</code></pre>


</div>