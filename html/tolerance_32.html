<div class="container">

<table style="width: 100%;"><tr>
<td>K.factor.sim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimating K-factors for Simultaneous Tolerance Intervals Based on Normality</h2>

<h3>Description</h3>

<p>Estimates k-factors for simultaneous tolerance intervals based on normality.
</p>


<h3>Usage</h3>

<pre><code class="language-R">K.factor.sim(n, l = NULL, alpha = 0.05, P = 0.99, side = 1, 
         method = c("EXACT", "BONF"), m = 50)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>If <code>method = "EXACT"</code>, this is the sample size of each of the <code>l</code> groups. If <code>method = "BONF"</code>, then <code>n</code> can be a vector of different sample sizes for the <code>l</code> groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l</code></td>
<td>
<p>The number of normal populations for which the k-factors will be constructed simultaneously.
If <code>NULL</code>, then it is taken to be the length of <code>n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The level chosen such that <code>1-alpha</code> is the confidence level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>The proportion of the population to be covered by the tolerance interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>side</code></td>
<td>
<p>Whether a k-factor for a 1-sided or 2-sided tolerance interval is required (determined by <code>side = 1</code> or <code>side = 2</code>,
respectively).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The method for calculating the k-factors.  <code>"EXACT"</code> is an exact method that can be used when all <code>l</code> groups have the same sample size. <code>"BONF"</code> is an approximate method using the Bonferroni inequality, which can be used when the <code>l</code> groups have different sample sizes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>The maximum number of subintervals to be used in the <code>integrate</code> function.  This is necessary only for <code>method = "EXACT"</code>.  The larger
the number, the more accurate the solution.  Too low of a value can result in an error. A large value can also cause the function to be slow for <code>method = "EXACT"</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>K.factor</code> returns the k-factor for simultaneous tolerance intervals based on normality with the arguments specified above.
</p>


<h3>Note</h3>

<p>For larger combinations of <code>n</code> and <code>l</code> when <code>side = 2</code> and <code>method = "EXACT"</code>, the calculation can be slow. For larger sample sizes when <code>method = "BONF"</code>, there may be some accuracy issues with the 1-sided calculation since it depends on the noncentral t-distribution.  
The code is primarily intended to be used for moderate values of the noncentrality parameter. It will not be highly accurate, especially in the tails, for large values.
See <code>TDist</code> for further details.
</p>
<p>Thanks to Andrew Landgraf for providing the basic code for the <code>method = "EXACT"</code> procedure.
</p>


<h3>References</h3>

<p>Krishnamoorthy, K. and Mathew, T. (2009), <em>Statistical Tolerance Regions: Theory, Applications, and Computation</em>, Wiley.
</p>
<p>Mee, R. W. (1990), Simultaneous Tolerance Intervals for Normal Populations with Common Variance, <em>Technometrics</em>, <b>32</b>, 83-92.
</p>


<h3>See Also</h3>

<p><code>integrate</code>, <code>K.factor</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"> 
## Reproducing part of Table B5 from Krishnamoorthy and 
## Mathew (2009).

n_sizes &lt;- c(2:20, seq(30, 100, 10))
l_sizes &lt;- 2:10
KM_table &lt;- sapply(1:length(l_sizes), function(i)
                   sapply(1:length(n_sizes), function(j)
                   round(K.factor.sim(n = n_sizes[j], 
                   l = l_sizes[i], side=1, alpha = 0.1, 
                   P = 0.9),3)))
dimnames(KM_table) &lt;- list(n = n_sizes, l = l_sizes)
KM_table

</code></pre>


</div>