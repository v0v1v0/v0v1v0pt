<div class="container">

<table style="width: 100%;"><tr>
<td>RenumberTree</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Reorder tree edges and nodes</h2>

<h3>Description</h3>

<p>Functions for systematically ordering the internal edges of trees.
</p>


<h3>Usage</h3>

<pre><code class="language-R">RenumberTree(parent, child, weight)

RenumberEdges(parent, child, ...)

Cladewise(tree, nTip, edge)

## S3 method for class 'phylo'
Cladewise(tree, nTip = NTip(tree), edge = tree[["edge"]])

## S3 method for class 'list'
Cladewise(tree, nTip, edge)

## S3 method for class 'multiPhylo'
Cladewise(tree, nTip, edge)

## S3 method for class 'matrix'
Cladewise(tree, nTip = min(tree[, 1]) - 1L, edge)

## S3 method for class ''NULL''
Cladewise(tree, nTip = min(tree[, 1]) - 1L, edge)

ApePostorder(tree, nTip, edge)

## S3 method for class 'phylo'
ApePostorder(tree, nTip = NTip(tree), edge = tree[["edge"]])

## S3 method for class 'list'
ApePostorder(tree, nTip, edge)

## S3 method for class ''NULL''
ApePostorder(tree, nTip, edge)

## S3 method for class 'multiPhylo'
ApePostorder(tree, nTip, edge)

Postorder(tree, force = FALSE)

## S3 method for class 'phylo'
Postorder(tree, force = FALSE)

## S3 method for class ''NULL''
Postorder(tree, force = FALSE)

## S3 method for class 'list'
Postorder(tree, force = FALSE)

## S3 method for class 'multiPhylo'
Postorder(tree, force = FALSE)

## S3 method for class 'numeric'
Postorder(tree, force = FALSE)

PostorderOrder(tree)

## S3 method for class 'phylo'
PostorderOrder(tree)

## S3 method for class 'numeric'
PostorderOrder(tree)

Pruningwise(tree, nTip, edge)

## S3 method for class 'phylo'
Pruningwise(tree, nTip = NTip(tree), edge = tree[["edge"]])

## S3 method for class 'list'
Pruningwise(tree, nTip, edge)

## S3 method for class 'multiPhylo'
Pruningwise(tree, nTip, edge)

## S3 method for class ''NULL''
Pruningwise(tree, nTip, edge)

Preorder(tree)

## S3 method for class 'phylo'
Preorder(tree)

## S3 method for class 'numeric'
Preorder(tree)

## S3 method for class 'multiPhylo'
Preorder(tree)

## S3 method for class 'list'
Preorder(tree)

## S3 method for class ''NULL''
Preorder(tree)

TntOrder(tree)

TNTOrder(tree)

## S3 method for class 'phylo'
TntOrder(tree)

## S3 method for class 'numeric'
TntOrder(tree)

## S3 method for class 'multiPhylo'
TntOrder(tree)

## S3 method for class 'list'
TntOrder(tree)

## S3 method for class ''NULL''
TntOrder(tree)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>parent</code></td>
<td>
<p>Integer vector corresponding to the first column of the edge
matrix of a tree of class <code>phylo</code>, i.e.
<code>tree[["edge"]][, 1]</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>child</code></td>
<td>
<p>Integer vector corresponding to the second column of the edge
matrix of a tree of class <code>phylo</code>, i.e.
<code>tree[["edge"]][, 2]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>
<p>Optional vector specifying the weight of each edge,
corresponding to the <code>edge.length</code> property of a <code>phylo</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Deprecated; included for compatibility with previous versions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>A tree of class <code>phylo</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nTip</code></td>
<td>
<p>Integer specifying number of tips (leaves).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edge</code></td>
<td>
<p>Two-column matrix listing the parent and child of each edge in a
tree, corresponding to <code>tree[["edge"]]</code>. Optional in <code>Cladewise()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>force</code></td>
<td>
<p>Logical specifying whether to rearrange trees already in
postorder, in order to ensure edges are ordered in the "TreeTools" fashion.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>Reorder()</code> is a wrapper for <code>ape:::.reorder_ape</code>.
Calling this C function directly is approximately twice as fast as using
<code>ape::cladewise</code> or
<code>ape::postorder</code>
</p>
<p><code>Cladewise()</code>, <code>ApePostorder()</code> and <code>Pruningwise()</code> are convenience
functions to the corresponding functions in "ape".
Single nodes may need to be collapsed using ape::collapse.singles first.
"ape" functions can cause crashes if nodes are numbered unconventionally â€“
sometimes arising after using tree rearrangement functions,
e.g. <code>phangorn::SPR()</code>.
</p>
<p><code>Preorder()</code> is more robust: it supports polytomies, nodes may be numbered
in any sequence, and edges may be listed in any order in the input tree.
Its output is guaranteed to be identical for any tree of an equivalent
leaf labelling (see <code>RenumberTips()</code>) and topology,
allowing unique trees to be detected by comparing sorted edge matrices alone.
</p>
<p>Nodes and edges in a preorder tree are numbered starting from the deepest
node.
Each node is numbered in the sequence in which it is encountered, and
each edge is listed in the sequence in which it is visited.
</p>
<p>At each node, child edges are sorted from left to right in order of the
lowest-numbered leaf in the subtree subtended by each edge; i.e. an edge
that leads eventually to tip 1 will be to the left of an edge leading to a
subtree containing tip 2.
</p>
<p>Numbering begins by following the leftmost edge of the root node,
and sorting its descendant subtree into preorder.
Then, the next edge at the root node is followed, and its descendants
sorted into preorder, until each edge has been visited.
</p>
<p><code>RenumberTree()</code> and <code>RenumberEdges()</code> are wrappers for the C function
<code>preorder_edges_and_nodes()</code>; they do not perform the same checks on input
as <code>Preorder()</code> and are intended for use where performance is at a premium.
</p>
<p><code>Postorder()</code> numbers nodes as in <code>Preorder()</code>, and lists edges in
descending order of parent node number, breaking ties by listing child
nodes in increasing order.  If a tree is already in postorder, it will not
be rearranged unless <code>force = TRUE</code>.
</p>
<p>Methods applied to numeric inputs do not check input for sanity, so should
be used with caution: malformed input may cause undefined results, including
crashing R.
</p>
<p>Trees with &gt;8191 leaves require additional memory and are not handled
by <code>Postorder()</code> at present.
If you need to process such large trees, please contact the maintainer for
advice.
</p>


<h3>Value</h3>

<p><code>RenumberTree()</code> returns an edge matrix for a tree of class <code>phylo</code>
following the preorder convention for edge and node numbering.
</p>
<p><code>RenumberEdges()</code> formats the output of <code>RenumberTree()</code> into a list
whose two entries correspond to the new parent and child vectors,
in preorder.
</p>
<p><code>ApePostorder()</code>, <code>Cladewise()</code>, <code>Postorder()</code>, <code>Preorder()</code> and
<code>Pruningwise()</code> each return a tree of class <code>phylo</code> with nodes following the
specified numbering scheme.
</p>
<p><code>Postorder.numeric</code> accepts a numeric matrix corresponding to the
<code>edge</code> entry of a tree of class <code>phylo</code>, and returns a two-column array
corresponding to <code>tree</code>, with edges listed in postorder
</p>
<p><code>PostorderOrder()</code> returns an integer vector. Visiting edges in this
order will traverse the tree in postorder.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>Cladewise()</code>: Reorder tree cladewise.
</p>
</li>
<li> <p><code>ApePostorder()</code>: Reorder tree in Postorder using ape's <code>postorder</code>
function, which is robust to unconventional node numbering.
</p>
</li>
<li> <p><code>Pruningwise()</code>: Reorder tree Pruningwise.
</p>
</li>
<li> <p><code>Preorder()</code>: Reorder tree in Preorder (special case of cladewise).
</p>
</li>
<li> <p><code>TntOrder()</code>: Reorder tree in postorder, numbering internal nodes
according to <a href="https://stackoverflow.com/a/54296100/3438001">TNT's rules</a>,
which number the root node as <code>nTip + 1</code>, then the remaining nodes in
the sequence encountered when traversing the tree in postorder, starting from
each tip in sequence.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p><code>Preorder()</code> and <code>Postorder()</code>: Martin R. Smith.
</p>
<p><code>Cladewise()</code>, <code>ApePostorder()</code> and <code>Pruningwise()</code>: modified by Martin R.
Smith from <code>.reorder_ape()</code> in <span class="pkg">ape</span> (Emmanuel Paradis).
</p>


<h3>See Also</h3>

<p>Rotate each node into a consistent orientation with <code>SortTree()</code>.
</p>
<p>Other tree manipulation: 
<code>AddTip()</code>,
<code>CollapseNode()</code>,
<code>ConsensusWithout()</code>,
<code>DropTip()</code>,
<code>EnforceOutgroup()</code>,
<code>ImposeConstraint()</code>,
<code>KeptPaths()</code>,
<code>KeptVerts()</code>,
<code>LeafLabelInterchange()</code>,
<code>MakeTreeBinary()</code>,
<code>Renumber()</code>,
<code>RenumberTips()</code>,
<code>RootTree()</code>,
<code>SortTree()</code>,
<code>Subtree()</code>,
<code>TipTimedTree()</code>,
<code>TrivialTree</code>
</p>
<p>Other C wrappers: 
<code>Neworder</code>
</p>
<p>Other C wrappers: 
<code>Neworder</code>
</p>


</div>