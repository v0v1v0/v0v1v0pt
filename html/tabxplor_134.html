<div class="container">

<table style="width: 100%;"><tr>
<td>tab_xl_confidential</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Excel output for tabxplor tables with confidentiality rules.</h2>

<h3>Description</h3>

<p>Excel output for tabxplor tables, with colors to show if counts
and percentages respect statistical confidentiality rules. Don't forget to provide
<code>subtext = c("Source : description of the source of the data")</code> in <code>tab</code> or <code>tab_many</code>,
otherwise it is not possible to assess, for your reader, which confidentiality rules
applies. For the same reason, you must supply a description of all variables in
<code>var_labels</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tab_xl_confidential(
  tabs,
  path = NULL,
  replace = NULL,
  open = rlang::is_interactive(),
  n_min = 5,
  pct_max = 0.95,
  recalculate_totcols = NULL,
  var_labels = character(),
  colnames_rotation = 0,
  colwidth = 10,
  sheets = "unique",
  print_color_legend = TRUE,
  titles,
  hide_near_zero = "auto",
  color_type = "text"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tabs</code></td>
<td>
<p>A table made with <code>tab</code>, <code>tab_many</code> or
<code>tab_plain</code>, or a list of such tables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>path, replace, open</code></td>
<td>
<p>The name, and possibly the path, of the Excel file to
create (possibly without the .xlsx extension). Default path to temporary directory.
Set global option <code>"tabxplor.export_dir"</code> with <code>link[base:options]{options}</code>
to change default directory. By default replace is <code>TRUE</code> when <code>path</code> is provided,
<code>FALSE</code> when <code>path</code> is not provided.
Use <code>replace = TRUE</code> to overwrite existing files. Use <code>open = FALSE</code>
if you don't want to automatically open the tables in Excel (or another
software associated with .xlsx files).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_min</code></td>
<td>
<p>The total count under which a column or row doesnt respect statistical
confidentiality. Default to 5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pct_max</code></td>
<td>
<p>The row or column percentage above which, knowing the column category,
it becomes possible to guess the row category, or the other way round.
Default to 0.95 (95%).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>recalculate_totcols</code></td>
<td>
<p>By default, total columns are recalculated from counts if
there are many <code>col_vars</code> but only one total column. Provide a logical vector the
length of the number of tables, or a single logical, to choose the wanted behavior.
The fastest way to do it is to use <code>tab_many()</code> with <code>totcol = "each"</code> before.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var_labels</code></td>
<td>
<p>The description of all the variables, necessary to assess that
the tables don't break confidentiality rules, as a character vector of the type
<code>c('variable1' = 'description of the variable', 'variable2' = ...)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colnames_rotation</code></td>
<td>
<p>Rotate the names of columns to an angle (in degrees).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colwidth</code></td>
<td>
<p>The standard width for numeric columns, as a number.
Default to 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sheets</code></td>
<td>
<p>The Excel sheets options :
</p>

<ul>
<li> <p><code>"unique"</code>: all tables are on the same sheet
</p>
</li>
<li> <p><code>"tabs"</code>: a new sheet is created for each table
</p>
</li>
<li> <p><code>"auto"</code>: subsequent tables with the same columns are printed on the
same sheets
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print_color_legend</code></td>
<td>
<p>Should the color legends be printed with the subtexts ?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>titles</code></td>
<td>
<p>The titles of the different tables, as a character vector. When missing
titles are given based on the names of the variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hide_near_zero</code></td>
<td>
<p>By default all cells displayed as 0 (even rounded)
turn pale grey, to make the distribution of empty cells (and other cells) more visible.
Provide a number to turn grey every cell below it. Set to <code>Inf</code> not to use
this feature.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color_type</code></td>
<td>
<p>By default, the text is colored. Set to <code>"bg"</code> to color
the background instead.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The table(s) with formatting and colors in an Excel file, as a side effect.
Invisibly returns <code>tabs</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
forcats::gss_cat |&gt;
  tab(race, marital, year, pct = "row", color = "diff",
     subtext = c('Source : National Opinion Research Center, General Social Survey.')) |&gt;
  tab_xl_confidential(titles = "Marital status by race",
     var_labels = c("marital" = "marital status", "race" = "race",
     "year" = "year of survey"))
  
</code></pre>


</div>