<div class="container">

<table style="width: 100%;"><tr>
<td>seqplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot state sequence objects</h2>

<h3>Description</h3>

<p>High level plot functions to render state sequence objects. Can produce many different types of plots and can render sequences by group.
</p>


<h3>Usage</h3>

<pre><code class="language-R">seqplot(seqdata,
  group = NULL,
  type = "i",
  main = "auto",
  cpal = NULL,
  missing.color = NULL,
  ylab = NULL,
  yaxis = "all",
  xaxis = "all",
  xtlab = NULL,
  cex.axis = 1,
  with.legend = "auto",
  ltext = NULL,
  cex.legend = 1,
  use.layout = (!is.null(group) | with.legend != FALSE),
  legend.prop = NA,
  rows = NA,
  cols = NA,
  title, cex.plot, withlegend, axes,
  ...)

seqdplot(seqdata, group = NULL, main = "auto", ...)
seqdHplot(seqdata, group = NULL, main = "auto", ...)
seqfplot(seqdata, group = NULL, main = "auto", ...)
seqiplot(seqdata, group = NULL, main = "auto", ...)
seqIplot(seqdata, group = NULL, main = "auto", ...)
seqHtplot(seqdata, group = NULL, main = "auto", ...)
seqmsplot(seqdata, group = NULL, main = "auto", ...)
seqmtplot(seqdata, group = NULL, main = "auto", ...)
seqrplot(seqdata, group = NULL, main = "auto", ...)
seqrfplot(seqdata, group = NULL, main = "auto", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>seqdata</code></td>
<td>
<p>State sequence object created with the <code>seqdef</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>Grouping variable of length equal to the number of sequences. When not <code>NULL</code>, a distinct plot is generated for each level of <code>group</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>the type of the plot. Available types are <code>"d"</code>
for state distribution plots (chronograms), <code>"dH"</code> for chronograms
with overlayed entropy line, <code>"f"</code> for sequence frequency
plots, <code>"Ht"</code> for transversal entropy plots, <code>"i"</code> for
selected sequence index plots, <code>"I"</code> for whole set index
plots, <code>"ms"</code> for plotting the sequence of modal states,
<code>"mt"</code> for mean times plots, <code>"pc"</code> for parallel
coordinate plots, <code>"r"</code> for representative sequence plots, and
<code>"rf"</code> for relative frequency plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>Character string. Title of the graphic. Default <code>"auto"</code> prints group levels as default title when group is not <code>NULL</code> and no title otherwise. Set as <code>NULL</code> to suppress titles. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cpal</code></td>
<td>
<p>Color palette of the states. By default, the <code>cpal</code> attribute of the <code>seqdata</code> sequence object is used (see <code>seqdef</code>). If user specified, a vector of colors of length and order corresponding to <code>alphabet(seqdata)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>missing.color</code></td>
<td>
<p>Color for representing missing values inside the sequences. By default, this color is taken from the <code>missing.color</code> attribute of <code>seqdata</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>Character string or vector of strings. Optional label of the y-axis. If a vector, y-axis label of each group level. If set as <code>NA</code>, no label is drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yaxis</code></td>
<td>
<p>Logical or one of <code>"all"</code> or <code>"left"</code>. If set as <code>TRUE</code> or <code>"all"</code> (default value), sequence index numbers are displayed for <code>"i"</code> and <code>"I"</code>, mean time values for <code>"mt"</code>, percentages for <code>"d"</code> and <code>"f"</code>, and state/event labels for <code>"pc"</code>. Ignored for <code>"r"</code>. If <code>"left"</code> and <code>group</code> is used, the y-axis is displayed on plots of the left panel only. If <code>FALSE</code> no y-axis is drawn. For type <code>"f"</code>, can also be one of <code>"pct"</code> or <code>"left.pct"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xaxis</code></td>
<td>
<p>Logical or one of <code>"all"</code> or <code>"bottom"</code>. If set as <code>TRUE</code> or <code>"all"</code> (default value) x-axes are drawn for each plot in the graphic. If set as <code>"bottom"</code> and <code>group</code> is used, axes are drawn under the plots of the bottom panel only. If <code>FALSE</code>, no x-axis is drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xtlab</code></td>
<td>
<p>Vector of length equal to the number of columns of <code>seqdata</code>. Optional x-axis tick labels. If unspecified, column names of the <code>seqdata</code> sequence object are used (see <code>seqdef</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.axis</code></td>
<td>
<p>Real value.
Axis annotation magnification. When <code>type = "r"</code> and for <code>seqrplot()</code>,
it also determines the magnification of the plotted text and symbols.
See <code>par</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>with.legend</code></td>
<td>
<p>Character string or logical. Defines if and where the legend of the state colors is plotted. The default value <code>"auto"</code> sets the position of the legend automatically. Other possible value is <code>"right"</code>. Obsolete value <code>TRUE</code> is equivalent to <code>"auto"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ltext</code></td>
<td>
<p>Vector of character strings of length and order corresponding to  <code>alphabet(seqdata)</code>. Optional description of the states to appear in the legend. If unspecified, the <code>label</code> attribute of the <code>seqdata</code> sequence object is used (see <code>seqdef</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.legend</code></td>
<td>
<p>Real. Legend magnification. See <code>legend</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.layout</code></td>
<td>
<p>Logical. Should <code>layout</code> be used to arrange plots when using the group option or plotting a legend? When layout is activated, the standard '<code>par(mfrow=....)</code>' for arranging plots does not work. With <code>with.legend=FALSE</code> and <code>group=NULL</code>, layout is automatically deactivated and '<code>par(mfrow=....)</code>' can be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.prop</code></td>
<td>
<p>Real in range [0,1]. Proportion of the graphic area devoted to the legend plot when <code>use.layout=TRUE</code> and <code>with.legend=TRUE</code>. Default value is set according to the place (bottom or right of the graphic area) where the legend is plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rows,cols</code></td>
<td>
<p>Integers. Number of rows and columns of the plot panel when <code>use.layout=TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>Deprecated. Use <code>main</code> instead.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.plot</code></td>
<td>
<p>Deprecated. Use <code>cex.axis</code> instead.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>withlegend</code></td>
<td>
<p>Deprecated. Use <code>with.legend</code> instead.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axes</code></td>
<td>
<p>Deprecated. Use <code>xaxis</code> instead.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments to be passed to the function called to produce the appropriate statistics and the associated plot method (see details), or other graphical parameters. For example, the <code>weighted</code> argument can be passed to control whether (un)weighted statistics are produced, and <code>with.missing=TRUE</code> to take missing values into account when computing cross-sectional or longitudinal state distributions. Can also include arguments of <code>legend</code> such as <code>bty="n"</code> to suppress the box surrounding the legend.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>seqplot</code> is the generic function for high level plots of state sequence objects with group splits and automatic display of the color legend. Many different types of plots can be produced by means of the <code>type</code> argument. Except for sequence index plots, <code>seqplot</code> first calls the specific function producing the required statistics and then the plot method for objects produced by this function (see below). For sequence index plots, the state sequence object itself is plotted by calling the <code>plot.stslist</code> method. When splitting by groups and/or displaying the color legend, the <code>layout</code> function is used for arranging the plots.
</p>
<p>The <code>seqdplot</code>, <code>seqdHplot</code>, <code>seqfplot</code>, <code>seqiplot</code>, <code>seqIplot</code>,
<code>seqHtplot</code>, <code>seqmsplot</code>, <code>seqmtplot</code>, <code>seqpcplot</code>
and <code>seqrplot</code> functions are aliases for calling <code>seqplot</code>
with <code>type</code> argument set respectively to <code>"d"</code>, <code>"dH"</code>, <code>"f"</code>,
<code>"i"</code>, <code>"I"</code>, <code>"Ht"</code>, <code>"ms"</code>, <code>"mt"</code>,
<code>"pc"</code> or <code>"r"</code>.
</p>
<p>A <em>State distribution plot</em> (<code>type="d"</code>) represents the sequence of the cross-sectional state frequencies by position (time point) computed by the <code>seqstatd</code> function and rendered with the <code>plot.stslist.statd</code> method. Such plots are also known as <em>chronograms</em>.
</p>
<p>A <em>Sequence frequency plots</em> (<code>type="f"</code>) displays the most frequent sequences, each one with an horizontal stack bar of its successive states. Sequences are displayed bottom-up in decreasing order of their frequencies (computed by the <code>seqtab</code> function). The <code>plot.stslist.freq</code> plot method is called for producing the plot. <br>
The <code>idxs</code> optional argument may be specified for selecting the sequences to be plotted (default is 1:10, i.e. the 10 most frequent sequences). The width of the bars representing the sequences is by default proportional to their frequencies, but this can be disabled with the <code>pbarw=FALSE</code> optional argument. If weights have been specified when creating <code>seqdata</code>, weighted frequencies are used unless you set the <code>weighted=TRUE</code> option. See examples below, the <code>seqtab</code> and <code>plot.stslist.freq</code> manual pages for a complete list of optional arguments and <cite>Müller et al., (2008)</cite> for a description of sequence frequency plots.
</p>
<p>In <em>sequence index plots</em> (<code>type="i"</code> or <code>type="I"</code>), the requested individual sequences are rendered with horizontal stacked bars depicting the states over successive positions (time). Optional arguments are <code>idxs</code> for specifying the indexes of the sequences to be plotted (when <code>type="i"</code> defaults to the first ten sequences, i.e <code>idxs=1:10</code>). For nicely plotting a (large) whole set of sequences, use <code>type="I"</code> which is  <code>type="i"</code> with <code>idxs=0</code> and the additional graphical parameters <code>border=NA</code> and <code>space=0</code> to suppress bar borders and space between bars. The <code>sortv</code> argument can be used to pass a vector of numerical values for sorting the sequences or to specify a sorting method. See <code>plot.stslist</code> for a complete list of optional arguments and their description.
</p>
<p>The interest of sequence index plots has, for instance, been stressed by <cite>Scherer (2001)</cite> and <cite>Brzinsky-Fay et al. (2006)</cite>. Notice that index plots for thousands of sequences result in very heavy PDF or POSTSCRIPT graphic files. Dramatic file size reduction may be achieved by saving the figures in bitmap format by using for instance the <code>png</code> graphic device instead of <code>postscript</code> or <code>pdf</code>.
</p>
<p>The <em>transversal entropy plot</em> (<code>type="Ht"</code>) displays the evolution over positions of the cross-sectional entropies (<cite>Billari, 2001</cite>). Cross-sectional entropies are computed by calling <code>seqstatd</code> function and then plotted with the <code>plot.stslist.statd</code> plot method. With <code>type="dH"</code>, the entropy line is overlayed on the state distribution plot. Due to argument name conflict, use <code>col.entr=</code> to set the color of the overlayed entropy curve (<code>col</code> argument of <code>plot.stslist.statd</code>).
</p>
<p>The <em>modal state sequence plot</em> (<code>type="ms"</code>) displays the sequence of the modal states with each mode proportional to its frequency at the given position. The <code>seqmodst</code> function is called which returns the sequence and the result is plotted by calling the <code>plot.stslist.modst</code> plot method.
</p>
<p>The <em>mean time plot</em> (<code>type="mt"</code>) displays the mean time spent in each state of the alphabet as computed by the <code>seqmeant</code> function. The <code>plot.stslist.meant</code> plot method is used to plot the resulting statistics. Set <code>serr=TRUE</code> to display error bars on the mean time plot. Bar labels can be specified by passing the <code>bar.labels</code> among the <code>...</code> arguments. In that case, <code>bar.labels</code> must be either a matrix with group specific labels in columns or a single vector to display the same labels for all groups.
</p>
<p>The <em>representative sequence plot</em> (<code>type="r"</code>) displays a reduced, non redundant set of representative sequences extracted from the provided state sequence object and sorted according to a representativeness criterion. The <code>seqrep</code> function is called to extract the representative set which is then plotted by calling the <code>plot.stslist.rep</code> method. A distance matrix is required that is passed with the <code>diss</code> argument or by calling the <code>seqdist</code> function if <code>diss=NULL</code>. The <code>criterion</code> argument sets the representativeness criterion used to sort the sequences.  Refer to the <code>seqrep</code> and <code>plot.stslist.rep</code> manual pages for a complete list of optional arguments.  See <cite>Gabadinho and Ritschard (2013)</cite> for more details on the extraction of representative sets. Also look at the examples below.
</p>
<p><em>Relative frequency plot</em> (<code>type="rf"</code>) displays the medoids of equal sized groups <cite>Fasang and Liao (2014)</cite>. The partition into equal sized groups and the identification of the medoids is done by calling <code>seqrf</code> and plots are generated by <code>plot.seqrf</code>. See these functions for possible options. Option <code>which.plot = "both"</code> applies only when <code>group = NULL</code>. Whatever the value of <code>info</code>, <code>seqplot</code> does not display the statistics on the plot. When <code>sortv="mds"</code> is set, the first MDS factor of the whole <code>diss</code> matrix is computed and used for sorting each group. Set <code>sortv=NULL</code> to use the original data order.
</p>
<p>For <em>decorated parallel coordinate plots</em> (<code>type="pc"</code>) see the specific manual page of <code>seqpcplot</code>.
</p>


<h3>Author(s)</h3>

<p>Alexis Gabadinho and Gilbert Ritschard</p>


<h3>References</h3>

<p>Billari, F. C. (2001). The analysis of early life courses: Complex description of
the transition to adulthood. <em>Journal of Population Research</em> <b>18</b>(2), 119-142.
</p>
<p>Brzinsky-Fay C., U. Kohler, M. Luniak (2006). Sequence Analysis with Stata. <em>The Stata Journal</em>, <b>6</b>(4), 435-460.
</p>
<p>Fasang, A.E. and T.F. Liao. (2014). Visualizing Sequences in the Social Sciences: Relative Frequency Sequence Plots. <em>Sociological Methods and Research</em> <b>43</b>(4), 643-676.
</p>
<p>Gabadinho, A., and G. Ritschard (2013), "Searching for typical life trajectories applied to childbirth histories", In Levy, R. &amp; Widmer, E. (eds) <em>Gendered life courses - Between individualization and standardization. A European approach applied to Switzerland</em>, pp. 287-312. Vienna: LIT.
</p>
<p>Gabadinho, A., G. Ritschard, N.S. Müller and M. Studer (2011). Analyzing and Visualizing State Sequences in R with TraMineR. <em>Journal of Statistical Software</em> <b>40</b>(4), 1-37.
</p>
<p>Gabadinho A., G. Ritschard, M. Studer, N.S. Müller (2011). "Extracting and Rendering Representative Sequences", In A Fred, JLG Dietz, K Liu, J Filipe (eds.), <em>Knowledge Discovery, Knowledge Engineering and Knowledge Management</em>, volume 128 of <em>Communications in Computer and Information Science (CCIS)</em>, pp. 94-106. Springer-Verlag.
</p>
<p>Müller, N.S., A. Gabadinho, G. Ritschard and M. Studer (2008). Extracting knowledge from life courses: Clustering and visualization. In <em>Data Warehousing and Knowledge Discovery, 10th International Conference  DaWaK 2008, Turin, Italy, September 2-5</em>, LNCS 5182, Berlin: Springer, 176-185.
</p>
<p>Scherer S (2001). Early Career Patterns: A Comparison of Great Britain and West Germany.
<em>European Sociological Review</em>, <b>17</b>(2), 119-144.
</p>


<h3>See Also</h3>

<p><code>plot.stslist.statd</code>, <code>plot.stslist.freq</code>, <code>plot.stslist</code>, <code>plot.stslist.modst</code>, <code>plot.stslist.meant</code>, <code>plot.stslist.rep</code>, <code>seqrep</code>,
<code>seqpcplot</code>,
<code>seqsplot</code>,
<code>seqplotMD</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## ======================================================
## Creating state sequence objects from example data sets
## ======================================================

## biofam data set
data(biofam)
## We use only a sample of 300 cases
set.seed(10)
biofam &lt;- biofam[sample(nrow(biofam),300),]
biofam.lab &lt;- c("Parent", "Left", "Married", "Left+Marr",
                "Child", "Left+Child", "Left+Marr+Child", "Divorced")
biofam.seq &lt;- seqdef(biofam, 10:25, labels=biofam.lab)

## actcal data set
data(actcal)
## We use only a sample of 300 cases
set.seed(1)
actcal &lt;- actcal[sample(nrow(actcal),300),]
actcal.lab &lt;- c("&gt; 37 hours", "19-36 hours", "1-18 hours", "no work")
actcal.seq &lt;- seqdef(actcal,13:24,labels=actcal.lab)

## ex1 using weights
data(ex1)
ex1.seq &lt;- seqdef(ex1, 1:13, weights=ex1$weights)

## ====================
## Sequence index plots
## ====================

## First ten sequences
seqiplot(biofam.seq)

## All sequences sorted by age in 2000
## grouped by sex
seqIplot(actcal.seq, group=actcal$sex, sortv=actcal$age00)


## =======================
## State distribution plot
## =======================

## biofam grouped by sex
seqplot(biofam.seq, type="d", group=actcal$sex)

## actcal grouped by sex
seqplot(actcal.seq, type="d", group=actcal$sex)

## with overlayed entropy line
seqplot(actcal.seq, type="dH", group=actcal$sex)

## ===================
## Cross-sectional entropy plot
## ===================
seqplot(biofam.seq, type="Ht", group=biofam$sex)

## ========================
## Sequence frequency plots
## ========================

## Plot of the 10 most frequent sequences
seqplot(biofam.seq, type="f")

## Grouped by sex
seqfplot(actcal.seq, group=actcal$sex)

## Unweighted vs weighted frequencies
seqfplot(ex1.seq, weighted=FALSE)
seqfplot(ex1.seq, weighted=TRUE)

## =====================
## Modal states sequence
## =====================
seqplot(biofam.seq, type="ms")
## same as
seqmsplot(biofam.seq)

## ====================
## Representative plots
## ====================

## Computing a distance matrix
## with OM metric
costs &lt;- seqcost(actcal.seq, method="INDELSLOG")
actcal.om &lt;- seqdist(actcal.seq, method="OM", sm=costs$sm, indel=costs$indel)

## Plot of the representative sets grouped by sex
## using the default density criterion
seqrplot(actcal.seq, group=actcal$sex, diss=actcal.om, coverage=.5)

## Plot of the representative sets grouped by sex
## using the "dist" (centrality) criterion
seqrplot(actcal.seq, group=actcal$sex, criterion="dist", diss=actcal.om, coverage=.33)

## ========================
## Relative frequency plots
## ========================
## Using default sorting by first MDS variable
seqrfplot(actcal.seq, diss=actcal.om, sortv=NULL, group=actcal$sex)


## ===============
## Mean time plot
## ===============

## actcal data set, grouped by sex
seqplot(actcal.seq, type="mt", group=actcal$sex)

## displaying mean times as bar labels
group &lt;- factor(actcal$sex)
blab &lt;- NULL
for (i in 1:length(levels(group))){
  blab &lt;- cbind(blab,seqmeant(actcal.seq[group==levels(group)[i],]))
}
seqmtplot(actcal.seq, group=group,
          bar.labels = round(blab,digits=2), cex.barlab=1.2)

</code></pre>


</div>