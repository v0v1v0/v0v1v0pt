<div class="container">

<table style="width: 100%;"><tr>
<td>draw_heatmap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>draw a heatmap plot</h2>

<h3>Description</h3>

<p>warning a heatmap plot for expression matrix and group by group_list praramter, exp will be scaled.
</p>


<h3>Usage</h3>

<pre><code class="language-R">draw_heatmap(
  n,
  group_list,
  scale_before = FALSE,
  n_cutoff = 3,
  legend = FALSE,
  show_rownames = FALSE,
  annotation_legend = FALSE,
  split_column = FALSE,
  show_column_title = FALSE,
  color = (grDevices::colorRampPalette(c("#2fa1dd", "white", "#f87669")))(100),
  color_an = c("#2fa1dd", "#f87669", "#e6b707", "#868686", "#92C5DE", "#F4A582",
    "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494",
    "#B3B3B3"),
  scale = TRUE,
  main = NA,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>A numeric matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group_list</code></td>
<td>
<p>A factor with duplicated character or factor</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale_before</code></td>
<td>
<p>deprecated parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_cutoff</code></td>
<td>
<p>3 by defalut , scale before plot and set a cutoff,usually 2 or 1.6</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>
<p>logical,show legend or not</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_rownames</code></td>
<td>
<p>logical,show rownames or not</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>annotation_legend</code></td>
<td>
<p>logical,show annotation legend or not</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>split_column</code></td>
<td>
<p>split column by group_list</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_column_title</code></td>
<td>
<p>show column title or not</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color</code></td>
<td>
<p>color for heatmap</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color_an</code></td>
<td>
<p>color for column annotation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>logical,scale the matrix or not</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>the title of the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other parameters from pheatmap</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a heatmap plot according to <code>exp</code> and grouped by <code>group</code>.
</p>


<h3>Author(s)</h3>

<p>Xiaojie Sun
</p>


<h3>See Also</h3>

<p><code>draw_pca</code>;<code>draw_volcano</code>;<code>draw_venn</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#example data
exp = matrix(abs(rnorm(60,sd = 16)),nrow = 10)
exp[,4:6] &lt;- exp[,4:6]+20
colnames(exp) &lt;- paste0("sample",1:6)
rownames(exp) &lt;- paste0("gene",1:10)
exp[1:4,1:4]
group_list = factor(rep(c("A","B"),each = 3))
if(requireNamespace("ggplotify",quietly = TRUE)){
  draw_heatmap(exp,group_list)
  #use iris
  n = t(iris[,1:4]);colnames(n) = 1:150
  group_list = iris$Species
  draw_heatmap(n,group_list)
  draw_heatmap(n,group_list,color = colorRampPalette(c("green","black","red"))(100),
               color_an = c("red","blue","pink") )
}else{
  warning("Package 'ggplotify' needed for this function to work.
    Please install it by install.packages('ggplotify')")
}
</code></pre>


</div>