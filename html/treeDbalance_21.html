<div class="container">

<table style="width: 100%;"><tr>
<td>extendPhylo</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Useful extensions to the phylo format</h2>

<h3>Description</h3>

<p><code>extendPhylo</code> - Extends a tree in phylo or phylo3D format, i.e., adds 
or updates several useful attributes of the tree that facilitate various
computations and allow it to be independent of a certain node enumeration.
These are: information on descendants, ancestors, and depths 
as well as on the centroids of all pending subtrees. The latter is 
only computed if the tree is in phylo3D format and as such contains the
attributes 'node.coord' and 'edge.weight'.
</p>
<p><code>getDescs</code> - Creates a matrix with two rows, the second contains 
in the <code class="reqn">i</code>-th entry the index of the first row in which the 
descendants of node <code class="reqn">i</code> start. Use the function <code>getChildren</code> 
to quickly retrieve the direct descendants of each node.
</p>
<p><code>getChildren</code> - Creates a vector containing the direct children of a 
node. If the method indicates that also edges should be returned, this 
function will also return the number (identifier) of the incoming edge of 
each child.
</p>
<p><code>getDescendants</code> - Creates a vector containing all descendants of a 
node.
</p>
<p><code>getAncs</code> - Creates a matrix that contains the parent (direct ancestor) 
of node <code class="reqn">i</code> as well as the corresponding edge number in column <code class="reqn">i</code>.
</p>
<p><code>getNodeDepths</code> - Creates a matrix with three rows:
The first contains the nodes ordered by increasing depth. The second
contains the indices at which the next depth starts in the first row, i.e.,
these first two rows are similar to the output matrix of <code>getDescs</code>.
The last row contains the depth of each node.
</p>
<p><code>getNodesAtDepth</code> - Creates a vector containing the nodes at a certain 
depth.
</p>
<p><code>getLeaves</code> - Creates a logical vector that indicates if the <code class="reqn">i</code>-th
node is a leaf.
</p>
<p><code>getSubtrCentr</code> - Calculates the centroid of each pending subtree. 
Returns a matrix containing the 3D coordinates (3 columns) where row <code class="reqn">i</code>
gives the position of the centroid of <code class="reqn">T_i</code>, the pending subtree rooted
in node <code class="reqn">i</code>.
</p>
<p><code>getDistFromRoot</code> - Creates a vector containing the length of the path 
from the node to the root, i.e., the sum of the corresponding edge lengths.
</p>
<p><code>getDistFromLeaf</code> - Creates a vector containing the length of the path 
from the node to the nearest descendant leaf, i.e., the sum of the 
corresponding edge lengths.
</p>
<p><code>getIncEdgeLens</code> - Returns the length of the incoming edge of every
node as a numeric vector.
</p>
<p><code>getIncEdgeWeights</code> - Returns the weight of the incoming edge of every
node as a numeric vector.
</p>


<h3>Usage</h3>

<pre><code class="language-R">extendPhylo(tree)

getDescs(tree)

getChildren(tree, node, method = "onlyNodes")

getDescendants(tree, node)

getAncs(tree)

getNodeDepths(tree)

getNodesAtDepth(tree, depth)

getLeaves(tree)

getSubtrCentr(tree)

getDistFromRoot(tree)

getDistFromLeaf(tree)

getIncEdgeLens(tree)

getIncEdgeWeights(tree)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>A rooted tree in phylo3D format (no special node enumeration 
required, except that nodes are numbered from 1 to |V| = the total number of
nodes). There must be at least 2 nodes, i.e., one edge. The attributes 
'node.coord' and 'edge.weight' are strictly required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>node</code></td>
<td>
<p>Numeric/integer value representing a node of the tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>A string specifying if only descending nodes or also
descending edges should be returned. Can be one of 'onlyNodes' or 
'alsoEdges'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>depth</code></td>
<td>
<p>An integer value representing the depth of interest in the tree.
A depth of 0 indicates the root layer, 1 the layer of its children, and so 
forth.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>extendPhylo</code> Tree in extended phylo(3D) format, 
i.e., phylo(3D) format with further attributes.
</p>
<p><code>getDescs</code> Numeric matrix with 2 rows.
</p>
<p><code>getChildren</code> Depending on the method the function either
returns an integer vector containing the direct descendants of a node
or an integer matrix with two rows, the first containing the direct
descendants and the second the corresponding incoming edges.
</p>
<p><code>getAncs</code> Integer matrix with 2 rows. The first 
row contains the direct ancestor of each node, the second row the incoming
edge of this node, i.e., the edge that leads to its ancestor.
</p>
<p><code>getNodeDepths</code> Numeric matrix with 3 rows.
</p>
<p><code>getNodesAtDepth</code> Integer/numeric vector 
containing all nodes at the desired depth.
</p>
<p><code>getLeaves</code> Creates a logical vector that indicates if the 
<code class="reqn">i</code>-th node is a leaf, TRUE for leaf and FALSE for interior node.
</p>
<p><code>getSubtrCentr</code> Numeric matrix with 2 columns.
</p>
<p><code>getDistFromRoot</code> Integer/numeric vector containing the length 
of the path from each node to the root.
</p>
<p><code>getDistFromLeaf</code> Integer/numeric vector containing the length 
of the path from each node to its nearest descendant leaf.
</p>
<p><code>getIncEdgeLens</code> Numeric vector containing the 
length of the incoming edge of each node, i.e., the length of the
edge from its direct ancestor to the node itself.
</p>
<p><code>getIncEdgeWeights</code> Numeric vector containing the 
weight of the incoming edge of each node, i.e., the weight of the
edge from its direct ancestor to the node itself.
</p>


<h3>Author(s)</h3>

<p>Sophie Kersting
</p>


<h3>Examples</h3>

<pre><code class="language-R">tree &lt;- treeDbalance::example3Dtrees$bean09
ext_tree &lt;- extendPhylo(tree)
getDescs(tree)
getChildren(ext_tree, 3, method="alsoEdges")
getDescendants(ext_tree,3)
getAncs(tree)
getNodeDepths(tree)
getNodesAtDepth(tree,4)
getLeaves(tree)
getSubtrCentr(ext_tree)
getDistFromRoot(ext_tree)
getDistFromLeaf(ext_tree)
getIncEdgeLens(tree)
getIncEdgeWeights(tree)
</code></pre>


</div>