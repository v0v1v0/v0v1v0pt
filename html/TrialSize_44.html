<div class="container">

<table style="width: 100%;"><tr>
<td>OneSide.varyEffect</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
One-Sided Tests with varying effect sizes
</h2>

<h3>Description</h3>

<p>One-sided tests 
</p>
<p>Ho: <code class="reqn"> \delta_j = 0 </code>
</p>
<p>Ha: <code class="reqn"> \delta_j &gt; 0 </code> 
</p>


<h3>Usage</h3>

<pre><code class="language-R">OneSide.varyEffect(s1, s2, m, m1, delta, a1, r1, fdr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>s1</code></td>
<td>

<p>We use bisection method to find the sample size, which let the equation h(n)=0. Here s1 and s2 are the initial value, 0&lt;s1&lt;s2. h(s1) should be smaller than 0. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s2</code></td>
<td>

<p>s2 is also the initial value, which is larger than s1 and h(s2) should be larger than 0. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>

<p>m is the total number of multiple tests
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m1</code></td>
<td>

<p>m1 = m - m0. m0 is the number of tests which the null hypotheses are true ;
m1 is the number of tests which the alternative hypotheses are true. (or m1 is the number of prognostic genes)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>

<p><code class="reqn">\delta_j</code> is the constant effect size for jth test. <code class="reqn"> \delta_j=(E(Xj)-E(Yj))/\sigma_j</code>.
<code class="reqn">X_{ij}(Y_{ij})</code> denote the expression level of gene j for subject i in group 1( and group 2, respectively) with common variance 
<code class="reqn">\sigma_{j}^{2}</code>. We assume <code class="reqn">\delta_j=0,~ j~ in~ M0</code> and <code class="reqn">\delta_j &gt;0, ~j~ in~ M1</code>=effect size for prognostic genes. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a1</code></td>
<td>

<p>a1 is the allocation proportion for group 1. a2=1-a1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r1</code></td>
<td>

<p>r1 is the number of true rejection
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fdr</code></td>
<td>

<p>fdr is the FDR level.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>alpha_star=r1*fdr/((m-m1)*(1-fdr)), which is the marginal type I error level for r1 true rejection with the FDR controlled at f. 
</p>
<p>beta_star=1-r1/m1, which is equal to 1-power.
</p>


<h3>References</h3>

<p>Chow SC, Shao J, Wang H. Sample Size Calculation in Clinical Research. New York: Marcel Dekker, 2003
</p>


<h3>Examples</h3>

<pre><code class="language-R">delta=c(rep(1,40/2),rep(1/2,40/2));

Example.12.2.2 &lt;- OneSide.varyEffect(100,150,4000,40,delta,0.5,24,0.01)
Example.12.2.2
# n=148 s1&lt;n&lt;s2, h(s1)&lt;0,h(s2)&lt;0
</code></pre>


</div>