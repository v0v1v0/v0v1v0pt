<div class="container">

<table style="width: 100%;"><tr>
<td>msq.itemfit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Mean Squared Residual Based Item Fit Statistics (Infit, Outfit)
</h2>

<h3>Description</h3>

<p>The function <code>msq.itemfit</code> computes computed the outfit and infit statistic
for items or item groups. Contrary to <code>tam.fit</code>, the function
<code>msq.itemfit</code> is not based on simulation from individual posterior distributions
but rather on evaluating the individual posterior.
</p>
<p>The function <code>msq.itemfit</code> also computes the outfit and infit statistics
but these are based on weighted likelihood estimates obtained from
<code>tam.wle</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">msq.itemfit( object, fitindices=NULL)

## S3 method for class 'msq.itemfit'
summary(object, file=NULL, ... )

msq.itemfitWLE( tamobj, fitindices=NULL, ... )

## S3 method for class 'msq.itemfitWLE'
summary(object, file=NULL, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>Object for which the classes <code>IRT.data</code>,
<code>IRT.posterior</code> and <code>predict</code> are defined.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitindices</code></td>
<td>
<p>Vector with parameter labels defining the item groups for
which the fit should be evaluated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tamobj</code></td>
<td>
<p>Object of class <code>tam.mml</code>, <code>tam.mml.2pl</code>
or <code>tam.mml.mfr</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>Optional name of a file to which the summary should be written</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>List with following entries
</p>
<table>
<tr style="vertical-align: top;">
<td><code>itemfit</code></td>
<td>
<p>Data frame with outfit and infit statistics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>summary_itemfit</code></td>
<td>
<p>Summary statistics of outfit
and infit</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p>See also <code>tam.fit</code> for simulation based assessment of item fit.
</p>
<p>See also <code>eRm::itemfit</code> or <code>mirt::itemfit</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 

#############################################################################
# EXAMPLE 1: Simulated data Rasch model
#############################################################################

#*** simulate data
library(sirt)
set.seed(9875)
N &lt;- 2000
I &lt;- 20
b &lt;- sample( seq( -2, 2, length=I ) )
a &lt;- rep( 1, I )
# create some misfitting items
a[c(1,3)] &lt;- c(.5, 1.5 )
# simulate data
dat &lt;- sirt::sim.raschtype( rnorm(N), b=b, fixed.a=a )
#*** estimate Rasch model
mod1 &lt;- TAM::tam.mml(resp=dat)
# compute WLEs
wmod1 &lt;- TAM::tam.wle(mod1)$theta

#--- item fit from "msq.itemfit" function
fit1 &lt;- TAM::msq.itemfit(mod1)
summary( fit1 )

#--- item fit using simulation in "tam.fit"
fit0 &lt;- TAM::tam.fit( mod1 )
summary(fit0)

#--- item fit based on WLEs
fit2a &lt;- TAM::msq.itemfitWLE( mod1 )
summary(fit2a)

#++ fit assessment in mirt package
library(mirt)
mod1b &lt;- mirt::mirt( dat, model=1, itemtype="Rasch", verbose=TRUE )
print(mod1b)
sirt::mirt.wrapper.coef(mod1b)
fmod1b &lt;- mirt::itemfit(mod1b, Theta=as.matrix(wmod1,ncol=1),
                 Zh=TRUE, X2=FALSE, S_X2=FALSE )
cbind( fit2a$fit_data, fmod1b )

#++ fit assessment in eRm package
library(eRm)
mod1c &lt;- eRm::RM( dat )
summary(mod1c)
eRm::plotPImap(mod1c)    # person-item map
pmod1c &lt;- eRm::person.parameter(mod1c)
fmod1c &lt;- eRm::itemfit(pmod1c)
print(fmod1c)
plot(fmod1c)

#--- define some item groups for fit assessment

# bases on evaluating the posterior
fitindices &lt;- rep( paste0("IG",c(1,2)), each=10)
fit2 &lt;- TAM::msq.itemfit( mod1, fitindices )
summary(fit2)

# using WLEs
fit2b &lt;- TAM::msq.itemfitWLE( mod1, fitindices )
summary(fit2b)

#############################################################################
# EXAMPLE 2: data.read | fit statistics assessed for testlets
#############################################################################

library(sirt)
data(data.read,package="sirt")
dat &lt;- data.read

# fit Rasch model
mod &lt;- TAM::tam.mml( dat )

#***** item fit for each item
# based on posterior
res1 &lt;- TAM::msq.itemfit( mod  )
summary(res1)
# based on WLEs
res2 &lt;- TAM::msq.itemfitWLE( mod  )
summary(res2)

#***** item fit for item groups
# define item groups
fitindices &lt;- substring( colnames(dat), 1, 1 )
# based on posterior
res1 &lt;- TAM::msq.itemfit( mod, fitindices )
summary(res1)
# based on WLEs
res2 &lt;- TAM::msq.itemfitWLE( mod, fitindices )
summary(res2)

#############################################################################
# EXAMPLE 3: Fit statistics for rater models
#############################################################################

library(sirt)
data(data.ratings2, package="sirt")
dat &lt;- data.ratings2

# fit rater model "~ item*step + rater"
mod &lt;- TAM::tam.mml.mfr( resp=dat[, paste0( "k",1:5) ],
            facets=dat[, "rater", drop=FALSE],
            pid=dat$pid, formulaA=~ item*step + rater )

# fit for parameter with "tam.fit" function
fmod1a &lt;- TAM::tam.fit( mod )
fmod1b &lt;- TAM::msq.itemfit( mod )
summary(fmod1a)
summary(fmod1b)

# define item groups using pseudo items from object "mod"
pseudo_items &lt;- colnames(mod$resp)
pss &lt;- strsplit( pseudo_items, split="-" )
item_parm &lt;- unlist( lapply( pss, FUN=function(ll){ ll[1] } ) )
rater_parm &lt;- unlist( lapply( pss, FUN=function(ll){ ll[2] } ) )

# fit for items with "msq.itemfit" functions
res2a &lt;- TAM::msq.itemfit( mod, item_parm )
res2b &lt;- TAM::msq.itemfitWLE( mod, item_parm )
summary(res2a)
summary(res2b)

# fit for raters
res3a &lt;- TAM::msq.itemfit( mod, rater_parm )
res3b &lt;- TAM::msq.itemfitWLE( mod, rater_parm )
summary(res3a)
summary(res3b)

## End(Not run)
</code></pre>


</div>