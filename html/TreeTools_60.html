<div class="container">

<table style="width: 100%;"><tr>
<td>TreeNumber</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Unique integer indices for bifurcating tree topologies</h2>

<h3>Description</h3>

<p>Functions converting between phylogenetic trees and their unique decimal
representation, based on a concept by John Tromp, employed in
(Li et al. 1996).
</p>


<h3>Usage</h3>

<pre><code class="language-R">as.TreeNumber(x, ...)

## S3 method for class 'phylo'
as.TreeNumber(x, ...)

## S3 method for class 'multiPhylo'
as.TreeNumber(x, ...)

## S3 method for class 'character'
as.TreeNumber(x, nTip, tipLabels = TipLabels(nTip), ...)

## S3 method for class 'TreeNumber'
as.TreeNumber(x, ...)

## S3 method for class 'MixedBase'
as.TreeNumber(x, ...)

## S3 method for class 'TreeNumber'
as.MixedBase(x, ...)

## S3 method for class 'integer64'
as.MixedBase(x, tipLabels = NULL, ...)

## S3 method for class 'numeric'
as.MixedBase(x, tipLabels = NULL, ...)

## S3 method for class 'numeric'
as.phylo(x, nTip = attr(x, "nTip"), tipLabels = attr(x, "tip.label"), ...)

## S3 method for class 'TreeNumber'
as.phylo(x, nTip = attr(x, "nTip"), tipLabels = attr(x, "tip.label"), ...)

as.MixedBase(x, ...)

## S3 method for class 'MixedBase'
as.MixedBase(x, ...)

## S3 method for class 'phylo'
as.MixedBase(x, ...)

## S3 method for class 'multiPhylo'
as.MixedBase(x, ...)

## S3 method for class 'MixedBase'
as.phylo(x, nTip = attr(x, "nTip"), tipLabels = attr(x, "tip.label"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Integer identifying the tree (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters for consistency with S3 methods (unused).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nTip</code></td>
<td>
<p>Integer specifying number of leaves in the tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tipLabels</code></td>
<td>
<p>Character vector listing the labels assigned to each tip
in a tree, perhaps obtained using <code>TipLabels()</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>There are <code>NUnrooted(n)</code> unrooted trees with <em>n</em> leaves.
As such, each <em>n</em>-leaf tree can be uniquely identified by a non-negative
integer <em>x</em> &lt; <code>NUnrooted(n)</code>.
</p>
<p>This integer can be converted by a tree by treating it as a mixed-base
number, with bases 1, 3, 5, 7, … (2 <em>n</em> - 5).
</p>
<p>Each digit of this mixed base number corresponds to a leaf, and determines
the location on a growing tree to which that leaf should be added.
</p>
<p>We start with a two-leaf tree, and treat 0 as the origin of the tree.
</p>
<div class="sourceCode"><pre>
0 ---- 1

</pre></div>
<p>We add leaf 2 by breaking an edge and inserting a node (numbered
<code>2 + nTip - 1</code>).
In this example, we'll work up to a six-leaf tree; this node will be numbered
2 + 6 - 1 = 7.
There is only one edge on which leaf 2 can be added.  Let's add node 7 and
leaf 2:
</p>
<div class="sourceCode"><pre>
0 ---- 7 ---- 1
       |
       |
       2

</pre></div>
<p>There are now three edges on which leaf 3 can be added.  Our options are:
</p>
<p>Option 0: the edge leading to 1;
</p>
<p>Option 1: the edge leading to 2;
</p>
<p>Option 2: the edge leading to 7.
</p>
<p>If we select option 1, we produce:
</p>
<div class="sourceCode"><pre>
0 ---- 7 ---- 1
       |
       |
       8 ---- 2
       |
       |
       3

</pre></div>
<p><code>1</code> is now the final digit of our mixed-base number.
</p>
<p>There are five places to add leaf 4:
</p>
<p>Option 0: the edge leading to 1;
</p>
<p>Option 1: the edge leading to 2;
</p>
<p>Option 2: the edge leading to 3;
</p>
<p>Option 3: the edge leading to 7;
</p>
<p>Option 4: the edge leading to 8.
</p>
<p>If we chose option 3, then <code>3</code> would be the penultimate digit of our
mixed-base number.
</p>
<p>If we chose option 0 for the next two additions, we could specify this tree
with the mixed-base number 0021.  We can convert this into decimal:
</p>
<p>0 × (1 × 3 × 5 × 9) +
</p>
<p>0 × (1 × 3 × 5) +
</p>
<p>3 × (1 × 3) +
</p>
<p>1 × (1)
</p>
<p>= 10
</p>
<p>Note that the hyperexponential nature of tree space means that there are &gt;
2^64 unique 20-leaf trees.  As a <code>TreeNumber</code> is a 64-bit integer,
only trees with at most 19 leaves can be accommodated.
</p>


<h3>Value</h3>

<p><code>as.TreeNumber()</code> returns an object of class <code>TreeNumber</code>,
which comprises a numeric vector, whose elements represent successive
nine-digit chunks of the decimal integer corresponding to the tree topology
(in big endian order).  The <code>TreeNumber</code> object has attributes
<code>nTip</code> and <code>tip.label</code>.  If <code>x</code> is a list of trees or a <code>multiPhylo</code> object,
then <code>as.TreeNumber()</code> returns a corresponding list of <code>TreeNumber</code> objects.
</p>
<p><code>as.phylo.numeric()</code> returns a tree of class <code>phylo</code>.
</p>


<h3>Author(s)</h3>

<p><a href="https://orcid.org/0000-0001-5660-1727">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>


<h3>References</h3>

<p>Li M, Tromp J, Zhang L (1996).
“Some notes on the nearest neighbour interchange distance.”
In Goos G, Hartmanis J, Leeuwen J, Cai J, Wong CK (eds.), <em>Computing and Combinatorics</em>, volume 1090, 343–351.
Springer, Berlin, Heidelberg.
ISBN 978-3-540-61332-9, <a href="https://doi.org/10.1007/3-540-61332-3_168">doi:10.1007/3-540-61332-3_168</a>.
</p>


<h3>See Also</h3>

<p>Describe the shape of a tree topology, independent of leaf labels:
<code>TreeShape()</code>
</p>
<p>Other tree generation functions: 
<code>ConstrainedNJ()</code>,
<code>GenerateTree</code>,
<code>NJTree()</code>,
<code>TrivialTree</code>
</p>
<p>Other 'TreeNumber' utilities: 
<code>is.TreeNumber()</code>,
<code>print.TreeNumber()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">tree &lt;- as.phylo(10, nTip = 6)
plot(tree)
as.TreeNumber(tree)

# Larger trees:
as.TreeNumber(BalancedTree(19))

# If &gt; 9 digits, represent the tree number as a string.
treeNumber &lt;- as.TreeNumber("1234567890123", nTip = 14)
tree &lt;- as.phylo(treeNumber)
as.phylo(0:2, nTip = 6, tipLabels = letters[1:6])

</code></pre>


</div>