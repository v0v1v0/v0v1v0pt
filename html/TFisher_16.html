<div class="container">

<table style="width: 100%;"><tr>
<td>stat.tfisher.omni</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Construct omnibus thresholding Fisher's (TFisher) p-value combination statistic.</h2>

<h3>Description</h3>

<p>Construct omnibus thresholding Fisher's (TFisher) p-value combination statistic.
</p>


<h3>Usage</h3>

<pre><code class="language-R">stat.tfisher.omni(p, TAU1, TAU2, M = NULL, MU = NULL, SIGMA2 = NULL,
  P0 = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>- input p-values from potentially correlated input sstatistics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TAU1</code></td>
<td>
<p>- a vector of truncation parameters. Must be in non-descending order.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TAU2</code></td>
<td>
<p>- a vector of normalization parameters. Must be in non-descending order.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>- correlation matrix of the input statistics. Default = NULL assumes independence</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MU</code></td>
<td>
<p>- a vector of means of TFisher statistics. Default = NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SIGMA2</code></td>
<td>
<p>- a vector of variances of TFisher statistics. Default = NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P0</code></td>
<td>
<p>- a vector of point masses of TFisher statistics. Default = NULL.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Let <code class="reqn">x_{i}</code>, <code class="reqn">i = 1,...,n</code> be a sequence of individual statistics with
correlation matrix M, <code class="reqn">p_{i}</code> be the corresponding two-sided p-values, then the TFisher statistics
</p>
<p style="text-align: center;"><code class="reqn">TFisher_j = \sum_{i=1}^n -2\log(p_i/\tau_{2j})I(p_i\leq\tau_{1j})</code>
</p>
<p>, <code class="reqn">j = 1,...,d</code>.
The omnibus test statistic is the minimum p-value of these thresholding tests,
</p>
<p style="text-align: center;"><code class="reqn">W_o = min_j G_j(Soft_j)</code>
</p>
<p>, where <code class="reqn">G_j</code> is the survival function of <code class="reqn">Soft_j</code>.
</p>


<h3>Value</h3>

<p>omni - omnibus TFisher statistic.
</p>
<p>pval - p-values of each TFisher tests.
</p>


<h3>References</h3>

<p>1. Hong Zhang and Zheyang Wu. "TFisher Tests: Optimal and Adaptive Thresholding for Combining p-Values", submitted.
</p>


<h3>Examples</h3>

<pre><code class="language-R">pval = runif(20)
TAU1 = c(0.01, 0.05, 0.5, 1)
TAU2 = c(0.1, 0.2, 0.5, 1)
stat.tfisher.omni(p=pval, TAU1=TAU1, TAU2=TAU2)
M = matrix(0.3,20,20) + diag(1-0.3,20)
stat.tfisher.omni(p=pval, TAU1=TAU1, TAU2=TAU2, M=M)
</code></pre>


</div>