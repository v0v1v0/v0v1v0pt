<div class="container">

<table style="width: 100%;"><tr>
<td>progArgs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Providing Arguments to a Script</h2>

<h3>Description</h3>

<p><code>withArgs()</code> allows you to <code>source()</code> an <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> script while providing
arguments. As opposed to running with <code>Rscript</code>, the code will be
evaluated in the same session in an environment of your choosing.
</p>
<p><code>progArgs()</code> is a generalized version of
<code>commandArgs(trailingOnly = TRUE)</code>, allowing you to access
the program's arguments whether it was <code>source()</code>-ed or run from a shell.
</p>
<p><code>asArgs()</code> coerces <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> objects into a character vector, for use with
command line applications and <code>withArgs()</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">asArgs(...)
progArgs(ifnotfound = character())
withArgs(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p><span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> objects to turn into script arguments; typically
<code>logical</code>, <code>numeric</code>,
<code>character</code>, <code>Date</code>, and
<code>POSIXt</code> vectors.
</p>
<p>for <code>withArgs()</code>, the first argument should be an (unevaluated) call
to a <code>source()</code>-like function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ifnotfound</code></td>
<td>
<p>any <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> object, e.g., <code>character(0)</code>, <code>NULL</code>, a
call to <code>stop()</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>progArgs()</code> will return the arguments associated with the executing
script, or <code>commandArgs(trailingOnly = TRUE)</code> when there is no executing
script.
</p>
<p><code>asArgs()</code> coerces objects into command-line arguments. <code>...</code> is
first put into a list, and then each non-list element is converted to
character. They are converted as follows:
</p>

<dl>
<dt>Factors (class <code>"factor"</code>)</dt>
<dd>
<p>using <code>as.character.factor()</code></p>
</dd>
<dt>Date-Times (class <code>"POSIXct"</code> and <code>"POSIXlt"</code>)</dt>
<dd>
<p>using format
<code>"%Y-%m-%d %H:%M:%OS6"</code>
(retains as much precision as possible)</p>
</dd>
<dt>Numbers (class <code>"numeric"</code> and <code>"complex"</code>)</dt>
<dd>
<p>with 17 significant digits (retains as much precision as possible) and
<code>"."</code> as the decimal point character.</p>
</dd>
<dt>Raw Bytes (class <code>"raw"</code>)</dt>
<dd>
<p>using
<code>sprintf("0x%02x", )</code>
(for easy conversion back to raw with <code>as.raw()</code> or
<code>as.vector(, "raw")</code>)</p>
</dd>
</dl>
<p>All others will be converted to character using
<code>as.character()</code> and its methods.
</p>
<p>The arguments will then be unlisted, and all attributes will be removed.
Arguments that are <code>NA_character_</code> after conversion will be converted to
<code>"NA"</code> (since the command-line arguments also never have missing
strings).
</p>


<h3>Value</h3>

<p>for <code>asArgs()</code> and <code>progArgs()</code>, a character vector.
</p>
<p>for <code>withArgs()</code>, the result of evaluating the first argument.
</p>


<h3>Examples</h3>

<pre><code class="language-R">this.path::asArgs(NULL, c(TRUE, FALSE, NA), 1:5, pi, exp(6i),
    letters[1:5], as.raw(0:4), Sys.Date(), Sys.time(),
    list(list(list("lists are recursed"))))


FILE.R &lt;- tempfile(fileext = ".R")
this.path:::.writeCode({
    this.path:::.withAutoprint({
        this.path::sys.path()
        this.path::progArgs()
    }, spaced = TRUE, verbose = FALSE, width.cutoff = 60L)
}, FILE.R)


## wrap your source call with a call to withArgs()
this.path::withArgs(
    source(FILE.R, local = TRUE, verbose = FALSE),
    letters[6:10], pi, exp(1)
)
this.path:::.Rscript(c("--default-packages=NULL", "--vanilla", FILE.R,
    this.path::asArgs(letters[16:20], pi, Sys.time())))
this.path:::.Rscript(c("--default-packages=NULL", "--vanilla",
    rbind("-e", readLines(FILE.R)[-2L]),
    this.path::asArgs(letters[16:20], pi, Sys.time())))


# ## with R &gt;= 4.1.0, use the forward pipe operator '|&gt;' to
# ## make calls to withArgs() more intuitive:
# source(FILE.R, local = TRUE, verbose = FALSE) |&gt; this.path::withArgs(
#     letters[6:10], pi, exp(1))


## withArgs() also works with set.sys.path()
sourcelike &lt;- function (file, envir = parent.frame())
{
    file &lt;- set.sys.path(file)
    envir &lt;- as.environment(envir)
    exprs &lt;- parse(n = -1, file = file)
    for (i in seq_along(exprs)) eval(exprs[i], envir)
}
this.path::withArgs(sourcelike(FILE.R), letters[21:26])


unlink(FILE.R)
</code></pre>


</div>