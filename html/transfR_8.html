<div class="container">

<table style="width: 100%;"><tr>
<td>hdist</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Geographical distance between catchments</h2>

<h3>Description</h3>

<p>Calculate distances between two sets of catchments using their spatial support.
</p>


<h3>Usage</h3>

<pre><code class="language-R">hdist(x, y, ...)

## S3 method for class 'sfc'
hdist(
  x,
  y,
  method = "rghosh",
  gres = 5,
  ditself = FALSE,
  maxsample = 25000,
  proj = NULL,
  parallel = FALSE,
  cores = NULL,
  verbose = TRUE,
  ...
)

## S3 method for class 'sf'
hdist(x, y, ...)

## S3 method for class 'stars'
hdist(x, y, ...)

## S3 method for class 'transfR'
hdist(x, y, method = "rghosh", weightO = 0.8, weightC = 0.2, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>sf, stars or transfR object of the first catchments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>sf, stars or transfR object of the second catchments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the method to use for computing distance. This must be one of "ghosh",
"rghosh", "points", "centroids", "combined"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gres</code></td>
<td>
<p>resolution of spatial discretisation (number of points by km²) for Ghosh
distance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ditself</code></td>
<td>
<p>logical value indicating if the distance to itself should be computed.
It will add one row and one column in the distance matrix. Only used if method is "ghosh"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxsample</code></td>
<td>
<p>maximum size of sampling points for each catchments during spatial discretisation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>proj</code></td>
<td>
<p>logical indicating if spatial layer are using a projection. If TRUE, euclidean
distance is used. If FALSE, the great-circle distance is used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>logical indicating if the computation should be parallelised</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cores</code></td>
<td>
<p>the number of cores to use for parallel execution if <code>parallel</code> is TRUE.
If not specified, the number of cores is set to the value of <code>parallel::detectCores()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>boolean indicating if information messages should be written to the console</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weightO</code></td>
<td>
<p>weight given to the distance between outlets if method is "combined"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weightC</code></td>
<td>
<p>weight given to the distance between centroids if method is "combined"</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>method</code> "ghosh" refers to a simplification of the distance defined
by Ghosh (1951) as proposed by Gottschalk (1993); Gottschalk et al. (2011).
The rescaled Ghosh distance (<code>method</code> "rghosh") is calculted following de Lavenne et al. (2016).
</p>


<h3>Value</h3>

<p>A matrix of class units with the catchments of <code>x</code> organised in rows
and the catchments of <code>y</code> organised in columns.
</p>


<h3>References</h3>

<p>Ghosh B (1951).
“Random distances within a rectangle and between two rectangles.”
<em>Bull. Calcutta Math. Soc</em>, <b>43</b>(1), 17–24.
</p>
<p>Gottschalk L (1993).
“Interpolation of runoff applying objective methods.”
<em>Stochastic Hydrology and Hydraulics</em>, <b>7</b>(4), 269–281.
<a href="https://doi.org/10.1007/BF01581615">doi:10.1007/BF01581615</a>.
</p>
<p>Gottschalk L, Leblois E, Skøien JO (2011).
“Distance measures for hydrological data having a support.”
<em>J. Hydrol.</em>, <b>402</b>(3-4), 415–421.
<a href="https://doi.org/10.1016/j.jhydrol.2011.03.020">doi:10.1016/j.jhydrol.2011.03.020</a>.
</p>
<p>de Lavenne A, Skøien JO, Cudennec C, Curie F, Moatar F (2016).
“Transferring measured discharge time series: Large-scale comparison of Top-kriging to geomorphology-based inverse modeling.”
<em>Water Resources Research</em>, <b>52</b>(7), 5555–5576.
<a href="https://doi.org/10.1002/2016WR018716">doi:10.1002/2016WR018716</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(Oudon)
catchments &lt;- st_geometry(Oudon$obs)
hdist(x = catchments[1:2], y = catchments[3:5], gres = 5, method = "rghosh")
</code></pre>


</div>