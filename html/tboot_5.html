<div class="container">

<table style="width: 100%;"><tr>
<td>tweights</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function <code>tweights</code>
</h2>

<h3>Description</h3>

<p>Returns a vector <code>p</code> of resampling probabilities 
such that the column means of <code>tboot(dataset = dataset, p = p)</code>
equals <code>target</code> on average.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tweights(dataset, target = apply(dataset, 2, mean), distance = "klqp",
  maxit = 1000, tol = 1e-08, warningcut = 0.05, silent = FALSE,
  Nindependent = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dataset</code></td>
<td>
<p>Data frame or matrix to use to find row weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>
<p>Numeric vector of target column means. If the 'target' is named, then all elements of names(target) should be in the dataset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>
<p>The distance to minimize. Must be either 'euchlidean,' 'klqp' or 'klpq' (i.e. Kullback-Leibler). 'klqp' which is exponential tilting is recommended.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>Defines the maximum number of iterations for optimizing 'kl' distance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>Tolerance. If the achieved mean is to0 far from the target (i.e. as defined by tol) an error will be thrown.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warningcut</code></td>
<td>
<p>Sets the cutoff for determining when a large weight will trigger a warning.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>Allows silencing of some messages.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nindependent</code></td>
<td>
<p>Assumes the input also includes 'Nindependent' samples with independent columns. See details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Let <code class="reqn">p_i = 1/n</code> be the probability of sampling subject <code class="reqn">i</code> from a dataset with <code class="reqn">n</code> individuals (i.e. rows of the dataset) in the classic resampling with replacement scheme.
Also, let <code class="reqn">q_i</code> be the probability of sampling subject <code class="reqn">i</code> from a dataset with <code class="reqn">n</code> individuals in our new resampling scheme. Let <code class="reqn">d(q,p)</code> represent a distance between the two resampling schemes.  The <code>tweights</code>
function seeks to solve the problem: 
</p>
<p style="text-align: center;"><code class="reqn">q = argmin_p d(q,p)</code>
</p>

<p>Subject to the constraint that:
</p>
<p style="text-align: center;"><code class="reqn"> sum_i q_i = 1</code>
</p>
<p> and
</p>
<p style="text-align: center;"><code class="reqn">  dataset' q = target</code>
</p>

<p>where dataset is a n x K matrix of variables input to the function.
</p>
<p style="text-align: center;"><code class="reqn">d_{euclidian}(q,p) = sqrt( \sum_i (p_i-q_i)^2 )</code>
</p>

<p style="text-align: center;"><code class="reqn">d_{kl}(q,p) = \sum_i (log(p_i) - log(q_i))</code>
</p>

<p>Optimization for Euclidean distance is a quadratic program and utilizes the ipop function in kernLab.
Optimization for the others utilize a Newton-Raphson type iterative algorithm.
</p>
<p>If the original target cannot be achieved. Something close to the original target will be selected.
A warning will be produced and the new target displayed.
</p>
<p>The 'Nindependent' option augments the dataset by assuming some additional specified
number of patients. These patients are assumed to made up of a random bootstrapped sample
from the dataset for each variable marginally leading to independent variables.
</p>


<h3>Value</h3>

<p>An object of type <code>tweights</code>. This object contains the following components:
</p>

<dl>
<dt>weights</dt>
<dd>
<p>Tilted weights for resampling</p>
</dd>
<dt>originalTarget</dt>
<dd>
<p>Will be null if target was not changed.</p>
</dd>
<dt>target</dt>
<dd>
<p>Actual target that was attempted.</p>
</dd>
<dt>achievedMean</dt>
<dd>
<p>Achieved mean from tilting.</p>
</dd>
<dt>dataset</dt>
<dd>
<p>Inputed dataset.</p>
</dd>
<dt>X</dt>
<dd>
<p>Reformated dataset.</p>
</dd>
<dt>Nindependent</dt>
<dd>
<p>Inputed 'Nindependent' option.</p>
</dd>
</dl>
<h3>See Also</h3>

<p><code>tboot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"> target=c(Sepal.Length=5.5, Sepal.Width=2.9, Petal.Length=3.4)
 w = tweights(dataset = iris, target = target, silent = TRUE)
 simulated_data = tboot(nrow = 1000, weights = w)
</code></pre>


</div>