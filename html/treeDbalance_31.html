<div class="container">

<table style="width: 100%;"><tr>
<td>makePhylo3DBalanced</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Turn a rooted 3D tree into one of its balanced versions</h2>

<h3>Description</h3>

<p><code>makePhylo3DBalanced</code> - Creates a balanced version of a rooted 3D tree
in phylo3D format. From the leaves of lowest depth to the root, each node
is turned into a balanced node by rotating its pending subtree such that
it is in line with its incoming edge. The edge and subtree lengths and 
weights as well as the angles between the outgoing edges of a single node 
(the sister edges) are left intact. <br>
Note that this function yields only one of many possible balanced 
version of the given rooted 3D tree (most often the minimal tree under the 
aforementioned requirements is not unique).
</p>
<p><code>rotate3dVec</code> - Rotates a vector in 3D space for a given angle and 
rotation axis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">makePhylo3DBalanced(tree)

rotate3dVec(angle, axis, vec)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>A rooted tree in phylo3D format (no special node enumeration 
required, except that nodes are numbered from 1 to |V| = the total number of
nodes). There must be at least 2 nodes, i.e., one edge. The attributes 
'node.coord' and 'edge.weight' are strictly required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>angle</code></td>
<td>
<p>Angle for the rotation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis</code></td>
<td>
<p>Rotation axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vec</code></td>
<td>
<p>Numeric vector of size 3 (3D coordinates of the
vector that shall be rotated).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>makePhylo3DBalanced</code> Tree in phylo3D format which is balanced
with regards to all four node imbalance measurements and their 
corresponding imbalance indices.
</p>
<p><code>rotate3dVec</code> Numeric vector of size 3 (3D coordinates of the
rotated vector).
</p>


<h3>Author(s)</h3>

<p>Sophie Kersting, Luise KÃ¼hn
</p>


<h3>Examples</h3>

<pre><code class="language-R">tree &lt;- treeDbalance::extendPhylo(treeDbalance::example3Dtrees$bean22)
tree_bal &lt;- makePhylo3DBalanced(tree)
rotate3dVec(angle = pi/2, axis = c(0,-1,0), vec = c(5,0,0)) # approx. (0,0,5)
round(rotate3dVec(angle = pi/2, axis = c(0,-1,0), vec = c(5,0,0)),15)
</code></pre>


</div>