<div class="container">

<table style="width: 100%;"><tr>
<td>Track-class</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Classes "Track", "Tracks", and "TracksCollection"</h2>

<h3>Description</h3>

<p> Classes for representing sets of trajectory data, 
with attributes, for different IDs (persons, objects, etc) </p>


<h3>Usage</h3>

<pre><code class="language-R">  Track(track, df = fn(track), fn = TrackStats)
  Tracks(tracks, tracksData = data.frame(row.names=names(tracks)), 
  		fn = TrackSummary)
  TracksCollection(tracksCollection, tracksCollectionData,
  		fn = TracksSummary)
  TrackStats(track)
  TrackSummary(track)
  TracksSummary(tracksCollection)
  ## S4 method for signature 'Track'
x[i, j, ..., drop = TRUE]
  ## S4 method for signature 'TracksCollection'
x[i, j, ..., drop = TRUE]
  ## S4 method for signature 'Track,data.frame'
coerce(from, to)
  ## S4 method for signature 'Tracks,data.frame'
coerce(from, to)
  ## S4 method for signature 'TracksCollection,data.frame'
coerce(from, to)


</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>track</code></td>
<td>
<p>object of class STIDF-class, representing a single trip</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>optional <code>data.frame</code> with information between track points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tracks</code></td>
<td>
<p>named list with <code>Track</code> objects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tracksData</code></td>
<td>
<p><code>data.frame</code> with summary data for each <code>Track</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tracksCollection</code></td>
<td>
<p>list, with <code>Tracks</code> objects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tracksCollectionData</code></td>
<td>
<p>data.frame, with summary data on
<code>tracksCollection</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fn</code></td>
<td>
<p>function; </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>object of class <code>Track</code> etc</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>i</code></td>
<td>
<p>selection of spatial entities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>j</code></td>
<td>
<p>selection of temporal entities (see syntax in package xts) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>selection of attribute(s)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drop</code></td>
<td>
<p>logical</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>from</code></td>
<td>
<p>from</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>to</code></td>
<td>
<p>target class</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Functions <code>Track</code>, <code>Tracks</code> and
<code>TracksCollection</code> are constructor functions that take the
slots as arguments, check object validity, and compute summary
statistics on the track and tracks sets.
</p>
<p><code>TrackStats</code> returns a <code>data.frame</code> with for each track
segment the distance, duration, speed, and direction. In case data are
geographical coordinates (long/lat), distance is in m, and direction
is initial bearing.
</p>
<p><code>TrackSummary</code> reports for each track xmin, xmax, ymin, ymax,
tmin, tmax, (number of points) n, (total) distance, and medspeed
(median speed).
</p>
<p><code>TracksSummary</code> reports for each Tracks of a TracksCollection
(number of tracks) n, xmin, xmax, ymin, ymax, tmin, tmin, tmax.
</p>


<h3>Objects from the Class</h3>

 
<p>Objects of class <code>Track</code> extend STIDF-class 
and contain single trips or tracks, 
objects of class <code>Tracks</code> contain multiple <code>Track</code> objects
for a single ID (person, object or tracking device), objects of class
<code>TracksCollection</code> contain multiple <code>Tracks</code> objects for
different IDs.
</p>


<h3>Slots of class "Track"</h3>


<dl>
<dt>
<code>sp</code>:</dt>
<dd>
<p>spatial locations of the track points, with length n</p>
</dd>
<dt>
<code>time</code>:</dt>
<dd>
<p>time stamps of the track points</p>
</dd>
<dt>
<code>endTime</code>:</dt>
<dd>
<p>end time stamps of the track points</p>
</dd>
<dt>
<code>data</code>:</dt>
<dd>
<p><code>data.frame</code> with n rows, containing
attributes of the track points</p>
</dd>
<dt>
<code>connections</code>:</dt>
<dd>
<p><code>data.frame</code>, with n-1 rows, containing
attributes between the track points such as distance and speed </p>
</dd>
</dl>
<h3>Slots of class "Tracks"</h3>


<dl>
<dt>
<code>tracks</code>:</dt>
<dd>
<p><code>list</code> with <code>Track</code> objects, of length m</p>
</dd>
<dt>
<code>tracksData</code>:</dt>
<dd>
<p><code>data.frame</code> with m rows, containing 
summary data for each <code>Track</code> object</p>
</dd>
</dl>
<h3>Slots of class "TracksCollection"</h3>


<dl>
<dt>
<code>tracksCollection</code>:</dt>
<dd>
<p><code>list</code> <code>Tracks</code> objects, of
length p</p>
</dd>
<dt>
<code>tracksCollectionData</code>:</dt>
<dd>
<p><code>data.frame</code> with p rows,
containing summary data for each <code>Tracks</code> object</p>
</dd>
</dl>
<h3>Methods</h3>


<dl>
<dt>[[</dt>
<dd>
<p><code>signature(obj = "Track")</code>: retrieves the attribute element</p>
</dd>
<dt>[[</dt>
<dd>
<p><code>signature(obj = "Tracks")</code>: retrieves the attribute element</p>
</dd>
<dt>[[</dt>
<dd>
<p><code>signature(obj = "TracksCollection")</code>: retrieves the attribute element</p>
</dd>
<dt>[[&lt;-</dt>
<dd>
<p><code>signature(obj = "Track")</code>: sets or replaces the attribute element</p>
</dd>
<dt>[[&lt;-</dt>
<dd>
<p><code>signature(obj = "Tracks")</code>: sets or replaces the attribute element</p>
</dd>
<dt>[[&lt;-</dt>
<dd>
<p><code>signature(obj = "TracksCollection")</code>: sets or replaces the attribute element</p>
</dd>
<dt>$</dt>
<dd>
<p><code>signature(obj = "Track")</code>: retrieves the attribute element</p>
</dd>
<dt>$</dt>
<dd>
<p><code>signature(obj = "Tracks")</code>: retrieves the attribute element</p>
</dd>
<dt>$</dt>
<dd>
<p><code>signature(obj = "TracksCollection")</code>: retrieves the attribute element</p>
</dd>
<dt>$&lt;-</dt>
<dd>
<p><code>signature(obj = "Track")</code>: sets or replaces the attribute element</p>
</dd>
<dt>$&lt;-</dt>
<dd>
<p><code>signature(obj = "Tracks")</code>: sets or replaces the attribute element</p>
</dd>
<dt>$&lt;-</dt>
<dd>
<p><code>signature(obj = "TracksCollection")</code>: sets or replaces the attribute element</p>
</dd>
<dt>coerce</dt>
<dd>
<p><code>signature(from = Track, to = data.frame)</code> coerce to <code>data.frame</code></p>
</dd>
<dt>coerce</dt>
<dd>
<p><code>signature(from = Tracks, to = data.frame)</code> coerce to <code>data.frame</code></p>
</dd>
<dt>coerce</dt>
<dd>
<p><code>signature(form = TracksCollection, to = data.frame)</code> coerce to <code>data.frame</code></p>
</dd>
<dt>plot</dt>
<dd>
<p><code>signature(x = "TracksCollection", y = "missing")</code>: 
plots sets of sets of tracks</p>
</dd>
<dt>stplot</dt>
<dd>
<p><code>signature(obj = "TracksCollection")</code>: 
plots sets of sets of tracks</p>
</dd>
</dl>
<h3>Note</h3>

<p><code>segments</code> is a <code>data.frame</code> form in which track
segments instead of track points form a record, with <code>x0</code>,
<code>y0</code>, <code>x1</code> and <code>y1</code> the start and end coordinates</p>


<h3>Author(s)</h3>

<p> Edzer Pebesma, <a href="mailto:edzer.pebesma@uni-muenster.de">edzer.pebesma@uni-muenster.de</a> </p>


<h3>References</h3>

<p> http://www.jstatsoft.org/v51/i07/ </p>


<h3>Examples</h3>

<pre><code class="language-R">library(sp)
library(spacetime)
# t0 = as.POSIXct(as.Date("2013-09-30",tz="CET"))
t0 = as.POSIXct("2013-09-30 02:00:00", tz = "Europe/Berlin")
# person A, track 1:
x = c(7,6,5,5,4,3,3)
y = c(7,7,6,5,5,6,7)
n = length(x)
set.seed(131)
t = t0 + cumsum(runif(n) * 60)
crs = CRS("+proj=longlat +datum=WGS84") # longlat
stidf = STIDF(SpatialPoints(cbind(x,y),crs), t, data.frame(co2 = rnorm(n)))
A1 = Track(stidf)
# person A, track 2:
x = c(7,6,6,7,7)
y = c(6,5,4,4,3)
n = length(x)
t = max(t) + cumsum(runif(n) * 60)
stidf = STIDF(SpatialPoints(cbind(x,y),crs), t, data.frame(co2 = rnorm(n)))
A2 = Track(stidf)
# Tracks for person A:
A = Tracks(list(A1=A1,A2=A2))
# person B, track 1:
x = c(2,2,1,1,2,3)
y = c(5,4,3,2,2,3)
n = length(x)
t = max(t) + cumsum(runif(n) * 60)
stidf = STIDF(SpatialPoints(cbind(x,y),crs), t, data.frame(co2 = rnorm(n)))
B1 = Track(stidf)
# person B, track 2:
x = c(3,3,4,3,3,4)
y = c(5,4,3,2,1,1)
n = length(x)
t = max(t) + cumsum(runif(n) * 60)
stidf = STIDF(SpatialPoints(cbind(x,y),crs), t, data.frame(co2 = rnorm(n)))
B2 = Track(stidf)
# Tracks for person A:
B = Tracks(list(B1=B1,B2=B2))
Tr = TracksCollection(list(A=A,B=B))
stplot(Tr, scales = list(draw=TRUE))
stplot(Tr, attr = "direction", arrows=TRUE, lwd = 3, by = "direction")
stplot(Tr, attr = "direction", arrows=TRUE, lwd = 3, by = "IDs")
plot(Tr, col=2, axes=TRUE)
dim(Tr)
dim(Tr[2])
dim(Tr[2][1])
u = stack(Tr) # four IDs
dim(u)
dim(unstack(u, c(1,1,2,2))) # regroups to original
dim(unstack(u, c(1,1,2,3))) # regroups to three IDs
dim(unstack(u, c(1,2,2,1))) # regroups differently
as(Tr, "data.frame")[1:10,] # tracks separated by NA rows
as(Tr, "segments")[1:10,]   # track segments as records
Tr[["distance"]] = Tr[["distance"]] * 1000
Tr$distance = Tr$distance / 1000
Tr$distance
# work with custum TrackStats function:
MyStats = function(track) {
	df = apply(coordinates(track@sp), 2, diff) # requires sp
	data.frame(distance = apply(df, 1, function(x) sqrt(sum(x^2))))
}
crs = CRS(as.character(NA))
stidf = STIDF(SpatialPoints(cbind(x,y),crs), t, data.frame(co2 = rnorm(n)))
B2 = Track(stidf) # no longer longlat;
B3 = Track(stidf, fn = MyStats)
all.equal(B3$distance, B2$distance)

# approxTrack:
opar = par()
par(mfrow = c(1, 2))
plot(B2, ylim = c(.5, 6))
plot(B2, pch = 16, add = TRUE)
title("irregular time steps")
i = index(B2)
B3 = approxTrack(B2, seq(min(i), max(i), length.out = 50))
plot(B3, col = 'red', type = 'p', add = TRUE)
B4 = approxTrack(B2, seq(min(i), max(i), length.out = 50), FUN = spline)
plot(B4, col = 'blue', type = 'b', add = TRUE)
# regular time steps:
t = max(t) + (1:n) * 60 # regular
B2 = Track(STIDF(SpatialPoints(cbind(x,y),crs), t, data.frame(co2 = rnorm(n))))
plot(B2, ylim = c(.5, 6))
plot(B2, pch = 16, add = TRUE)
title("constant time steps")
i = index(B2)
B3 = approxTrack(B2)
plot(B3, type = 'p', col = 'red', add = TRUE)
B4 = approxTrack(B2, FUN = spline)
plot(B4, type = 'p', col = 'blue', add = TRUE)

# par(opar) # good to do, but would generate warnings
smth = function(x,y,xout,...) predict(smooth.spline(as.numeric(x), y), as.numeric(xout))
data(storms)
plot(storms, type = 'p')
storms.smooth = approxTracksCollection(storms, FUN = smth, n = 200)
plot(storms.smooth, add = TRUE, col = 'red')

</code></pre>


</div>