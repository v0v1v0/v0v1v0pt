<div class="container">

<table style="width: 100%;"><tr>
<td>tmodPanelPlot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot a summary of multiple tmod analyses</h2>

<h3>Description</h3>

<p>Plot a summary of multiple tmod analyses
</p>


<h3>Usage</h3>

<pre><code class="language-R">tmodPanelPlot(
  x,
  pie = NULL,
  clust = "qval",
  select = NULL,
  filter.empty.cols = FALSE,
  filter.empty.rows = TRUE,
  filter.unknown = TRUE,
  filter.rows.pval = 0.05,
  filter.rows.auc = 0.5,
  filter.by.id = NULL,
  col.labels = NULL,
  col.labels.style = "top",
  row.labels = NULL,
  row.labels.auto = "both",
  pval.thr = 10^-2,
  pval.thr.lower = 10^-6,
  plot.func = NULL,
  grid = "at",
  pie.colors = c("#0000FF", "#cccccc", "#FF0000"),
  plot.cex = 1,
  text.cex = 1,
  pie.style = "auto",
  min.e = 0.5,
  max.e = 1,
  legend.style = "auto",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>either a list, in which each element has been generated with a tmod test function, or the result of the tmodSummary function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pie</code></td>
<td>
<p>a list of data frames with information for drawing a pie chart</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clust</code></td>
<td>
<p>whether, in the resulting data frame, the modules should be
ordered by clustering them with either q-values ("qval") or the effect size
("effect"). If "sort" or NULL, the modules are sorted alphabetically by their ID.
If "keep", then the order of the modules is kept.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>select</code></td>
<td>
<p>a character vector of module IDs to show. If clust == "keep", then in that particular
order.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filter.empty.cols</code></td>
<td>
<p>If TRUE, all elements (columns) with no enrichment below pval.thr in any row will be removed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filter.empty.rows</code></td>
<td>
<p>If TRUE, all modules (rows) with no enrichment below pval.thr in any column will be removed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filter.unknown</code></td>
<td>
<p>If TRUE, modules with no annotation will be omitted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filter.rows.pval</code></td>
<td>
<p>Rows in which no p value is below this threshold will be omitted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filter.rows.auc</code></td>
<td>
<p>Rows in which no AUC value is above this threshold will be omitted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filter.by.id</code></td>
<td>
<p>if provided, show only modules with IDs in this character vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.labels</code></td>
<td>
<p>Labels for the columns. If NULL, names of the elements
of the list x will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.labels.style</code></td>
<td>
<p>Style of column names: "top" (default), "bottom", "both", "none"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>row.labels</code></td>
<td>
<p>Labels for the modules. This must be a named vector, with module IDs as vector names. If NULL, module titles from
the analyses results will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>row.labels.auto</code></td>
<td>
<p>Automatic generation of row labels from module
data: "both" or "auto" (default, ID and title), "id" (only ID), "title" (only title),
"none" (no row label)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval.thr</code></td>
<td>
<p>Results with p-value above pval.thr will not be shown</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval.thr.lower</code></td>
<td>
<p>Results with p-value below pval.thr.lower will look identical on the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.func</code></td>
<td>
<p>Optionally, a function to be used to draw the dots. See "pvalEffectPlot"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>Style of a light-grey grid to be plotted; can be "none", "at" and "between"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pie.colors</code></td>
<td>
<p>character vector of length equal to the cardinality of the third dimension of the pie argument. By default: blue, grey and red.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.cex</code></td>
<td>
<p>a numerical value giving the amount by which the plot
symbols will be maginfied</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text.cex</code></td>
<td>
<p>a numerical value giving the amount by which the plot
text will be magnified, or a vector containing three cex values for row labels, column labels and legend, respectively</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pie.style</code></td>
<td>
<p>Can be "auto" (default), "dot", "symdot", "pie", "boxpie", "rug" (see Details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.e, max.e</code></td>
<td>
<p>scale limits for the effect size (default: 0.5 and 1.0)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.style</code></td>
<td>
<p>Style of the legend: "auto" â€“ automatic; "broad":
pval legend side by side with effect size legend; "tall": effect size
legend above pval legend</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Any further arguments will be passed to the pvalEffectPlot function (for example, grid.color)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is useful if you run an analysis for several conditions or
time points and would like to summarize the information on a plot.
You can use lapply() to generate a list with tmod results and use
tmodPanelPlot to visualize it.
</p>
<p>tmodPanelPlot shows a heatmap-like plot. Each row corresponds to one
module, and columns correspond to the time points or conditions for which
the tmod analyses were run. Each significantly enriched module is shown as
a red dot. Size of the dot corresponds to the effect size (for example, AUC
in the CERNO test), and intensity of the color corresponds to the q-value.
</p>
<p>By default, tmodPanelPlot visualizes each the results of a single
statistical test by a red dot, or blue and red dots if the effect sizes are both 
negative and positive. However, it is often interesting to know how
many of the genes in a module are significantly up- or down regulated.
tmodPanelPlot can draw a pie chart based on the optional argument "pie".
The argument must be a list of length equal to the length of x.
Note also that the names of the pie list must be equal to the names of x.
Objects returned by the function tmodDecideTests can be directly used
here. The rownames of either the data frame or the array must be the
module IDs.
</p>


<h3>Value</h3>

<p>a data frame with a line for each module encountered anywhere in
the list x, two columns describing the module (ID and module title), and
two columns(effect size and q value) for each element of list x.
</p>


<h3>See Also</h3>

<p>tmodDecideTests, tmodSummary, pvalEffectPlot, simplePie
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(Egambia)
E &lt;- Egambia[,-c(1:3)]
pca &lt;- prcomp(t(E), scale.=TRUE)

# Calculate enrichment for first 5 PCs
gs   &lt;- Egambia$GENE_SYMBOL
gn.f &lt;- function(r) {
    o &lt;- order(abs(r), decreasing=TRUE)
    tmodCERNOtest(gs[o], 
                qval=0.01)
}
x &lt;- apply(pca$rotation[,3:4], 2, gn.f)
tmodPanelPlot(x, text.cex=0.7)
</code></pre>


</div>