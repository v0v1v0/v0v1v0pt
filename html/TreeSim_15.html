<div class="container">

<table style="width: 100%;"><tr>
<td>sim.rateshift.taxa</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>sim.rateshift.taxa: Simulating trees incorporating mass extinction events and rate shifts.</h2>

<h3>Description</h3>

<p>sim.rateshift.taxa simulates trees on n species under the constant rate birth-death process. At user-specified points in the past, the rates can shift. Further, mass extinction events can be incorporated. The method further allows for incomplete sampling, i.e. only a fixed fraction of all tips is included in the sampled tree. The tree is conditioned to have n tips after sampling.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim.rateshift.taxa(n, numbsim, lambda, mu, frac, times, complete = TRUE, K=0, norm = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Number of extant sampled tips.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numbsim</code></td>
<td>
<p>Number of trees to simulate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Vector of speciation rates, the rate in entry i is the speciation rate prior (ancestral) to time times[i].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>Vector of extinction rates, the rate in entry i is the extinction rate prior (ancestral) to time times[i].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frac</code></td>
<td>
<p>Vector of proportion of species surviving mass extinction event. Entry i corresponds to the mass extinction at time times[i]. If frac[i]=1, only rate shift but no mass extinction at time times[i].
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>
<p>Vector of mass extinction and rate shift times. Time is 0 today and increasing going backwards in time. Specify the vector as times[i]&lt;times[i+1]. times[1]=0 (today).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>complete</code></td>
<td>
<p>If TRUE, the tree including the extinct lineages and non-sampled lineages is returned (so the tree has round(n/frac[1]) extant tips). If FALSE, the extinct lineages and non-sampled lineages are suppressed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>If K&gt;0, then a density-dependent speciation rate = lambda*(1-numberspecies/K) is used. Only works currently for mu=0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>norm</code></td>
<td>
<p>If norm = TRUE the simulations are exact. If norm = FALSE tree is always returned once N=0 in Stadler 2011, p.678, point (7).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table><tr style="vertical-align: top;">
<td><code>out</code></td>
<td>
<p>List of numbsim simulated trees with n extant sampled tips.</p>
</td>
</tr></table>
<h3>Author(s)</h3>

<p>Tanja Stadler </p>


<h3>References</h3>

<p>T. Stadler. Simulating trees on a fixed number of extant species. Syst. Biol., 60: 676-684, 2011.
</p>


<h3>See Also</h3>

<p>sim.bd.age, sim.bd.taxa, sim.gsa.taxa, birthdeath.tree
</p>


<h3>Examples</h3>

<pre><code class="language-R">n&lt;-10
numbsim&lt;-1

##
# Simulating trees with a fixed number of species having shifts in rate
# and mass extinction events.
# Between today and time 0.3 in the past, we have speciation rate 2,
# extinction rate 0. At time 0.3, we have a mass extinction event which
# 10% of the species survive. Prior to 0.3, we have a speciation rate 
# of 1 and an extinction rate of 0.3:

sim.rateshift.taxa(n,numbsim,c(2,1),c(0,0.3),
c(1,0.1),c(0,0.3),complete=TRUE)

# The fraction 0.6 of the extant species is included into the final tree
# (the tree has n species AFTER sampling, extinct and
# non-sampled lineages are not included):

sim.rateshift.taxa(n,numbsim,c(2,1),c(0,0.3),
c(0.6,0.1),c(0,0.3),complete=FALSE)
</code></pre>


</div>