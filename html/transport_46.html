<div class="container">

<table style="width: 100%;"><tr>
<td>semidiscrete</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Find Optimal Transport Partition Between pgrid and wpp.
</h2>

<h3>Description</h3>

<p>Given an object <code>a</code> of class <code>pgrid</code> specifying an image and an object <code>b</code>
of class <code>wpp</code> specifiying a more flexible mass distribution at finitely many points,
find the partition of the image (and hence the optimal transport map) that minimizes the total transport cost
for going from <code>a</code> to <code>b</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  semidiscrete(a, b, p = 2, method = c("aha"), control = list(), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>

<p>an object of class <code>pgrid</code> usually representing an image or the discretization of a measure.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>

<p>an object of class <code>wpp</code> usually having the same total mass as <code>a</code>.   	
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>

<p>the power <code class="reqn">\geq 1</code> to which the Euclidean distance between points is taken in order
to compute costs. Only <code class="reqn">p \in \{1,2\}</code> is implemented.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>the name of the algorithm to use. Currently only <code>aha</code> is supported.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>

<p>a named list of parameters for the chosen method or the result of a call to <code>trcontrol</code>. Currently only
the parameters <code>factr</code> and <code>maxit</code> can be set.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>currently without effect.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is a wrapper for the functions <code>aha</code> and <code>semidiscrete1</code>. In the former the
Aurenhammer–Hoffmann–Aronov (1998) method for <code class="reqn">p=2</code> is implemented in the multiscale variant presented
in Mérigot (2011). In the latter an adapted Aurenhammer–Hoffmann–Aronov method for <code class="reqn">p=1</code> is used that
was presented in Hartmann and Schuhmacher (2018).
</p>
<p>The present function is automatically called by <code>transport</code> if the
first argument is of class <code>pgrid</code> and the second argument is of class <code>wpp</code>.
</p>


<h3>Value</h3>

<p>An object describing the optimal transport partition for <code>a</code> and <code>b</code>.
</p>
<p>If <code>p=1</code> an object of class <code>apollonius_diagram</code> having components <code>sites</code> and <code>weights</code>,
as well as (optionally) <code>wasserstein_dist</code> and <code>ret_code</code> (the return code from the call to
<code>semidiscrete1</code>).
</p>
<p>If <code>p=2</code> an objectof class <code>power_diagram</code> having components <code>sites</code> and <code>cells</code>,
as well as (optionally) <code>wasserstein_dist</code>. <code>sites</code> is here a data.frame with columns <code>xi</code>,
<code>eta</code> and <code>w</code> (the weights for the power diagram). <code>cells</code> is a list with as many
2-column matrix components as there are sites, each describing the <code class="reqn">x</code>- and <code class="reqn">y</code>-coordinates
of the polygonal cell associated with the corresponding site or <code>NULL</code> if the cell of the site is empty.
</p>
<p>Plotting methods exist for objects of class <code>apollonius_diagram</code>, <code>power_diagram</code> and
for optimal transport maps represented by either of the two.
</p>


<h3>Note</h3>

<p>For <code>p=1</code> this function requires the Computational Geometry Algorithms Library (CGAL), available at <a href="https://www.cgal.org">https://www.cgal.org</a>. Adapt the file src/Makevars according to the instructions given there and re-install from source.
</p>
<p>Internally the code from liblbfgs 1.10 by Naoaki Okazaki (2010) is used.
</p>


<h3>Author(s)</h3>

<p>Dominic Schuhmacher <a href="mailto:dschuhm1@uni-goettingen.de">dschuhm1@uni-goettingen.de</a> <br>  
Björn Bähre <a href="mailto:bjobae@gmail.com">bjobae@gmail.com</a> <br>  
Valentin Hartmann <a href="mailto:valentin.hartmann@epfl.ch">valentin.hartmann@epfl.ch</a>
</p>


<h3>References</h3>

<p>F. Aurenhammer, F. Hoffmann and B. Aronov (1998). Minkowski-type theorems and least-squares clustering. Algorithmica 20(1), 61–76.
</p>
<p>V. Hartmann and D. Schuhmacher (2017). Semi-discrete optimal transport — the case p=1. Preprint <a href="https://arxiv.org/abs/1706.07650">arXiv:1706.07650</a>
</p>
<p>M. Karavelas and M. Yvinec. 2D Apollonius Graphs 
(Delaunay Graphs of Disks). In CGAL User and Reference Manual.
CGAL Editorial Board, 4.12 edition, 2018
</p>
<p>Q. Mérigot (2011). A multiscale approach to optimal transport. Computer Graphics Forum 30(5), 1583–1592. <a href="https://doi.org/10.1111/j.1467-8659.2011.02032.x">doi:10.1111/j.1467-8659.2011.02032.x</a>
</p>
<p>Naoaki Okazaki (2010). libLBFGS: a library of Limited-memory
Broyden-Fletcher-Goldfarb-Shanno (L-BFGS). Version 1.10
</p>


<h3>See Also</h3>

<p><code>plot</code>, <code>transport</code>, <code>aha</code>, <code>semidiscrete1</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">##  See examples for function transport</code></pre>


</div>