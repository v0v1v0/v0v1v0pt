<div class="container">

<table style="width: 100%;"><tr>
<td>plotTPD</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plotting Trait Probability Distributions</h2>

<h3>Description</h3>

<p><code>plotTPD</code> plots a TPD object (created with either TPDs ot TPDc) of 1 or 2 dimensions. In the 1-dimension case, <code>plotTPD</code> displays the trait in the x-axis and the probability associated to each trait value in the y-axis. In the 2-dimensions case, <code>plotTPD</code> displays traits in the x- and y-axes, and probabilities are indicated by a gradient of colors. The function yields a panel for each TPD calculated (one for each species or population in the case of TPDs and one for each community in the case of TPDc).
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotTPD(TPD, whichPlot = NULL, nRowCol = NULL, color1 = "grey60",
  leg = TRUE, leg.text = NULL, leg.pos = "topright", leg.cex = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>TPD</code></td>
<td>
<p>An object of class "TPDsp" or TPDcomm", generated with the <code>TPDs</code> or <code>TPDc</code> functions, respectively, containing the TPDs of the considered populations or species or the TPDc of the considered communities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>whichPlot</code></td>
<td>
<p>A vector indicating the identity of the species, populations or communities to plots. Defaults to NULL, in which case, all cases are plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nRowCol</code></td>
<td>
<p>A vector with two integers indicating the number of rows and columns of the layout. The product of the two numbers must be greater or equal than the length of whichPlot, so that all plots can be included. Defaults to NULL, in which case the layout is automatically selected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color1</code></td>
<td>
<p>The color used to fill the TPD in the 1-dimension case. Defaults to "grey60".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leg</code></td>
<td>
<p>Logical, indicating whether a legend with the name of the species, population or community should be added in the 1-dimension case.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leg.text</code></td>
<td>
<p>Vector, containing the names to be used in the legend of each plot in the 1-dimension case, or in the plots title in the 2-dimensions case. If provided, it must have the same length as whichPlot. Defaults to NULL, in which case the names of the species/populations or communities are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leg.pos</code></td>
<td>
<p>Character, indicating the location of the legend in the plot. Possible values are: "bottomright", "bottom", "bottomleft", "left", "topleft", "top", "topright", "right" and "center". Defaults to "topright".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leg.cex</code></td>
<td>
<p>Numeric, indicating the character expansion factor relative to current par("cex") for the text of the legend.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In the 2-dimensions case, <code>plotTPD</code> requires the packages <code>ggplot2</code> and <code>gridExtra</code> in order to work.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># 1.  Compute the TPDs of five different species. SP3 is in the center of
#   the trait space, and the rest of species in the corners
set.seed(1)
nind &lt;- 10
species_ex &lt;- c(rep("SP1",nind), rep("SP2",nind), rep("SP3",nind),
 rep("SP4",nind), rep("SP5",nind))
traits_ex &lt;- data.frame(trait1 = c(rnorm(nind, 10, 3),
                                   rnorm(nind, 10, 3),
                                   rnorm(nind, 15, 3),
                                   rnorm(nind, 20, 3),
                                   rnorm(nind, 20, 3)),
                        trait2 = c(rnorm(nind, 10, 3),
                                   rnorm(nind, 20, 3),
                                   rnorm(nind, 15, 3),
                                   rnorm(nind, 10, 3),
                                   rnorm(nind, 20, 3)))
## Not run: 
species_TPDs_2D &lt;- TPDs (species = species_ex, traits = traits_ex)
# Plot all species
plotTPD(species_TPDs_2D)
# Plot only species 3
plotTPD(species_TPDs_2D, whichPlot = 3)

## End(Not run)
#1 dimension case:
species_TPDs_1D &lt;- TPDs (species = species_ex, traits = traits_ex$trait1)
plotTPD(species_TPDs_1D)

#Now, let us plot communities (TPDc)
#2. three different communities with different abundances of each species
abundances_ex &lt;- matrix(c(c(0.05, 0.05, 0.8,  0.05, 0.05),
                          c(0.9,  0,    0,    0,    0.1 ),
                          c(0,    0,    1,    0,    0   )),
                   ncol = 5, byrow = TRUE, dimnames = list(paste0("Comm.",1:3),
                     unique(species_ex)))
## Not run: 
example_TPDc_2D &lt;- TPDc (TPDs = species_TPDs_2D, sampUnit = abundances_ex)
plotTPD(example_TPDc_2D)

## End(Not run)
example_TPDc_1D &lt;- TPDc (TPDs = species_TPDs_1D, sampUnit = abundances_ex)
plotTPD(example_TPDc_1D)

</code></pre>


</div>