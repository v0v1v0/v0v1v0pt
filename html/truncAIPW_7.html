<div class="container">

<table style="width: 100%;"><tr>
<td>truncAIPW_cen1</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Doubly Robust Estimation under Covariate-induced Dependent Left Truncation and Noninformative Right Censoring where Censoring can be before Left Truncation</h2>

<h3>Description</h3>

<p>Doubly robust estimation of the mean of an arbitrarily transformed survival time under covariate-induced dependent left truncation and noninformative right censoring where censoring can be before left truncation. Inverse probability of censoring weighting is used to handle the right censoring.
</p>


<h3>Usage</h3>

<pre><code class="language-R">truncAIPW_cen1(
  dat,
  nu,
  Fuz.mx,
  Gvz.mx,
  Sc,
  X.name,
  Q.name,
  status.name,
  trim = 1e-07
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>data frame that contains the data for constructing the estimating equation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p>transformation that defines the parameter of interest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Fuz.mx</code></td>
<td>
<p>matrix for the estimated conditional CDF of the event time given covariates. Each row corresponds to a subject, and each column corresponds to a time point. The column names of the matrix are the time points. See <code>F_est</code> for an example of computing this input matrix for the conditional CDF.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gvz.mx</code></td>
<td>
<p>matrix for the estimated conditional CDF of the truncation time given covariates. Each row corresponds to a subject, and each column corresponds to a time point. The column names of the matrix are the time points. See <code>G_est</code> for an example of computing this input matrix for the conditional CDF.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sc</code></td>
<td>
<p>a function for the censoring survival curve <code class="reqn">S_c(\cdot)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X.name</code></td>
<td>
<p>name of the censored event time variable X = min(T, C).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q.name</code></td>
<td>
<p>name of the left truncation time variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>status.name</code></td>
<td>
<p>name of the event time indicator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trim</code></td>
<td>
<p>constant that is used to bound from below for the denominators involved in the computation.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>truncAIPW_cen1()</code> returns a list of estimators (‘dr’, ‘IPW.Q’, ‘Reg.T1’, ‘Reg.T2’).
</p>
<table>
<tr style="vertical-align: top;">
<td><code>dr</code></td>
<td>
<p>doubly robust estimator ‘dr’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>IPW.Q</code></td>
<td>
<p>inverse probability of truncation weighted estimator ‘IPW.Q’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Reg.T1</code></td>
<td>
<p>regression based estimator ‘Reg.T1’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Reg.T2</code></td>
<td>
<p>regression based estimator ‘Reg.T2’.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Wang, Y., Ying, A., Xu, R. (2022) "Doubly robust estimation under covariate-induced dependent left truncation" &lt;arXiv:2208.06836&gt;.
</p>


<h3>See Also</h3>

<p>See also <code>truncAIPW</code> for estimation under no censoring, and <code>truncAIPW_cen2</code> for estimation under another type of noninformative right censoring. See also <code>F_est</code>, <code>G_est</code> as examples for computing the input matrices of the conditional CDF's.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(survival)
data("simu_c1")
simu_c1$delta.1 = 1

nu &lt;- function(t){ return(as.numeric(t&gt;3)) }
u = c(min(simu_c1$X)-1e-10, sort(simu_c1$X), max(simu_c1$X)+1e-10)
v = c(min(simu_c1$Q)-1e-10, sort(simu_c1$Q), max(simu_c1$Q)+1e-10)

Fuz.mx = F_est(simu_c1, simu_c1, u, "Cox", "X", "Q", "delta.1", c("Z1","Z2"))
Gvz.mx = G_est(simu_c1, simu_c1, v, "Cox", "X", "Q", "delta.1", c("Z1","Z2"))

# KM curve for Sc
kmfit.C = survfit(Surv(Q, X, 1-delta)~1, data = simu_c1, type = "kaplan-meier")
Sc = stepfun(kmfit.C$time,  c(1, kmfit.C$surv))

est = truncAIPW_cen1(simu_c1, nu, Fuz.mx, Gvz.mx, Sc, "X", "Q", "delta", trim = 1e-7)
est
</code></pre>


</div>