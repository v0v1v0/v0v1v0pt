<div class="container">

<table style="width: 100%;"><tr>
<td>bat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bat simulated data</h2>

<h3>Description</h3>

<p>Synthetic data generated from tensor response regression (TRR) model. Each response observation is a two-dimensional image, and each binary predictor observation takes values 0 and 1, representing two groups.
</p>


<h3>Usage</h3>

<pre><code class="language-R">data("bat")
</code></pre>


<h3>Format</h3>

<p>A list consisting of four components:
</p>

<dl>
<dt>x</dt>
<dd>
<p>A <code class="reqn">1 \times 20</code> matrix, each entry takes values 0 and 1, representing two groups.</p>
</dd>
<dt>y</dt>
<dd>
<p>A <code class="reqn">64\times 64\times 20</code> tensor, each matrix <code>y@data[,,i]</code> represents an image.</p>
</dd>
<dt>coeffiicients</dt>
<dd>
<p>A <code class="reqn">64\times 64 \times 1</code> tensor with the bat pattern.</p>
</dd>
<dt>Gamma</dt>
<dd>
<p>A list consisting of two <code class="reqn">64 \times 14</code> envelope basis.</p>
</dd>
</dl>
<h3>Details</h3>

<p>The dataset is generated from the tensor response regression (TRR) model:
</p>
<p style="text-align: center;"><code class="reqn">Y_i = B X_i + \epsilon_i,  i = 1,\ldots, n,</code>
</p>

<p>where <code class="reqn">n=20</code> and the regression coefficient <code class="reqn">B \in R^{64\times 64}</code> is a given image with rank 14, representing the mean difference of the response <code class="reqn">Y</code> between two groups. To make the model conform to the envelope structure, we construct the envelope basis <code class="reqn">\Gamma_k</code> and the covariance matrices <code class="reqn">\Sigma_k, k=1,2</code>, of error term as following. With the singular value decomposition of <code class="reqn">B</code>, namely <code class="reqn">B = \Gamma_1 \Lambda \Gamma_2^T</code>, we choose the envelope basis as <code class="reqn">\Gamma_k \in R^{64\times 14}, k=1,2</code>. Then the envelope dimensions are <code class="reqn">u_1 =  u_2 = 14</code>. We generate another two matrices <code class="reqn">\Omega_k \in R^{14\times 14} = A_k A_k^T</code> and  <code class="reqn">\Omega_{0k} \in R^{50\times 50} =  A_{0k}A_{0k}^T</code>, where <code class="reqn">A_k \in R^{14\times 14}</code> and <code class="reqn">A_{0k} \in R^{50\times 50}</code> are randomly generated from Uniform(0,1) elementwise. Then we set the covariance matrices <code class="reqn">\Sigma_k = \Gamma_k\Omega_k \Gamma_k^T + \Gamma_{0k}\Omega_{0k} \Gamma_{0k}^T</code>, followed by normalization with their Frobenius norms. We set the first 10 predictors <code class="reqn">X_i, i=1,\ldots, 10,</code> as 1 and the rest as 0. The error term is then generated from two-way tensor (matrix) normal distribution <code class="reqn">TN( 0; \Sigma_1, \Sigma_2)</code>.
</p>


<h3>References</h3>

<p>Li, L. and Zhang, X., 2017. Parsimonious tensor response regression. Journal of the American Statistical Association, 112(519), pp.1131-1146.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Fit bat dataset with the tensor response regression model
data("bat")
x &lt;- bat$x
y &lt;- bat$y
# Model fitting with ordinary least square.
fit_std &lt;- TRR.fit(x, y, method="standard")
# Draw the coefficient and p-value plots
plot(fit_std)

</code></pre>


</div>