<div class="container">

<table style="width: 100%;"><tr>
<td>EM_est</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate parameters and hazard function via EM algorithm.</h2>

<h3>Description</h3>

<p>Estimate the vector of parameters for baseline covariates
<code class="reqn">\beta</code> and baseline cumulative hazard function <code class="reqn">\Lambda(\cdot)</code>
using the expectation-maximization algorithm. <code class="reqn">\Lambda(t)</code> is estimated
as a step function with jumps only at the observed failure times. Typically,
it would only be used in a call to <code>trans.m</code> or <code>Simu</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">EM_est(Y, X, delta, alpha, Q = 60, EM_itmax = 250)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>observed event times</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>design matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>censoring indicator. If <code class="reqn">Y_i</code> is censored, <code>delta</code>=0. If
not, <code>delta</code>=1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>parameter in transformation function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q</code></td>
<td>
<p>number of nodes and weights in Gaussian quadrature. Defaults to 60.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EM_itmax</code></td>
<td>
<p>maximum iteration of EM algorithm. Defaults to 250.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list containing
</p>

<table>
<tr>
<td style="text-align: left;"> <code>beta_new</code> </td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: left;">
 estimator of <code class="reqn">\beta</code> </td>
</tr>
<tr>
<td style="text-align: left;"> <code>Lamb_Y</code> </td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: left;"> estimator of
 <code class="reqn">\Lambda(Y)</code> </td>
</tr>
<tr>
<td style="text-align: left;"> <code>lamb_Y</code> </td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: left;"> estimator of
 <code class="reqn">\lambda(Y)</code> </td>
</tr>
<tr>
<td style="text-align: left;"> <code>lamb_Ydot</code> </td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: left;"> estimator of
 <code class="reqn">\lambda(Y')</code> </td>
</tr>
<tr>
<td style="text-align: left;"> <code>Y_eq_Yhat</code> </td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: left;"> a matrix used in
 <code>trans.m</code> and <code>Simu</code> </td>
</tr>
<tr>
<td style="text-align: left;"> <code>Y_geq_Yhat</code> </td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: left;"> a matrix
 used in <code>trans.m</code> and <code>Simu</code> </td>
</tr>
<tr>
<td style="text-align: left;"> </td>
</tr>
</table>
<h3>References</h3>

<p>Abramowitz, M., and Stegun, I.A. (1972). Handbook of Mathematical
Functions (9th ed.). Dover Publications, New York.
</p>
<p>Evans, M. and Swartz, T. (2000). Approximating Integrals via Monte Carlo and
Deterministic Methods. Oxford University Press.
</p>
<p>Liu, Q. and Pierce, D.A. (1994). A note on Gauss-Hermite quadrature.
Biometrika 81: 624-629.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  gen_data = generate_data(200, 1, 0.5, c(-0.5, 1))
  delta = gen_data$delta
  Y = gen_data$Y
  X = gen_data$X
  EM_est(Y, X, delta, alpha = 1)$beta_new - c(-0.5, 1)


</code></pre>


</div>