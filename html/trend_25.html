<div class="container">

<table style="width: 100%;"><tr>
<td>snh.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Standard Normal Homogeinity Test (SNHT) for Change-Point Detection</h2>

<h3>Description</h3>

<p>Performes the Standard Normal Homogeinity Test (SNHT)
for change-point detection of a normal variate.
</p>


<h3>Usage</h3>

<pre><code class="language-R">snh.test(x, m = 20000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a vector of class "numeric" or a time series object of class "ts"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>numeric, number of Monte-Carlo replicates, defaults to 20000</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Let <code class="reqn">X</code> denote a normal random variate, then the following model
with a single shift (change-point) can be proposed:
</p>
<p style="text-align: center;"><code class="reqn">
  x_i = \left\{
      \begin{array}{lcl}
       \mu + \epsilon_i, &amp; \qquad &amp; i = 1, \ldots, m \\
       \mu + \Delta + \epsilon_i &amp; \qquad &amp; i = m + 1, \ldots, n \\
      \end{array} \right.</code>
</p>

<p>with <code class="reqn">\epsilon \approx N(0,\sigma)</code>. The null hypothesis <code class="reqn">\Delta = 0</code>
is tested against the alternative <code class="reqn">\Delta \ne 0</code>.
</p>
<p>The test statistic for the SNHT test is calculated as follows:
</p>
<p style="text-align: center;"><code class="reqn">T_k = k z_1^2 + \left(n - k\right) z_2^2 \qquad (1 \le k &lt; n)</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">
\begin{array}{l l}
z_1 = \frac{1}{k} \sum_{i=1}^k \frac{x_i - \bar{x}}{\sigma} &amp;
z_2 = \frac{1}{n-k} \sum_{i=k+1}^n \frac{x_i - \bar{x}}{\sigma}. \\
\end{array}</code>
</p>

<p>The critical value is:
</p>
<p style="text-align: center;"><code class="reqn">T = \max T_k.</code>
</p>
 
<p>The <code>p.value</code> is estimated with a Monte Carlo simulation
using <code>m</code> replicates.
</p>
<p>Critical values based on <code class="reqn">m = 1,000,000</code> Monte Carlo simulations
are tabulated for <code class="reqn">T</code> by Khaliq and Ouarda (2007).
</p>


<h3>Value</h3>

<p>A list with class "htest" and "cptest"
</p>
<table>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>
<p>character string that denotes the input data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>the p-value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>the test statistic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null.value</code></td>
<td>
<p>the null hypothesis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimates</code></td>
<td>
<p>the time of the probable change point</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>the alternative hypothesis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>character string that denotes the test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>numeric vector of Tk for plotting</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The current function is for complete observations only.
</p>


<h3>References</h3>

<p>H. Alexandersson (1986), A homogeneity test applied to precipitation data,
<em>Journal of Climatology</em> 6, 661–675.
</p>
<p>M. N. Khaliq, T. B. M. J. Ouarda (2007), On the critical values of the
standard normal homogeneity test (SNHT),
<em>International Journal of Climatology</em> 27, 681–687.
</p>
<p>G. Verstraeten, J. Poesen, G. Demaree, C. Salles (2006),
Long-term (105 years) variability in rain erosivity as derived from 10-min
rainfall depth data for Ukkel (Brussels, Belgium):
Implications for assessing soil erosion rates.
<em>Journal of Geophysical Research</em> 111, D22109.
</p>


<h3>See Also</h3>

<p><code>efp</code>
<code>sctest.efp</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(Nile)
(out &lt;- snh.test(Nile))
plot(out)

data(PagesData) ; snh.test(PagesData)
 
</code></pre>


</div>