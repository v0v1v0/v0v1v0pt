<div class="container">

<table style="width: 100%;"><tr>
<td>EstimationBR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimation of the parameters of the Brown-Resnick process</h2>

<h3>Description</h3>

<p>Estimation the parameters of the Brown-Resnick process, using either the pairwise M-estimator or weighted least squares (WLS).
</p>


<h3>Usage</h3>

<pre><code class="language-R">EstimationBR(
  x,
  locations,
  indices,
  k,
  method,
  isotropic = FALSE,
  biascorr = FALSE,
  Tol = 1e-05,
  k1 = (nrow(x) - 10),
  tau = 5,
  startingValue = NULL,
  Omega = diag(nrow(indices)),
  iterate = FALSE,
  covMat = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">d</code> data matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>locations</code></td>
<td>
<p>A <code class="reqn">d</code> x 2 matrix containing the Cartesian coordinates of <code class="reqn">d</code> points in the plane.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indices</code></td>
<td>
<p>A <code class="reqn">q</code> x <code class="reqn">d</code> matrix containing exactly 2 ones per row, representing a pair of points from the matrix <code>locations</code>, and zeroes elsewhere.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>An integer between 1 and <code class="reqn">n - 1</code>; the threshold parameter in the definition of the empirical stable tail dependence function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Choose between <code>Mestimator</code> and <code>WLS</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>isotropic</code></td>
<td>
<p>A Boolean variable. If <code>FALSE</code> (the default), then an anisotropic process is estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>biascorr</code></td>
<td>
<p>For <code>method = "WLS"</code> only. If <code>TRUE</code>, then the bias-corrected estimator of the stable tail dependence function is used. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tol</code></td>
<td>
<p>For <code>method = "Mestimator"</code> only. The tolerance parameter used in the numerical integration procedure. Defaults to 1e-05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k1</code></td>
<td>
<p>For <code>biascorr = TRUE</code> only. The value of <code class="reqn">k_1</code> in the definition of the bias-corrected estimator of the stable tail dependence function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>For <code>biascorr = TRUE</code> only. The parameter of the power kernel.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>startingValue</code></td>
<td>
<p>Initial value of the parameters in the minimization routine. Defaults to <code class="reqn">c(1,1.5)</code> if <code>isotropic = TRUE</code> and <code class="reqn">c(1, 1.5, 0.75, 0.75)</code> if <code>isotropic = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Omega</code></td>
<td>
<p>A <code class="reqn">q</code> x <code class="reqn">q</code> matrix specifying the metric with which the distance between the parametric and nonparametric estimates will be computed. The default is the identity matrix, i.e., the Euclidean metric.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterate</code></td>
<td>
<p>A Boolean variable. If <code>TRUE</code>, then for <code>method = "Mestimator"</code> the estimator is calculated twice, first with <code>Omega</code> specified by the user, and then a second time with the optimal <code>Omega</code> calculated at the initial estimate. If <code>method = "WLS"</code>, then continuous updating is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covMat</code></td>
<td>
<p>A Boolean variable. If <code>TRUE</code> (the default), the covariance matrix is calculated. Standard errors are obtained by taking the square root of the diagonal elements.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The parameters of the Brown-Resnick process are either <code class="reqn">(\alpha,\rho)</code> for an isotropic process or <code class="reqn">(\alpha,\rho,\beta,c)</code> for an anisotropic process. The matrix <code>indices</code> can be either user-defined or returned from the function <code>selectGrid</code> with <code>cst = c(0,1)</code>. Estimation might be rather slow when <code>iterate = TRUE</code> or even when <code>covMat = TRUE</code>.
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>

<table>
<tr>
<td style="text-align: left;">
<code>theta</code> </td>
<td style="text-align: left;"> The estimator using the optimal weight matrix. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>theta_pilot</code> </td>
<td style="text-align: left;"> The estimator without the optimal weight matrix.</td>
</tr>
<tr>
<td style="text-align: left;">
<code>covMatrix</code> </td>
<td style="text-align: left;"> The estimated covariance matrix for the estimator. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>value</code> </td>
<td style="text-align: left;"> The value of the minimized function at <code>theta</code>. </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>References</h3>

<p>Einmahl, J.H.J., Kiriliouk, A., and Segers, J. (2018). A continuous updating weighted least squares estimator of tail dependence in high dimensions. Extremes 21(2), 205-233.
</p>
<p>Einmahl, J.H.J., Kiriliouk, A., Krajina, A., and Segers, J. (2016). An Mestimator of spatial tail dependence. Journal of the Royal Statistical Society: Series B (Statistical Methodology), 78(1), 275-298.
</p>


<h3>See Also</h3>

<p><code>selectGrid</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## define the locations of 9 stations
locations &lt;- cbind(rep(c(1:3), each = 3), rep(1:3, 3))
## select the pairs of locations
indices &lt;- selectGrid(cst = c(0,1), d = 9, locations = locations, maxDistance = 1.5)
## The Brown-Resnick process
set.seed(1)
x &lt;- SpatialExtremes::rmaxstab(n = 1000, coord = locations, cov.mod = "brown",
                               range = 3, smooth = 1)
## Calculate the estimtors.
EstimationBR(x, locations, indices, 100, method = "Mestimator", isotropic = TRUE,
             covMat = FALSE)$theta
EstimationBR(x, locations, indices, 100, method = "WLS", isotropic = TRUE,
covMat = FALSE)$theta
</code></pre>


</div>