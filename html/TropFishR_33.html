<div class="container">

<table style="width: 100%;"><tr>
<td>predict_mod</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Prediction models</h2>

<h3>Description</h3>

<p>This function applies Beverton &amp; Holt's yield per recruit model
as well as the Thompson &amp; Bell model. These models predict catch, yield, biomass
and economic values for different
fishing mortality scenarions (in combination with gear changes).
</p>


<h3>Usage</h3>

<pre><code class="language-R">predict_mod(
  param,
  type,
  FM_change = NA,
  E_change = NA,
  FM_relative = FALSE,
  Lc_change = NULL,
  tc_change = NULL,
  s_list = NA,
  stock_size_1 = NA,
  age_unit = "year",
  curr.E = NA,
  curr.Lc = NA,
  plus_group = NA,
  Lmin = NA,
  Lincr = NA,
  plot = FALSE,
  mark = TRUE,
  hide.progressbar = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>a list consisting of following parameters (not all are required):
</p>

<ul>
<li> <p><strong>Linf</strong> or <strong>Winf</strong>: infinite length or weight, respectively,
for investigated species in cm [cm],
</p>
</li>
<li> <p><strong>K</strong>: growth coefficent for investigated species per year [1/year],
</p>
</li>
<li> <p><strong>t0</strong>: theoretical time zero, at which individuals of this species
hatch,
</p>
</li>
<li> <p><strong>M</strong>: natural mortality or
</p>
</li>
<li> <p><strong>Z</strong>: total mortality,
</p>
</li>
<li> <p><strong>FM</strong>: fishing mortality,
</p>
</li>
<li> <p><strong>a</strong>: length-weight relationship coefficent (W = a * L^b),
</p>
</li>
<li> <p><strong>b</strong>: length-weight relationship coefficent (W = a * L^b),
</p>
</li>
<li> <p><strong>Lr</strong> or <strong>tr</strong>: length or age of recruitment;</p>
</li>
</ul>
<p>additional list objects for the Thompson and Bell model:
</p>

<ul>
<li> <p><strong>midLengths</strong> or <strong>age</strong>: midpoints of the length classes
(length-frequency data) or ages (age composition data),
</p>
</li>
<li> <p><strong>meanWeight</strong>: vector with mean weight per length group or age class,
</p>
</li>
<li> <p><strong>meanValue</strong>: vector with mean value per length group or age class,
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>indicating which model should be applied: <code>"ypr"</code> for Beverton
and Holt's yield per recruit model and <code>"ThompBell"</code> for the Thompson and Bell model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FM_change</code></td>
<td>
<p>vector with ascending fishing mortalities (if <code>FM_relative</code>
is set to TRUE, values can also be relative (only for Thompson and Bell model).
Default are absolute values from 0 to 10). Or</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>E_change</code></td>
<td>
<p>vector with ascending absolute exploitation rates;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FM_relative</code></td>
<td>
<p>logical; indicating whether <code>FM_change</code> is relative or
absolute. Default is FALSE (absolute fishing mortalities in <code>FM_change</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lc_change</code></td>
<td>
<p>vector with ascending lengths at first capture (Lc), or</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tc_change</code></td>
<td>
<p>vector with ascending ages at first capture (tc)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s_list</code></td>
<td>
<p>list with selectivity parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stock_size_1</code></td>
<td>
<p>stock size of smallest size class, if NA values are calculated
relative to a stock size of 1000 individuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>age_unit</code></td>
<td>
<p>in which time unit the data is provided? "month" or "year"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>curr.E</code></td>
<td>
<p>current exploitation rate if available</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>curr.Lc</code></td>
<td>
<p>current Lc (length at first capture) if available</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plus_group</code></td>
<td>
<p>if a value is provided, a plus group is created comprising this
size class and all above</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lmin</code></td>
<td>
<p>smallest length group where to start with selection ogive. Not required
for "knife_edge" selection type</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lincr</code></td>
<td>
<p>arbitrary length increment between length groups for estimation of
selection ogive. The smaller the higher the resolution but the slower the model
run. Not required for "knife_edge" selection type</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical; if TRUE results are displayed graphically</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mark</code></td>
<td>
<p>logical; if value of choosen points should be displayed in graph (default: TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hide.progressbar</code></td>
<td>
<p>logical; should progressbar be displayed or hidden? (Default: FALSE)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Thompson and Bell model incorporates an iteration step simulating the
stock by means
of the <code>stock_sim</code> function. In case changes in gear
characteristics -
here measured in terms of Lc or tc, the length or age at first capture,
respectively -
should be explored, a list with selectivity information about the gear has
to be provided and
the prediction models make use of the selectivity <code>select_ogive</code>
function.
Sparre and Venema (1998) recommend to treat the last length class always as plus group.
This model is very sensitive to zero observations in the ultimate length
classes. If unrealistic results are returned,
it is recommended to cut length classes with zero observations, group
them in a plus group or to change the interval between
length classes.
Equations which are used in this function assume isometric growth, an
assumption often not met. Further, the assumption that there is no relationship
between the parental stock size and progeny
over a wide range of fishing mortalities or exploitation values,
respectively, is also said to be untrue. By default, the functions assume
knife-edge recruitment and selection of gears (Sparre and Venema, 1998).
If E_change instead of FM_change is used the range is cut at E=0.9, because
higher values of E correspond to unrealistic high values of fishing mortality.
If no selectivity information is given (by use of s_list), knife edge selectivity
with L50 equal to the first argument of Lc_change is assumed.
</p>


<h3>Value</h3>

<p>A list with the input parameters and dependent on the model type following
list objects:
</p>

<ul>
<li> <p><code>type = 'ypr'</code>
</p>

<ul>
<li> <p><strong>FM</strong>: fishing mortalities,
</p>
</li>
<li> <p><strong>Lc</strong> or <strong>tc</strong>: lengths or ages at first capture,
</p>
</li>
<li> <p><strong>list_Lc_runs</strong>: a list with dataframes for each Lc value:
</p>

<ul>
<li> <p><strong>FM_change</strong>: fishing mortalities
</p>
</li>
<li> <p><strong>E</strong>: expoitation rates
</p>
</li>
<li> <p><strong>Ty</strong>: mean age in annual yield
</p>
</li>
<li> <p><strong>LY</strong>: mean length in annual yield
</p>
</li>
<li> <p><strong>Wy</strong>: mean weight in annual yield
</p>
</li>
<li> <p><strong>Y_R.rel</strong>: relative yield per recruit (change in catch in
weigth per recruit relative to initial Y/R value)
</p>
</li>
<li> <p><strong>B_R.rel</strong>: relative biomass per recruit
</p>
</li>
<li> <p><strong>Y_R</strong>: yield per recurit (catch in weight per recruit)
</p>
</li>
<li> <p><strong>B_R</strong>: biomass per recruit
</p>
</li>
<li> <p><strong>B_R.percent</strong>: percentage biomass per recurit in relation to virgin
biomass per recruit
</p>
</li>
</ul>
</li>
<li> <p><strong>df_Es</strong>: a dataframe with references points (columns) for
different Lc values (rows)
</p>
</li>
<li> <p><strong>df_current</strong>: a dataframe with the exploitation status, yield
and biomass values of current exploitation or selectivity (if E_curr or
Lc_tc_curr provided).
</p>
</li>
</ul>
</li>
<li> <p><code>type = 'ThompBell'</code>
</p>

<ul>
<li> <p><strong>dt</strong>: delta t,
</p>
</li>
<li> <p><strong>N</strong>: population number,
</p>
</li>
<li> <p><strong>dead</strong>: deaths due to natural reasons,
</p>
</li>
<li> <p><strong>C</strong>: catch,
</p>
</li>
<li> <p><strong>Y</strong>: yield,
</p>
</li>
<li> <p><strong>B</strong>: biomass,
</p>
</li>
<li> <p><strong>V</strong>: value,
</p>
</li>
<li> <p><strong>totals</strong>: summed up values (total catch, total yield, total value, average biomass),
</p>
</li>
<li> <p><strong>totC</strong>: total catches for different x factors,
</p>
</li>
<li> <p><strong>totY</strong>: total yield values for different x factors,
</p>
</li>
<li> <p><strong>totV</strong>: total values for different x factors,
</p>
</li>
<li> <p><strong>meanB</strong>: average biomasses for different x factors,
</p>
</li>
<li> <p><strong>F_change</strong>: fishing mortality changes;
</p>
</li>
</ul>
</li>
<li> <p><code>type = 'ThompBell'</code> and <code>Lc_change</code> provided
</p>

<ul>
<li> <p><strong>FM_change</strong>: fishing mortality changes,
</p>
</li>
<li> <p><strong>Lc_change</strong>: changes in length at first capture,
</p>
</li>
<li> <p><strong>Lt</strong>: lengths at age,
</p>
</li>
<li> <p><strong>sel</strong>: probability of capture,
</p>
</li>
<li> <p><strong>mat_FM_Lc_com.C</strong>: catch matrix for all fishing mortality and Lc/tc combinations,
</p>
</li>
<li> <p><strong>mat_FM_Lc_com.Y</strong>: yield matrix for all fishing mortality and Lc/tc combinations,
</p>
</li>
<li> <p><strong>mat_FM_Lc_com.V</strong>: value matrix for all fishing mortality and Lc/tc combinations,
</p>
</li>
<li> <p><strong>mat_FM_Lc_com.B</strong>: biomass matrix for all fishing mortality and Lc/tc combinations;
</p>
</li>
</ul>
</li>
</ul>
<h3>References</h3>

<p>Berkeley, S.A., and Houde, E.D., 1980. Swordfish, Xiphias gladius, dynamics in
the Straits of Florida. <em>ICES C.M.</em>, 11.
</p>
<p>Beverton, R.J.H., and Holt, S.J., 1964. Table of yield functions for fishery
management. <em>FAO Fish. Tech. Pap.</em> 38, 49 p.
</p>
<p>Beverton, R.J.H., and Holt, S.J., 1966. Manual of methods for fish stock
assessment. Pt. 2: Tables of yield functions. <em>FAO Fisheries Technical Paper</em>,
(38)Rev.1:67 p.
</p>
<p>Boerema, L.K., and J.A. Gulland, 1973. Stock assessment of the Peruvian anchovy
(Engraulis ringens) and management of the fishery. <em>Journal of the Fisheries
Board of Canada</em>, 30(12):2226-2235
</p>
<p>Garcia, S. and N.P. van Zalinge, 1982. Shrimp fishing in Kuwait: methodology
for a joint analysis of the artisanal and industrial fisheries. pp. 119-142 In:
Report on the Workshop on assessment of the shrimp stocks of the west coast of
the Gulf between Iran and the Arabian Peninsula. Fisheries development in the
Gulf. Rome, FAO, FI:DP/RAB/80/015/1, 163 p.
</p>
<p>Gulland, J.A., 1983. Fish stock assessment: a manual of basic methods.
<em>FAO/Wiley</em>, New York.
</p>
<p>Gulland, J.A. and Boerema, L., 1973. Scientific advice on catch levels.
<em>Fish. Bull. (US)</em> 71:325-335.
</p>
<p>Jones, R.E. 1957. A much simplified version of the fish yield equation. Doc. No.
P. 21. Paper presented at the Lisbon joint meeting of International Commission
Northwest Atlantic-Fisheries, International Council for the Exploration of the
Sea, and Food and Agriculture Organization of the United Nations. 8 p. [Mimeo].
</p>
<p>Millar, R.B., and Holst, R., 1997. Estimation of gillnet and hook selectivity using
log-linear models. <em>ICES Journal of Marine Science: Journal du Conseil</em>,
54(3):471-477
</p>
<p>Pauly, D., 1980. A selection of simple methods for the assessment of tropical fish
stocks. <em>FAO Fisheries Circulars (FAO)</em>. no. 729.
</p>
<p>Pauly, D., 1984. Fish population dynamics in tropical waters: a manual for use
with programmable calculators. <em>ICLARM</em> Stud. Rev. 8, 325 p.
</p>
<p>Pauly, D. and M. Soriano. 1986. Some practical extensions to Beverton and
Holt's relative yield-per-recruit model, p. 491-495. In J.L. Maclean, L.B. Dizon
and L.V. Hosillos (eds.) The First Asian Fisheries Forum. Asian Fisheries Society,
Manila.
</p>
<p>Schaefer, M.B., 1954. Some aspects of the dynamics of populations important to the
management of the commercial marine fisheries. <em>Inter-Am. Trop. Tuna Comm.,
Bull.</em> 1(2):27-56.
</p>
<p>Schaefer, M.B., 1957. A study of the dynamics of the fishery for yellowfin tuna
in the eastern tropical Pacific Ocean. <em>Inter-Am. Trop. Tuna Comm., Bull.</em>
2:247-268.
</p>
<p>Sparre, P., and Venema, S.C., 1998. Introduction to tropical fish stock assessment.
Part 1. Manual. <em>FAO Fisheries Technical Paper</em>, (306.1, Rev. 2). 407 p.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#______________________________________
# Yiel Per Recruit (YPR) / Beverton and Holt's model
#______________________________________
# age structured data
# Nemipterus marginatus
threadfin &lt;- list(Winf = 286, K = 0.37, t0 = -0.2, M = 1.1, tr = 0.4)

predict_mod(threadfin, FM_change = seq(0,6,0.1),
   tc_change = seq(0.2,1,0.2), type = 'ypr')

# Leiognathus spendens (Pauly, 1980)
ponyfish &lt;- list(Winf = 64, K = 1, t0 = -0.2, M = 1.8, tr = 0.2)

predict_mod(ponyfish, tc_change = c(0.2,0.3,1.0), type = 'ypr', plot=TRUE)

#______________________________________
# length structured data
# Xiphias gladius (Berkeley and Houde, 1980)
swordfish &lt;- list(Linf = 309, K = 0.0949, M = 0.18,
                  a = 0.0003, b = 3, Lr = 90)

select.list &lt;- list(selecType = 'trawl_ogive', L50 = 120, L75 = 132)
#swordfish$midLengths &lt;- seq(60,300,5)

output &lt;- predict_mod(param = swordfish, Lc_change = c(100,118,150,180),
            s_list = select.list, type = 'ypr', Lmin = 90, Lincr = 8)
plot(output)

data(hake)
hake$Lr &lt;- 35
select.list &lt;- list(selecType = 'trawl_ogive', L50 = 50, L75 = 54)
output &lt;- predict_mod(param = hake, FM_change = seq(0,3,0.05),
                      Lc_change = seq(30,70,1), s_list = select.list,
                      type = 'ypr', plot = FALSE, curr.Lc = 50, curr.E = 0.73)
plot(output, type = "Isopleth", xaxis1 = "FM", yaxis1 = "Y_R.rel", mark = TRUE)

output &lt;- predict_mod(param = hake, E_change = seq(0,1,0.1),
                      Lc_change = seq(2,120,2), #s_list = select.list,
                      type = 'ypr', plot = FALSE)
plot(output, type = "Isopleth", xaxis1 = "E", yaxis1 = "B_R")

#______________________________________
#      Thompson and Bell model
#______________________________________
# with age structured data
data(shrimps)

output &lt;- predict_mod(param = shrimps, FM_change = seq(0.1,20,0.1),
     type = "ThompBell", age_unit = "month", plot = TRUE)

#______________________________________
# with length structured data
data(hake)
par(mar = c(5, 4, 4, 7))
predict_mod(param = hake,FM_change = seq(0.1,3,0.05),
     type = 'ThompBell', plot = TRUE)

# create list with selectivity information
select.list &lt;- list(selecType = 'trawl_ogive', L50 = 50, L75 = 55)

output &lt;- predict_mod(param = hake, FM_change = seq(0,2,0.1),
     Lc_change = seq(20,70,1),
     curr.E = 0.4, curr.Lc = 50,
     type = 'ThompBell', s_list = select.list)
plot(output, xaxis1 = "FM", yaxis_iso = "Lc", yaxis1 = "B_R", mark = TRUE)


</code></pre>


</div>