<div class="container">

<table style="width: 100%;"><tr>
<td>fit_tapnet</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit the tapnet model to a network</h2>

<h3>Description</h3>

<p>Estimates the parameters of the tapnet model by log-likelihood based on the oberved network(s)
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit_tapnet(
  tapnet,
  ini = NULL,
  tmatch_type_pem = "normal",
  tmatch_type_obs = "normal",
  lambda = 0,
  method = "Nelder",
  maxit = 50000,
  hessian = FALSE,
  obj_function = "multinom",
  fit.delta = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tapnet</code></td>
<td>
<p>a tapnet object;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ini</code></td>
<td>
<p>initial parameter values for the optimization; optional;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tmatch_type_pem</code></td>
<td>
<p>type of trait matching function for latent traits, currently "normal" or "shiftlnorm";</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tmatch_type_obs</code></td>
<td>
<p>type of trait matching function for observed traits, currently "normal" or "shiftlnorm";</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>LASSO shrinkage factor for latent trait parameters;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Optimization method (most derivative-based approaches will not work! SANN is a (slow) alternative to the default);</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>Maximum number of steps for optimization;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hessian</code></td>
<td>
<p>logical: output hessian for calculation of standard errors?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obj_function</code></td>
<td>
<p>Objective function for the optimization, either "multinom" or "sq_diff";</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.delta</code></td>
<td>
<p>logical; should the parameter delta be fitted? It allows tapnet to down-weigh the importance of trait matching relative to abundances.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The core function for using the tapnet approach: it fits the model to the data (= networks). Then, the estimated parameters can be used to predict to other networks (using <code>predict_tapnet</code>).
</p>


<h3>Value</h3>

<p>A tapnet-fit object, containing the tapnet model parameters as entries "par_opt", the settings of the tmatch_type for PEMs and observed traits, the parameter set for lambda, the optimisation method set, along with its maxit-value, and, finally, the output of the call to <code>optim</code>, including the target value (the negative log-likelihood), the convergence report and the parameters as fitted <em>at the transformed scale</em>. Note that the entries under "opt" will not be the same as those under "par_opt"!
</p>


<h3>Author(s)</h3>

<p>Gita Benadi &lt;gita.benadi@biom.uni-freiburg.de&gt; and Carsten Dormann &lt;carsten.dormann@biom.uni-freiburg.de&gt;
</p>


<h3>References</h3>

<p>Benadi et al. in prep
</p>


<h3>Examples</h3>

<pre><code class="language-R"> # takes about 35 s
 data(Tinoco)
 tap &lt;- make_tapnet(tree_low = plant_tree, tree_high = humm_tree, networks = networks[2:3], 
        traits_low = plant_traits, traits_high = humm_traits, npems_lat = 4)
 fit &lt;- fit_tapnet(tap) # fits to networks 2 and 3 only
 str(fit)
  

</code></pre>


</div>