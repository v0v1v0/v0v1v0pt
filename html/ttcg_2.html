<div class="container">

<table style="width: 100%;"><tr>
<td>ttcg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Accelerated three-term conjugate gradient optimization with restart</h2>

<h3>Description</h3>

<p>The <code>ttcg</code> function minimizes a given function using several Neculai Andrei's
three-term conjugate gradient algorithms.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ttcg(par, fn, gr = NULL, method = "TTDES", control = list(), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>
<p>A numerical vector containing the initial parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fn</code></td>
<td>
<p>A function to be minimized. It should accept a numerical vector as its sole
argument and return a scaler.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gr</code></td>
<td>
<p>The gradient function of <code>fn</code>. It should accept the same argument as <code>fn</code>
and return a vector of the same length as <code>par</code>. If it is <code>NULL</code> then
numerical finite difference is used to obtain the gradient.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>A character string, one of 'TTDES', 'TTCG', 'THREECG'. This determines how the
line search direction is computed. 'TTDES' is the default method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>A list of control parameters. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Extra arguments to be passed to <code>fn</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>By default, the algorithm stops when any one of the following three convergence tests
is satisfied. (1) The squared Euclidean norm of the squared Euclidean norm of the
gradient is smaller than a tolerance; (2) The infinity norm of the gradient is smaller
than a tolerance; (3) <code class="reqn">|f_{k+1} - f_k| &lt; \epsilon * (1 + |f_k|)</code>. These three
tolerances can be set in the <code>control</code> argument, and turnt off by setting them
to any negative values. If all three were turnt off, the algorithm may never stop.
</p>
<p>The <code>method</code> argument specifies how the search direction in each step is computed.
Please see the three Neculai Andrei's three papers in the citation section for more
detailed description. An acceleration scheme and a restart procedure are implemented
according to his three papers. Line search is done by a bisection-like
weak-Wolfe search described in Oliveira and Takahashi's (2020) interpolate-truncate-project
algorithm, but replacing their gradient-secant interpolation with some of More-Thuente's (1994)
cubic interpolation idea.
</p>
<p>The <code>control</code> argument is a list that can contain any of the following named
element:
</p>

<dl>
<dt>maxit</dt>
<dd>
<p>The maximal number of iteration. Default is 500.</p>
</dd>
<dt>gl2tol</dt>
<dd>
<p>A positive small number. The iteration will be terminated if the
squared Euclidean norm of the gradient is smaller than this number. Default is
<code>min(1e-9, length(par)*1e-10)</code>. To turn off this test,
set it to any negative values.</p>
</dd>
<dt>gmaxtol</dt>
<dd>
<p>A positive small number. The iteration will be terminated if the infinity norm of the graident is smaller than
<code>gmaxtol</code>. Default is 1e-6. To turn off this test, set it to any negative values.</p>
</dd>
<dt>ftol</dt>
<dd>
<p>A positive small number. The iteration will be terminated if <code class="reqn">|f_{k+1} - f_k| &lt; ftol * (1 + |f_k|)</code>.
To turn off this test, set it to any negative values.</p>
</dd>
<dt>c1</dt>
<dd>
<p>The line search parameter for the sufficient descent condition. Default is 1e-3.</p>
</dd>
<dt>c2</dt>
<dd>
<p>The line search parameter for the curvature condition. Default is 0.08.</p>
</dd>
<dt>trace</dt>
<dd>
<p>Either TRUE or FALSE, indicating whether or not details should be printed to the terminal
during the optimization. Default is FALSE.</p>
</dd>
</dl>
<h3>Value</h3>

<p>A list containing the following named elements.
</p>

<dl>
<dt>par</dt>
<dd>
<p>The optimal parameter.</p>
</dd>
<dt>value</dt>
<dd>
<p>The optimal function value.</p>
</dd>
<dt>counts</dt>
<dd>
<p>An integer vector containing the number of function and gradient calls
used during the optimization.</p>
</dd>
<dt>convergence</dt>
<dd>
<p>An integer indicating convergence status. '0' means successful convergence; '1'
means <code>maxit</code> has been reached; '2' means a line search failure in which
a point that satisfies the weak Wolfe condition is not found. Among other possibilities,
this may happen when the function is unbounded below or the function is
non-differentiable.)</p>
</dd>
<dt>message</dt>
<dd>
<p>A character string giving additional message.</p>
</dd>
</dl>
<h3>References</h3>

<p>Andrei, N. (2013). On three-term conjugate gradient algorithms for unconstrained optimization. Applied Mathematics and Computation, 219(11), 6316-6327.
</p>
<p>Andrei, N. (2013). A simple three-term conjugate gradient algorithm for unconstrained optimization. Journal of Computational and Applied Mathematics, 241, 19-29.
</p>
<p>Andrei, N. (2015). A new three-term conjugate gradient algorithm for unconstrained optimization. Numerical Algorithms, 68(2), 305-321.
</p>
<p>Oliveira, I. F., &amp; Takahashi, R. H. (2020). An Enhancement of the Bisection Method Average Performance Preserving Minmax Optimality. ACM Transactions on Mathematical Software (TOMS), 47(1), 1-24.
</p>
<p>More, J. J., &amp; Thuente, D. J. (1994). Line search algorithms with guaranteed sufficient decrease. ACM Transactions on Mathematical Software (TOMS), 20(3), 286-307.
</p>


<h3>Examples</h3>

<pre><code class="language-R">nqm = rnorm(500)*2
fn  = function (x,nqm1) sum((x - nqm1)^2.)
gr  = function (x,nqm1) 2.*(x - nqm1)
r   = ttcg(par = rnorm(500)*4., fn = fn, gr = gr, method='TTDES', nqm=nqm)
all.equal(r$value, 0.0)
</code></pre>


</div>