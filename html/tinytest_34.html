<div class="container">

<table style="width: 100%;"><tr>
<td>run_test_dir</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Run all tests in a directory</h2>

<h3>Description</h3>

<p><code>run\_test\_dir</code> runs all test files in a directory.
</p>
<p><code>test_all</code> is a convenience function for package development, that
wraps <code>run_test_dir</code>. By default, it runs all files starting with
<code>test</code> in <code>./inst/tinytest/</code>.  It is assumed that all functions to
be tested are loaded.
</p>


<h3>Usage</h3>

<pre><code class="language-R">run_test_dir(
  dir = "inst/tinytest",
  pattern = "^test.*\\.[rR]$",
  at_home = TRUE,
  verbose = getOption("tt.verbose", 2),
  color = getOption("tt.pr.color", TRUE),
  remove_side_effects = TRUE,
  cluster = NULL,
  lc_collate = getOption("tt.collate", NA),
  ...
)

test_all(pkgdir = "./", testdir = "inst/tinytest", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dir</code></td>
<td>
<p><code>[character]</code> path to directory</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pattern</code></td>
<td>
<p><code>[character]</code> A regular expression that is used to find
scripts in <code>dir</code> containing tests (by default <code>.R</code> or <code>.r</code>
files starting with <code>test</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>at_home</code></td>
<td>
<p><code>[logical]</code> toggle local tests.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p><code>[logical]</code> toggle verbosity during execution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color</code></td>
<td>
<p><code>[logical]</code> toggle colorize output</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remove_side_effects</code></td>
<td>
<p><code>[logical]</code> toggle remove user-defined side 
effects. Environment variables (<code>Sys.setenv()</code>) and options (<code>options()</code>)
defined in a test file are reset before running the next test file (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p>A <code>makeCluster</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lc_collate</code></td>
<td>
<p><code>[character]</code> Locale setting used to sort the
test files into the order of execution. The default <code>NA</code> ensures
current locale is used. Set this e.g. to <code>"C"</code> to ensure bytewise
and more platform-independent sorting (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments passed to <code>run_test_file</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pkgdir</code></td>
<td>
<p><code>[character]</code> scalar. Root directory of the package (i.e.
direcory where <code>DESCRIPTION</code> and <code>NAMESPACE</code> reside).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>testdir</code></td>
<td>
<p><code>[character]</code> scalar. Subdirectory where test files are
stored.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>tinytests</code> object
</p>


<h3>Details</h3>

<p>We cannot guarantee that files will be run in any particular order accross
all platforms, as it depends on the available collation charts (a chart that
determines how alphabets are sorted).  For this reason it is a good idea to
create test files that run independent of each other so their order of
execution does not matter. In tinytest, test files cannot share variables.
The default behavior of test runners further discourages interdependence by
resetting environment variables and options that are set in a test file
after the file is executed. If an environment variable needs to survive a
single file, use <code>base::Sys.setenv()</code> explicitly.  Similarly, if an
option setting needs to survive, use <code>base::options()</code>
</p>


<h3>Parallel tests</h3>

<p>If <code>inherits(cluster, "cluster")</code> the tests are paralellized over a
cluster of worker nodes. <span class="pkg">tinytest</span> will be loaded onto each cluster
node. All other preparation, including loading code from the tested package,
must be done by the user. It is also up to the user to clean up the cluster
after running tests. See the 'using tinytest' vignette for examples:
<code>vignette("using_tinytest")</code>.
</p>


<h3>See Also</h3>

<p><code>makeCluster</code>,
<code>clusterEvalQ</code>, <code>clusterExport</code>
</p>
<p>Other test-files: 
<code>build_install_test()</code>,
<code>exit_file()</code>,
<code>run_test_file()</code>,
<code>summary.tinytests()</code>,
<code>test_package()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># create a test file in tempdir
tests &lt;- "
addOne &lt;- function(x) x + 2

expect_true(addOne(0) &gt; 0)
expect_equal(2, addOne(1))
"
testfile &lt;- tempfile(pattern="test_", fileext=".R")
write(tests, testfile)

# extract testdir
testdir &lt;- dirname(testfile)
# run all files starting with 'test' in testdir
out &lt;- run_test_dir(testdir)
print(out)
dat &lt;- as.data.frame(out)

</code></pre>


</div>