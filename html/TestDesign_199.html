<div class="container">

<table style="width: 100%;"><tr>
<td>calc_likelihood</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>(C++) For multiple items, calculate likelihoods</h2>

<h3>Description</h3>

<p><code>calc_likelihood()</code> and <code>calc_likelihood_function()</code> are functions for calculating likelihoods.
</p>


<h3>Usage</h3>

<pre><code class="language-R">calc_likelihood(x, item_parm, resp, ncat, model)

calc_likelihood_function(theta_grid, item_parm, resp, ncat, model)

calc_log_likelihood(x, item_parm, resp, ncat, model, prior, prior_parm)

calc_log_likelihood_function(
  theta_grid,
  item_parm,
  resp,
  ncat,
  model,
  prior,
  prior_parm
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, theta_grid</code></td>
<td>
<p>the theta value. This must be a column vector in matrix form for <code>calc_*_function()</code> functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>item_parm</code></td>
<td>
<p>a matrix containing item parameters. Each row should represent an item.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resp</code></td>
<td>
<p>a vector containing responses on each item.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncat</code></td>
<td>
<p>a vector containing the number of response categories of each item.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a vector indicating item models of each item, using </p>

<ul>
<li>
<p><code>1</code>: 1PL model
</p>
</li>
<li>
<p><code>2</code>: 2PL model
</p>
</li>
<li>
<p><code>3</code>: 3PL model
</p>
</li>
<li>
<p><code>4</code>: PC model
</p>
</li>
<li>
<p><code>5</code>: GPC model
</p>
</li>
<li>
<p><code>6</code>: GR model
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p>an integer indicating the type of prior distribution, using </p>

<ul>
<li>
<p><code>1</code>: normal distribution
</p>
</li>
<li>
<p><code>2</code>: uniform distribution
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior_parm</code></td>
<td>
<p>a vector containing parameters for the prior distribution.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>calc_log_likelihood()</code> and <code>calc_log_likelihood_function()</code> are functions for calculating log likelihoods.
</p>
<p>These functions are designed for multiple items.
</p>
<p><code>calc_*()</code> functions accept a single theta value, and <code>calc_*_function()</code> functions accept multiple theta values.
</p>
<p>Currently supports unidimensional models.
</p>


<h3>References</h3>

<p>Rasch, G. (1960). <em>Probabilistic models for some intelligence and attainment tests.</em>
Copenhagen: Danish Institute for Educational Research.
</p>
<p>Lord, F. M. (1952). A theory of test scores (Psychometric Monograph No. 7). Richmond, VA: Psychometric Corporation.
</p>
<p>Birnbaum, A. (1957). <em>Efficient design and use of tests of mental ability for various decision-making problems</em>
(Series Report No. 58-16. Project No. 7755-23).
Randolph Air Force Base, TX: USAF School of Aviation Medicine.
</p>
<p>Birnbaum, A. (1958). <em>On the estimation of mental ability</em>
(Series Report No. 15. Project No. 7755-23).
Randolph Air Force Base, TX: USAF School of Aviation Medicine.
</p>
<p>Birnbaum, A. (1958). <em>Further considerations of efficiency in tests of a mental ability</em>
(Series Report No. 17. Project No. 7755-23).
Randolph Air Force Base, TX: USAF School of Aviation Medicine.
</p>
<p>Birnbaum, A. (1968). Some latent trait models and their use in inferring an examinee's ability.
In Lord, F. M., Novick, M. R. (eds.), <em>Statistical Theories of Mental Test Scores</em>, 397-479.
Reading, MA: Addison-Wesley.
</p>
<p>Masters, G. N. (1982). A Rasch model for partial credit scoring.
<em>Psychometrika, 47</em>(2), 149-174.
</p>
<p>Andrich, D. (1978). A rating formulation for ordered response categories.
<em>Psychometrika, 43</em>(4), 561-573.
</p>
<p>Muraki, E. (1992). A generalized partial credit model: Application of an EM algorithm.
<em>Applied Psychological Measurement, 16</em>(2), 159-176.
</p>
<p>Samejima, F. (1969). Estimation of latent ability using a response pattern of graded scores.
<em>Psychometrika Monograph, 17</em>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># item parameters
item_parm &lt;- matrix(c(
  1, NA,   NA,
  1,  2,   NA,
  1,  2, 0.25,
  0,  1,   NA,
  2,  0,    1,
  2,  0,    2),
  nrow = 6,
  byrow = TRUE
)

ncat  &lt;- c(2, 2, 2, 3, 3, 3)
model &lt;- c(1, 2, 3, 4, 5, 6)
resp  &lt;- c(0, 1, 0, 1, 0, 1)

x &lt;- 3
l  &lt;- calc_likelihood(x, item_parm, resp, ncat, model)
ll &lt;- calc_log_likelihood(x, item_parm, resp, ncat, model, 2, NA)
log(l) == ll

x &lt;- matrix(seq(-3, 3, .1))
l  &lt;- calc_likelihood_function(x, item_parm, resp, ncat, model)
ll &lt;- calc_log_likelihood_function(x, item_parm, resp, ncat, model, 2, NA)
all(log(l) == ll)

</code></pre>


</div>