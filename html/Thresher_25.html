<div class="container">

<table style="width: 100%;"><tr>
<td>SimThresher-class</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Class <code>"SimThresher"</code>
</h2>

<h3>Description</h3>

<p>The <code>SimThresher</code> class is used to simulate <code>Thresher</code> objects.
</p>


<h3>Usage</h3>

<pre><code class="language-R">SimThresher(ss, nSample, nm = deparse(substitute(ss)), rho = NULL,
            agfun = agDimTwiceMean, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ss</code></td>
<td>
<p>A covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nSample</code></td>
<td>
<p>An integer; the number of samples to simulate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nm</code></td>
<td>
<p>A character string; the name of this object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>A numeric vector; the correlation between different
variables. If NULL, then these are obtained from the covariance
matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>agfun</code></td>
<td>
<p>A function used by the <code>AuerGervini</code>
function to determine the number of principal components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Parameters to be passed to the <code>Thresher</code>
constructor.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Basically, given a number of samples and a covariance matrix,
simulate a data matrix of the appropriate size and multivariate normal
structure by assuming that all of the means are zero. After simulating
the data, we apply the Thresher algorithm. The result is an
object that combines the simulation parameters, simulated data, and
fitted model.
</p>


<h3>Value</h3>

<p>The <code>SimThresher</code> function returns an object of the
<code>SimThresher</code> class.
</p>


<h3>Objects from the Class</h3>

<p>Objects should be created using the <code>SimThresher</code> constructor.
</p>


<h3>Slots</h3>


<dl>
<dt>
<code>nSample</code>:</dt>
<dd>
<p>An integer; the number of simulated samples.</p>
</dd>
<dt>
<code>covariance</code>:</dt>
<dd>
<p>A covariance matrix.</p>
</dd>
<dt>
<code>rho</code>:</dt>
<dd>
<p>A vector of correlation coefficients; essentially
the unique values in the upper triangular part of the covariance
matrix.</p>
</dd>
</dl>
<h3>Extends</h3>

<p>Class <code>Thresher</code>, directly.
</p>


<h3>Methods</h3>


<dl>
<dt>image</dt>
<dd>
<p><code>signature(x = "SimThresher")</code>: Produces an image
of the covariance matrix.</p>
</dd>
<dt>makeFigures</dt>
<dd>
<p><code>signature(object = "SimThresher")</code>: This is a
convenience function to produce a standard set of figures. In
addition tot he plots preodcued for<code>Thresher</code> object, this
function also produces an image of te covariance matrix used in
the simulations.
If the <code>DIR</code> argument is
non-null, it is treated as the name of an existing directory where the
figures are stored as PNG files. Otherwise, the figures are
displayed interactively, one at a time, in a window on screen.</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Kevin R. Coombes &lt;krc@silicovore.com&gt;, Min Wang.
</p>


<h3>References</h3>

<p>Wang M, Abrams ZB, Kornblau SM, Coombes KR.
Thresher: determining the number of clusters while removing outliers.
BMC Bioinformatics, 2018; 19(1):1-9. doi://10.1186/s12859-017-1998-9.
</p>


<h3>See Also</h3>

<p><code>Thresher</code>, <code>Reaper</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(250264)
rho &lt;- 0.5
nProtein &lt;- 16
splinter &lt;- sample((nProtein/2) + (-3:3), 1)
sigma1 &lt;- matrix(rho, ncol=nProtein, nrow=nProtein)
diag(sigma1) &lt;- 1
st &lt;- SimThresher(sigma1, nSample=300)
image(st, col=redgreen(64), zlim=c(-1,1))
screeplot(st, col='pink', lcol='red')
plot(st)
scatter(st)
heat(st)
</code></pre>


</div>