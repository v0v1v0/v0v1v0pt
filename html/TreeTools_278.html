<div class="container">

<table style="width: 100%;"><tr>
<td>RoguePlot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Visualize position of rogue taxa</h2>

<h3>Description</h3>

<p>Plots a consensus of trees with a rogue taxon omitted, with edges coloured
according to the proportion of trees in which the taxon attaches to that
edge, after Klopfstein and Spasojevic (2019).
</p>


<h3>Usage</h3>

<pre><code class="language-R">RoguePlot(
  trees,
  tip,
  p = 1,
  plot = TRUE,
  Palette = colorRampPalette(c(par("fg"), "#009E73"), space = "Lab"),
  nullCol = rgb(colorRamp(unlist(par(c("fg", "bg"))), space = "Lab")(0.8)/255),
  edgeLength = NULL,
  thin = par("lwd"),
  fat = thin + 1L,
  outgroupTips,
  sort = FALSE,
  legend = "none",
  legend.inset = 0,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>trees</code></td>
<td>
<p>List or <code>multiPhylo</code> object containing phylogenetic trees
of class <code>phylo</code> to be summarized.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tip</code></td>
<td>
<p>Numeric or character identifying rogue leaf, in format accepted
by <code>DropTip()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>A numeric value between 0.5 and 1 giving the proportion for a clade
to be represented in the consensus tree (see <code>Consensus()</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>Logical specifying whether to plot the tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Palette</code></td>
<td>
<p>Function that takes a parameter <code>n</code> and generates a colour
palette with <code>n</code> entries.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nullCol</code></td>
<td>
<p>Colour to paint regions of the tree on which the rogue is
never found.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edgeLength</code></td>
<td>
<p>Numeric specifying edge lengths of consensus tree;
<code>NULL</code> aligns tips by scaling edges proportional to clade size; <code>1</code> sets
all edges to unit length.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin, fat</code></td>
<td>
<p>Numeric specifying width to plot edges if the rogue tip
never / sometimes does attach to them.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outgroupTips</code></td>
<td>
<p>Vector of type character, integer or logical, specifying
the names or indices of the tips to include in the outgroup.
If <code>outgroupTips</code> is a of type character, and a tree contains multiple tips
with a matching label, the first will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sort</code></td>
<td>
<p>Logical specifying whether to sort consensus tree using
<code>SortTree()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>
<p>Character vector specifying position of legend (e.g.
<code>"bottomleft"</code>), or <code>"none"</code> to suppress legend.
For fine-grained control of legend, use <code>PlotTools::SpectrumLegend()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.inset</code></td>
<td>
<p>Numeric specifying fraction of plot width / height
by which the legend's position should be inset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters to <code>plot.phylo()</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Rogue taxa can be identified using the package <span class="pkg">Rogue</span>
(Smith 2022).
</p>


<h3>Value</h3>

<p><code>RoguePlot()</code> invisibly returns a list whose elements are:
</p>

<ul>
<li> <p><code>cons</code>: The reduced consensus tree, in preorder;
</p>
</li>
<li> <p><code>onEdge</code>: a vector of integers specifying the number of
trees in <code>trees</code> in which the rogue leaf is attached to each edge in turn
of the consensus tree;
</p>
</li>
<li> <p><code>atNode</code>: a vector of integers specifying the number of trees in <code>trees</code>
in which the rogue leaf is attached to an edge collapsed into each node
of the consensus tree.
</p>
</li>
<li> <p><code>legendLabels</code>: A character vector suggesting labels for a plot legend;
suitable for <code>PlotTools::SpectrumLegend(legend = x$legendLabels)</code>.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p><a href="https://orcid.org/0000-0001-5660-1727">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>


<h3>References</h3>

<p>Klopfstein S, Spasojevic T (2019).
“Illustrating phylogenetic placement of fossils using RoguePlots: An example from ichneumonid parasitoid wasps (Hymenoptera, Ichneumonidae) and an extensive morphological matrix.”
<em>PLOS ONE</em>, <b>14</b>(4), e0212942.
<a href="https://doi.org/10.1371/journal.pone.0212942">doi:10.1371/journal.pone.0212942</a>.<br><br> Smith MR (2022).
“Using information theory to detect rogue taxa and improve consensus trees.”
<em>Systematic Biology</em>, <b>71</b>(5), 986–1008.
<a href="https://doi.org/10.1093/sysbio/syab099">doi:10.1093/sysbio/syab099</a>.
</p>


<h3>See Also</h3>

<p>Other consensus tree functions: 
<code>Consensus()</code>,
<code>ConsensusWithout()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">trees &lt;- list(read.tree(text = "(a, (b, (c, (rogue, (d, (e, f))))));"),
              read.tree(text = "(a, (b, (c, (rogue, (d, (e, f))))));"),
              read.tree(text = "(a, (b, (c, (rogue, (d, (e, f))))));"),
              read.tree(text = "(a, (b, (c, (rogue, (d, (e, f))))));"),
              read.tree(text = "(rogue, (a, (b, (c, (d, (e, f))))));"),
              read.tree(text = "((rogue, a), (b, (c, (d, (e, f)))));"),
              read.tree(text = "(a, (b, ((c, d), (rogue, (e, f)))));"),
              read.tree(text = "(a, (b, ((c, (rogue, d)), (e, f))));"),
              read.tree(text = "(a, (b, (c, (d, (rogue, (e, f))))));"))
plotted &lt;- RoguePlot(trees, "rogue", legend = "topleft", legend.inset = 0.02)
PlotTools::SpectrumLegend(
  "bottomleft",
  palette = colorRampPalette(c(par("fg"), "#009E73"), space = "Lab")(100),
  legend = plotted$legendLabels,
  cex = 0.4
)
</code></pre>


</div>