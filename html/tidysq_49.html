<div class="container">

<table style="width: 100%;"><tr>
<td>remove_na</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Remove sequences that contain NA values</h2>

<h3>Description</h3>

<p>This function replaces sequences with <code>NA</code> values by
empty (<code>NULL</code>) sequences or removes <code>NA</code> values from sequences
in an <code>sq</code> object.
</p>


<h3>Usage</h3>

<pre><code class="language-R">remove_na(x, by_letter = FALSE, ...)

## S3 method for class 'sq'
remove_na(x, by_letter = FALSE, ..., NA_letter = getOption("tidysq_NA_letter"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>[<code>sq</code>]<br>
An object this function is applied to.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by_letter</code></td>
<td>
<p>[<code>logical(1)</code>]<br>
If <code>FALSE</code>, filter condition is applied to sequence as a whole. If
<code>TRUE</code>, each letter is applied filter to separately.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed from or to other methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NA_letter</code></td>
<td>
<p>[<code>character(1)</code>]<br>
A string that is used to interpret and display <code>NA</code> value in the
context of <code>sq class</code>. Default value equals to
"<code>!</code>".</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>NA</code> may be introduced as a result of using functions like
<code>substitute_letters</code> or <code>bite</code>. They can also appear
in sequences if the user reads FASTA file using <code>read_fasta</code> or
constructs <code>sq</code> object from <code>character</code> vector with
<code>sq</code> function without <code>safe_mode</code> turned on - and there are
letters in file or strings other than specified in the alphabet.
</p>
<p><code>remove_na()</code> is used to filter out sequences or elements that have
<code>NA</code> value(s). By default, if any letter in a sequence is <code>NA</code>,
then whole sequence is replaced by empty (<code>NULL</code>) sequence. However, if
<code>by_letter</code> parameter is set to <code>TRUE</code>, then sequences are
only shortened by excluding <code>NA</code> values.
</p>


<h3>Value</h3>

<p>An <code>sq</code> object with the same type as the
input type. Sequences that do not contain any <code>NA</code> values are left
unchanged.
</p>


<h3>See Also</h3>

<p><code>sq</code>
</p>
<p>Functions that clean sequences:
<code>is_empty_sq()</code>,
<code>remove_ambiguous()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Creating objects to work on:
sq_ami &lt;- sq(c("MIAANYTWIL","TIAALGNIIYRAIE", "NYERTGHLI", "MAYXXXIALN"),
             alphabet = "ami_ext")
sq_dna &lt;- sq(c("ATGCAGGA", "GACCGAACGAN", "TGACGAGCTTA", "ACTNNAGCN"),
             alphabet = "dna_ext")

# Substituting some letters with NA
sq_ami_sub &lt;- substitute_letters(sq_ami, c(E = NA_character_, R = NA_character_))
sq_dna_sub &lt;- substitute_letters(sq_dna, c(N = NA_character_))

# Biting sequences out of range
sq_bitten &lt;- bite(sq_ami, 1:15)

# Printing the sequences
sq_ami_sub
sq_dna_sub

# Removing sequences containing NA
remove_na(sq_ami_sub)
remove_na(sq_dna_sub)
remove_na(sq_bitten)

# Removing only NA elements
remove_na(sq_ami_sub, by_letter = TRUE)
remove_na(sq_dna_sub, TRUE)
remove_na(sq_bitten, TRUE)

</code></pre>


</div>