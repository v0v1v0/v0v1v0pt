<div class="container">

<table style="width: 100%;"><tr>
<td>update_weights_strat_wilson</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Helper function for the estimation of weights for <code>prop_strat_wilson()</code>
</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt="[Stable]"></a>
</p>
<p>This function wraps the iteration procedure that allows you to estimate
the weights for each proportional strata. This assumes to minimize the
weighted squared length of the confidence interval.
</p>


<h3>Usage</h3>

<pre><code class="language-R">update_weights_strat_wilson(
  vars,
  strata_qnorm,
  initial_weights,
  n_per_strata,
  max_iterations = 50,
  conf_level = 0.95,
  tol = 0.001
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>vars</code></td>
<td>
<p>(<code>numeric</code>)<br> normalized proportions for each strata.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strata_qnorm</code></td>
<td>
<p>(<code>numeric(1)</code>)<br> initial estimation with identical weights of the quantiles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial_weights</code></td>
<td>
<p>(<code>numeric</code>)<br> initial weights used to calculate <code>strata_qnorm</code>. This can
be optimized in the future if we need to estimate better initial weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_per_strata</code></td>
<td>
<p>(<code>numeric</code>)<br> number of elements in each strata.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_iterations</code></td>
<td>
<p>(<code>integer(1)</code>)<br> maximum number of iterations to be tried. Convergence is always checked.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf_level</code></td>
<td>
<p>(<code>proportion</code>)<br> confidence level of the interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>(<code>numeric(1)</code>)<br> tolerance threshold for convergence.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>list</code> of 3 elements: <code>n_it</code>, <code>weights</code>, and <code>diff_v</code>.
</p>


<h3>See Also</h3>

<p>For references and details see <code>prop_strat_wilson()</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">vs &lt;- c(0.011, 0.013, 0.012, 0.014, 0.017, 0.018)
sq &lt;- 0.674
ws &lt;- rep(1 / length(vs), length(vs))
ns &lt;- c(22, 18, 17, 17, 14, 12)

update_weights_strat_wilson(vs, sq, ws, ns, 100, 0.95, 0.001)

</code></pre>


</div>