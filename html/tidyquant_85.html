<div class="container">

<table style="width: 100%;"><tr>
<td>excel_date_functions</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Excel Date and Time Functions</h2>

<h3>Description</h3>

<p>50+ date and time functions familiar to users coming from an <strong>Excel Background.</strong>
The main benefits are:
</p>

<ol>
<li>
<p> Integration of the amazing <code>lubridate</code> package for handling dates and times
</p>
</li>
<li>
<p> Integration of Holidays from <code>timeDate</code> and Business Calendars
</p>
</li>
<li>
<p> New Date Math and Date Sequence Functions that factor in Business Calendars (e.g. <code>EOMONTH()</code>, <code>NET_WORKDAYS()</code>)
</p>
</li>
</ol>
<p>These functions are designed to help users coming from an <strong>Excel background</strong>.
Most functions replicate the behavior of Excel:
</p>

<ul>
<li>
<p> Names in most cases match Excel function names
</p>
</li>
<li>
<p> Functionality replicates Excel
</p>
</li>
<li>
<p> By default, missing values are ignored (same as in Excel)
</p>
</li>
</ul>
<h3>Usage</h3>

<pre><code class="language-R">AS_DATE(x, ...)

AS_DATETIME(x, ...)

DATE(year, month, day)

DATEVALUE(x, ...)

YMD(x, ...)

MDY(x, ...)

DMY(x, ...)

YMD_HMS(x, ...)

MDY_HMS(x, ...)

DMY_HMS(x, ...)

YMD_HM(x, ...)

MDY_HM(x, ...)

DMY_HM(x, ...)

YMD_H(x, ...)

MDY_H(x, ...)

DMY_H(x, ...)

WEEKDAY(x, ..., label = FALSE, abbr = TRUE)

WDAY(x, ..., label = FALSE, abbr = TRUE)

DOW(x, ..., label = FALSE, abbr = TRUE)

MONTHDAY(x, ...)

MDAY(x, ...)

DOM(x, ...)

QUARTERDAY(x, ...)

QDAY(x, ...)

DAY(x, ...)

WEEKNUM(x, ...)

WEEK(x, ...)

WEEKNUM_ISO(x, ...)

MONTH(x, ..., label = FALSE, abbr = TRUE)

QUARTER(x, ..., include_year = FALSE, fiscal_start = 1)

YEAR(x, ...)

YEAR_ISO(x, ...)

DATE_TO_NUMERIC(x, ...)

DATE_TO_DECIMAL(x, ...)

SECOND(x, ...)

MINUTE(x, ...)

HOUR(x, ...)

NOW(...)

TODAY(...)

EOMONTH(start_date, months = 0)

EDATE(start_date, months = 0)

NET_WORKDAYS(start_date, end_date, remove_weekends = TRUE, holidays = NULL)

COUNT_DAYS(start_date, end_date)

YEARFRAC(start_date, end_date)

DATE_SEQUENCE(start_date, end_date, by = "day")

WORKDAY_SEQUENCE(start_date, end_date, remove_weekends = TRUE, holidays = NULL)

HOLIDAY_SEQUENCE(
  start_date,
  end_date,
  calendar = c("NYSE", "LONDON", "NERC", "TSX", "ZURICH")
)

HOLIDAY_TABLE(years, pattern = ".")

FLOOR_DATE(x, ..., by = "day")

FLOOR_DAY(x, ...)

FLOOR_WEEK(x, ...)

FLOOR_MONTH(x, ...)

FLOOR_QUARTER(x, ...)

FLOOR_YEAR(x, ...)

CEILING_DATE(x, ..., by = "day")

CEILING_DAY(x, ...)

CEILING_WEEK(x, ...)

CEILING_MONTH(x, ...)

CEILING_QUARTER(x, ...)

CEILING_YEAR(x, ...)

ROUND_DATE(x, ..., by = "day")

ROUND_DAY(x, ...)

ROUND_WEEK(x, ...)

ROUND_MONTH(x, ...)

ROUND_QUARTER(x, ...)

ROUND_YEAR(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A vector of date or date-time objects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Parameters passed to underlying <code>lubridate</code> functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>year</code></td>
<td>
<p>Used in <code>DATE()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>month</code></td>
<td>
<p>Used in <code>DATE()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>day</code></td>
<td>
<p>Used in <code>DATE()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label</code></td>
<td>
<p>A logical used for <code>MONTH()</code> and <code>WEEKDAY()</code> Date Extractors to decide whether or not to return names
(as ordered factors) or numeric values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abbr</code></td>
<td>
<p>A logical used for <code>MONTH()</code> and <code>WEEKDAY()</code>. If <code>label = TRUE</code>, used to determine if
full names (e.g. Wednesday) or abbreviated names (e.g. Wed) should be returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include_year</code></td>
<td>
<p>A logical value used in <code>QUARTER()</code>. Determines whether or not to return 2020 Q3 as <code>3</code> or <code>2020.3</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fiscal_start</code></td>
<td>
<p>A numeric value used in <code>QUARTER()</code>. Determines the fiscal-year starting quarter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start_date</code></td>
<td>
<p>Used in Date Math and Date Sequence operations. The starting date in the calculation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>months</code></td>
<td>
<p>Used to offset months in <code>EOMONTH()</code> AND <code>EDATE()</code> Date Math calculations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>end_date</code></td>
<td>
<p>Used in Date Math and Date Sequence operations. The ending date in the calculation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remove_weekends</code></td>
<td>
<p>A logical value used in Date Sequence and Date Math calculations.
Indicates whether or not weekends should be removed from the calculation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>holidays</code></td>
<td>
<p>A vector of dates corresponding to holidays that should be removed from the calculation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by</code></td>
<td>
<p>Used to determine the gap in Date Sequence calculations and value to round to in Date Collapsing operations.
Acceptable values are: A character string, containing one of <code>"day"</code>, <code>"week"</code>, <code>"month"</code>, <code>"quarter"</code> or <code>"year"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>calendar</code></td>
<td>
<p>The calendar to be used in Date Sequence calculations for Holidays from the <code>timeDate</code> package.
Acceptable values are: <code>"NYSE"</code>, <code>"LONDON"</code>, <code>"NERC"</code>, <code>"TSX"</code>, <code>"ZURICH"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>years</code></td>
<td>
<p>A numeric vector of years to return Holidays for in <code>HOLIDAY_TABLE()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pattern</code></td>
<td>
<p>Used to filter Holidays (e.g. <code>pattern = "Easter"</code>). A "regular expression" filtering pattern.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><strong>Converters</strong> - Make date and date-time from text (character data)
</p>

<ul>
<li>
<p> General String-to-Date Conversion: <code>AS_DATE()</code>, <code>AS_DATETIME()</code>
</p>
</li>
<li>
<p> Format-Specific String-to-Date Conversion: <code>YMD()</code> (YYYY-MM-DD), <code>MDY()</code> (MM-DD-YYYY), <code>DMY()</code> (DD-MM-YYYY)
</p>
</li>
<li>
<p> Hour-Minute-Second Conversion: <code>YMD_HMS()</code>, <code>YMD_HM()</code>, and friends.
</p>
</li>
</ul>
<p><strong>Extractors</strong> - Returns information from a time-stamp.
</p>

<ul><li>
<p> Extractors: <code>SECOND()</code>, <code>MINUTE()</code>, <code>HOUR()</code>, <code>DAY()</code>, <code>WEEK()</code>, <code>MONTH()</code>, <code>QUARTER()</code>, <code>YEAR()</code>
</p>
</li></ul>
<p><strong>Current Time</strong> - Returns the current date/date-time based on your locale.
</p>

<ul><li> <p><code>NOW()</code>, <code>TODAY()</code>
</p>
</li></ul>
<p><strong>Date Math</strong> - Perform popular Excel date calculations
</p>

<ul>
<li> <p><code>EOMONTH()</code> - End of Month
</p>
</li>
<li> <p><code>NET_WORKDAYS()</code>, <code>COUNT_DAYS()</code> - Return number of days between 2 dates factoring in working days and holidays
</p>
</li>
<li> <p><code>YEARFRAC()</code> - Return the fractional period of the year that has been completed between 2 dates.
</p>
</li>
</ul>
<p><strong>Date Sequences</strong> - Return a vector of dates or a Holiday Table (<code>tibble</code>).
</p>

<ul><li> <p><code>DATE_SEQUENCE()</code>, <code>WORKDAY_SEQUENCE()</code>, HOLIDAY_SEQUENCE - Return a sequence of dates between 2 dates that
factor in workdays and <code>timeDate</code> holiday calendars for popular business calendars including NYSE and London stock exchange.
</p>
</li></ul>
<p><strong>Date Collapsers</strong> - Collapse a date sequence (useful in <code>dplyr::group_by()</code> and <code>pivot_table()</code>)
</p>

<ul>
<li> <p><code>FLOOR_DATE()</code>, <code>FLOOR_DAY()</code>, <code>FLOOR_WEEK()</code>, <code>FLOOR_MONTH()</code>, <code>FLOOR_QUARTER()</code>, <code>FLOOR_YEAR()</code>
</p>
</li>
<li>
<p> Similar functions exist for CEILING and ROUND. These are wrappers for <code>lubridate</code> functions.
</p>
</li>
</ul>
<h3>Value</h3>


<ul>
<li> <p><strong>Converters</strong> - Date or date-time object the length of x
</p>
</li>
<li> <p><strong>Extractors</strong> - Returns information from a time-stamp.
</p>
</li>
<li> <p><strong>Current Time</strong> - Returns the current date/date-time based on your locale.
</p>
</li>
<li> <p><strong>Date Math</strong> - Numeric values or Date Values depending on the calculation.
</p>
</li>
<li> <p><strong>Date Sequences</strong> - Return a vector of dates or a Holiday Table (<code>tibble</code>).
</p>
</li>
<li> <p><strong>Date Collapsers</strong> - Date or date-time object the length of x
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R"># Libraries
library(lubridate)

# --- Basic Usage ----

# Converters ---
AS_DATE("2011 Jan-01") # General
YMD("2011 Jan-01")     # Year, Month-Day Format
MDY("01-02-20")        # Month-Day, Year Format (January 2nd, 2020)
DMY("01-02-20")        # Day-Month, Year Format (February 1st, 2020)

# Extractors ---
WEEKDAY("2020-01-01")                                  # Labelled Day
WEEKDAY("2020-01-01", label = FALSE)                   # Numeric Day
WEEKDAY("2020-01-01", label = FALSE, week_start = 1)   # Start at 1 (Monday) vs 7 (Sunday)
MONTH("2020-01-01")
QUARTER("2020-01-01")
YEAR("2020-01-01")

# Current Date-Time ---
NOW()
TODAY()

# Date Math ---
EOMONTH("2020-01-01")
EOMONTH("2020-01-01", months = 1)
NET_WORKDAYS("2020-01-01", "2020-07-01") # 131 Skipping Weekends
NET_WORKDAYS("2020-01-01", "2020-07-01",
             holidays = HOLIDAY_SEQUENCE("2020-01-01", "2020-07-01",
                                         calendar = "NYSE")) # 126 Skipping 5 NYSE Holidays

# Date Sequences ---
DATE_SEQUENCE("2020-01-01", "2020-07-01")
WORKDAY_SEQUENCE("2020-01-01", "2020-07-01")
HOLIDAY_SEQUENCE("2020-01-01", "2020-07-01", calendar = "NYSE")
WORKDAY_SEQUENCE("2020-01-01", "2020-07-01",
                 holidays = HOLIDAY_SEQUENCE("2020-01-01", "2020-07-01",
                                             calendar = "NYSE"))

# Date Collapsers ---
FLOOR_DATE(AS_DATE("2020-01-15"), by = "month")
CEILING_DATE(AS_DATE("2020-01-15"), by = "month")
CEILING_DATE(AS_DATE("2020-01-15"), by = "month") - ddays(1) # EOMONTH using lubridate

# --- Usage with tidyverse ---

# Calculate returns by symbol/year/quarter
FANG %&gt;%
    pivot_table(
        .rows       = c(symbol, ~ QUARTER(date)),
        .columns    = ~ YEAR(date),
        .values     = ~ PCT_CHANGE_FIRSTLAST(adjusted)
    )

</code></pre>


</div>