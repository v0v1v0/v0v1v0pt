<div class="container">

<table style="width: 100%;"><tr>
<td>nn_multi_margin_loss</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multi margin loss</h2>

<h3>Description</h3>

<p>Creates a criterion that optimizes a multi-class classification hinge
loss (margin-based loss) between input <code class="reqn">x</code> (a 2D mini-batch <code>Tensor</code>) and
output <code class="reqn">y</code> (which is a 1D tensor of target class indices,
<code class="reqn">0 \leq y \leq \mbox{x.size}(1)-1</code>):
</p>


<h3>Usage</h3>

<pre><code class="language-R">nn_multi_margin_loss(p = 1, margin = 1, weight = NULL, reduction = "mean")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>(int, optional): Has a default value of <code class="reqn">1</code>. <code class="reqn">1</code> and <code class="reqn">2</code>
are the only supported values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>margin</code></td>
<td>
<p>(float, optional): Has a default value of <code class="reqn">1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>
<p>(Tensor, optional): a manual rescaling weight given to each
class. If given, it has to be a Tensor of size <code>C</code>. Otherwise, it is
treated as if having all ones.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reduction</code></td>
<td>
<p>(string, optional): Specifies the reduction to apply to the output:
<code>'none'</code> | <code>'mean'</code> | <code>'sum'</code>. <code>'none'</code>: no reduction will be applied,
<code>'mean'</code>: the sum of the output will be divided by the number of
elements in the output, <code>'sum'</code>: the output will be summed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For each mini-batch sample, the loss in terms of the 1D input <code class="reqn">x</code> and scalar
output <code class="reqn">y</code> is:
</p>
<p style="text-align: center;"><code class="reqn">
  \mbox{loss}(x, y) = \frac{\sum_i \max(0, \mbox{margin} - x[y] + x[i]))^p}{\mbox{x.size}(0)}
</code>
</p>

<p>where <code class="reqn">x \in \left\{0, \; \cdots , \; \mbox{x.size}(0) - 1\right\}</code>
and <code class="reqn">i \neq y</code>.
</p>
<p>Optionally, you can give non-equal weighting on the classes by passing
a 1D <code>weight</code> tensor into the constructor.
The loss function then becomes:
</p>
<p style="text-align: center;"><code class="reqn">
  \mbox{loss}(x, y) = \frac{\sum_i \max(0, w[y] * (\mbox{margin} - x[y] + x[i]))^p)}{\mbox{x.size}(0)}
</code>
</p>



</div>