<div class="container">

<table style="width: 100%;"><tr>
<td>tm_t_exposure</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>teal Module: Exposure Table for Risk management plan</h2>

<h3>Description</h3>

<p>The module produces an exposure table for risk management plan.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tm_t_exposure(
  label,
  dataname,
  parentname = ifelse(inherits(col_by_var, "data_extract_spec"),
    teal.transform::datanames_input(col_by_var), "ADSL"),
  row_by_var,
  col_by_var,
  paramcd = teal.transform::choices_selected(choices =
    teal.transform::value_choices(dataname, "PARAMCD", "PARAM"), selected = "TDURD"),
  paramcd_label = "PARAM",
  id_var = teal.transform::choices_selected(teal.transform::variable_choices(dataname,
    subset = "USUBJID"), selected = "USUBJID", fixed = TRUE),
  parcat,
  aval_var = teal.transform::choices_selected(teal.transform::variable_choices(dataname,
    subset = "AVAL"), selected = "AVAL", fixed = TRUE),
  avalu_var = teal.transform::choices_selected(teal.transform::variable_choices(dataname,
    subset = "AVALU"), selected = "AVALU", fixed = TRUE),
  add_total,
  total_label = default_total_label(),
  add_total_row = TRUE,
  total_row_label = "Total number of patients and patient time*",
  na_level = default_na_str(),
  pre_output = NULL,
  post_output = NULL,
  basic_table_args = teal.widgets::basic_table_args()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>label</code></td>
<td>
<p>(<code>character</code>)<br> menu item label of the module in the teal app.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataname</code></td>
<td>
<p>(<code>character</code>)<br> analysis data used in teal module.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parentname</code></td>
<td>
<p>(<code>character</code>)<br> parent analysis data used in teal module, usually this refers to <code>ADSL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>row_by_var</code></td>
<td>
<p>(<code>teal.transform::choices_selected()</code>)<br>
object with all available choices and preselected option for
variable names that can be used to split rows.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_by_var</code></td>
<td>
<p>(<code>teal.transform::choices_selected()</code>)<br>
object with all available choices and preselected option for
variable names that can be used to split columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>paramcd</code></td>
<td>
<p>(<code>teal.transform::choices_selected()</code>)<br> object with all
available choices and preselected option for the parameter code variable from <code>dataname</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>paramcd_label</code></td>
<td>
<p>(<code>character</code>)<br> the column from the dataset where the value will be used to
label the argument <code>paramcd</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id_var</code></td>
<td>
<p>(<code>teal.transform::choices_selected()</code>)<br> object specifying
the variable name for subject id.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parcat</code></td>
<td>
<p>(<code>teal.transform::choices_selected()</code>)<br>
object with all available choices and preselected option for
parameter category values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aval_var</code></td>
<td>
<p>(<code>teal.transform::choices_selected()</code>)<br> object with
all available choices and pre-selected option for the analysis variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>avalu_var</code></td>
<td>
<p>(<code>teal.transform::choices_selected()</code>)<br> object with
all available choices and preselected option for the analysis unit variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add_total</code></td>
<td>
<p>(<code>logical</code>)<br> whether to include column with total number of patients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>total_label</code></td>
<td>
<p>(<code>string</code>)<br> string to display as total column/row label if column/row is
enabled (see <code>add_total</code>). Defaults to <code>"All Patients"</code>. To set a new default <code>total_label</code> to
apply in all modules, run <code>set_default_total_label("new_default")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add_total_row</code></td>
<td>
<p>(<code>flag</code>)<br> whether a "total" level should be added after the others which includes all the
levels that constitute the split. A custom label can be set for this level via the <code>total_row_label</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>total_row_label</code></td>
<td>
<p>(<code>character</code>)<br> string to display as total row label if row is
enabled (see <code>add_total_row</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na_level</code></td>
<td>
<p>(<code>string</code>)<br> used to replace all <code>NA</code> or empty values
in character or factor variables in the data. Defaults to <code>"&lt;Missing&gt;"</code>. To set a
default <code>na_level</code> to apply in all modules, run <code>set_default_na_str("new_default")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pre_output</code></td>
<td>
<p>(<code>shiny.tag</code>) optional,<br> with text placed before the output to put the output into context.
For example a title.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>post_output</code></td>
<td>
<p>(<code>shiny.tag</code>) optional,<br> with text placed after the output to put the output into context.
For example the <code>shiny::helpText()</code> elements are useful.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basic_table_args</code></td>
<td>
<p>(<code>basic_table_args</code>) optional<br> object created by <code>teal.widgets::basic_table_args()</code>
with settings for the module table. The argument is merged with option <code>teal.basic_table_args</code> and with default
module arguments (hard coded in the module body).
For more details, see the vignette: <code>vignette("custom-basic-table-arguments", package = "teal.widgets")</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a <code>teal_module</code> object.
</p>


<h3>See Also</h3>

<p>The <a href="https://insightsengineering.github.io/tlg-catalog/stable/">TLG Catalog</a> where additional example
apps implementing this module can be found.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(dplyr)

data &lt;- teal_data()
data &lt;- within(data, {
  ADSL &lt;- tmc_ex_adsl
  ADEX &lt;- tmc_ex_adex

  set.seed(1, kind = "Mersenne-Twister")
  labels &lt;- col_labels(ADEX, fill = FALSE)
  ADEX &lt;- ADEX %&gt;%
    distinct(USUBJID, .keep_all = TRUE) %&gt;%
    mutate(
      PARAMCD = "TDURD",
      PARAM = "Overall duration (days)",
      AVAL = sample(x = seq(1, 200), size = n(), replace = TRUE),
      AVALU = "Days"
    ) %&gt;%
    bind_rows(ADEX)
  col_labels(ADEX) &lt;- labels
})

datanames &lt;- c("ADSL", "ADEX")
datanames(data) &lt;- datanames
join_keys(data) &lt;- default_cdisc_join_keys[datanames]

app &lt;- init(
  data = data,
  modules = modules(
    tm_t_exposure(
      label = "Duration of Exposure Table",
      dataname = "ADEX",
      paramcd = choices_selected(
        choices = value_choices(data[["ADEX"]], "PARAMCD", "PARAM"),
        selected = "TDURD"
      ),
      col_by_var = choices_selected(
        choices = variable_choices(data[["ADEX"]], subset = c("SEX", "ARM")),
        selected = "SEX"
      ),
      row_by_var = choices_selected(
        choices = variable_choices(data[["ADEX"]], subset = c("RACE", "REGION1", "STRATA1", "SEX")),
        selected = "RACE"
      ),
      parcat = choices_selected(
        choices = value_choices(data[["ADEX"]], "PARCAT2"),
        selected = "Drug A"
      ),
      add_total = FALSE
    )
  ),
  filter = teal_slices(teal_slice("ADSL", "SAFFL", selected = "Y"))
)
if (interactive()) {
  shinyApp(app$ui, app$server)
}

</code></pre>


</div>