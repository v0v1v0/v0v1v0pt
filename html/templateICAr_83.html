<div class="container">

<table style="width: 100%;"><tr>
<td>rm_nuisIC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Remove nuisance ICs from data</h2>

<h3>Description</h3>

<p>Subtract estimated nuisance ICs from data matrix. If the number of
nuisance ICs is not provided, will estimate using PESEL (the nuisance ICs
are a rotation of the nuisance PCs).
</p>


<h3>Usage</h3>

<pre><code class="language-R">rm_nuisIC(
  BOLD,
  DR = NULL,
  template_mean = NULL,
  Q2 = NULL,
  Q2_max = NULL,
  checkRowCenter = TRUE,
  verbose = FALSE,
  return_Q2 = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>BOLD</code></td>
<td>
<p>the row-centered <code class="reqn">V</code> by <code class="reqn">T</code> data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DR, template_mean</code></td>
<td>
<p>We need an initial estimate of the group ICs, so
that we can avoid removing them during removal of the estimated noise ICs.
Provide either <code>DR</code> if dual regression has already been calculated, or
<code>template_mean</code> (in this context, equivalent to a GICA result) if it
hasn't. Exactly one must be provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q2</code></td>
<td>
<p>The number of nuisance ICs. If <code>NULL</code> (default) will estimate
using PESEL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q2_max</code></td>
<td>
<p>If <code>Q2</code> is <code>NULL</code>, PESEL's estimate will be less than
or equal to <code>Q2_max</code>. If <code>Q2_max</code> is <code>NULL</code> (default), do not
limit PESEL's estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>checkRowCenter</code></td>
<td>
<p>Check row means, and raise an error if they are
nonzero? Default: <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>If <code>TRUE</code>, display progress updates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return_Q2</code></td>
<td>
<p>Return (estimated) <code>Q2</code> too? Default: <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The <code class="reqn">V</code> by <code class="reqn">T</code> data with the estimated nuisance ICs
subtracted from it. If <code>return_Q2</code>, a list of length two: the second
entry will be <code>Q2</code>.
</p>


</div>