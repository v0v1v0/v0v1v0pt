<div class="container">

<table style="width: 100%;"><tr>
<td>download_metadata</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Download the metadata on treebase using the OAI-MPH interface</h2>

<h3>Description</h3>

<p>Download the metadata on treebase using the OAI-MPH interface
</p>


<h3>Usage</h3>

<pre><code class="language-R">download_metadata(
  query = "",
  by = c("all", "until", "from"),
  curl = getCurlHandle()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>query</code></td>
<td>
<p>a date in format yyyy-mm-dd</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by</code></td>
<td>
<p>return all data "until" that date, 
"from" that date to current, or "all"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>curl</code></td>
<td>
<p>if calling in series many times, call getCurlHandle() first and 
then pass the return value in here. Avoids repeated handshakes with server.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>query must be#'  download_metadata(2010-01-01, by="until")
all isn't a real query type, but will return all trees regardless of date
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
Near &lt;- search_treebase("Near", "author", max_trees=1)
 metadata(Near[[1]]$S.id)
## or manualy give a sudy id
metadata("2377")

### get all trees from a certain depostition date forwards ##
m &lt;- download_metadata("2009-01-01", by="until")
## extract any metadata, e.g. publication date:
dates &lt;- sapply(m, function(x) as.numeric(x$date))
hist(dates, main="TreeBase growth", xlab="Year")

### show authors with most tree submissions in that date range 
authors &lt;- sapply(m, function(x){
   index &lt;- grep( "creator", names(x))
     x[index] 
})
a &lt;- as.factor(unlist(authors))
head(summary(a))

## Show growth of TreeBASE 
all &lt;- download_metadata("", by="all")
dates &lt;- sapply(all, function(x) as.numeric(x$date))
hist(dates, main="TreeBase growth", xlab="Year")

## make a barplot submission volume by journals
journals &lt;- sapply(all, function(x) x$publisher)
J &lt;- tail(sort(table(as.factor(unlist(journals)))),5)
b&lt;- barplot(as.numeric(J))
text(b, names(J), srt=70, pos=4, xpd=T)

## End(Not run)
</code></pre>


</div>