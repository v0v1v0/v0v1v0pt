<div class="container">

<table style="width: 100%;"><tr>
<td>plot_time_series</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Interactive Plotting for One or More Time Series</h2>

<h3>Description</h3>

<p>A workhorse time-series plotting function that generates interactive <code>plotly</code> plots,
consolidates 20+ lines of <code>ggplot2</code> code, and scales well to many time series.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_time_series(
  .data,
  .date_var,
  .value,
  .color_var = NULL,
  .facet_vars = NULL,
  .facet_ncol = 1,
  .facet_nrow = 1,
  .facet_scales = "free_y",
  .facet_dir = "h",
  .facet_collapse = FALSE,
  .facet_collapse_sep = " ",
  .facet_strip_remove = FALSE,
  .line_color = "#2c3e50",
  .line_size = 0.5,
  .line_type = 1,
  .line_alpha = 1,
  .y_intercept = NULL,
  .y_intercept_color = "#2c3e50",
  .x_intercept = NULL,
  .x_intercept_color = "#2c3e50",
  .smooth = TRUE,
  .smooth_period = "auto",
  .smooth_message = FALSE,
  .smooth_span = NULL,
  .smooth_degree = 2,
  .smooth_color = "#3366FF",
  .smooth_size = 1,
  .smooth_alpha = 1,
  .legend_show = TRUE,
  .title = "Time Series Plot",
  .x_lab = "",
  .y_lab = "",
  .color_lab = "Legend",
  .interactive = TRUE,
  .plotly_slider = FALSE,
  .trelliscope = FALSE,
  .trelliscope_params = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>.data</code></td>
<td>
<p>A <code>tibble</code> or <code>data.frame</code> with a time-based column</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.date_var</code></td>
<td>
<p>A column containing either date or date-time values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.value</code></td>
<td>
<p>A column containing numeric values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.color_var</code></td>
<td>
<p>A categorical column that can be used to change the
line color</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.facet_vars</code></td>
<td>
<p>One or more grouping columns that broken out into <code>ggplot2</code> facets.
These can be selected using <code>tidyselect()</code> helpers (e.g <code>contains()</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.facet_ncol</code></td>
<td>
<p>Number of facet columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.facet_nrow</code></td>
<td>
<p>Number of facet rows (only used for <code>.trelliscope = TRUE</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.facet_scales</code></td>
<td>
<p>Control facet x &amp; y-axis ranges.
Options include "fixed", "free", "free_y", "free_x"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.facet_dir</code></td>
<td>
<p>The direction of faceting ("h" for horizontal, "v" for vertical). Default is "h".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.facet_collapse</code></td>
<td>
<p>Multiple facets included on one facet strip instead of
multiple facet strips.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.facet_collapse_sep</code></td>
<td>
<p>The separator used for collapsing facets.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.facet_strip_remove</code></td>
<td>
<p>Whether or not to remove the strip and text label for each facet.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.line_color</code></td>
<td>
<p>Line color. Overrided if <code>.color_var</code> is specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.line_size</code></td>
<td>
<p>Line size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.line_type</code></td>
<td>
<p>Line type.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.line_alpha</code></td>
<td>
<p>Line alpha (opacity). Range: (0, 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.y_intercept</code></td>
<td>
<p>Value for a y-intercept on the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.y_intercept_color</code></td>
<td>
<p>Color for the y-intercept</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.x_intercept</code></td>
<td>
<p>Value for a x-intercept on the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.x_intercept_color</code></td>
<td>
<p>Color for the x-intercept</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.smooth</code></td>
<td>
<p>Logical - Whether or not to include a trendline smoother.
Uses See <code>smooth_vec()</code> to apply a LOESS smoother.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.smooth_period</code></td>
<td>
<p>Number of observations to include in the Loess Smoother.
Set to "auto" by default, which uses <code>tk_get_trend()</code>
to determine a logical trend cycle.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.smooth_message</code></td>
<td>
<p>Logical.
Whether or not to return the trend selected as a message.
Useful for those that want to see what <code>.smooth_period</code> was selected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.smooth_span</code></td>
<td>
<p>Percentage of observations to include in the Loess Smoother.
You can use either period or span. See <code>smooth_vec()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.smooth_degree</code></td>
<td>
<p>Flexibility of Loess Polynomial.
Either 0, 1, 2 (0 = lest flexible, 2 = more flexible).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.smooth_color</code></td>
<td>
<p>Smoother line color</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.smooth_size</code></td>
<td>
<p>Smoother line size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.smooth_alpha</code></td>
<td>
<p>Smoother alpha (opacity). Range: (0, 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.legend_show</code></td>
<td>
<p>Toggles on/off the Legend</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.title</code></td>
<td>
<p>Title for the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.x_lab</code></td>
<td>
<p>X-axis label for the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.y_lab</code></td>
<td>
<p>Y-axis label for the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.color_lab</code></td>
<td>
<p>Legend label if a <code>color_var</code> is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.interactive</code></td>
<td>
<p>Returns either a static (<code>ggplot2</code>) visualization or an interactive (<code>plotly</code>) visualization</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.plotly_slider</code></td>
<td>
<p>If <code>TRUE</code>, returns a plotly date range slider.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.trelliscope</code></td>
<td>
<p>Returns either a normal plot or a trelliscopejs plot (great for many time series)
Must have <code>trelliscopejs</code> installed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.trelliscope_params</code></td>
<td>
<p>Pass parameters to the <code>trelliscopejs::facet_trelliscope()</code> function as a <code>list()</code>.
The only parameters that cannot be passed are:
</p>

<ul>
<li> <p><code>ncol</code>: use <code>.facet_ncol</code>
</p>
</li>
<li> <p><code>nrow</code>: use <code>.facet_nrow</code>
</p>
</li>
<li> <p><code>scales</code>: use <code>facet_scales</code>
</p>
</li>
<li> <p><code>as_plotly</code>: use <code>.interactive</code>
</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>plot_time_series()</code> is a scalable function that works with both <em>ungrouped</em> and <em>grouped</em>
<code>data.frame</code> objects (and <code>tibbles</code>!).
</p>
<p><strong>Interactive by Default</strong>
</p>
<p><code>plot_time_series()</code> is built for exploration using:
</p>

<ul>
<li> <p><strong>Interactive Plots:</strong> <code>plotly</code> (default) - Great for exploring!
</p>
</li>
<li> <p><strong>Static Plots:</strong> <code>ggplot2</code> (set <code>.interactive = FALSE</code>) - Great for PDF Reports
</p>
</li>
</ul>
<p>By default, an interactive <code>plotly</code> visualization is returned.
</p>
<p><strong>Scalable with Facets &amp; Dplyr Groups</strong>
</p>
<p><code>plot_time_series()</code> returns multiple time series plots using <code>ggplot2</code> facets:
</p>

<ul>
<li> <p><code>group_by()</code> - If groups are detected, multiple facets are returned
</p>
</li>
<li> <p><code>plot_time_series(.facet_vars)</code> - You can manually supply facets as well.
</p>
</li>
</ul>
<p><strong>Can Transform Values just like ggplot</strong>
</p>
<p>The <code>.values</code> argument accepts transformations just like <code>ggplot2</code>.
For example, if you want to take the log of sales you can use
a call like <code>plot_time_series(date, log(sales))</code> and the log transformation
will be applied.
</p>
<p><strong>Smoother Period / Span Calculation</strong>
</p>
<p>The <code>.smooth = TRUE</code> option returns a smoother that is calculated based on either:
</p>

<ol>
<li>
<p> A <code>.smooth_period</code>: Number of observations
</p>
</li>
<li>
<p> A <code>.smooth_span</code>: A percentage of observations
</p>
</li>
</ol>
<p>By default, the <code>.smooth_period</code> is automatically calculated using 75% of the observertions.
This is the same as <code>geom_smooth(method = "loess", span = 0.75)</code>.
</p>
<p>A user can specify a time-based window (e.g. <code>.smooth_period = "1 year"</code>)
or a numeric value (e.g. <code>smooth_period = 365</code>).
</p>
<p>Time-based windows return the median number of observations in a window using <code>tk_get_trend()</code>.
</p>


<h3>Value</h3>

<p>A static <code>ggplot2</code> plot or an interactive <code>plotly</code> plot
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(dplyr)
library(lubridate)

# Works with individual time series
FANG %&gt;%
    filter(symbol == "FB") %&gt;%
    plot_time_series(date, adjusted, .interactive = FALSE)

# Works with groups
FANG %&gt;%
    group_by(symbol) %&gt;%
    plot_time_series(date, adjusted,
                     .facet_ncol  = 2,     # 2-column layout
                     .interactive = FALSE)

# Can also group inside &amp; use .color_var
FANG %&gt;%
    mutate(year = year(date)) %&gt;%
    plot_time_series(date, adjusted,
                     .facet_vars     = c(symbol, year), # add groups/facets
                     .color_var      = year,            # color by year
                     .facet_ncol     = 4,
                     .facet_scales   = "free",
                     .facet_collapse = TRUE,  # combine group strip text into 1 line
                     .interactive    = FALSE)

# Can apply transformations to .value or .color_var
# - .value = log(adjusted)
# - .color_var = year(date)
FANG %&gt;%
    plot_time_series(date, log(adjusted),
                     .color_var    = year(date),
                     .facet_vars   = contains("symbol"),
                     .facet_ncol   = 2,
                     .facet_scales = "free",
                     .y_lab        = "Log Scale",
                     .interactive  = FALSE)



</code></pre>


</div>