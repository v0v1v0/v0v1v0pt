<div class="container">

<table style="width: 100%;"><tr>
<td>wasserstein</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Compute the Wasserstein Distance Between Two Objects
</h2>

<h3>Description</h3>

<p>Given two objects <code>a</code> and <code>b</code> that specify measures in <code class="reqn">R^d</code>, compute the Wasserstein distance of
order <code>p</code> between the objects.
</p>


<h3>Usage</h3>

<pre><code class="language-R">wasserstein(a, b, p=1, tplan=NULL, costm=NULL, prob=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>a, b</code></td>
<td>

<p>two objects that describe mass distributions in <code class="reqn">R^d</code>. Either both of class <code>pgrid</code> or <code>pp</code>
or <code>wpp</code> or <code>numeric</code>. For the first three the dimension <code class="reqn">d</code> of the structures must be at least 2; see function <code>wasserstein1d</code> for <code class="reqn">d=1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>

<p>the power <code class="reqn">\geq 1</code> to which the Euclidean distance between points is taken in order to
compute transportation costs.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tplan</code></td>
<td>

<p>an optional transference plan in the format returned by the function <code>transport</code>. If <code>NULL</code> an optimal
transference plan based on <code>a</code>, <code>b</code> and <code>p</code> is computed by a call to <code>transport</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>costm</code></td>
<td>

<p>the matrix of costs between the support points of the measures. Ignored unless <code>a</code> and <code>b</code> are numeric vectors.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>

<p>logical. Should the objects <code>a</code>, <code>b</code> be interpreted as probability measures, i.e. their total mass be normalized to 1?
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>further parameters passed to <code>transport</code> if <code>tplan</code> is <code>NULL</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Wasserstein distance of order <code>p</code> is defined as the <code>p</code>-th root of the total cost incurred when transporting measure <code>a</code>
to measure <code>b</code> in an optimal way, where the cost of transporting a unit of mass from <code class="reqn">x</code> to <code class="reqn">y</code> is given as the <code>p</code>-th 
power <code class="reqn">\|x-y\|^p</code> of the Euclidean distance. 
</p>
<p>If <code>tplan</code> is supplied by the user, no checks are performed whether it is optimal for the given problem. So this
function may be used to compare different (maybe suboptimal) transference plans with regard to their total costs.
</p>
<p>For further details on the algorithms used, see help of <code>transport</code>. 
</p>


<h3>Value</h3>

<p>A single number, the Wasserstein distance for the specified problem.
</p>


<h3>Author(s)</h3>

<p>Dominic Schuhmacher <a href="mailto:dschuhm1@uni-goettingen.de">dschuhm1@uni-goettingen.de</a>
</p>


<h3>See Also</h3>

<p><code>plot</code>, <code>transport</code>, <code>wasserstein1d</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#
# example for class 'pgrid'
#
wasserstein(random32a,random32b,p=1)
res &lt;- transport(random32a,random32b,p=2)
wasserstein(random32a,random32b,p=1,res)
# is larger than above:
# the optimal transport for p=2 is not optimal for p=1

#
# example for class 'pp'
#
set.seed(27)
x &lt;- pp(matrix(runif(500),250,2))
y &lt;- pp(matrix(runif(500),250,2))
wasserstein(x,y,p=1)
wasserstein(x,y,p=2)
</code></pre>


</div>