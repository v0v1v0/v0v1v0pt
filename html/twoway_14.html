<div class="container">

<table style="width: 100%;"><tr>
<td>plot.twoway</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot methods for two-way tables</h2>

<h3>Description</h3>

<p>Plots either the fitted values and residuals under additivity or
a diagnostic plot for removable non-additivity by a power transformation
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'twoway'
plot(x, which = c("fit", "diagnose"), ...,
  na.rm=any(is.na(x$residuals)))

## S3 method for class 'twoway.fit'
plot(x, main = paste0("Tukey two-way fit plot for ",
  x$name, " (method: ", x$method, ")"), xlab = expression(hat(mu) *
  " + Column Effect - Row Effect"), ylab = expression("Fit = " * hat(mu)
  * " + Column Effect + Row Effect"), rfactor = 1, rcolor = c("blue",
  "red"), lwd = 3, ylim = NULL, ...,
  na.rm=any(is.na(x$residuals)))

## S3 method for class 'twoway.diagnose'
plot(x, annotate = TRUE, jitter = FALSE,
  smooth = FALSE, pch = 16, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a <code>class("twoway")</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>one of <code>"fit"</code> or <code>"diagnose"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments, passed to <code>plot</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>logical. Should missing values be removed?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>plot title</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>X axis label</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>Y axis label</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rfactor</code></td>
<td>
<p>draw lines for <code>abs(residuals) &gt; rfactor*sqrt(MSPE)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rcolor</code></td>
<td>
<p>a vector of length 2 giving the color of lines for positive and negative residuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>line width for residual lines in the fit plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>Y axis limits</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>annotate</code></td>
<td>
<p>A logical value; if <code>TRUE</code>, the slope and power are displayed in the diagnostic plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jitter</code></td>
<td>
<p>A logical value; if <code>TRUE</code>, the comparison values in the plot are jittered to avoid overplotting</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth</code></td>
<td>
<p>A logical value; if <code>TRUE</code>, a smoothed <code>loess</code> curve is added to the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>
<p>Plot character for point symbols in the diagnostic plot</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For the <code>which="fit"</code> plot, the basic result comes from a plot of the row effects against the column fitted
values, which appears as a rectangular grid in these coordinates.  Rotating this 45 degrees counterclockwise give a plot
in which the vertical coordinate is the fitted value for the two-way table, and the horizontal coordinate is the column fit
minus the row effect.  The spacing of the grid lines for the rows and columns of the table show the relative magnitudes of the
row/column means or medians.
</p>
<p>For the <code>which="diagnose"</code> plot, the interaction residuals from an additive model, <code class="reqn">y_{ij} = \mu + \alpha_i + \beta_j</code>,
are plotted against the estimated components <code class="reqn">\alpha_i \beta_j / \mu</code>. If this plot shows a substantially non-zero
slope, <code class="reqn">b</code>, this analysis suggests that a power transformation, <code class="reqn"> y \rightarrow y^(1-b)</code> might reduce the
apparent interaction effects.
</p>
<p>For both plots, if you want to directly compare the result of <code>method="mean"</code> and <code>method="median"</code>, it is
essential to set the same <code>xlim</code> and <code>ylim</code> axes in the call.
</p>


<h3>Value</h3>

<p>The diagnostic plot invisibly returns a list with elements <code>c("slope", "power")</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(taskRT)
tw &lt;- twoway(taskRT)
tw
twmed &lt;- twoway(taskRT, method="median")
twmed
plot(tw,    xlim=c(2,7), ylim=c(2,7)) ## use the same xlim and ylim, for comparison
plot(twmed, xlim=c(2,7), ylim=c(2,7))

plot(tw,    which="diagnose", xlim=c(-.19, .19), ylim=c(-.5, .55))
plot(twmed, which="diagnose", xlim=c(-.19, .19), ylim=c(-.5, .55))

data(insectCounts)
twi &lt;- twoway(insectCounts)
twimed &lt;- twoway(insectCounts, method="median")

plot(twi,    xlim=c(-250, 700), ylim=c(-180, 900))
plot(twimed, xlim=c(-250, 700), ylim=c(-180, 900))

plot(twi,    which="diagnose", xlim=c(-160, 170), ylim=c(-200, 400))  ## power = .1
plot(twimed, which="diagnose", xlim=c(-160, 170), ylim=c(-200, 400))  ## power = .3

</code></pre>


</div>