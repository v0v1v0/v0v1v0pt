<div class="container">

<table style="width: 100%;"><tr>
<td>counts2fpkm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fragments per kilobase per million</h2>

<h3>Description</h3>

<p>Takes a count matrix and a vector of gene lengths and returns an optionally <code>log2</code>-transformed FPKM matrix. Modified from edgeR.
</p>


<h3>Usage</h3>

<pre><code class="language-R">counts2fpkm(x, length, log = FALSE, prior.count = 0.25)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a matrix of counts</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>length</code></td>
<td>
<p>a vector of length <code>nrow(x)</code> giving length in bases</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>logical, if <code>TRUE</code>, then <code>log2</code> values are returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior.count</code></td>
<td>
<p>average count to be added to each observation to avoid 
taking log of zero. Used only if <code>log=TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A matrix of FPKM values.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
library(readr)
library(dplyr)
countdata &lt;- read_csv("http://files.figshare.com/2439061/GSE37704_featurecounts.csv") 
counts &lt;- countdata %&gt;% select(countdata, starts_with("SRR")) %&gt;% as.matrix
counts2fpkm(counts, countdata$length)

## End(Not run)
  
</code></pre>


</div>