<div class="container">

<table style="width: 100%;"><tr>
<td>wav.trend.est</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Linear Wavelet Thresholding Trend Estimation of Time Series</h2>

<h3>Description</h3>

<p>Internal function to compute the linear wavelet thresholding trend estimate for a
time series that may be second-order nonstationary. The function calculates
the wavelet transform of the time series, sets to zero the non-boundary coefficients,
then inverts the transform to obtain the estimate.
This function is not intended for general use by regular users of the package.
</p>


<h3>Usage</h3>

<pre><code class="language-R">wav.trend.est(
  x,
  filter.number = 4,
  family = "DaubLeAsymm",
  max.scale = floor(log2(length(x)) * 0.7),
  transform.type = "nondec",
  boundary.handle = FALSE,
  T.CI = FALSE,
  sig.lvl = 0.05,
  lag.max = floor(10 * (log10(length(x)))),
  confint.type = "normal",
  reps = 199,
  spec.est = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The time series you want to estimate the trend function of.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filter.number</code></td>
<td>
<p>Selects the index of the wavelet used in the estimation
procedure. For Daubechies compactly supported wavelets the filter number is
the number of vanishing moments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>Selects the wavelet family to use. Recommended to only use the
Daubechies compactly supported wavelets DaubExPhase and DaubLeAsymm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.scale</code></td>
<td>
<p>Selects the coarsest scale of the wavelet transform to
analyse to. Should be a value from <code class="reqn">1</code> (finest) to <code class="reqn">J-1</code> (coarsest),
where <code class="reqn">n=2^J</code> is the length of the time series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transform.type</code></td>
<td>
<p>The type of wavelet transform used. Can be <code>"dec"</code>
which is the standard discrete wavelet transform or <code>"nondec"</code> (default),
a non-decimated wavelet transform, but a confidence interval
cannot be calculated in this case.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boundary.handle</code></td>
<td>
<p>Logical variable. If <code>TRUE</code>, the time
series is boundary corrected, to get a less variable trend estimate at the
boundaries of the times series. If <code>FALSE</code>, no boundary correction is applied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T.CI</code></td>
<td>
<p>Logical variable, only to be used if <code>transform.type = TRUE</code>.
If <code>TRUE</code>, a <code>(1-sig.lvl)</code> pointwise confidence interval is
computed for the trend estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig.lvl</code></td>
<td>
<p>Used only if <code>T.CI = TRUE</code>; a numeric value
(<code>0 &lt;= sig.lvl &lt;= 1</code>) with which a <code>(1-sig.lvl)</code> pointwise
confidence interval for the trend estimate is generated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lag.max</code></td>
<td>
<p>Used only if <code>T.CI = TRUE</code>; a positive integer
specifying the maximum lag to which the local autocovariance function is
estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>confint.type</code></td>
<td>
<p>Used only if <code>T.CI = TRUE</code>; the type of confidence
interval computed. Can be <code>"percentile"</code>, in which case empirical percentiles are used, or
<code>"normal"</code> (default), in which case the normal approximation is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reps</code></td>
<td>
<p>Used only if <code>T.CI = TRUE</code> and <code>transform.type = "dec"</code> ; the number
of bootstrap replications used to compute the confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spec.est</code></td>
<td>
<p>Used only if <code>T.CI = TRUE</code>; the spectrum estimate of the time series,
used to calculate the confidence interval for the trend estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed to the <code>ewspec.trend</code> call.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>list</code> object containing the following fields:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Input data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filter.number, family</code></td>
<td>
<p>Input wavelet parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transform.type, max.scale, boundary.handle, T.CI</code></td>
<td>
<p>Input parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T</code></td>
<td>
<p>A vector of length <code>length(x)</code> containing the trend estimate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.CI</code></td>
<td>
<p>Returned if <code>T.CI = TRUE</code>. The lower limit of the pointwise confidence interval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper.CI</code></td>
<td>
<p>Returned if <code>T.CI = TRUE</code>. The upper limit of the pointwise confidence interval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig.lvl</code></td>
<td>
<p>Returned if <code>T.CI = TRUE</code>. The significance level of the pointwise confidence interval</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>McGonigle, E. T., Killick, R., and Nunes, M. (2022). Trend
locally stationary wavelet processes. <em>Journal of Time Series
Analysis</em>, 43(6), 895-917.
</p>


<h3>See Also</h3>

<p><code>TLSW</code>
</p>


</div>