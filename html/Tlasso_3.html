<div class="container">

<table style="width: 100%;"><tr>
<td>covres</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sample Covariance Matrix of Residuals</h2>

<h3>Description</h3>

<p>Generate sample covariance matrix of residuals (includes diagnoal) described in <a href="https://arxiv.org/abs/1609.04522">Lyu et al. (2019)</a>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">covres(data, Omega.list, k = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>tensor object stored in a m1 * m2 * ... * mK * n array, where n is sample size
and mk is dimension of the kth tensor mode.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Omega.list</code></td>
<td>
<p>list of precision matrices of tensor, i.e., <code>Omega.list[[k]]</code> is precision matrix 
for the kth tensor mode, <code class="reqn">k \in \{1 , \ldots, K\}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>index of interested mode, default is 1.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function computes sample covariance of residuals and is the basis for support recovery procedure in <a href="https://arxiv.org/abs/1609.04522">Lyu et al. (2019)</a>. Note that output matrix includes 
diagnoal while bias corrected matrix (output of <code>biascor</code>) for inference is off-diagnoal, see <a href="https://arxiv.org/abs/1609.04522">Lyu et al. (2019)</a> for details.
Elements in Omega.list are true precision matrices or estimation of the true ones, the latter can be output of <code>Tlasso.fit</code>.
</p>


<h3>Value</h3>

<p>A matrix whose (i,j) entry (includes diagnoal) is sample covariance of the ith and jth residuals in the kth mode. See <a href="https://arxiv.org/abs/1609.04522">Lyu et al. (2019)</a> for details.
</p>


<h3>Author(s)</h3>

<p>Xiang Lyu, Will Wei Sun, Zhaoran Wang, Han Liu, Jian Yang, Guang Cheng.
</p>


<h3>See Also</h3>

<p><code>varcor</code>, <code>biascor</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
m.vec = c(5,5,5)  # dimensionality of a tensor 
n = 5   # sample size 
k=1 # index of interested mode
lambda.thm = 20*c( sqrt(log(m.vec[1])/(n*prod(m.vec))), 
                   sqrt(log(m.vec[2])/(n*prod(m.vec))), 
                   sqrt(log(m.vec[3])/(n*prod(m.vec))))
DATA=Trnorm(n,m.vec,type='Chain') 
# obersavations from tensor normal distribution
out.tlasso = Tlasso.fit(DATA,T=1,lambda.vec = lambda.thm)   
# output is a list of estimation of precision matrices
rho=covres(DATA, out.tlasso, k = k) # sample covariance of residuals, including diagnoal 
rho

</code></pre>


</div>