<div class="container">

<table style="width: 100%;"><tr>
<td>split_cols_by_groups</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Split columns by groups of levels</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt="[Stable]"></a>
</p>


<h3>Usage</h3>

<pre><code class="language-R">split_cols_by_groups(lyt, var, groups_list = NULL, ref_group = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>lyt</code></td>
<td>
<p>(<code>PreDataTableLayouts</code>)<br> layout that analyses will be added to.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var</code></td>
<td>
<p>(<code>string</code>)<br> single variable name that is passed by <code>rtables</code> when requested
by a statistics function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups_list</code></td>
<td>
<p>(named <code>list</code> of <code>character</code>)<br> specifies the new group levels via the names and the
levels that belong to it in the character vectors that are elements of the list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ref_group</code></td>
<td>
<p>(<code>data.frame</code> or <code>vector</code>)<br> the data corresponding to the reference group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to <code>rtables::split_cols_by()</code> in order. For instance, to
control formats (<code>format</code>), add a joint column for all groups (<code>incl_all</code>).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A layout object suitable for passing to further layouting functions. Adding
this function to an <code>rtable</code> layout will add a column split including the given
groups to the table layout.
</p>


<h3>See Also</h3>

<p><code>rtables::split_cols_by()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># 1 - Basic use

# Without group combination `split_cols_by_groups` is
# equivalent to [rtables::split_cols_by()].
basic_table() %&gt;%
  split_cols_by_groups("ARM") %&gt;%
  add_colcounts() %&gt;%
  analyze("AGE") %&gt;%
  build_table(DM)

# Add a reference column.
basic_table() %&gt;%
  split_cols_by_groups("ARM", ref_group = "B: Placebo") %&gt;%
  add_colcounts() %&gt;%
  analyze(
    "AGE",
    afun = function(x, .ref_group, .in_ref_col) {
      if (.in_ref_col) {
        in_rows("Diff Mean" = rcell(NULL))
      } else {
        in_rows("Diff Mean" = rcell(mean(x) - mean(.ref_group), format = "xx.xx"))
      }
    }
  ) %&gt;%
  build_table(DM)

# 2 - Adding group specification

# Manual preparation of the groups.
groups &lt;- list(
  "Arms A+B" = c("A: Drug X", "B: Placebo"),
  "Arms A+C" = c("A: Drug X", "C: Combination")
)

# Use of split_cols_by_groups without reference column.
basic_table() %&gt;%
  split_cols_by_groups("ARM", groups) %&gt;%
  add_colcounts() %&gt;%
  analyze("AGE") %&gt;%
  build_table(DM)

# Including differentiated output in the reference column.
basic_table() %&gt;%
  split_cols_by_groups("ARM", groups_list = groups, ref_group = "Arms A+B") %&gt;%
  analyze(
    "AGE",
    afun = function(x, .ref_group, .in_ref_col) {
      if (.in_ref_col) {
        in_rows("Diff. of Averages" = rcell(NULL))
      } else {
        in_rows("Diff. of Averages" = rcell(mean(x) - mean(.ref_group), format = "xx.xx"))
      }
    }
  ) %&gt;%
  build_table(DM)

# 3 - Binary list dividing factor levels into reference and treatment

# `combine_groups` defines reference and treatment.
groups &lt;- combine_groups(
  fct = DM$ARM,
  ref = c("A: Drug X", "B: Placebo")
)
groups

# Use group definition without reference column.
basic_table() %&gt;%
  split_cols_by_groups("ARM", groups_list = groups) %&gt;%
  add_colcounts() %&gt;%
  analyze("AGE") %&gt;%
  build_table(DM)

# Use group definition with reference column (first item of groups).
basic_table() %&gt;%
  split_cols_by_groups("ARM", groups, ref_group = names(groups)[1]) %&gt;%
  add_colcounts() %&gt;%
  analyze(
    "AGE",
    afun = function(x, .ref_group, .in_ref_col) {
      if (.in_ref_col) {
        in_rows("Diff Mean" = rcell(NULL))
      } else {
        in_rows("Diff Mean" = rcell(mean(x) - mean(.ref_group), format = "xx.xx"))
      }
    }
  ) %&gt;%
  build_table(DM)

</code></pre>


</div>