<div class="container">

<table style="width: 100%;"><tr>
<td>reconstruct</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Reconstruct tensor from low dimensional components</h2>

<h3>Description</h3>

<p>This function reconstructs the temporal tensor from the low dimensional components extracted by <code>tempted</code> and <code>svd_centralize</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">reconstruct(res_tempted, res_svd = NULL, datlist = NULL, r_reconstruct = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>res_tempted</code></td>
<td>
<p>Output of function <code>tempted</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res_svd</code></td>
<td>
<p>Output of function <code>svd_centralize</code> if mean subtraction <code>svd_centralize</code> was performed before <code>tempted</code>. If mean subtraction was not performed, specify <code>res_svd=NULL</code> and provide <code>datlist</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>datlist</code></td>
<td>
<p>Output of function <code>format_tempted</code> if mean subtraction was not performed and <code>res_svd=NULL</code>, or left as <code>NULL</code> if mean subtraction was performed and <code>res_svd</code> is provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r_reconstruct</code></td>
<td>
<p>The number of components from TEMPTED to be used for the tensor reconstruction.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>datlist_est The reconstructed tensor stored in a datlist format same as the output of <code>format_tempted</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Take a subset of the samples so the example runs faster

# Here we are taking samples from the odd months
sub_sample &lt;- rownames(meta_table)[(meta_table$day_of_life%/%12)%%2==1]
count_table_sub &lt;- count_table[sub_sample,]
processed_table_sub &lt;- processed_table[sub_sample,]
meta_table_sub &lt;- meta_table[sub_sample,]
# reconstruct with mean subtraction
datlist &lt;- format_tempted(processed_table_sub,
                          meta_table_sub$day_of_life,
                          meta_table_sub$studyid,
                          pseudo=NULL,
                          transform="none")

mean_svd &lt;- svd_centralize(datlist, r=1)

res_tempted &lt;- tempted(mean_svd$datlist, r=2, smooth=1e-5)

datlist_est &lt;- reconstruct(res_tempted, mean_svd, datlist=NULL, r_reconstruct=2)
vec_est &lt;- unlist(sapply(datlist_est, function(x){x[-1,]}))
vec_obs &lt;- unlist(sapply(datlist, function(x){x[-1,]}))
R2 &lt;- 1-sum((vec_est-vec_obs)^2)/sum(vec_obs^2)
R2

# reconstruct without mean subtraction
datlist &lt;- format_tempted(processed_table_sub,
                          meta_table_sub$day_of_life,
                          meta_table_sub$studyid,
                          pseudo=NULL,
                          transform="none")

res_tempted &lt;- tempted(datlist, r=2, smooth=1e-5)

datlist_est &lt;- reconstruct(res_tempted, res_svd=NULL, datlist=datlist, r_reconstruct=2)
vec_est &lt;- unlist(sapply(datlist_est, function(x){x[-1,]}))
vec_obs &lt;- unlist(sapply(datlist, function(x){x[-1,]}))
R2 &lt;- 1-sum((vec_est-vec_obs)^2)/sum(vec_obs^2)
R2

</code></pre>


</div>