<div class="container">

<table style="width: 100%;"><tr>
<td>diagnostic_assessment_continuous</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Diagnostic ability assessment for continuous diagnostic tests
</h2>

<h3>Description</h3>

<p>This function estimates the AUC, optimal threshold, sensitivity and specificity at a fixed time-point t for continuous diagnostic tests with survival data by using three methods: 1) unknown status exclusion (USE), which excludes subjects with missing status at t; 2) imputation of censored times (ICT), a method based on multiple imputation; and 3) survivalROC, which uses a method based on time-dependent ROC curves. The status of the subjects at a certain time-point of interest t (the event occurred before or at t or not) is defined by the time-to-event variable.
</p>


<h3>Usage</h3>

<pre><code class="language-R">diagnostic_assessment_continuous(cont.var, time, status, predict.time,
                                 method=c("USE", "ICT", "survivalROC"),
                                 index=c("all", "AUC", "threshold", "sens", "spec"),
                                 costs=NULL, R=NULL,
                                 method.thres=c("normal", "empirical"),
                                 var.equal=FALSE, lambda=0.05, m=10,
                                 ci=TRUE, plot=FALSE, alpha=0.05,
                                 B=1000, range=3, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cont.var</code></td>
<td>

<p>continuous variable or biomarker to be used as predictor of the status
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>

<p>survival time
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>status</code></td>
<td>

<p>censoring status codified as 0=censored, 1=event
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predict.time</code></td>
<td>

<p>time-point of interest to define the subjects' status as event present or absent
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>method to be used in the estimation process. The user can choose between <code>USE</code> (unknown status exclusion), <code>ICT</code> (imputation of censored times) or <code>survivalROC</code> (time-dependent ROC curves). Default, <code>ME</code>  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index</code></td>
<td>

<p>indices to be estimated. The user can choose one or more of the following: <code>AUC</code>, <code>threshold</code>, <code>sens</code> (sensitivity achieved by the optimal threshold), <code>spec</code> (specificity achieved by the optimal threshold). The option <code>all</code> (default) estimates all four indices
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>costs</code></td>
<td>

<p>cost matrix. Costs should be entered as a 2x2 matrix, where the first row corresponds to the true positive and true negative costs and the second row to the false positive and false negative costs. Default cost values (<code>costs=NULL</code>, when also <code>R=NULL</code>) are a combination of costs that yields R=1, which is equivalent to the Youden index method (for details about this concept, see <b>Details</b> and <b>References</b>)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>

<p>if the cost matrix <code>costs</code> is not set (that is, <code>costs=NULL</code>), R desired (the algorithm will choose a suitable combination of costs that leads to <code>R</code>). Default, <code>NULL</code> (which leads to R=1 using the default <code>costs</code>). For details about this concept, see <b>Details</b> and <b>References</b>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method.thres</code></td>
<td>

<p>method used in the estimation: <code>"normal"</code> (default) or <code>"empirical"</code>. The user can specify just the initial letters. See <b>Details</b> for more information about the methods available
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.equal</code></td>
<td>

<p>when <code>method="normal"</code>, assume equal variances? Default, <code>FALSE</code>. When <code>method="empirical"</code>, <code>var.equal</code> is ignored
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>

<p>smoothing parameter for the NNE algorithm used in <code>survivalROC()</code> function. Default, 0.05
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>

<p>the number of data sets to impute. Default, 10
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>

<p>Should a confidence interval be calculated? Default, <code>TRUE</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>

<p>Should some graphs about the estimation be plotted? Default, <code>FALSE</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>significance level for the confidence interval. Default, 0.05
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>

<p>number of bootstrap resamples for the confidence interval. Only used when <code>method</code> is <code>survivalROC</code>. Otherwise, this argument is ignored. Default, 1000
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>range</code></td>
<td>

<p>this value, which is passed to <code>boxplot</code> function from <code>graphics</code> package, determines the data points that are considered to be extreme in the estimates and standard errors from the multiple imputation process. We consider extreme observations those that exceed <code>range</code> times the interquartile range. If extreme observations are found in the estimates or standard errors from the multiple imputation process, Winsorized estimators (Wilcox, 2012) are used for the point estimate and the between and within variances. Default, 3
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>extra arguments to be passed to <code>plot()</code>  
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When <code>method</code> is <code>USE</code>: First, the algorithm determines the status of the subjects at time <code>predict.time</code>. Those censored subjects whose status could be not be determined are excluded from the analysis. Then, diagnostic ability is assessed with standard methods in the binary setting.
</p>
<p>When <code>method</code> is <code>ICT</code>: First, the algorithm determines the status of the subjects at time <code>predict.time</code>. For those subjects whose status could not be determined because their censored time is lower than t, we impute survival times using the method of Hsu et al (2006), that is implemented in the package <code>InformativeCensoring</code> (Ruau et al, 2020). The status of the subjects is then determined by these imputed times and is used to estimate the indices in <code>index</code>. Confidence intervals are calculated using the standard error proposed by Rubin (1987).
</p>
<p>When <code>method</code> is <code>survivalROC</code>: Diagnostic ability is assessed by constructing the ROC curve at time t through time-dependent ROC curves (Heagerty et al, 2000). Confidence intervals are obtained using normal and percentile bootstrap. In normal bootstrap, the bootstrap is used to obtain an estimate of the standard error of the threshold estimate, and then the standard normal distribution is used for the confidence interval calculation. In percentile bootstrap, <code>B</code> bootstrap resamples are generated and the threshold is estimated in all of them. Then, the confidence interval is calculated as the empirical 1-<code>alpha</code>/2 and 1+<code>alpha</code>/2 percentiles of the <code>B</code> bootstrap estimates.
</p>
<p>For parameter <code>method.thres</code>, the method used in the estimation of the optimal threshold, the user can choose between <code>"normal"</code> (assumes binormality) or <code>"empirical"</code> (leaves out any distributional assumption). When <code>method="normal"</code>, the user can specify if the algorithm should assume equal or different variances using the parameter <code>var.equal</code>. For further details see the <code>thres2</code> function in the <code>ThresholdROC</code> package.
</p>
<p>R, mentioned in parameters <code>costs</code> and <code>R</code>, is the product of the non-disease odds and the cost ratio:
</p>
<p style="text-align: center;"><code class="reqn">R=((1-p)/p)((C_{TN}-C_{FP})/(C_{TP}-C_{FN})),</code>
</p>

<p>where <em>p</em> is the disease prevalence (estimated using Kaplan-Meier) and <em>C_i</em> are the classification costs.
</p>


<h3>Value</h3>

<p>An object of class <code>diagnostic_assessment</code>, which is a list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>AUC </code></td>
<td>
<p>AUC estimate and its corresponding confidence interval (if <code>ci=TRUE</code>), only if AUC has been included in <code>index</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold </code></td>
<td>
<p>threshold estimate and its corresponding confidence interval (if <code>ci=TRUE</code>), only if threshold has been included in <code>index</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sens </code></td>
<td>
<p>Sensitivity estimate (achieved by the optimal threshold) and its corresponding confidence interval (if <code>ci=TRUE</code>), only if sensitivity has been included in <code>index</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spec </code></td>
<td>
<p>Specificity estimate (achieved by the optimal threshold) and its corresponding confidence interval (if <code>ci=TRUE</code>), only if specificity has been included in <code>index</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method </code></td>
<td>
<p><code>method</code> used in the estimation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha </code></td>
<td>
<p>significance level provided by the user</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data </code></td>
<td>
<p>A data.frame containing the following columns previously provided by the user: <code>cont.var</code>, <code>time</code> and <code>status</code>, and a new column <code>statusNA</code>, which contains the status of the subjects at time <code>predict.time</code> (0=no event, 1=event, <code>NA</code>=unknown)</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Heagerty PJ, Lumley T, Pepe MS. Time-Dependent ROC Curves for Censored Survival Data and a Diagnostic Marker. Biometrics 2000; 56(2): 337-344. doi: 10.1111/j.0006-341X.2000.00337.x
</p>
<p>Heagerty PJ, Saha-Chaudhuri P (2022). survivalROC: Time-dependent ROC curve estimation from censored survival data. R package version 1.0.3.1. <a href="https://CRAN.R-project.org/package=survivalROC">https://CRAN.R-project.org/package=survivalROC</a>
</p>
<p>Hsu CH, Taylor JMG, Murray S, Commenges D. Survival analysis using auxiliary variables via non-parametric multiple imputation. Statistics in Medicine 2006; 25(20): 3503-3517. doi: https://doi.org/10.1002/sim.2452
</p>
<p>Kottas M, Kuss O, Zapf A. A modified Wald interval for the area under the ROC curve (AUC) in diagnostic case-control studies. BMC Medical Research Methodology 2014; 14(26). doi:10.1186/1471-2288-14-26
</p>
<p>Perez-Jaume S, Skaltsa K, Pallares N, Carrasco JL. ThresholdROC: Optimum Threshold Estimation Tools for Continuous Diagnostic Tests in R. Journal of Statistical Software 2017; 82(4): 1-21. doi: 10.18637/jss.v082.i04
</p>
<p>Ruau D, Burkoff N, Bartlett J, Jackson D, Jones E, Law M and Metcalfe P (2020). InformativeCensoring: Multiple Imputation for Informative Censoring. R package version 0.3.5. <a href="https://CRAN.R-project.org/package=InformativeCensoring">https://CRAN.R-project.org/package=InformativeCensoring</a>
</p>
<p>Robin X, Turck N, Hainard A, Tiberti N, Lisacek F, Sanchez JC, Muller M. pROC: an open-source package for R and S+ to analyze and compare ROC curves. BMC Bioinformatics 2011; 12. doi:10.1186/1471-2105-12-77
</p>
<p>Rubin DB. Multiple Imputation for Nonresponse in Surveys. Wiley Series in Probability and Statistics. John Wiley &amp; Sons (1987)
</p>
<p>Skaltsa K, Jover L, Carrasco JL. Estimation of the diagnostic threshold accounting for decision costs and sampling uncertainty. Biometrical Journal 2010; 52(5): 676-697. doi: 10.1002/bimj.200900294
</p>
<p>Wilcox, R. Introduction to Robust Estimation and Hypothesis Testing. 3rd Edition. Elsevier, Amsterdam (2012)
</p>


<h3>See Also</h3>

<p><code>diagnostic_assessment_binary</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(ThresholdROCsurvival)
data(NSCLC)
# unknown status exclusion (Youden index maximization, R=1)
with(NSCLC, diagnostic_assessment_continuous(log(COL), OS,
                                             ST, 1095, method="USE", method.thres="normal",
                                             var.equal=FALSE, ci=TRUE))

# multiple imputation (Youden index maximization, R=1)
set.seed(2020)
with(NSCLC, diagnostic_assessment_continuous(log(COL), OS,
                                             ST, 1095, method="ICT", method.thres="normal",
                                             var.equal=FALSE, m=50, ci=TRUE))


# unknown status exclusion (R=1.1)
with(NSCLC, diagnostic_assessment_continuous(log(COL), OS,
                                             ST, 1095, method="USE", method.thres="normal",
                                             var.equal=FALSE, ci=TRUE, R=1.1))

# multiple imputation (R=1.1)
set.seed(2020)
with(NSCLC, diagnostic_assessment_continuous(log(COL), OS,
                                             ST, 1095, method="ICT", method.thres="normal",
                                             var.equal=FALSE, m=50, ci=TRUE, R=1.1))


# time-dependent ROC curves (Youden index maximization, R=1)
set.seed(2020)
with(NSCLC, diagnostic_assessment_continuous(log(COL), OS,
                                             ST, 1095, method="survivalROC",
                                             ci=TRUE, R=1, B=500))

</code></pre>


</div>