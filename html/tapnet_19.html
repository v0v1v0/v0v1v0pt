<div class="container">

<table style="width: 100%;"><tr>
<td>predict_tapnet</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Predict from fitted tapnet to new data</h2>

<h3>Description</h3>

<p>Function allows direct use of data prepared for tapnet analysis by other statistical methods, e.g. regression approaches
</p>


<h3>Usage</h3>

<pre><code class="language-R">predict_tapnet(fit, abuns, tapnet = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>results of applying fit_tapnet to the tapnet object;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abuns</code></td>
<td>
<p>named list of two entries ("low" and "high"), containing a species-named vector of abundances of the new network</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tapnet</code></td>
<td>
<p>optional name of a tapnet object containing traits, phylogeny etc.; these are not stored in <span class="option">fit</span>, but rather it is assumed that a tapnet object with the name stored in <span class="option">fit</span> is available in the global environment. That may not be the case, e.g. when simulating networks. In this case, <span class="option">tapnet</span> provides the required tapnet-object.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The fitted tapnet object contains the estimated parameters, describing how traits, abundance and phylogeny play together to produce the network(s) used for fitting. This information is now used to predict interaction probabilities for a new network. Accordingly, we need to know this new network's species abundances (an input to the function), PEMs and traits. The latter are computed based on the information contained in the tapnet object (which is linked in by attribute reference). For new species, their PEMs are computed and the network is simulated, using <code>simnetfromtap</code>, for the information provided.
</p>


<h3>Value</h3>

<p>A matrix of predicted interaction probabilities, summing to 1. This would need to be multiplied by the total number of interactions in the new network to be comparable to the observations.
</p>


<h3>Author(s)</h3>

<p>Ruth Stephan, Gita Benadi and Carsten Dormann &lt;carsten.dormann@biom.uni-freiburg.de&gt;
</p>


<h3>References</h3>

<p>Benadi et al. in prep
</p>


<h3>Examples</h3>

<pre><code class="language-R">
  data(Tinoco)
  tap &lt;- make_tapnet(tree_low = plant_tree, tree_high = humm_tree, networks = networks[1:2], 
         traits_low = plant_traits, traits_high = humm_traits, npems_lat = 4)
  fit &lt;- fit_tapnet(tap) # uses two networks for fitting!
  gof_tapnet(fit)
  # predict to omitted forest network's abundances:
  pred1 &lt;- predict_tapnet(fit, abuns=list("low"=plant_abun[[3]], "high"=humm_abun[[3]] )) 
  cor(as.vector(pred1*sum(networks[[3]])), as.vector(networks[[3]])) 


</code></pre>


</div>