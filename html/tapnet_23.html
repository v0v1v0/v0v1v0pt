<div class="container">

<table style="width: 100%;"><tr>
<td>simulate_tapnet</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Creates a simulated along with all parameters, abundances, traits and phylogeny used</h2>

<h3>Description</h3>

<p>Simulation function to produce a tapnet object, i.e. one or more networks along with their descriptors, abundances, traits, phylogenetic information
</p>


<h3>Usage</h3>

<pre><code class="language-R">simulate_tapnet(
  nlower,
  nhigher,
  ntraits_nopem,
  ntraits_pem,
  pem_noise = 0.5,
  abuns = "lognormal",
  meanlog = 0,
  sdlog = 1,
  tmatch_type_pem = "normal",
  tmatch_type_obs = "normal",
  npems_lat = NULL,
  lat_low = 1,
  lat_high = 1,
  tmatch_width_pem = 1,
  pem_shift = 0,
  tmatch_width_obs = 1,
  Nwebs = 1,
  prop_species = 1,
  new_abuns = FALSE,
  Nobs = 1000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>nlower</code></td>
<td>
<p>species number in lower trophic level;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nhigher</code></td>
<td>
<p>species number in higher trophic level;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntraits_nopem</code></td>
<td>
<p>number of phylogenetically uncorrelated traits (for each level);</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntraits_pem</code></td>
<td>
<p>number of phylogenetically correlated traits (for each level);</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pem_noise</code></td>
<td>
<p>noise (sd of normal dist) to put on PEMs;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abuns</code></td>
<td>
<p>abundances set to "lognormal", "equal" or a list of two abundance vectors;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meanlog</code></td>
<td>
<p>parameters of the log-normal distribution for drawing abundances;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdlog</code></td>
<td>
<p>same as before, but width;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tmatch_type_pem</code></td>
<td>
<p>type of trait matching function for latent traits;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tmatch_type_obs</code></td>
<td>
<p>type of trait matching function for observed traits (can be a vector as long as there are traits);</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npems_lat</code></td>
<td>
<p>number of phylogenetic eigenvectors to be used to construct latent traits. If NULL, all eigenvectors will be used;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lat_low</code></td>
<td>
<p>vector of PEM linear combination parameters for lower trophic level; if 1, all values will be set to 1, if "random", values will be drawn from a uniform dist;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lat_high</code></td>
<td>
<p>same for higher trophic level;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tmatch_width_pem</code></td>
<td>
<p>width of trait matching function for latent (PEM-based) traits;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pem_shift</code></td>
<td>
<p>shift parameter for latent trait matching;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tmatch_width_obs</code></td>
<td>
<p>width of trait matching function for observed traits, can be a single value or a vector of length ntraits_nopem + ntraits_pem;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nwebs</code></td>
<td>
<p>number of webs to be simulated;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prop_species</code></td>
<td>
<p>proportion of species in the phylogeny that appear in each web (species are drawn randomly). With multiple networks, this allows to create networks with partly overlapping species composition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>new_abuns</code></td>
<td>
<p>If abuns = "lognormal" and Nwebs &gt; 1, should new abundances be drawn for each web?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nobs</code></td>
<td>
<p>number of observed interactions per web</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function was written to explore the fitting of networks by different methods. Hence, we first have to simulate such networks. It is a very nice starting point for simulations, but irrelevant for tapnet-based analyses. The function internally sets up all the parameters and then calls <code>simnetfromtap</code> for the simulation of the actual network. Lots of options means, regrettably, lots of decisions for the user.
</p>


<h3>Value</h3>

<p>A tapnet object, with a highly nested structure. There are six entries at the top level: trees, traits_all, networks, sim_params and the two tmatch types. Within networks, there is a list of 5 entries (for each of the <span class="option">Nweb</span> networks): abundances, traits, PEMs, web and I_mat. "I_mat" is the actual output from simnetfromtap, while "web" is a single draw from a multinomial distribution with I_mat as probabilities and <span class="option">Nobs</span> as size.
</p>


<h3>Author(s)</h3>

<p>Gita Benadi &lt;gita.benadi@biom.uni-freiburg.de&gt;, Jochen Fr√ºnd &lt;jochen.fruend@biom.uni-freiburg.de&gt; and Carsten Dormann &lt;carsten.dormann@biom.uni-freiburg.de&gt;
</p>


<h3>References</h3>

<p>Benadi et al. in prep
</p>


<h3>Examples</h3>

<pre><code class="language-R">tapnet &lt;- simulate_tapnet(nlower=10, nhigher=20, ntraits_nopem=2, ntraits_pem=0) 
# a minimal call of simulate_tapnet
str(tapnet, 1) # the structure at the first level
str(tapnet, 2) # the structure at the first and second level

</code></pre>


</div>