<div class="container">

<table style="width: 100%;"><tr>
<td>collesslikeI</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculation of the Colless-like indices for rooted trees</h2>

<h3>Description</h3>

<p>This function calculates the Colless-like index for a given rooted
tree <code class="reqn">T</code> according to the chosen weight function <code class="reqn">f</code> and dissimilarity <code class="reqn">D</code>.
The Colless-like index <code class="reqn">CL(T)</code>
relative to <code class="reqn">D</code> and <code class="reqn">f</code> is the sum of the <code class="reqn">(D,f)</code>-balance values
over all inner vertices of the tree. More precisely,
</p>
<p style="text-align: center;"><code class="reqn">CL(T)=\sum_{v\in V_{in}(T)} bal_{D,f}(v)</code>
</p>

<p>where <code class="reqn">V_{in}(T)</code> is the
set of inner vertices of <code class="reqn">T</code>. The <code class="reqn">(D,f)</code>-balance value
of <code class="reqn">v</code> with children <code class="reqn">v_1,...,v_k</code> is computed as
</p>
<p style="text-align: center;"><code class="reqn">bal_{D,f}(v)=D(fs(T_{v_1}),...,fs(T_{v_k}))</code>
</p>

<p>with <code class="reqn">D</code> denoting the dissimilarity and <code class="reqn">fs</code> denoting the f.size.<br>
The f.size <code class="reqn">fs(T)</code> of a tree <code class="reqn">T</code> uses the function <code class="reqn">f</code>, which maps any
integer to a non-negative real number, to build a weighted sum of
the out-degrees of all vertices in <code class="reqn">T</code>. More precisely,
</p>
<p style="text-align: center;"><code class="reqn">fs(T)=\sum_{v\in V(T)} f(deg+(v))</code>
</p>

<p>where <code class="reqn">V(T)</code> is the set of all
vertices of <code class="reqn">T</code> and <code class="reqn">deg+(v)</code> denotes the out-degree (i.e. the number of
children) of the vertex <code class="reqn">v</code>. The <code class="reqn">f</code>-functions that are already
implemented are <code class="reqn">f(x)=e^x</code> and <code class="reqn">f(x)=ln(x+e)</code>.<br>
The dissimilarity <code class="reqn">D(x_1,...,x_k)</code> of a vector <code class="reqn">x_1,...,x_k</code> assigns
a non-negative value to the vector, is independent of the order of the vector
entries and equals zero if and only if <code class="reqn">x_1=...=x_k</code>. In this
implementation the following dissimilarity functions are already built-in:
mean deviation from the median (<code class="reqn">mdm</code>),
the sample variance (<code class="reqn">var</code>) and the sample standard deviation (<code class="reqn">sd</code>).<br><code>collesslikeI</code> also allows the use of other functions for the weight function <code class="reqn">f</code>
and the dissimilarity <code class="reqn">D</code>.<br><br>
Special cases: For <code class="reqn">n=1</code> the function returns <code class="reqn">CL(T)=0</code> and a warning. <br><br>
For details on the family of Colless-like indices, see 
also Chapter 16 in "Tree balance indices: a comprehensive survey" (https://doi.org/10.1007/978-3-031-39800-1_16).
</p>


<h3>Usage</h3>

<pre><code class="language-R">collesslikeI(tree, f.size, dissim)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>A rooted binary tree in phylo format.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f.size</code></td>
<td>
<p>A character string specifying the function <code class="reqn">f</code> that shall be used to compute the f.size.
It can be one of the following: "exp", "ln" or the name of a function as a string.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dissim</code></td>
<td>
<p>A character string specifying the dissimilarity that shall be
used. It can be one of the following: "mdm", "var", "sd" or the name of a function as a string.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>collesslikeI</code> returns the Colless-like index of the given tree according to the chosen
function and dissimilarity.
</p>


<h3>Author(s)</h3>

<p>Luise Kuehn, Sophie Kersting
</p>


<h3>References</h3>

<p>A. Mir, L. Rotger, and F. Rossello. Sound Colless-like balance indices for multifurcating trees. PLOSONE, 13(9):e0203401, 2018. doi: 10.1371/journal.pone.0203401
</p>


<h3>Examples</h3>

<pre><code class="language-R">tree &lt;- ape::read.tree(text="((((,),),(,)),(((,),),(,)));")
collesslikeI(tree, f.size="exp", dissim="mdm")
collesslikeI(tree, f.size="exp", dissim="var")
collesslikeI(tree, f.size="ln", dissim="sd")
myfsize &lt;- function(x) return(x+1)
mydissim &lt;- function(x) return (var(x))
collesslikeI(tree, f.size="myfsize",dissim = "mydissim")

</code></pre>


</div>