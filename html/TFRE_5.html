<div class="container">

<table style="width: 100%;"><tr>
<td>TFRE</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit a TFRE regression model with Lasso, SCAD or MCP regularization</h2>

<h3>Description</h3>

<p>Fit a TFRE Lasso model and/or a TFRE SCAD or MCP model. The TFRE 
regression models are fitted via QICD algorithm and <em>Incomplete U-statistics</em> 
resampling technique (optional). The tuning parameter of TFRE Lasso regression 
is estimated by the covariate matrix X. The TFRE SCAD / MCP regressions are 
computed at a grid of values for the tuning parameter eta. High dimensional 
BIC (HBIC) will be used as the criterion on the TFRE SCAD / MCP tuning parameter 
searching.
</p>


<h3>Usage</h3>

<pre><code class="language-R">TFRE(
  X,
  y,
  alpha0 = 0.1,
  const_lambda = 1.01,
  times = 500,
  incomplete = TRUE,
  const_incomplete = 10,
  thresh = 1e-06,
  maxin = 100,
  maxout = 20,
  second_stage = "scad",
  a = 3.7,
  eta_list = NULL,
  const_hbic = 6
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Input matrix, of dimension n_obs x n_vars; each row is an observation vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha0</code></td>
<td>
<p>The level to estimate the tuning parameter. Default value is 0.1.
See more details in the "Details" section of <code>est_lambda</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>const_lambda</code></td>
<td>
<p>The constant to estimate the tuning parameter, should be
greater than 1. Default value is 1.01. See more details in the "Details" section
of <code>est_lambda</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>
<p>The size of simulated samples to estimate the tuning parameter.
Default value is 500.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>incomplete</code></td>
<td>
<p>Logical. If <code>incomplete = TRUE</code>, the <em>Incomplete
U-statistics</em> resampling technique would be applied; if <code>incomplete = FALSE</code>,
the complete U-statistics would be used in computation. See more details in
Clémençon, Colin and Bellet (2016).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>const_incomplete</code></td>
<td>
<p>The constant for the <em>Incomplete U-statistics</em>
resampling technique. If <code>incomplete = TRUE</code>, <code>const_incomplete</code> x n_obs
samples will be randomly selected in the coefficient estimation. Default value is 10.
See more details in Clémençon, Colin and Bellet (2016).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresh</code></td>
<td>
<p>Convergence threshold for QICD algorithm. Default value is 1e-6.
See more details in Peng and Wang (2015).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxin</code></td>
<td>
<p>Maximum number of inner coordiante descent iterations in QICD
algorithm; default is 100. See more details in Peng and Wang (2015).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxout</code></td>
<td>
<p>Maximum number of outter Majoriaztion Minimization step (MM)
iterations in QICD algorithm; default is 20. See more details in Peng and Wang (2015).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>second_stage</code></td>
<td>
<p>Penalty function for the second stage model. Character vector,
which can be "scad", "mcp" and "none". If <code>second_stage = "scad"</code>, the TFRE
SCAD regression would be fitted; if <code>second_stage = "mcp"</code>, the TFRE MCP
regression would be fitted; if <code>scad = "none"</code>, only the TFRE Lasso regression
outputs would be returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>an unknown parameter in SCAD and MCP penalty functions. The default
value is 3.7, suggested by Fan and Li (2001).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta_list</code></td>
<td>
<p>A numerical vector for the tuning parameters to be used in the
TFRE SCAD or MCP regression. Cannot be <code>NULL</code> if <code>second_stage = "scad"</code>
or <code>"mcp"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>const_hbic</code></td>
<td>
<p>The constant to be used in calculating HBIC in the TFRE SCAD
regression. Default value is 6. See more details in "Details".</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Wang <em>et al.</em> (2020) proposed the TFRE Lasso estimator for high-dimensional
linear regressions with heavy-tailed errors as below:
</p>
<p style="text-align: center;"><code class="reqn">\widehat{\bm{\beta}}(\lambda^*) = \arg\min_{\bm{\beta}}\frac{1}{n(n-1)}{\sum\sum}_{i\neq j}\left|(Y_i-\bm{x}_i^T\bm{\beta})-(Y_j-\bm{x}_j^T\bm{\beta})\right| + \lambda^*\sum_{k=1}^p|\beta_k|,</code>
</p>

<p>where <code class="reqn">\lambda^*</code> is the tuning parameter estimated by <code>est_lambda</code>.
The TFRE Lasso model is fitted by QICD algorithm proposed in Peng and Wang (2015).
To overcome the computational barrier arising from the U-statistics structure of
the aforementioned loss function, we apply the <em>Incomplete U-statistics</em>
resampling technique which was first proposed in Clémençon, Colin and Bellet (2016).<br>
Wang <em>et al.</em> (2020) also proposed a second-stage enhancement by using the
TFRE Lasso estimator <code class="reqn">\widehat{\bm{\beta}}(\lambda^*)</code> as an initial estimator.
It is defined as:
</p>
<p style="text-align: center;"><code class="reqn">\widetilde{\bm{\beta}}^{(1)} = \arg\min_{\bm{\beta}}\frac{1}{n(n-1)}{\sum\sum}_{i\neq j}\left|(Y_i-\bm{x}_i^T\bm{\beta})-(Y_j-\bm{x}_j^T\bm{\beta})\right| + \sum_{k=1}^pp_{\eta}'(|\widehat{\beta}_k(\lambda^*)|)|\beta_k|,</code>
</p>

<p>where <code class="reqn">p'_{\eta}(\cdot)</code> denotes the derivative of some nonconvex penalty
function <code class="reqn">p_{\eta}(\cdot)</code>, <code class="reqn">\eta &gt; 0</code> is a tuning parameter. This
function implements the second-stage enhancement with two popular nonconvex
penalty functions: SCAD and MCP. The modified high-dimensional BIC criterion
in Wang <em>et al.</em> (2020) is employed for selecting <code class="reqn">\eta</code>. Define:
</p>
<p style="text-align: center;"><code class="reqn">HBIC(\eta) = \log\left\{{\sum\sum}_{i\neq j}\left|(Y_i-\bm{x}_i^T\widetilde{\bm{\beta}}_{\eta})-(Y_j-\bm{x}_j^T\widetilde{\bm{\beta}}_{\eta})\right|\right\} + |A_\eta|\frac{\log\log n}{n* const\_hbic}\log p,</code>
</p>

<p>where <code class="reqn">\widetilde{\bm{\beta}}_{\eta}</code> denotes the second-stage estimator with
the tuning parameter value <code class="reqn">\eta</code>, and <code class="reqn">|A_\eta|</code> denotes the cardinality
of the index set of the selected model. This function selects the value of <code class="reqn">\eta</code>
that minimizes HBIC(<code class="reqn">\eta</code>).
</p>


<h3>Value</h3>

<p>An object of class "TFRE", which is a list containing at least the
following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>The input matrix used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The response variable used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>incomplete</code></td>
<td>
<p>Logical. <code>TRUE</code> if the <em>Incomplete U-statistics</em>
resampling technique is applied, and <code>FALSE</code> if not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_TFRE_Lasso</code></td>
<td>
<p>The estimated coefficient vector of the TFRE Lasso regression.
The first element is the estimated intercept.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tfre_lambda</code></td>
<td>
<p>The estimated tuning parameter of the TFRE Lasso regression.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>second_stage</code></td>
<td>
<p>Character vector, <code>"scad"</code> if the TFRE SCAD regression
is fitted,  <code>"mcp"</code> if the TFRE MCP regression is fitted, <code>"none"</code> if
only the TFRE Lasso regression is fitted.</p>
</td>
</tr>
</table>
<p>If <code>second_stage = "scad"</code>, then the fitted TFRE object will also contain
an object named as "TFRE_scad", which is a list containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Beta_TFRE_scad</code></td>
<td>
<p>The estimated coefficient matrix of the TFRE SCAD regression.
The diminsion is n_eta x (p+1) with the first column to be the intercepts,
where n_eta is the length of <code>eta_list</code> vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df_TFRE_scad</code></td>
<td>
<p>The number of nonzero coefficients (intercept excluded) for
each value in <code>eta_list</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta_list</code></td>
<td>
<p>The tuning parameter vector used in the TFRE SCAD regressions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hbic</code></td>
<td>
<p>A numerical vector of HBIC values for the TFRE SCAD model corresponding
to each value in <code>eta_list</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta_min</code></td>
<td>
<p>The eta value which yields the smallest HBIC value in the TFRE
SCAD regression.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Beta_TFRE_scad_min</code></td>
<td>
<p>The estimated coefficient vector which employs <code>eta_min</code>
as the eta value in the TFRE SCAD regression.</p>
</td>
</tr>
</table>
<p>If <code>second_stage = "mcp"</code>, then the fitted TFRE object will also contain
an object named as "TFRE_mcp", which is a list containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Beta_TFRE_mcp</code></td>
<td>
<p>The estimated coefficient matrix of the TFRE MCP regression.
The diminsion is n_eta x (p+1) with the first column to be the intercepts,
where n_eta is the length of <code>eta_list</code> vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df_TFRE_mcp</code></td>
<td>
<p>The number of nonzero coefficients (intercept excluded) for
each value in <code>eta_list</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta_list</code></td>
<td>
<p>The tuning parameter vector used in the TFRE MCP regressions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hbic</code></td>
<td>
<p>A numerical vector of HBIC values for the TFRE MCP model corresponding
to each value in <code>eta_list</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta_min</code></td>
<td>
<p>The eta value which yields the smallest HBIC value in the TFRE
MCP regression.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Beta_TFRE_mcp_min</code></td>
<td>
<p>The estimated coefficient vector which employs <code>eta_min</code>
as the eta value in the TFRE MCP regression.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Yunan Wu and Lan Wang<br> Maintainer:
Yunan Wu &lt;yunan.wu@utdallas.edu&gt;
</p>


<h3>References</h3>

<p>Wang, L., Peng, B., Bradic, J., Li, R. and Wu, Y. (2020),
<em>A Tuning-free Robust and Efficient Approach to High-dimensional Regression,
Journal of the American Statistical Association, 115:532, 1700-1714</em>,
<a href="https://doi.org/10.1080/01621459.2020.1840989">doi:10.1080/01621459.2020.1840989</a>.<br>
Peng, B. and Wang, L. (2015),
<em>An Iterative Coordinate Descent Algorithm for High-Dimensional Nonconvex
Penalized Quantile Regression, Journal of Computational and Graphical Statistics,
24:3, 676-694</em>, <a href="https://doi.org/10.1080/10618600.2014.913516">doi:10.1080/10618600.2014.913516</a>. <br>
Clémençon, S., Colin, I., and Bellet, A. (2016),
<em>Scaling-up empirical risk minimization: optimization of incomplete u-statistics.
The Journal of Machine Learning Research, 17(1):2682–2717</em>. <br>
Fan, J. and Li, R. (2001),
<em>Variable Selection via Nonconcave Penalized Likelihood and its Oracle
Properties, Journal of the American Statistical Association, 96:456, 1348-1360</em>,
<a href="https://doi.org/10.1198/016214501753382273">doi:10.1198/016214501753382273</a>.
</p>


<h3>See Also</h3>

<p><code>predict.TFRE</code>, <code>coef.TFRE</code>, <code>plot.TFRE</code>, <code>est_lambda</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">n &lt;- 20; p &lt;- 50
beta0 &lt;- c(1.5,-1.25,1,-0.75,0.5,rep(0,p-5))
eta_list &lt;- 0.1*6:15*sqrt(log(p)/n)
X &lt;- matrix(rnorm(n*p),n)
y &lt;- X %*% beta0 + rt(n,4)


Obj_TFRE_Lasso &lt;- TFRE(X, y, second_stage = "none", const_incomplete = 5)
Obj_TFRE_Lasso$beta_TFRE_Lasso[1:10]

Obj_TFRE_SCAD &lt;- TFRE(X, y, eta_list = eta_list, const_incomplete = 5)
Obj_TFRE_SCAD$TFRE_scad$hbic
Obj_TFRE_SCAD$TFRE_scad$df_TFRE_scad
Obj_TFRE_SCAD$TFRE_scad$Beta_TFRE_scad_min[1:10]


Obj_TFRE_MCP &lt;- TFRE(X, y, second_stage = "mcp", eta_list = eta_list, const_incomplete = 5)
Obj_TFRE_MCP$TFRE_mcp$hbic
Obj_TFRE_MCP$TFRE_mcp$df_TFRE_mcp
Obj_TFRE_MCP$TFRE_mcp$Beta_TFRE_mcp_min[1:10]

</code></pre>


</div>