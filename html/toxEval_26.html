<div class="container">

<table style="width: 100%;"><tr>
<td>plot_tox_stacks</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot stacked bar charts</h2>

<h3>Description</h3>

<p>The <code>plot_tox_stacks</code> function creates a set of boxplots representing EAR
values computed with the <code>get_chemical_summary</code> function, and
dependent on the choice of several input options. See "Summarizing the data"
in the Introduction vignette: <a href="../doc/Introduction.html#summarize_data"><code>vignette("Introduction", package = "toxEval")</code></a>
for a description on how the EAR values are computed, aggregated, and summarized.
Choosing "Chemical Class" in the category argument will generate separate stacked
bars for each unique class. "Chemical" will generate stacked bars for each individual
chemical, and "Biological" will generate stacked bars for each group in the selected
ToxCast annotation. The legend can optionally be turned on or off using the
include_legend argument. It may be impractical for instance to show the
legend for "Chemical" if there are hundreds of chemicals.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_tox_stacks(
  chemical_summary,
  chem_site,
  category = "Biological",
  mean_logic = FALSE,
  sum_logic = TRUE,
  manual_remove = NULL,
  include_legend = TRUE,
  font_size = NA,
  title = NA,
  y_label = NA,
  top_num = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>chemical_summary</code></td>
<td>
<p>Data frame from <code>get_chemical_summary</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chem_site</code></td>
<td>
<p>Data frame with at least columns SiteID, site_grouping, and Short Name.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>category</code></td>
<td>
<p>Character. Either "Biological", "Chemical Class", or "Chemical".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean_logic</code></td>
<td>
<p>Logical. <code>TRUE</code> displays the mean sample from each site,
<code>FALSE</code> displays the maximum sample from each site.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sum_logic</code></td>
<td>
<p>Logical. <code>TRUE</code> sums the EARs in a specified grouping,
<code>FALSE</code> does not. <code>FALSE</code> may be better for traditional benchmarks as
opposed to ToxCast benchmarks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>manual_remove</code></td>
<td>
<p>Vector of categories to remove.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include_legend</code></td>
<td>
<p>Logical. Used to include legend or not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>font_size</code></td>
<td>
<p>Numeric value to adjust the axis font size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>Character title for plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_label</code></td>
<td>
<p>Character for x label. Default is NA which produces an automatic label.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>top_num</code></td>
<td>
<p>Integer number to include in the graph. If NA, all
data will be included.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The graph displays a slightly different result for a single site. Providing
data with only one site displays each individual sample as a stacked bar
rather than the mean or maximum for a site.
</p>
<p>This is a function where it may be ideal to create a custom order to the sites
(for example, west-to-east). See the above section "Custom configuration"
<a href="../doc/Introduction.html#custom_config"><code>vignette("Introduction", package = "toxEval")</code></a> for instructions on how to convert
the character vector sites to a factor with ordered levels.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># This is the example workflow:
path_to_tox &lt;- system.file("extdata", package = "toxEval")
file_name &lt;- "OWC_data_fromSup.xlsx"

full_path &lt;- file.path(path_to_tox, file_name)

tox_list &lt;- create_toxEval(full_path)

ACC &lt;- get_ACC(tox_list$chem_info$CAS)
ACC &lt;- remove_flags(ACC)

cleaned_ep &lt;- clean_endPoint_info(end_point_info)
filtered_ep &lt;- filter_groups(cleaned_ep)
chemical_summary &lt;- get_chemical_summary(tox_list, ACC, filtered_ep)

plot_tox_stacks(chemical_summary, tox_list$chem_site, "Biological")


plot_tox_stacks(chemical_summary, tox_list$chem_site, "Chemical Class")
plot_tox_stacks(chemical_summary, tox_list$chem_site, "Chemical", include_legend = FALSE)
plot_tox_stacks(chemical_summary, tox_list$chem_site, "Chemical", top_num = 5, y_label = "EAR")

single_site &lt;- dplyr::filter(chemical_summary, site == "USGS-04024000")
plot_tox_stacks(single_site, tox_list$chem_site, "Chemical", top_num = 5)
plot_tox_stacks(single_site,
  chem_site = tox_list$chem_site,
  category = "Chemical", top_num = 5, y_label = "EAR"
)

</code></pre>


</div>