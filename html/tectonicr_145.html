<div class="container">

<table style="width: 100%;"><tr>
<td>rolling_test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Apply Rolling Functions using Circular Statistical Tests for Uniformity</h2>

<h3>Description</h3>

<p>A generic function for applying a function to rolling margins of an array.
</p>


<h3>Usage</h3>

<pre><code class="language-R">roll_normchisq(
  obs,
  prd,
  unc = NULL,
  width = NULL,
  by.column = FALSE,
  partial = TRUE,
  fill = NA,
  ...
)

roll_rayleigh(
  obs,
  prd,
  unc = NULL,
  width = NULL,
  by.column = FALSE,
  partial = TRUE,
  fill = NA,
  ...
)

roll_dispersion(
  x,
  y,
  w = NULL,
  w.y = NULL,
  width = NULL,
  by.column = FALSE,
  partial = TRUE,
  fill = NA,
  ...
)

roll_confidence(
  x,
  conf.level = 0.95,
  w = NULL,
  axial = TRUE,
  width = NULL,
  by.column = FALSE,
  partial = TRUE,
  fill = NA,
  ...
)

roll_dispersion_CI(
  x,
  y,
  w = NULL,
  w.y = NULL,
  R,
  conf.level = 0.95,
  width = NULL,
  by.column = FALSE,
  partial = TRUE,
  fill = NA,
  ...
)

roll_dispersion_sde(
  x,
  y,
  w = NULL,
  w.y = NULL,
  R,
  conf.level = 0.95,
  width = NULL,
  by.column = FALSE,
  partial = TRUE,
  fill = NA,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obs</code></td>
<td>
<p>Numeric vector containing the observed azimuth of
<code class="reqn">\sigma_{Hmax}</code>,
same length as <code>prd</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prd</code></td>
<td>
<p>Numeric vector containing the modeled azimuths of
<code class="reqn">\sigma_{Hmax}</code>, i.e.
the return object from <code>model_shmax()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unc</code></td>
<td>
<p>Uncertainty of observed <code class="reqn">\sigma_{Hmax}</code>, either a
numeric vector or a number</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>integer specifying the window width (in numbers of observations)
which is aligned to the original sample according to the <code>align</code> argument.
If <code>NULL</code>, an optimal width is estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by.column</code></td>
<td>
<p>logical. If <code>TRUE</code>, FUN is applied to each column
separately.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>partial</code></td>
<td>
<p>logical or numeric. If <code>FALSE</code> then <code>FUN</code> is only
applied when all indexes of the rolling window are within the observed time
range. If <code>TRUE</code> (default), then the subset of indexes that are in range
are passed to <code>FUN</code>. A numeric argument to partial can be used to determine
the minimal window size for partial computations. See below for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fill</code></td>
<td>
<p>a three-component vector or list (recycled otherwise) providing
filling values at the left/within/to the right of the data range. See the
fill argument of <code>zoo::na.fill()</code> for details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments passed to <code>zoo::rollapply()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p>numeric. Directions in degrees</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w, w.y</code></td>
<td>
<p>(optional) Weights of <code>x</code> and <code>y</code>, respectively. A vector of
positive numbers and of the same length as <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>Level of confidence: <code class="reqn">(1 - \alpha \%)/100</code>.
(<code>0.95</code> by default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axial</code></td>
<td>
<p>logical. Whether the data are axial, i.e. pi-periodical
(<code>TRUE</code>, the default) or directional, i.e. <code class="reqn">2 \pi</code>-periodical (<code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>The number of bootstrap replicates.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>numeric vector with the test statistic of the rolling test.
<code>roll_dispersion_CI</code> returns a 2-column matrix with the lower and the upper
confidence limits
</p>


<h3>Note</h3>

<p>If the rolling functions are applied to values that are a function of
distance it is recommended to sort the values first.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("plates")
plate_boundary &lt;- subset(plates, plates$pair == "na-pa")
data("san_andreas")
PoR &lt;- subset(nuvel1, nuvel1$plate.rot == "na")
distance &lt;- distance_from_pb(
  x = san_andreas,
  PoR = PoR,
  pb = plate_boundary,
  tangential = TRUE
)
dat &lt;- san_andreas[order(distance), ]
dat.PoR &lt;- PoR_shmax(san_andreas, PoR, "right")
roll_normchisq(dat.PoR$azi.PoR, 135, dat$unc)
roll_rayleigh(dat.PoR$azi.PoR, prd = 135, unc = dat$unc)
roll_dispersion(dat.PoR$azi.PoR, y = 135, w = 1 / dat$unc)
roll_confidence(dat.PoR$azi.PoR, w = 1 / dat$unc)

roll_dispersion_CI(dat.PoR$azi.PoR, y = 135, w = 1 / dat$unc, R = 10)

</code></pre>


</div>