<div class="container">

<table style="width: 100%;"><tr>
<td>post_hocRM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Power analysis of tests of invariance of item parameters between two groups of persons in binary Rasch model</h2>

<h3>Description</h3>

<p>Returns post hoc power of Wald (W), likelihood ratio (LR), Rao score (RS)
and gradient (GR) test given data and probability of error of first kind <code class="reqn">\alpha</code>.
The hypothesis to be tested assumes equal item parameters  between two predetermined groups
of persons. The alternative states that at least one of the parameters differs between the two
groups.
</p>


<h3>Usage</h3>

<pre><code class="language-R">post_hocRM(data, x, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Binary data matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A numeric vector of length equal to number of persons containing zeros and ones indicating group membership of the persons.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Probability of error of first kind.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The power of the tests (Wald, LR, score, and gradient) is determined from the assumption that the
approximate distributions of the four test statistics are from the family of noncentral <code class="reqn">\chi^2</code>
distributions with <code class="reqn">df</code> equal to the number of items minus 1 and noncentrality parameter <code class="reqn">\lambda</code>. In case
of evaluating the post hoc power, <code class="reqn">\lambda</code> is assumed to be given by the observed value of the test statistic.
Given the probability of the error of the first kind <code class="reqn">\alpha</code> the post hoc power of the tests can be
determined from <code class="reqn">\lambda</code>. More details about the distributions of the test statistics and the relationship
between <code class="reqn">\lambda</code>, power, and sample size can be found in Draxler and Alexandrowicz (2015).
</p>
<p>In particular, let <code class="reqn">q_{\alpha}</code> be the <code class="reqn">1- \alpha</code> quantile of the central <code class="reqn">\chi^2</code> distribution
with df equal to the number of items minus 1. Then,
</p>
<p style="text-align: center;"><code class="reqn">power = 1 - F_{df, \lambda} (q_{\alpha}),</code>
</p>

<p>where <code class="reqn">F_{df, \lambda}</code> is the cumulative distribution function of the noncentral <code class="reqn">\chi^2</code> distribution
with <code class="reqn">df</code> equal to the number of items reduced by 1 and <code class="reqn">\lambda</code> equal to the observed value of the test statistic.
</p>


<h3>Value</h3>

<p>A list of results.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>A numeric vector of Wald (W), likelihood ratio (LR), Rao score (RS), and gradient (GR) test statistics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>Post hoc power value for each test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>global deviation</code></td>
<td>
<p>Observed global deviation from hypothesis to be tested represented by a single number.
It is obtained by dividing the test statistic by the informative sample size. The latter does not include persons
with minimum or maximum person score. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>local deviation</code></td>
<td>
<p>CML estimates of free item parameters in both groups of persons (first item parameter set
to 0 in both groups) representing observed deviation from hypothesis to be tested locally per item.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>person score distribution in group 1</code></td>
<td>
<p>Relative frequencies of person scores in group 1. Uninformative scores,
i.e., minimum and maximum score, are omitted. Note that the person score distribution does also have an influence on
the power of the tests.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>person score distribution in group 2</code></td>
<td>
<p>Relative frequencies of person scores in group 2. Uninformative scores,
i.e., minimum and maximum score, are omitted. Note that the person score distribution does also have an influence on
the power of the tests.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degrees of freedom</code></td>
<td>
<p>Degrees of freedom <code class="reqn">df</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noncentrality parameter</code></td>
<td>
<p>Noncentrality parameter <code class="reqn">\lambda</code> of <code class="reqn">\chi^2</code> distribution from which power is determined.
It equals observed value of test statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The matched call.</p>
</td>
</tr>
</table>
<h3>References</h3>


<p>Draxler, C. (2010). Sample Size Determination for Rasch Model Tests. Psychometrika, 75(4), 708–724.
</p>
<p>Draxler, C., &amp; Alexandrowicz, R. W. (2015). Sample Size Determination Within the Scope of Conditional Maximum Likelihood Estimation
with Special Focus on Testing the Rasch Model. Psychometrika, 80(4), 897–919.
</p>
<p>Draxler, C., Kurz, A., &amp; Lemonte, A. J. (2020). The Gradient Test and its Finite Sample Size Properties in a Conditional Maximum Likelihood
and Psychometric Modeling Context. Communications in Statistics-Simulation and Computation, 1-19.
</p>
<p>Glas, C. A. W., &amp; Verhelst, N. D. (1995a). Testing the Rasch Model. In G. H. Fischer &amp; I. W. Molenaar (Eds.),
Rasch Models: Foundations, Recent Developments, and Applications (pp. 69–95). New York: Springer.
</p>
<p>Glas, C. A. W., &amp; Verhelst, N. D. (1995b). Tests of Fit for Polytomous Rasch Models. In G. H. Fischer &amp; I. W. Molenaar (Eds.),
Rasch Models: Foundations, Recent Developments, and Applications (pp. 325-352). New York: Springer.
</p>



<h3>See Also</h3>

<p><code>sa_sizeRM</code>, and <code>powerRM</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Numerical example for post hoc power analysis for Rasch Model

y &lt;- eRm::raschdat1
n &lt;- nrow(y) # sample size
x &lt;- c( rep(0,n/2), rep(1,n/2) ) # binary covariate

res &lt;-  post_hocRM(data = y, x = x, alpha = 0.05)

# &gt; res
# $test
#      W     LR     RS     GR
# 29.241 29.981 29.937 30.238
#
# $power
#     W    LR    RS    GR
# 0.890 0.900 0.899 0.903
#
# $`observed global deviation`
#     W    LR    RS    GR
# 0.292 0.300 0.299 0.302
#
# $`observed local deviation`
#           I2    I3    I4    I5    I6    I7    I8    I9   I10   I11
# group1 1.039 0.693 2.790 2.404 1.129 1.039 0.864 1.039 2.790 2.244
# group2 2.006 0.945 2.006 3.157 1.834 0.690 0.822 1.061 2.689 2.260
#          I12   I13   I14   I15   I16   I17   I18   I19   I20   I21
# group1 1.412 3.777 3.038 1.315 2.244 1.039 1.221 2.404 0.608 0.608
# group2 0.945 2.962 4.009 1.171 2.175 1.472 2.091 2.344 1.275 0.690
#          I22   I23   I24   I25   I26   I27   I28   I29   I30
# group1 0.438 0.608 1.617 3.038 0.438 1.617 2.100 2.583 0.864
# group2 0.822 1.275 1.565 2.175 0.207 1.746 1.746 2.260 0.822
#
# $`person score distribution in group 1`
#
#    1    2    3    4    5    6    7    8    9   10   11   12   13
# 0.02 0.02 0.02 0.06 0.02 0.10 0.10 0.06 0.10 0.12 0.08 0.12 0.12
#   14   15   16   17   18   19   20   21   22   23   24   25   26
# 0.06 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
#   27   28   29
# 0.00 0.00 0.00
#
# $`person score distribution in group 2`
#
#    1    2    3    4    5    6    7    8    9   10   11   12   13
# 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
#   14   15   16   17   18   19   20   21   22   23   24   25   26
# 0.08 0.12 0.10 0.16 0.06 0.04 0.10 0.12 0.08 0.02 0.02 0.02 0.08
#   27   28   29
# 0.00 0.00 0.00
#
# $`degrees of freedom`
# [1] 29
#
# $`noncentrality parameter`
#      W     LR     RS     GR
# 29.241 29.981 29.937 30.238
#
# $call
# post_hocRM(alpha = 0.05, data = y, x = x)


## End(Not run)
</code></pre>


</div>