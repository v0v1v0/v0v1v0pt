<div class="container">

<table style="width: 100%;"><tr>
<td>NIDP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Number of immediate adjacent cells flowing into each cell</h2>

<h3>Description</h3>

<p>Compute the number of immediate adjacent cells flowing into each cell
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'SpatRaster'
NIDP(x, filename="",...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>SpatRaster with flow-direction. see <code>terrain</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filename</code></td>
<td>
<p>character. Output filename</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments for writing files as in <code>writeRaster</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>NDIP is computed first to compute flow-accumulation with the algorithm by Zhou at al, 2019. 
</p>


<h3>Value</h3>

 
<p>SpatRaster
</p>


<h3>Author(s)</h3>

<p>Emanuele Cordano </p>


<h3>References</h3>

<p>Zhou, G., Wei, H. &amp; Fu, S. A fast and simple algorithm for calculating flow accumulation matrices from raster digital elevation. Front. Earth Sci. 13, 317â€“326 (2019). https://doi.org/10.1007/s11707-018-0725-9
<a href="https://link.springer.com/article/10.1007/s11707-018-0725-9">https://link.springer.com/article/10.1007/s11707-018-0725-9</a>
</p>


<h3>See Also</h3>

<p><code>flowAccumulation</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
elev1 &lt;- array(NA,c(9,9))
elev2 &lt;- elev1
dx &lt;- 1
dy &lt;- 1 
for (r in 1:nrow(elev1)) {
  y &lt;- (r-5)*dx
  for (c in 1:ncol(elev1)) {
    
    x &lt;- (c-5)*dy
    elev1[r,c] &lt;- 5*(x^2+y^2)
    elev2[r,c] &lt;- 10+5*(abs(x))-0.001*y ### 5*(x^2+y^2)
  }
} 


## Elevation Raster 
elev1 &lt;- rast(elev1)
elev2 &lt;- rast(elev2)

t(array(elev1[],rev(dim(elev1)[1:2])))
t(array(elev2[],rev(dim(elev2)[1:2])))

plot(elev1)
plot(elev2)

## Flow Direction Raster
flowdir1&lt;- terrain(elev1,v="flowdir")
flowdir2&lt;- terrain(elev2,v="flowdir")


t(array(flowdir1[],rev(dim(flowdir1)[1:2])))
t(array(flowdir2[],rev(dim(flowdir2)[1:2])))

plot(flowdir1)
plot(flowdir2)

## 
nidp1 &lt;- NIDP((flowdir1))
nidp2 &lt;- NIDP((flowdir2))

t(array(nidp1[],rev(dim(nidp1)[1:2])))
t(array(nidp2[],rev(dim(nidp2)[1:2])))

plot(nidp1)
plot(nidp2)

</code></pre>


</div>