<div class="container">

<table style="width: 100%;"><tr>
<td>tvgeom</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>tvgeom: A package for the time-varying geometric probability distribution</h2>

<h3>Description</h3>

<p>The tvgeom package provides two categories of important functions:
probability distribution functions (d, p, q, r) and moments (tvgeom_mean and
tvgeom_var).
</p>
<p>Density (<code>dtvgeom</code>), distribution function (<code>qtvgeom</code>), quantile
function (<code>ptvgeom</code>), and random number generation (<code>rtvgeom</code> and
<code>rttvgeom</code> for sampling from the <em>full</em> and <em>truncated</em>
distribution, respectively) for the time-varying, right-truncated geometric
distribution with parameter <code>prob</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dtvgeom(x, prob, log = FALSE)

ptvgeom(q, prob, lower.tail = TRUE, log.p = FALSE)

qtvgeom(p, prob, lower.tail = TRUE, log.p = FALSE)

rtvgeom(n, prob)

rttvgeom(n, prob, lower = 0, upper = length(prob) + 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, q</code></td>
<td>
<p>vector of quantiles representing the trial at which the first
success occurred.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>vector of the probability of success for each trial.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log, log.p</code></td>
<td>
<p>logical; if <code>TRUE</code>, probabilities, p, are given as
<code>log(p)</code>. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>
<p>logical; if <code>FALSE</code>, <code>ptvgeom</code> returns</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>vector of probabilities at which to evaluate the quantile function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of observations to sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>lower value (exclusive) at which to truncate the distribution
for random number generation. Defaults to <code>0</code>, in which case the
distribution is not left-truncated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>upper value (inclusive) at which to truncate the distribution
for random number generation. Defaults to <code>length(prob)</code>, in which case
the distribution is not right-truncated.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The time-varying geometric distribution describes the number of independent
Bernoulli trials needed to obtain one success. The probability of success,
<code>prob</code>, may vary for each trial. It has mass </p>
<p style="text-align: center;"><code class="reqn">p(x) = prob[x] *
prod(1 - prob[1:(x-1)])</code>
</p>
<p> with support <code class="reqn">x = 1, 2, ..., n + 1</code>,
where <code>n</code> equals then length of <code>prob</code>. For <code class="reqn">i</code> in
<code class="reqn">prob, 0 \le i \le 1</code>. The <code>n+1</code> case represents the case that the event did not
happen in the first n trials.
</p>


<h3>Value</h3>

<p>dtvgeom gives the probability mass, qtvgeom gives the
quantile functions, ptvgeom gives the distribution function, rtvgeom
generates random numbers, and rttvgeom gives random numbers from the
distribution truncated at bounds provided by the user.
<code class="reqn">P(X &gt; x)</code> instead of <code class="reqn">P(X \le x)</code>. Defaults to <code>TRUE</code>.
</p>


<h3>Package functions</h3>

<p>The tvgeom functions ...
</p>


<h3>Examples</h3>

<pre><code class="language-R"># What's the probability that a given number of trials, n, are needed to get
# one success if `prob` = `p0`, as defined below...?
p0 &lt;- .15 # the probability of success

# Axis labels (for plotting purposes, below).
x_lab &lt;- "Number of trials, n"
y_lab &lt;- sprintf("P(success at trial n | prob = %s)", p0)

# Scenario 1: the probability of success is constant and we invoke functions
# from base R's implementation of the geometric distribution.
y1 &lt;- rgeom(1e3, p0) + 1 # '+1' b/c dgeom parameterizes in terms of failures
x1 &lt;- seq_len(max(y1))
z1 &lt;- dgeom(x1 - 1, p0)
plot(table(y1) / 1e3,
  xlab = x_lab, ylab = y_lab, col = "#00000020",
  bty = "n", ylim = c(0, p0)
)
lines(x1, z1, type = "l")

# Scenario 2: the probability of success is constant, but we use tvgeom's
# implementation of the time-varying geometric distribution. For the purposes
# of this demonstration, the length of vector `prob` (`n_p0`) is chosen to be
# arbitrarily large *relative* to the distribution of n above (`y1`) to
# ensure we don't accidentally create any censored observations!
n_p0 &lt;- max(y1) * 5
p0_vec &lt;- rep(p0, n_p0)
y2 &lt;- rtvgeom(1e3, p0_vec)
x2 &lt;- seq_len(max(max(y1), max(y2)))
z2 &lt;- dtvgeom(x2, p0_vec) # dtvgeom is parameterized in terms of successes
points(x2[x2 &lt;= max(y1)], z2[x2 &lt;= max(y1)],
  col = "red", xlim = c(1, max(y1))
)

# Scenario 3: the probability of success for each process varies over time
# (e.g., chances increase linearly by `rate` for each subsequent trial until
# chances saturate at `prob` = 1).
rate &lt;- 1.5
prob_tv &lt;- numeric(n_p0)
for (i in 1:length(p0_vec)) {
  prob_tv[i] &lt;- ifelse(i == 1, p0_vec[i], rate * prob_tv[i - 1])
}
prob_tv[prob_tv &gt; 1] &lt;- 1
y3 &lt;- rtvgeom(1e3, prob_tv)
x3 &lt;- seq_len(max(y3))
z3 &lt;- dtvgeom(x3, prob_tv)
plot(table(y3) / 1e3,
  xlab = x_lab, col = "#00000020", bty = "n",
  ylim = c(0, max(z3)),
  ylab = sprintf("P(success at trial n | prob = %s)", "`prob_tv`")
)
lines(x3, z3, type = "l")
</code></pre>


</div>