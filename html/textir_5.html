<div class="container">

<table style="width: 100%;"><tr>
<td>srproj</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Multinomial Inverse Regression (MNIR)</h2>

<h3>Description</h3>

<p>Estimation of MNIR sufficient reduction projections.   Note that <code>mnlm</code> is just a call to <code>dmr</code> from the <code>distrom</code> package.
</p>


<h3>Usage</h3>

<pre><code class="language-R">srproj(obj, counts, dir=1:K, ...)
mnlm(cl, covars, counts, mu=NULL, bins=NULL, verb=0, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cl</code></td>
<td>
<p>A <code>parallel</code> library socket cluster.  See the same argument in <code>help(dmr)</code> for details. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covars</code></td>
<td>
<p>A dense <code>matrix</code> 
or sparse <code>Matrix</code> of covariates.
This should not include the intercept.  See the same argument in <code>help(dmr)</code> for details.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>counts</code></td>
<td>
<p>A dense <code>matrix</code> 
or sparse <code>Matrix</code> of
response counts (e.g., token counts in text mining). 
See the same argument in <code>help(dmr)</code> for details. For <code>srproj</code>,
this must have the same number of columns as the response dimensions (vocabulary size) in <code>obj</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>

<p>Pre-specified fixed effects for each observation in the Poisson regression linear equation.  See the same argument in <code>help(dmr)</code> for details.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bins</code></td>
<td>
<p>Number of bins into which we will attempt to collapse each column of <code>covars</code>.  <code>bins=NULL</code>
does no collapsing. See the same argument in <code>help(dmr)</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verb</code></td>
<td>
<p>Whether to print some info.  See the same argument in <code>help(dmr)</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>Either a <code>dmr</code> object, as returned from <code>mnlm</code>, or the <code>dmrcoef</code> object obtained by calling <code>coef</code> on the output of <code>mnlm</code> or <code>dmr</code>.  The latter will be faster, since <code>coef.dmr</code> is called inside <code>srproj</code> otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dir</code></td>
<td>
<p>The attribute (<code>covar</code>) dimensions onto which you want to project.  
The default is all dimensions: <code>1:K</code>, where <code>K</code> is the number of columns in the <code>covars</code> argument to mnlm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to <code>gamlr</code> from <code>dmr</code> (or <code>mnlm</code>), and to <code>coef.dmr</code> from <code>srproj</code>.  See <code>help(gamlr)</code> and <code>help(dmr)</code> for details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>These functions provide the first two steps of multinomial inverse regression (see MNIR paper).
</p>
<p><code>mnlm</code> fits multinomial logistic regression
parameters under gamma lasso penalization on a factorized Poisson likelihood.  The <code>mnlm</code> function, which remains in this package for backwards compatability only, is just call to the <code>dmr</code> function of the <code>distrom</code> library (see DMR paper).  For simplicity, we recommend using <code>dmr</code> instead of <code>mnlm</code>. For model selection, coefficients, prediction, and plotting see the relevant functions in <code>help(dmr)</code>.
</p>
<p><code>srproj</code> calculates the MNIR  Sufficient Reduction projection from text <code>counts</code> on to the attribute dimensions of interest (<code>covars</code> in <code>mnlm</code> or <code>dmr</code>).  In particular, for counts <code class="reqn">C</code>, with row sums <code class="reqn">m</code>, and <code>mnlm</code>/<code>dmr</code> coefficients <code class="reqn">\phi_j</code> corresponding to attribute <code class="reqn">j</code>,
<code class="reqn">z_j = C'\phi_j/m</code> is the SR projection in the direction of <code class="reqn">j</code>.  The MNIR paper explains how <code class="reqn">V=[v_1 ... v_K]</code>, your original covariates/attributes, are independent of text counts <code class="reqn">C</code> given SR projections <code class="reqn">Z=[z_1 ... z_K]</code>.  
</p>
<p>The final step of MNIR is ‘forward regression’ for any element of <code class="reqn">V</code> onto <code class="reqn">Z</code> and the remaining elements of <code class="reqn">V</code>.  We do not provide a function for this because you are free to use whatever you want; see the MNIR and DMR papers for linear, logistic, and random forest forward regression examples.
</p>
<p>Note that if you were previously using <code>textir</code> not for inverse regression, but rather just as fast code for multinomial logistic regression, you probably want to work directly with the <code>gamlr</code> (binary response) or <code>dmr</code> (multinomial response) packages.
</p>


<h3>Value</h3>

<p><code>srproj</code> returns a matrix with columns corresponding to directions <code>dir</code>, plus an additional column <code>m</code> holding the row totals of <code>counts</code>.
<code>mnlm</code> returns a <code>dmr</code> s3 object.  See <code>help(dmr)</code> for details.
</p>


<h3>Author(s)</h3>

<p>Matt Taddy <a href="mailto:mataddy@gmail.com">mataddy@gmail.com</a>
</p>


<h3>References</h3>

<p>Taddy (2013, JASA), <em>Multinomial Inverse Regression for Text Analysis</em> (MNIR).
</p>
<p>Taddy (2015, AoAS), <em>Distributed Multinomial Regression</em> (DMR).  
</p>
<p>Taddy (2016, JCGS), <em>The Gamma Lasso</em> (GL). 
</p>


<h3>See Also</h3>

<p>congress109, we8there, dmr
</p>


<h3>Examples</h3>

<pre><code class="language-R">
### Ripley's Cushing Data; see help(Cushings) ###
library(MASS)
data(Cushings)
Cushings[,1:2] &lt;- log(Cushings[,1:2])
train &lt;- Cushings[Cushings$Type!="u",]
newdata &lt;- as.matrix(Cushings[Cushings$Type == "u", 1:2])

## fit, coefficients, predict, and plot

# you could replace 'mnlm' with 'dmr' here.
fit &lt;- mnlm(NULL, 
  covars=train[,1:2], 
  counts=factor(train$Type))

## dmr applies corrected AICc selection by default
round(coef(fit),1) 
round(predict(fit, newdata, type="response"),1)
par(mfrow=c(1,3))
for(j in c("a","b","c")){ 
  plot(fit[[j]]); mtext(j,line=2) }

## see we8there and congress109 for MNIR and srproj examples
 
</code></pre>


</div>