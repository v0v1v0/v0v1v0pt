<div class="container">

<table style="width: 100%;"><tr>
<td>LengthAdded</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Contribution of character to leaf instability</h2>

<h3>Description</h3>

<p>Would tree lengths change if a character was coded as ambiguous for each
leaf (Pol and Escapa 2009)?
</p>


<h3>Usage</h3>

<pre><code class="language-R">LengthAdded(trees, char, concavity = Inf)

PolEscapa(trees, char, concavity = Inf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>trees</code></td>
<td>
<p>List of trees of class <code>phylo</code>, or <code>multiPhylo</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>char</code></td>
<td>
<p><code>phyDat</code> object containing a single character.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>concavity</code></td>
<td>
<p>Determines the degree to which extra steps beyond the first
are penalized.  Specify a numeric value to use implied weighting
(Goloboff 1993); <code>concavity</code> specifies <em>k</em> in
<em>k</em> / <em>e</em> + <em>k</em>. A value of 10 is recommended;
TNT sets a default of 3, but this is too low in some circumstances
(Goloboff et al. 2018; Smith 2019).
Better still explore the sensitivity of results under a range of
concavity values, e.g. <code>k = 2 ^ (1:7)</code>.
Specify <code>Inf</code> to weight each additional step equally.
Specify <code>"profile"</code> to employ profile parsimony (Faith and Trueman 2001).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>High values for a leaf indicate that its coding contributes to instability
("wildcard" or "roguish" behaviour; see
<a href="https://ms609.github.io/Rogue/"><span class="pkg">Rogue</span></a>for further details).
The coding is in tension with other data, which may indicate that the
assumptions of homology that underlie the character's construction and
scoring require careful scrutiny – or that the taxon in question has
been subject to convergent evolution.
</p>
<p>When inapplicable tokens are present in a character, the applicability of
each coding is maintained: i.e. a leaf coded with an applicable token is
never allowed to take an inapplicable value; and an inapplicable token
remains inapplicable.
</p>


<h3>Value</h3>

<p><code>LengthAdded()</code> returns a named numeric vector listing the mean
absolute change to tree length resulting if the character were coded
ambiguous for each leaf in turn, under the specified concavity constant.
</p>


<h3>Author(s)</h3>

<p><a href="https://smithlabdurham.github.io/">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>


<h3>References</h3>

<p>Faith DP, Trueman JWH (2001).
“Towards an inclusive philosophy for phylogenetic inference.”
<em>Systematic Biology</em>, <b>50</b>(3), 331–350.
<a href="https://doi.org/10.1080/10635150118627">doi:10.1080/10635150118627</a>.<br><br> Goloboff PA (1993).
“Estimating character weights during tree search.”
<em>Cladistics</em>, <b>9</b>(1), 83–91.
<a href="https://doi.org/10.1111/j.1096-0031.1993.tb00209.x">doi:10.1111/j.1096-0031.1993.tb00209.x</a>.<br><br> Goloboff PA, Torres A, Arias JS (2018).
“Weighted parsimony outperforms other methods of phylogenetic inference under models appropriate for morphology.”
<em>Cladistics</em>, <b>34</b>(4), 407–437.
<a href="https://doi.org/10.1111/cla.12205">doi:10.1111/cla.12205</a>.<br><br> Pol D, Escapa IH (2009).
“Unstable taxa in cladistic analysis: identification and the assessment of relevant characters.”
<em>Cladistics</em>, <b>25</b>(5), 515–527.
<a href="https://doi.org/10.1111/j.1096-0031.2009.00258.x">doi:10.1111/j.1096-0031.2009.00258.x</a>.<br><br> Smith MR (2019).
“Bayesian and parsimony approaches reconstruct informative trees from simulated morphological datasets.”
<em>Biology Letters</em>, <b>15</b>(2), 20180632.
<a href="https://doi.org/10.1098/rsbl.2018.0632">doi:10.1098/rsbl.2018.0632</a>.
</p>


<h3>See Also</h3>

<p>Other tree scoring: 
<code>CharacterLength()</code>,
<code>IWScore()</code>,
<code>MinimumLength()</code>,
<code>MorphyTreeLength()</code>,
<code>TaxonInfluence()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">trees &lt;- inapplicable.trees[["Vinther2008"]]
dataset &lt;- inapplicable.phyData[["Vinther2008"]]
char &lt;- dataset[, 11]
added &lt;- LengthAdded(trees, char)

PlotCharacter(
  tree = trees[[1]], 
  dataset = char,
  tip.color = 1 + added[trees[[1]]$tip.label] # Colour by added steps
) -&gt; XX # Suppress return value; display plot only

</code></pre>


</div>