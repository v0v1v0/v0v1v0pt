<div class="container">

<table style="width: 100%;"><tr>
<td>pettitt.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Pettitt's Test for Change-Point Detection</h2>

<h3>Description</h3>

<p>Performes a non-parametric test after Pettitt in order to test for a
shift in the central tendency of a time series. The H0-hypothesis,
no change, is tested against the HA-Hypothesis, change.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pettitt.test(x)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a vector of class "numeric" or a time series object of class "ts"</p>
</td>
</tr></table>
<h3>Details</h3>

<p>In this function, the test is implemented as given by Verstraeten et. al.
(2006), where the ranks <code class="reqn">r_1, \ldots, r_n</code> of
the <code class="reqn">X_i, \ldots, X_n</code> are used for the statistic:
</p>
<p style="text-align: center;"><code class="reqn">U_k = 2 \sum_{i=1}^k r_i - k \left(n + 1\right) \qquad k = 1, \ldots, n</code>
</p>

<p>The test statistic is the maximum of the absolute value of the vector:
</p>
<p style="text-align: center;"><code class="reqn">\hat{U} = \max |U_k|</code>
</p>
<p>.
</p>
<p>The probable change-point <code class="reqn">K</code> is located where <code class="reqn">\hat{U}</code> has its maximum.
The approximate probability for a two-sided test is calculated
according to 
</p>
<p style="text-align: center;"><code class="reqn">p = 2 \exp^{-6K^2 / (T^3 + T^2)}</code>
</p>



<h3>Value</h3>

<p>A list with class "htest" and "cptest"
</p>


<h3>Note</h3>

<p>The current function is for complete observations only.
The approximate probability is good for <code class="reqn">p \le 0.5</code>.
</p>


<h3>References</h3>

<p>CHR (ed., 2010), Das Abflussregime des Rheins und seiner Nebenfluesse im
20. Jahrhundert, Report no I-22 of the CHR, p. 172.
</p>
<p>Pettitt, A. N. (1979), A non-parametric approach to the change point
problem. <em>Journal of the Royal Statistical Society Series C</em>, Applied
Statistics 28, 126-135.
</p>
<p>G. Verstraeten, J. Poesen, G. Demaree, C. Salles (2006),
Long-term (105 years) variability in rain erosivity as derived from 10-min
rainfall depth data for Ukkel (Brussels, Belgium):
Implications for assessing soil erosion rates.
<em>Journal of Geophysical Research</em> 111, D22109.
</p>


<h3>See Also</h3>

<p><code>efp</code>
<code>sctest.efp</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(maxau) ; plot(maxau[,"s"])
s.res &lt;- pettitt.test(maxau[,"s"])
n &lt;- s.res$nobs
i &lt;- s.res$estimate
s.1 &lt;- mean(maxau[1:i,"s"])
s.2 &lt;- mean(maxau[(i+1):n,"s"])
s &lt;- ts(c(rep(s.1,i), rep(s.2,(n-i))))
tsp(s) &lt;- tsp(maxau[,"s"])
lines(s, lty=2)
print(s.res)


data(PagesData) ; pettitt.test(PagesData)
 
</code></pre>


</div>