<div class="container">

<table style="width: 100%;"><tr>
<td>tfd_hidden_markov_model</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Hidden Markov model distribution</h2>

<h3>Description</h3>

<p>The <code>HiddenMarkovModel</code> distribution implements a (batch of) hidden
Markov models where the initial states, transition probabilities
and observed states are all given by user-provided distributions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tfd_hidden_markov_model(
  initial_distribution,
  transition_distribution,
  observation_distribution,
  num_steps,
  validate_args = FALSE,
  allow_nan_stats = TRUE,
  name = "HiddenMarkovModel"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>initial_distribution</code></td>
<td>
<p>A <code>Categorical</code>-like instance.
Determines probability of first hidden state in Markov chain.
The number of categories must match the number of categories of
<code>transition_distribution</code> as well as both the rightmost batch
dimension of <code>transition_distribution</code> and the rightmost batch
dimension of <code>observation_distribution</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transition_distribution</code></td>
<td>
<p>A <code>Categorical</code>-like instance.
The rightmost batch dimension indexes the probability distribution
of each hidden state conditioned on the previous hidden state.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>observation_distribution</code></td>
<td>
<p>A <code>tfp$distributions$Distribution</code>-like
instance.  The rightmost batch dimension indexes the distribution
of each observation conditioned on the corresponding hidden state.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_steps</code></td>
<td>
<p>The number of steps taken in Markov chain. An <code>integer</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>validate_args</code></td>
<td>
<p>Logical, default FALSE. When TRUE distribution parameters are checked
for validity despite possibly degrading runtime performance. When FALSE invalid inputs may
silently render incorrect outputs. Default value: FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allow_nan_stats</code></td>
<td>
<p>Logical, default TRUE. When TRUE, statistics (e.g., mean, mode, variance)
use the value NaN to indicate the result is undefined. When FALSE, an exception is raised if
one or more of the statistic's batch members are undefined.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>name prefixed to Ops created by this class.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This model assumes that the transition matrices are fixed over time.
In this model, there is a sequence of integer-valued hidden states:
<code style="white-space: pre;">⁠z[0], z[1], ..., z[num_steps - 1]⁠</code> and a sequence of observed states:
<code style="white-space: pre;">⁠x[0], ..., x[num_steps - 1]⁠</code>.
</p>
<p>The distribution of <code>z[0]</code> is given by <code>initial_distribution</code>.
The conditional probability of <code>z[i  +  1]</code> given <code>z[i]</code> is described by
the batch of distributions in <code>transition_distribution</code>.
For a batch of hidden Markov models, the coordinates before the rightmost one
of the <code>transition_distribution</code> batch correspond to indices into the hidden
Markov model batch. The rightmost coordinate of the batch is used to select
which distribution <code>z[i + 1]</code> is drawn from.  The distributions corresponding
to the probability of <code>z[i + 1]</code> conditional on <code>z[i] == k</code> is given by the
elements of the batch whose rightmost coordinate is <code>k</code>.
</p>
<p>Similarly, the conditional distribution of <code>z[i]</code> given <code>x[i]</code> is given by
the batch of <code>observation_distribution</code>.
When the rightmost coordinate of <code>observation_distribution</code> is <code>k</code> it
gives the conditional probabilities of <code>x[i]</code> given <code>z[i] == k</code>.
The probability distribution associated with the <code>HiddenMarkovModel</code>
distribution is the marginal distribution of <code style="white-space: pre;">⁠x[0],...,x[num_steps - 1]⁠</code>.
</p>


<h3>Value</h3>

<p>a distribution instance.
</p>


<h3>See Also</h3>

<p>For usage examples see e.g. <code>tfd_sample()</code>, <code>tfd_log_prob()</code>, <code>tfd_mean()</code>.
</p>
<p>Other distributions: 
<code>tfd_autoregressive()</code>,
<code>tfd_batch_reshape()</code>,
<code>tfd_bates()</code>,
<code>tfd_bernoulli()</code>,
<code>tfd_beta_binomial()</code>,
<code>tfd_beta()</code>,
<code>tfd_binomial()</code>,
<code>tfd_categorical()</code>,
<code>tfd_cauchy()</code>,
<code>tfd_chi2()</code>,
<code>tfd_chi()</code>,
<code>tfd_cholesky_lkj()</code>,
<code>tfd_continuous_bernoulli()</code>,
<code>tfd_deterministic()</code>,
<code>tfd_dirichlet_multinomial()</code>,
<code>tfd_dirichlet()</code>,
<code>tfd_empirical()</code>,
<code>tfd_exp_gamma()</code>,
<code>tfd_exp_inverse_gamma()</code>,
<code>tfd_exponential()</code>,
<code>tfd_gamma_gamma()</code>,
<code>tfd_gamma()</code>,
<code>tfd_gaussian_process_regression_model()</code>,
<code>tfd_gaussian_process()</code>,
<code>tfd_generalized_normal()</code>,
<code>tfd_geometric()</code>,
<code>tfd_gumbel()</code>,
<code>tfd_half_cauchy()</code>,
<code>tfd_half_normal()</code>,
<code>tfd_horseshoe()</code>,
<code>tfd_independent()</code>,
<code>tfd_inverse_gamma()</code>,
<code>tfd_inverse_gaussian()</code>,
<code>tfd_johnson_s_u()</code>,
<code>tfd_joint_distribution_named_auto_batched()</code>,
<code>tfd_joint_distribution_named()</code>,
<code>tfd_joint_distribution_sequential_auto_batched()</code>,
<code>tfd_joint_distribution_sequential()</code>,
<code>tfd_kumaraswamy()</code>,
<code>tfd_laplace()</code>,
<code>tfd_linear_gaussian_state_space_model()</code>,
<code>tfd_lkj()</code>,
<code>tfd_log_logistic()</code>,
<code>tfd_log_normal()</code>,
<code>tfd_logistic()</code>,
<code>tfd_mixture_same_family()</code>,
<code>tfd_mixture()</code>,
<code>tfd_multinomial()</code>,
<code>tfd_multivariate_normal_diag_plus_low_rank()</code>,
<code>tfd_multivariate_normal_diag()</code>,
<code>tfd_multivariate_normal_full_covariance()</code>,
<code>tfd_multivariate_normal_linear_operator()</code>,
<code>tfd_multivariate_normal_tri_l()</code>,
<code>tfd_multivariate_student_t_linear_operator()</code>,
<code>tfd_negative_binomial()</code>,
<code>tfd_normal()</code>,
<code>tfd_one_hot_categorical()</code>,
<code>tfd_pareto()</code>,
<code>tfd_pixel_cnn()</code>,
<code>tfd_poisson_log_normal_quadrature_compound()</code>,
<code>tfd_poisson()</code>,
<code>tfd_power_spherical()</code>,
<code>tfd_probit_bernoulli()</code>,
<code>tfd_quantized()</code>,
<code>tfd_relaxed_bernoulli()</code>,
<code>tfd_relaxed_one_hot_categorical()</code>,
<code>tfd_sample_distribution()</code>,
<code>tfd_sinh_arcsinh()</code>,
<code>tfd_skellam()</code>,
<code>tfd_spherical_uniform()</code>,
<code>tfd_student_t_process()</code>,
<code>tfd_student_t()</code>,
<code>tfd_transformed_distribution()</code>,
<code>tfd_triangular()</code>,
<code>tfd_truncated_cauchy()</code>,
<code>tfd_truncated_normal()</code>,
<code>tfd_uniform()</code>,
<code>tfd_variational_gaussian_process()</code>,
<code>tfd_vector_diffeomixture()</code>,
<code>tfd_vector_exponential_diag()</code>,
<code>tfd_vector_exponential_linear_operator()</code>,
<code>tfd_vector_laplace_diag()</code>,
<code>tfd_vector_laplace_linear_operator()</code>,
<code>tfd_vector_sinh_arcsinh_diag()</code>,
<code>tfd_von_mises_fisher()</code>,
<code>tfd_von_mises()</code>,
<code>tfd_weibull()</code>,
<code>tfd_wishart_linear_operator()</code>,
<code>tfd_wishart_tri_l()</code>,
<code>tfd_wishart()</code>,
<code>tfd_zipf()</code>
</p>


</div>