<div class="container">

<table style="width: 100%;"><tr>
<td>Ts.estim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Two-Step Estimator</h2>

<h3>Description</h3>

<p>Function that computes the two-step estimator proposed in Craiu et al.
(2011) and its <code>print</code> method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Ts.estim(formula, data, random, all.m.1 = FALSE, D = "UN(1)",
  itermax = 2000, tole = 1e-06)

## S3 method for class 'Ts.estim'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A formula object, with the response on the left of a <code>~</code> operator, 
and the covariates on the right. The right hand side of the model must also 
include two special terms: a <code>strata</code> and a <code>cluster</code> term 
(ex. <code>formula = Y ~ X1 + X2 + X3 + strata(var_strata) + cluster(var_cluster)</code>).
The <code>strata</code> and <code>cluster</code> functions (from the package <span class="pkg">survival</span>) are
used to identify the stratification and the cluster variables, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame (or object coercible by as.data.frame to a data frame) containing the 
variables in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random</code></td>
<td>
<p>A formula object, with a blank on the left of a <code>~</code> operator, 
and, on the right, the covariates with random coefficients among the 
covariate listed in the model <code>formula</code> (ex. <code>random = ~ X1 + X3</code>).
The default is to add random coefficients for every covariates listed in 
the model <code>formula</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>all.m.1</code></td>
<td>
<p><code>TRUE</code> if sum of Y's in all strata is 1, <code>FALSE</code> otherwise 
(the default). When in doubt use <code>FALSE</code> (always works, but slower than
necessary if all stratum sums are 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>The form of the between-cluster variance-covariance matrix of the regression 
coefficients (matrix D) : either <code>"UN"</code> for unstructured matrix D or <code>"UN(1)"</code> 
(the default) for diagonal matrix D.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>itermax</code></td>
<td>
<p>maximal number of EM iterations (default = 2000)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tole</code></td>
<td>
<p>maximal distance between successive EM iterations tolerated
before declaring convergence (default = 0.000001)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object, produced by the <code>Ts.estim</code> function, to print.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed to <code>print.default</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Calls <code>coxph</code> from the package <span class="pkg">survival</span>.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p> A vector: the regression coefficients. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p> A vector: the regression coefficients' standard errors. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcov</code></td>
<td>
<p> A matrix: the variance-covariance matrix of the regression coefficients. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p> A matrix: estimate of the between-cluster variance-covariance matrix of the regression coefficients (matrix D).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r.effect</code></td>
<td>
<p> The random effect estimates. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coxph.warn</code></td>
<td>
<p> A list of character string vectors. If the <code>coxph</code> 
function generates one or more warnings when fitting the Cox
model to a cluster, a copy of these warnings are stored in 
<code>coxph.warn$Cluster_name</code> where <code>Cluster_name</code> is 
the identification value for the cluster in the data set. 
A <code>NULL</code> list element means that <code>coxph</code> did not 
produce any warnings for that cluster. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Call</code></td>
<td>
<p> The function call.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Radu V. Craiu, Thierry Duchesne, Daniel Fortin and Sophie Baillargeon
</p>


<h3>References</h3>

<p>Craiu, R.V., Duchesne, T., Fortin, D. and Baillargeon, S.
(2011), Conditional Logistic Regression with Longitudinal Follow-up and
Individual-Level Random Coefficients: A Stable and Efficient Two-Step
Estimation Method, <em>Journal of Computational and Graphical Statistics</em>. 
<b>20</b>(3), 767-784.
</p>


<h3>See Also</h3>

<p><code>ddim</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Two ways for specifying the same model
# Data: bison
# Model: covariates forest, biomass and pmeadow
# Random effects in front of forest and biomass
# Main diagonal covariance structure for D (the default)
way1 &lt;- Ts.estim(formula = Y ~ forest  + biomass + pmeadow + 
        strata(Strata) + cluster(Cluster), data = bison, 
        random = ~ forest + biomass)
way1
way2 &lt;- Ts.estim(formula = bison[,3] ~ as.matrix(bison[,c(6,8:9)]) + 
        strata(bison[,2]) + cluster(bison[,1]), data = bison, 
        random = ~ as.matrix(bison[,c(6,8)]))
way2

# Unstructured covariance for D
Fit &lt;- Ts.estim(formula = Y ~ forest  + biomass + pmeadow + 
        strata(Strata) + cluster(Cluster), data = bison, 
        random = ~ forest + biomass, D="UN")
Fit
</code></pre>


</div>