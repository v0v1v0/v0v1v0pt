<div class="container">

<table style="width: 100%;"><tr>
<td>logLik.tramME</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Get the log-likelihood of the tramME model</h2>

<h3>Description</h3>

<p>Evaluates the log-likelihood function. New parameter values and data can
optionally be supplied. In the latter case, the function returns the
out-of-sample log-likelihood.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'tramME'
logLik(
  object,
  param = NULL,
  newdata = NULL,
  type = c("integrated", "fix_smooth", "penalized"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A <code>tramME</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>An optional named list of parameter values (beta and theta).
See details.  Optionally, gamma elements can also be added, which leads to
'fixing' those random effects terms at the supplied values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>An optional data.frame to calculate the out-of-sample
log-likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>The type of the likelihood to be calculated:
</p>

<ul>
<li>
<p> integrated (default when <code>newdata = NULL</code>): The marginal
log-likelihood, calculated by integrating out the random effects.
</p>
</li>
<li>
<p> fix_smooth (default when <code>newdata</code> is supplied): Treating the
penalized parameters of the smooth terms as fixed at their
posterior mode predictions and only integrating out the 'true'
random effects. (Consistent with the functionality of
<code>ranef.tramME</code> and
<code>residuals.tramME</code> when
<code>fix_smooth = TRUE</code>.)
</p>
</li>
<li>
<p> penalized: Treat all parameters as fixed, return the penalized
log-likelihood (conditional log-likelihood + penalty for smooth
terms and random effects). This is equivalent to fixing all random
effect values.
</p>
</li>
</ul>
<p>See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Optional argument (for consistency with generic).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>By default, <code>param</code> is set to the estimated (or previously set)
parameters. If the parameter vectors in the model are incomplete (contain
<code>NA</code> elemets), the returned log-likelihood will also be <code>NA</code>,
unless the user provides new values.
</p>
<p>Setting <code>type = "fix_smooth"</code> fixes the random effects terms that
correspond to penalized smooths at their estimated values, so that they
are not refitted when <code>newdata</code> is supplied. This is consistent with
treating these parameter regularized fixed terms, i.e. as 'new-style'
random effects described by Hodges (2014, Chapter 13).
</p>
<p>The <code>"fix_smooth"</code> and <code>"penalized"</code> options for <code>type</code> are
just for convenience.  The same functionality can be achieved by setting
<code>param$gamma</code> to the desired values.  <code>"penalized"</code> respects the
values of <code>param$gamma</code> if both are supplied, while
<code>"fix_smooth"</code> overwrites them with the fitted values if there are
ambiguities.
</p>


<h3>Value</h3>

<p>A numeric value of the log-likelihood.
</p>


<h3>Type of the log-likelihood</h3>

<p>By default, <code>logLik</code> calculates the _integrated_ (or marginal)
log-likelihood by integrating over the random effects. By fixing the
random effects, the value of the log-likelihood changes, because TMB won't
integrate over these random effects.  This will result in the _penalized_
log-likelihood (conditional log-likelihood + penalty for smooth terms and
random effects, see example).
</p>
<p>By setting <code>type = "penalized"</code>, the function will 'fix' all random
effects and penalized parameters of the smooth terms at their predicted
levels, and calcualte the penalized log-likelihood. In this sense, setting
<code>type = "fix_smooth"</code> will result in a hybrid log-likelihood value,
where the 'true' random effects (c.f.  Hodges 2014, Ch. 13) are integrated
out, while it includes the penalty values for the penalized parameters of
the smooths terms.
</p>
<p>In general, it is not clear which type of log-likelihood we should calculate
when we want to evaluate models based on their out-of-sample
log-likelihood values.  The context and the model setup are key in these
cases. Please make sure you know what you want to calculate to avoid
misunderstandings.
</p>


<h3>References</h3>

<p>Hodges, James S. (2014). Richly Parameterized Linear Models: Additive, Time
Series, and Spatial Models Using Random Effects. Chapman &amp; Hall/CRC Texts
in Statistical Science Series.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data("sleepstudy", package = "lme4")
fit &lt;- LmME(Reaction ~ Days + (Days | Subject), data = sleepstudy)
logLik(fit)

data("mcycle", package = "MASS")
fit &lt;- LmME(accel ~ s(times), data = mcycle)
logLik(fit) &lt; logLik(fit, type = "penalized")

</code></pre>


</div>