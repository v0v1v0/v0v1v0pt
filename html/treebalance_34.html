<div class="container">

<table style="width: 100%;"><tr>
<td>rQuartetI</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculation of the rooted quartet index for rooted trees</h2>

<h3>Description</h3>

<p>This function calculates the rooted quartet index <code class="reqn">rQI(T)</code> for a given
rooted tree <code class="reqn">T</code>. The tree must not necessarily be binary.<br><br>
Let <code class="reqn">T</code> be a rooted tree, whose leaves are <code class="reqn">1,...,n</code>. Let
<code class="reqn">P_4</code> denote the set of all subsets of <code class="reqn">\{1,...,n\}</code> that have
cardinality 4. Let <code class="reqn">T(Q)</code> denote the rooted quartet on <code class="reqn">Q\in P_4</code>
that is obtained by taking the subgraph of <code class="reqn">T</code> that is induced by
<code class="reqn">Q</code> and supressing its outdegree-1 vertices. <code class="reqn">T(Q)</code> can have one of
the five following shapes:<br><br>
- <code class="reqn">Q_0^*</code>: This is the caterpillar tree shape on 4 leaves, i.e.
<code>"(,(,(,)));"</code> in Newick format. It has 2 automorphisms.<br>
- <code class="reqn">Q_1^*</code>: This is the tree shape on 4 leaves that has three pending
subtrees rooted at the children of the root of <code class="reqn">T</code>, one of them being
a cherry and the other two
being single vertices, i.e. <code>"((,),,);"</code> in Newick format. It has 4
automorphisms.<br>
- <code class="reqn">Q_2^*</code>: This is the tree shape on 4 leaves that has two pending
subtrees rooted at the children of the root of <code class="reqn">T</code>, one of them being
a star tree shape on 3 leaves
and the other one being a single vertex, i.e. <code>"((,,),);"</code> in Newick
format. It has 6 automorphisms.<br>
- <code class="reqn">Q_3^*</code>: This is the fully balanced binary tree shape on 4 leaves,
i.e. <code>"((,),(,));"</code> in Newick format. It has 8 automorphisms.<br>
- <code class="reqn">Q_4^*</code>: This is the star tree shape on 4 leaves, i.e.
<code>"(,,,);"</code> in Newick format. It has 24 automorphisms.<br><br><code class="reqn">T(Q)</code> is assigned an rQI-value based on its shape, i.e. <code class="reqn">rQI(T(Q))=q_i</code>
if <code class="reqn">T(Q)</code> has the shape <code class="reqn">Q_i^*</code>. The values <code class="reqn">q_0,...,q_4</code> are
chosen in such a way that they increase with the symmetry of the shape as
measured by means of its number of automorphisms. Coronado et al. (2019)
suggested the values <code class="reqn">q_0=0</code> and <code class="reqn">q_i=i</code> or <code class="reqn">q_i=2^i</code> for <code class="reqn">i=1,...,4</code>.<br>
The rooted quartet index <code class="reqn">rQI(T)</code> of the tree <code class="reqn">T</code> is then defined as
the sum of the rQI-values of its rooted quartets:
</p>
<p style="text-align: center;"><code class="reqn">rQI(T)=\sum_{Q\in P_4} rQI(T(Q))</code>
</p>

<p>The rooted quartet index is a balance index. <br><br>
For details on the rooted quartet index, see 
also Chapter 20 in "Tree balance indices: a comprehensive survey" (https://doi.org/10.1007/978-3-031-39800-1_20).
</p>


<h3>Usage</h3>

<pre><code class="language-R">rQuartetI(tree, shapeVal = c(0, 1, 2, 3, 4))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>A rooted tree in phylo format.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shapeVal</code></td>
<td>
<p>A vector of length 5 containing the shape values <code class="reqn">q_0,...,q_4</code>.
Default is <code class="reqn">(q_0,q_1,q_2,q_3,q_4)=(0,1,2,3,4)</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>rQuartetI</code> returns the rooted quartet index of the given tree based on the chosen shape values (see description for details).
</p>


<h3>Author(s)</h3>

<p>Sophie Kersting
</p>


<h3>References</h3>

<p>T. M. Coronado, A. Mir, F. Rossello, and G. Valiente.  A balance index for phylogenetic trees based on rooted quartets. Journal of Mathematical Biology, 79(3):1105-1148, 2019. doi: 10.1007/s00285-019-01377-w. URL https://doi.org/10.1007/s00285-019-01377-w.
</p>


<h3>Examples</h3>

<pre><code class="language-R">tree &lt;- ape::read.tree(text="((((,),),(,)),(((,),),(,)));")
rQuartetI(tree)

</code></pre>


</div>