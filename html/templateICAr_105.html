<div class="container">

<table style="width: 100%;"><tr>
<td>UpdateTheta_templateICA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Parameter Estimates in EM Algorithm for Template ICA Model</h2>

<h3>Description</h3>

<p>Parameter Estimates in EM Algorithm for Template ICA Model
</p>


<h3>Usage</h3>

<pre><code class="language-R">UpdateTheta_templateICA.spatial(
  template_mean,
  template_var,
  meshes,
  BOLD,
  theta,
  C_diag,
  H,
  Hinv,
  s0_vec,
  D,
  Dinv_s0,
  verbose = FALSE,
  return_MAP = FALSE,
  update = c("all", "kappa", "A")
)

UpdateTheta_templateICA.independent(
  template_mean,
  template_var,
  BOLD,
  theta,
  C_diag,
  H,
  Hinv,
  update_nu0sq = TRUE,
  return_MAP = FALSE,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>template_mean</code></td>
<td>
<p>(<code class="reqn">V \times Q</code> matrix) mean maps for each IC in template</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>template_var</code></td>
<td>
<p>(<code class="reqn">V \times Q</code> matrix) between-subject variance maps for each IC in template</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meshes</code></td>
<td>
<p><code>NULL</code> for spatial independence model, otherwise a list of
objects of class "templateICA_mesh" containing the triangular mesh (see
<code>make_mesh</code>) for each brain structure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BOLD</code></td>
<td>
<p>(<code class="reqn">V \times Q</code> matrix) dimension-reduced fMRI data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>(list) current parameter estimates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C_diag</code></td>
<td>
<p><code class="reqn">(Qx1)</code> diagonal elements of residual covariance after dimension reduction</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H, Hinv</code></td>
<td>
<p>For dimension reduction</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s0_vec</code></td>
<td>
<p>Vectorized template means</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>Sparse diagonal matrix of template standard deviations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Dinv_s0</code></td>
<td>
<p>The inverse of D times s0_vec</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>If <code>TRUE</code>, display progress of algorithm. Default: <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return_MAP</code></td>
<td>
<p>If <code>TRUE</code>. return the posterior mean and precision of
the latent fields instead of the parameter estimates. Default: <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>update</code></td>
<td>
<p>Which parameters to update. Either <code>"all"</code>, <code>"A"</code> or <code>"kappa"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>update_nu0sq</code></td>
<td>
<p>For non-spatial model: updating <code>nu0sq</code> is recommended
if dimension reduction was not performed, and is not recommended if it was.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An updated list of parameter estimates, theta, OR if
<code>return_MAP=TRUE</code>, the posterior mean and precision of the latent fields
</p>


</div>