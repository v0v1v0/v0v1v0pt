<div class="container">

<table style="width: 100%;"><tr>
<td>glue.chr.segment.par</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Splicing chromosomal segments</h2>

<h3>Description</h3>

<p>This function splices the triad chromosomal segments into "complete" trios. The spliced trio sets are written into separate plink
files chromosome by chromosome. It is parallelized and if no no_cores value is given the ceiling of half of the total number
of CPUs available will be used in the parallelization.
</p>


<h3>Usage</h3>

<pre><code class="language-R">glue.chr.segment.par(
  input.plink.file,
  out.put.file,
  brks,
  sel.fam.all,
  snp.all2,
  pathway.all,
  target.snp,
  pop.vec = NA,
  no_cores = NA,
  flip = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>input.plink.file</code></td>
<td>
<p>for simulations of homogenous population, it is a vector of three character strings for the base filenames of the mother's
father's and child's plink base filenames. The plink files are in bed format and in the same folder three files with 
extensions .bed .bim and .fam are expected for each individual's genotypes. The mothers, fathers, and 
childredn must be from the same set of trio families even though the ordering of the families can be different
for the three sets of data. For simulations under population stratification it is a list of two vectors. Each vector is a vector 
of three character strings for the base filenames as described above.The two vectors correspond to the two subpopulations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out.put.file</code></td>
<td>
<p>is a character string giving the base file name for the output file. Genotypes on different chromosomes are output to different files.
The final file name also contains information on chromosome number. E.g., for a base filename "trio" and for chromosome 1 the final file name is "trio1sim".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>brks</code></td>
<td>
<p>is a matrix of integers showing where the chromosomal breaks is to take place for each individual in the simulated trios.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sel.fam.all</code></td>
<td>
<p>is a matrix of integer giving the families (in terms of row number) selected for each chromosomal segment and each simulated trio.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>snp.all2</code></td>
<td>
<p>is a dataframe containing the list of SNPs in PLINK .bim format. Two columns of the dataframe
is used: column 1 with column name "V1" containing the chromosome number and column 2 with column name "V2" containing the rs number of the SNPs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pathway.all</code></td>
<td>
<p>is a matrix giving the genotypes on the pathway SNPs in the simulated trio.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target.snp</code></td>
<td>
<p>is a vector of integers showing the row number of the target SNPs in the .bim file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pop.vec</code></td>
<td>
<p>is a vector of 1's and 2's giving the subpopulation group of each simulated trio. This parameter is relevant only for stratified scenarios.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no_cores</code></td>
<td>
<p>is an integer which specifies the number of CPU cores to be parallelized.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flip</code></td>
<td>
<p>is a boolean indicating whether the mother's and the father's genotypes will be swapped to wipe out potential maternal effects in the orignal data.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>This function does not return values. Instead it writes PLINK files into the designated directory. Each set of PLINK files contains genotype
data for one chromosome for all trios. The first one third of the rows are genotypes of the mothers'. The second one third are those of the fathers' and the last one 
third are the children's.
</p>


<h3>Examples</h3>

<pre><code class="language-R">tar.snp &lt;- c(21, 118, 121, 140, 155, 168, 218, 383) 
found.brks &lt;- get.brks(N.brk=3,n.ped=1000, snp.all2, tar.snp,rcmb.rate=NA)
breaks &lt;- found.brks[[1]]
family.position &lt;- found.brks[[2]] 
betas &lt;- c(-6.4, 3.2, 5.8)
pwy &lt;- list(1:4,5:8)
m.file &lt;- file.path(system.file(package = "TriadSim"),'extdata/pop1_4chr_mom')
f.file &lt;- file.path(system.file(package = "TriadSim"),'extdata/pop1_4chr_dad')
k.file &lt;- file.path(system.file(package = "TriadSim"),'extdata/pop1_4chr_kid')
# the preloaded data frame snp.all2 contains the data frame read from the corresponding .bim file.
target.geno &lt;- get.target.geno(c(m.file,f.file,k.file), tar.snp,snp.all2)
mom.target &lt;- target.geno[[1]]
dad.target &lt;- target.geno[[2]]
kid.target &lt;- target.geno[[3]]
 ## Not run: 
fitted.model &lt;- fit.risk.model.par(n.ped=1000,brks=breaks,target.snp=tar.snp, 
fam.pos=family.position,mom.tar=mom.target,dad.tar=dad.target, kid.tar=kid.target,  
pathways=pwy,betas, e.fr=NA, betas,pop1.frac= NA,rate.beta=NA,no_cores=2)
sel.fam &lt;- fitted.model[[1]]
sim.pathway.geno &lt;-  fitted.model[[2]]
glue.chr.segment.par(c(m.file,f.file,k.file),file.path(tempdir(),'trio'), breaks,sel.fam,
                     snp.all2,sim.pathway.geno,target.snp,pop.vec=NA,no_cores=1,flip=TRUE) 

## End(Not run)

</code></pre>


</div>