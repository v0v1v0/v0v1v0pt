<div class="container">

<table style="width: 100%;"><tr>
<td>tpm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit Two-part Regression Models for Zero-inflated Data</h2>

<h3>Description</h3>

<p>Fit two-part regression models for zero-inflated data. The first-model is a binomial regression model for indicators about any non-zero responses. The second-model is a generalized linear regression model for non-zero response values.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tpm(formula_part1, formula_part2 = NULL,data, link_part1 = c("logit",
"probit", "cloglog", "cauchit", "log"), family_part2 = gaussian(), weights = NULL, ...)

## S4 method for signature 'twopartm'
summary(object,...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula_part1</code></td>
<td>
<p>formula specifying the dependent variable and the regressors used for the first-part model, i.e., the binomial model for probabilities of non-zero responses. If <code>formula_part2</code> is <code>NULL</code>, the same regressors specified here are employed in both parts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula_part2</code></td>
<td>
<p>formula specifying the dependent variable and the regressors used for the second-part model, i.e., the glm model for non-zero responses. If it's <code>NULL</code>, the same regressors specified in <code>formula_part1</code> are employed in the second-part model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame, list or environment (or object coercible by as.data.frame to a data frame) containing the variables in the models for both parts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link_part1</code></td>
<td>
<p>character string specifying the link function of the first-part model, i.e., the binomial model for probabilities of non-zero responses. It could be <code>logit</code>, <code>probit</code>, <code>cauchit</code>, (corresponding to logistic, normal and Cauchy CDFs respectively) <code>log</code> or <code>cloglog</code> (complementary log-log).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family_part2</code></td>
<td>
<p>a description of the error distribution and link function to be used in the second-part model,  i.e.,  the glm model for non-zero responses. This can be a character string naming a family function, a family function or the result of a call to a family function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>an optional numeric vector of weights to be used in the fitting process for both parts. Should be NULL or a numeric vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>a fitted two-part model object of class <code>twopartm</code> as returned by <code>tpm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments passed to <code>glm</code> or <code>summary.glm</code> in the default setup.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Two-part models are two-component models for zero-inflated data, one modeling indicators
about any non-zero responses and another modeling non-zero response values. It models
the zeros and non-zeros as two separate processes.  For instance, in explaining individual
annual health expenditure, the event is represented by a specific disease. If the illness
occurs, then some not-for-free treatment will be needed, and a positive expense will be
observed. In these situations, a two-part model allows the censoring mechanism and the
outcome to be modeled to use separate processes. In other words, it permits the zeros and
nonzeros to be generated by different densities as a special type of mixture model.
</p>
<p>In function <code>tpm</code>, the zeros are handled using the first-model, specifically a glm with binomial family
and specified link function for the probability of a non-zero outcome. The second-model is a
glm with specified family function with link for non-zero values. The regressors for both parts
could be different and specified separately. The two components of the model are estimated separately
using <code>glm</code> calls, with iterated reweighted least-squares (IRLS) optimization.
</p>
<p>The returned fitted model object is of class <code>twopartm</code>.A set of standard extractor functions
for fitted model objects is available for objects of class <code>twopartm</code>, including methods to
the generic functions <code>print</code>, <code>summary</code>, <code>plot</code>, <code>coef</code>,
<code>logLik</code>, <code>residuals</code>, and <code>predict</code>.See
<code>predict-methods</code> for more details on prediction method.
</p>
<p>The <code>summary</code> method lists result summaries of two fitted glm models for each part respectively.
</p>


<h3>Value</h3>

<p><code>tpm</code> returns an object of class <code>twopartm</code>.
</p>
<p><code>summary</code> returns a list with two objects of class <code>summary.glm</code> for first-part model and second-part model respectively.
</p>


<h3>Author(s)</h3>

<p>Yajie Duan, Birol Emir, Griffith Bell and Javier Cabrera</p>


<h3>References</h3>

<p>Belotti, F., Deb, P., Manning, W.G. and Norton, E.C. (2015). twopm: Two-part models.
<em>The Stata Journal</em>, 15(1), pp.3-20.
</p>
<p>Hay, J. W., and R. J. Olsen. (1984). Let them eat cake: A note on comparing alternative
models of the demand for medical care. <em>Journal of Business and Economic Statistics</em>
2: 279–282.
</p>
<p>Leung, S. F., and S. Yu. (1996). On the choice between sample selection and two-part
models. <em>Journal of Econometrics</em> 72: 197–229
</p>
<p>Mihaylova, B., A. Briggs, A. O’Hagan, and S. G. Thompson. (2011). Review of statistical
methods for analyzing healthcare resources and costs. <em>Health Economics</em> 20: 897–916.
</p>


<h3>See Also</h3>

<p><code>twopartm-class</code>, <code>glm</code>, <code>summary.glm</code>, <code>predict-methods</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
##data about health expenditures, i.e., non-negative continuous response
data(meps,package = "twopartm")


##fit two-part model with the same regressors in both parts, with logistic
##regression model for the first part, and glm with Gamma family with log
##link for the second-part model
tpmodel = tpm(exp_tot~female+age, data = meps,link_part1 = "logit",
family_part2 = Gamma(link = "log"))

tpmodel

summary(tpmodel)


##fit two-part model with different regressors in both parts, with probit
##regression model for the first part, and glm with Gamma family with log
##link for the second-part model
tpmodel = tpm(formula_part1 = exp_tot~female+age, formula_part2 =
exp_tot~female+age+ed_colplus,data = meps,link_part1 = "probit",
family_part2 = Gamma(link = "log"))

tpmodel

summary(tpmodel)

##fit two-part model with transformed regressors and randomly assigned weights
meps$weights = sample(1:30,nrow(meps),replace = TRUE)

tpmodel = tpm(formula_part1 = exp_tot~female+age, formula_part2 =
exp_tot~female+I(age^2)+ed_colplus,data = meps,link_part1 = "logit",
family_part2 = Gamma(link = "log"),weights = meps$weights)

tpmodel

summary(tpmodel)


##data for count response
data("bioChemists")

##fit two-part model with the same regressors in both parts, with logistic
##regression model for the first part, and poisson regression model with
##default log link for the second-part model
tpmodel = tpm(art ~ .,data = bioChemists,link_part1 = "logit",
family_part2 = poisson)

tpmodel

summary(tpmodel)


</code></pre>


</div>