<div class="container">

<table style="width: 100%;"><tr>
<td>thres2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Threshold point estimation and confidence intervals (two-state setting)
</h2>

<h3>Description</h3>

<p>This function calculates the threshold estimate and its corresponding confidence interval in a two-state setting.
</p>


<h3>Usage</h3>

<pre><code class="language-R">thres2(k1, k2, rho,
  costs = matrix(c(0, 0, 1, (1 - rho)/rho), 2, 2, byrow = TRUE),
  R=NULL,
  method = c("equal", "unequal", "empirical", "smooth", "parametric"),
  dist1 = NULL, dist2 = NULL, ci = TRUE, ci.method = c("delta", "boot"),
  B = 1000, alpha = 0.05, extra.info = FALSE, na.rm = FALSE, q1=0.05, q2=0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>k1</code></td>
<td>

<p>vector containing the healthy sample values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k2</code></td>
<td>

<p>vector containing the diseased sample values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>

<p>disease prevalence.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>costs</code></td>
<td>

<p>cost matrix. Costs should be entered as a 2x2 matrix, where the first row corresponds to the true positive and true negative costs and the second row to the false positive and false negative costs. Default cost values are a combination of costs that yields R=1, which is equivalent to the Youden index method (for details about this concept, see <b>References</b>). It must be set to <code>NULL</code> if the user prefers to set <code>R</code> (see next argument).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>

<p>if the cost matrix <code>costs</code> is not set, R desired (the algorithm will choose a suitable combination of costs that leads to <code>R</code>). Default, <code>NULL</code> (which leads to R=1 using the default <code>costs</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>method used in the estimation. The user can specify just the initial letters. Default, <code>"equal"</code>. See <b>Details</b> for more information about the methods available.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist1</code></td>
<td>

<p>distribution to be assumed for the healthy population. See <b>Details</b>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist2</code></td>
<td>

<p>distribution to be assumed for the diseased population. See <b>Details</b>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>

<p>should a confidence interval be calculated? Default, <code>TRUE</code>. The user can set it to <code>FALSE</code> to supress the calculation of any confidence interval (in that case, arguments <code>ci.method</code>, <code>B</code> and <code>alpha</code> are ignored).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci.method</code></td>
<td>

<p>method to be used for the confidence intervals calculation. The user can specify just the initial letters. Default, <code>"delta"</code>. See <b>Details</b> for more information about the methods available.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>

<p>number of bootstrap resamples when <code>ci.method = "boot"</code>. Otherwise, ignored. Default, 1000.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>significance level for the confidence interval. Default, 0.05.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extra.info</code></td>
<td>

<p>when using <code>method="empirical"</code>, if set to <code>TRUE</code> the function returns extra information about the calculation of the threshold. Ignored when <code>method</code> is not <code>"empirical"</code>. Default, <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>

<p>a logical value indicating whether <code>NA</code> values in <code>k1</code> and <code>k2</code> should be stripped before the computation proceeds. Default, <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q1</code></td>
<td>

<p>probability of the left distribution in order to determine a low quantile when <code>method="parametric"</code> (ignored otherwise). Default, 0.05.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q2</code></td>
<td>

<p>probability of the right distribution in order to determine a high quantile when <code>method="parametric"</code> (ignored otherwise). Default, 0.95.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For parameter <code>method</code> the user can choose between <code>"equal"</code> (assumes binormality and equal variances), <code>"unequal"</code> (assumes binormality and unequal variances), <code>"empirical"</code> (leaves out any distributional assumption), <code>"smooth"</code> (leaves out any distributional assumption, but uses a kernel to estimate the densities) or <code>"parametric"</code> (based on the distribution assumed for the two populations).
</p>
<p>Parameters <code>dist1</code> and <code>dist2</code> can be chosen between the following 2-parameter distributions: <code>"beta"</code>, <code>"cauchy"</code>, <code>"chisq"</code> (chi-squared), <code>"gamma"</code>, <code>"lnorm"</code> (lognormal), <code>"logis"</code> (logistic), <code>"norm"</code> (normal) and <code>"weibull"</code>. Notice that <code>dist1</code> and <code>dist2</code> are only needed when <code>method = "parametric"</code>.
</p>
<p>For parameter <code>ci.method</code> the user can choose between <code>"delta"</code> (delta method is used to estimate the threshold standard error assuming a binormal underlying model) or <code>"boot"</code> (the confidence interval is calculated by bootstrap).
</p>


<h3>Value</h3>

<p>An object of class <code>thres2</code>, which is a list with two components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>T</code></td>
<td>
<p>a list of at least seven components:
</p>
<p><code>thres</code>  threshold estimate.
</p>
<p><code>prev</code>  disease prevalence provided by the user.
</p>
<p><code>costs</code>  cost matrix provided by the user.
</p>
<p><code>R</code>  R term, the product of the non-disease odds and the cost ratio (for further details about this concept, see <b>References</b>).
</p>
<p><code>method</code>  method used in the estimation.
</p>
<p><code>k1</code>  vector containing the healthy sample values provided by the user.
</p>
<p><code>k2</code>  vector containing the diseased sample values provided by the user.
</p>
<p>When <code>method = "empirical"</code>, <code>T</code> also contains:
</p>
<p><code>sens</code>  sensitivity obtained.
</p>
<p><code>spec</code>  specificity obtained.
</p>
<p><code>cost</code>  the minimum cost associated with <code>T$thres</code>.
</p>
<p><code>tot.thres</code> vector of possible thresholds. Only if <code>extra.info = TRUE</code>.
</p>
<p><code>tot.cost</code> vector of empirical costs. Only if <code>extra.info = TRUE</code>.
</p>
<p><code>tot.spec.c</code>  complementary of the vector of empirical specificities (1-spec). Only if <code>extra.info = T</code>.
</p>
<p><code>tot.sens</code>  vector of empirical sensitivities. Only if <code>extra.info = TRUE</code>.
</p>
<p>When <code>method = "parametric"</code>, <code>T</code> also contains:
</p>
<p><code>dist1</code>  distribution assumed for the healthy population.
</p>
<p><code>dist2</code>  distribution assumed for the diseased population.
</p>
<p><code>pars1</code>  a numeric vector containing the estimation of the parameters of <code>dist1</code>.
</p>
<p><code>pars2</code>  a numeric vector containing the estimation of the parameters of <code>dist2</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI </code></td>
<td>
<p>When <code>ci.method = "delta"</code>, a list of five components:
</p>
<p><code>lower</code>  the lower limit of the confidence interval.
</p>
<p><code>upper</code>  the upper limit of the confidence interval.
</p>
<p><code>se</code>  the standard error used in the calculation of the confidence interval. 
</p>
<p><code>alpha</code>  significance level provided by the user.
</p>
<p><code>ci.method</code> method used for the confidence intervals calculation.
</p>
<p>When <code>ci.method = "boot"</code>, a list of eight components:
</p>
<p><code>low.norm</code>  the lower limit of the bootstrap confidence interval based on the normal distribution.
</p>
<p><code>up.norm</code>  the upper limit of the bootstrap confidence interval based on the normal distribution.
</p>
<p><code>se</code>  the bootstrap standard error used in the calculation of the confidence interval based on the normal distribution. 
</p>
<p><code>low.perc</code> the lower limit of the bootstrap confidence interval based on percentiles.
</p>
<p><code>up.perc</code>  the upper limit of the bootstrap confidence interval based on percentiles.
</p>
<p><code>alpha</code>  significance level provided by the user.
</p>
<p><code>B</code>  number of bootstrap resamples used.
</p>
<p><code>ci.method</code>  method used for the confidence intervals calculation.
</p>
<p>When <code>ci = FALSE</code>, <code>NULL</code>.
</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>It is assumed that <code>k1</code> is the sample with lower values. If that is not the case, <code>k1</code> and <code>k2</code> (and the corresponding parameters) are exchanged.
</p>


<h3>References</h3>

<p>Efron B, Tibshirani RJ. (1993). An introduction to the bootstrap, Chapman &amp; Hall.
</p>
<p>Skaltsa K, Jover L, Carrasco JL. (2010). Estimation of the diagnostic threshold accounting for decision costs and sampling uncertainty. Biometrical Journal 52(5):676-697.
</p>


<h3>See Also</h3>

<p><code>thresTH2</code>, <code>plot.thres2</code>, <code>lines.thres2</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># example 1
n1 &lt;- 100
n2 &lt;- 100
set.seed(1234)
par1.1 &lt;- 0
par1.2 &lt;- 1
par2.1 &lt;- 2
par2.2 &lt;- 1
rho &lt;- 0.2
k1 &lt;- rnorm(n1, par1.1, par1.2) # non-diseased
k2 &lt;- rnorm(n2, par2.1, par2.2) # diseased

thres2(k1, k2, rho, method="eq", ci.method="d")
thres2(k1, k2, rho, method="uneq", ci.method="d")
# specify R instead of (default) costs
thres2(k1, k2, rho, costs=NULL, R=2, method="uneq", ci.method="d")
## Not run: 
thres2(k1, k2, rho, method="empirical", ci.method="b")

# example 2
set.seed(1234)
k1 &lt;- rnorm(50, 10, 3)
k2 &lt;- rlnorm(55)
rho &lt;- 0.3
thres2(k1, k2, rho, method="param", ci.method="boot", dist1="norm", dist2="lnorm")

## End(Not run)

# supress confidence intervals calculation
thres2(k1, k2, rho, method="equal", ci=FALSE)
thres2(k1, k2, rho, method="empirical", ci=FALSE)

# example 3
n1 &lt;- 100
n2 &lt;- 100
set.seed(1234)
par1.1 &lt;- 0
par1.2 &lt;- 1
par2.1 &lt;- 2
par2.2 &lt;- 1
rho &lt;- 0.2
k1 &lt;- rnorm(n1, par1.1, par1.2) # non-diseased
k2 &lt;- rnorm(n2, par2.1, par2.2) # diseased
## Not run: 
thres2(k1, k2, rho, method="smooth", ci.method="b")

## End(Not run)

</code></pre>


</div>