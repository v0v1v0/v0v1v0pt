<div class="container">

<table style="width: 100%;"><tr>
<td>tvLM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Time-Varying Coefficients Linear Models</h2>

<h3>Description</h3>

<p><code>tvLM</code> is used to fit a time-varying coefficients linear model
</p>


<h3>Usage</h3>

<pre><code class="language-R">tvLM(
  formula,
  z = NULL,
  ez = NULL,
  data,
  bw = NULL,
  cv.block = 0,
  est = c("lc", "ll"),
  tkernel = c("Triweight", "Epa", "Gaussian"),
  singular.ok = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>An object of class formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>A vector with the smoothing variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ez</code></td>
<td>
<p>(optional) A scalar or vector with the smoothing values. If 
values are not included then the vector <code>z</code> is used instead.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>An optional data frame or matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw</code></td>
<td>
<p>An opcional scalar. It represents the bandwidth in
the estimation of trend coefficients. If NULL, it is selected by cross validation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv.block</code></td>
<td>
<p>A positive scalar with the size of the block in leave one block out cross-validation.
By default 'cv.block=0' meaning leave one out cross-validation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est</code></td>
<td>
<p>The nonparametric estimation method, one of "lc" (default) for linear constant
or "ll" for local linear.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tkernel</code></td>
<td>
<p>A character, either "Triweight" (default), "Epa" or "Gaussian" kernel function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>singular.ok</code></td>
<td>
<p>Logical. If FALSE, a singular model is an error.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Models for <code>tvLM</code> are specified symbolically using the same formula
format than function <code>lm</code>. A typical model has the form <em>response</em> ~ <em>terms</em>
where response is the (numeric) response vector and terms is a series of terms which
specifies a linear predictor for response. A terms specification of the form
first + second indicates all the terms in first together with all the terms
in second with duplicates removed. A specification of the form first:second indicates
the set of terms obtained by taking the interactions of all terms in first with all
terms in second. The specification first*second indicates the cross of first and second.
This is the same as first + second + first:second.
</p>
<p>A formula has an implied intercept term. To remove this use either
y ~ x - 1 or y ~ 0 + x.
</p>


<h3>Value</h3>

<p>An object of class <code>tvlm</code>
The object of class <code>tvlm</code> have the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>A matrix of dimensions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted</code></td>
<td>
<p>The fitted values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>Estimation residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A matrix with the regressors data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A vector with the dependent variable data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>A vector with the smoothing variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ez</code></td>
<td>
<p>A vector with the smoothing estimation variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw</code></td>
<td>
<p>Bandwidth of mean estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est</code></td>
<td>
<p>Nonparametric estimation methodology.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tkernel</code></td>
<td>
<p>Kernel used in estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>Confidence interval range.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>runs</code></td>
<td>
<p>Number of bootstrap replications.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tboot</code></td>
<td>
<p>Type of bootstrap.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BOOT</code></td>
<td>
<p>List with all bootstrap replications of <code>coefficients</code>, if done.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Bollerslev, T., Patton, A. J. and Quaedvlieg, R. (2016) Exploiting the 
errors: A simple approach for improved volatility forecasting. 
<em>Journal of Econometrics</em>, 192, 1-18.
</p>
<p>Casas, I., Mao, X. and Veiga, H. (2018) Reexamining financial and economic 
predictability with new estimators of realized variance and variance 
risk premium. Url= http://pure.au.dk/portal/files/123066669/rp18_10.pdf
</p>


<h3>See Also</h3>

<p><code>bw</code>, <code>tvAR</code>, <code>confint</code>, 
<code>plot</code>, <code>print</code> and <code>summary</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Simulate a linear process with time-varying coefficient
## as functions of scaled time.
set.seed(42)
tau &lt;- seq(1:200)/200
beta &lt;- data.frame(beta1 = sin(2*pi*tau), beta2= 2*tau)
X1 &lt;- rnorm(200)
X2 &lt;- rchisq(200, df = 4)
error &lt;- rt(200, df = 10)
y &lt;- apply(cbind(X1, X2)*beta, 1, sum) + error
data &lt;- data.frame(y = y, X1 = X1, X2 = X2)
## Estimate coefficients with lm and tvLM for comparison

coef.lm &lt;- stats::lm(y ~ 0 + X1 + X2, data = data)$coef
tvlm.fit &lt;- tvLM(y ~ 0 + X1 + X2, data = data, bw = 0.29)

## Estimate coefficients of different realized variance models
data("RV")
RV2 &lt;- head(RV, 2000)
##Bollerslev t al. (2016) HARQ model
HARQ &lt;- with(RV2, lm(RV ~ RV_lag + I(RV_lag * RQ_lag_sqrt) + RV_week + RV_month))

#Casas et al. (2018) TVHARQ model
TVHARQ &lt;- with(RV2, tvLM (RV ~ RV_lag + RV_week + RV_month, z = RQ_lag_sqrt, 
                         bw = 0.0061))
boxplot(data.frame(TVHARQ = TVHARQ$coefficients[,2] * RV2$RV_lag,
                   HARQ = (HARQ$coef[2] + HARQ$coef[3] * RV2$RQ_lag_sqrt)*RV2$RV_lag),
                   main = expression (RV[t-1]), outline = FALSE)
                 
</code></pre>


</div>