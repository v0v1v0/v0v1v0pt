<div class="container">

<table style="width: 100%;"><tr>
<td>OptMFG</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate the envelope subspace (<span class="pkg">OptM</span> FG)</h2>

<h3>Description</h3>

<p>The FG algorithm to estimate the envelope subspace based on the curvilinear search algorithm for optimization on Stiefel manifold. The curvilinear algorithm is developed by Wen and Yin (2013) and the Matlab version is implemented in the Matlab package <span class="pkg">OptM</span>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">OptMFG(M, U, u, Gamma_init = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>The <code class="reqn">p</code>-by-<code class="reqn">p</code> positive definite matrix <code class="reqn">M</code> in the envelope objective function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>U</code></td>
<td>
<p>The <code class="reqn">p</code>-by-<code class="reqn">p</code> positive semi-definite matrix <code class="reqn">U</code> in the envelope objective function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>An integer between 0 and <code class="reqn">n</code> representing the envelope dimension. Ignored if <code>Gamma_init</code> is provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gamma_init</code></td>
<td>
<p>Initial envelope subspace basis. The default value is the estimator from <code>OptM1D(M, U, u)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional user-defined arguments for the curvilinear search algorithm:
</p>

<ul>
<li> <p><code>maxiter</code>: The maximal number of iterations.
</p>
</li>
<li> <p><code>xtol</code>: The convergence tolerance for <code class="reqn">\Gamma</code>, e.g., <code class="reqn">||\Gamma^{(k)} - \Gamma^{(k-1)}||_F/\sqrt{p}</code>
</p>
</li>
<li> <p><code>gtol</code>: The convergence tolerance for the projected gradient, e.g., <code class="reqn">||G^{(k)} - \Gamma^{(k)} (G^{(t)})^T \Gamma^{(t)}||_F</code>
</p>
</li>
<li> <p><code>ftol</code>: The convergence tolerance for objective function <code class="reqn">F</code>, e.g., <code class="reqn">|F^{(k)} - F^{(k-1)}|/(1+|F^{(k-1)}|)</code>. Usually, <code>max{xtol, gtol} &gt; ftol</code>
</p>
</li>
</ul>
<p>The default values are: <code>maxiter=500; xtol=1e-08; gtol=1e-08; ftol=1e-12.</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>Gamma_init</code> is provided, then the envelope dimension <code>u = ncol(Gamma_init)</code>.
</p>
<p>The function <code>OptMFG</code> calls the function <code>OptStiefelGBB</code> internally which implements the curvilinear search algorithm.
</p>
<p>The objective function <code class="reqn">F(\Gamma)</code> and its gradient <code class="reqn">G(\Gamma)</code> in curvilinear search algorithm are:
</p>
<p style="text-align: center;"><code class="reqn">F(\Gamma)=\log|\Gamma^T M \Gamma|+\log| \Gamma^T(M+U)^{-1}\Gamma|</code>
</p>

<p style="text-align: center;"><code class="reqn">G(\Gamma) = dF/d \Gamma = 2 M \Gamma (\Gamma^T M \Gamma)^{-1} + 2 (M + U)^{-1} \Gamma (\Gamma^T (M + U)^{-1} \Gamma)^{-1}</code>
</p>



<h3>Value</h3>

<p>Return the estimated orthogonal basis of the envelope subspace.
</p>


<h3>References</h3>

<p>Wen, Z. and Yin, W., 2013. A feasible method for optimization with orthogonality constraints. Mathematical Programming, 142(1-2), pp.397-434.
</p>


<h3>See Also</h3>

<p><code>OptStiefelGBB</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">##simulate two matrices M and U with an envelope structure
data &lt;- MenvU_sim(p=20, u=5, wishart = TRUE, n = 200)
M &lt;- data$M
U &lt;- data$U
G &lt;- data$Gamma
Gamma_FG &lt;- OptMFG(M, U, u=5)
subspace(Gamma_FG, G)
</code></pre>


</div>