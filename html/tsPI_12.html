<div class="container">

<table style="width: 100%;"><tr>
<td>struct_pi</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Prediction Intervals for Structural Time Series with Exogenous Variables Using Importance Sampling</h2>

<h3>Description</h3>

<p>Function <code>struct_pi</code> computes prediction intervals for structural time series
with exogenous variables using importance sampling.
</p>


<h3>Usage</h3>

<pre><code class="language-R">struct_pi(
  x,
  type = c("level", "trend", "BSM"),
  xreg = NULL,
  n_ahead = 1,
  level = 0.95,
  median = TRUE,
  se_limits = TRUE,
  prior = "uniform",
  custom_prior,
  custom_prior_args = NULL,
  nsim = 1000,
  inits = NULL,
  last_only = FALSE,
  return_weights = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>vector containing the time series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of model. Possible options are <code>"level"</code>, <code>"trend"</code> and <code>"BSM"</code>,
corresponding to local level, local linear trend, and local linear trend model with seasonal component.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xreg</code></td>
<td>
<p>matrix or data frame containing the exogenous variables
(not including the intercept which is always included for non-differenced series)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_ahead</code></td>
<td>
<p>length of the forecast horizon.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>desired frequentist coverage probability of the prediction intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>median</code></td>
<td>
<p>compute the median of the prediction interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se_limits</code></td>
<td>
<p>compute the standard errors of the prediction interval limits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p>prior to be used in importance sampling for log-sd parameters.
Defaults to uniform prior on logarithm of standard deviations (with constraints that all variances are smaller than 1e7).
If "custom", a user-defined custom prior is used (see next arguments).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>custom_prior</code></td>
<td>
<p>function for computing custom prior.
First argument must be a vector containing the log-variance parameters (observation error, level, slope, and seasonal).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>custom_prior_args</code></td>
<td>
<p>list containing additional arguments to <code>custom_prior</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>number of simulations used in importance sampling. Default is 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inits</code></td>
<td>
<p>initial values for log-sds</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>last_only</code></td>
<td>
<p>compute the prediction intervals only for the last prediction step.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return_weights</code></td>
<td>
<p>Return (scaled) weights used in importance sampling.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list containing the prediction intervals.
</p>


<h3>See Also</h3>

<p><code>tsPI</code>, <code>arima_pi</code>
@references
</p>

<ol><li>
<p>Helske, J. (2015). Prediction and interpolation of time series by state space models.
University of Jyväskylä. PhD thesis, Report 152.
<a href="https://urn.fi/URN:NBN:fi:jyu-201603111829">https://urn.fi/URN:NBN:fi:jyu-201603111829</a>
</p>
</li></ol>
<h3>Examples</h3>

<pre><code class="language-R">
pred_StructTS &lt;- predict(StructTS(Nile, type ="level"), n.ahead = 10, se.fit = TRUE)
pred_StructTS &lt;- cbind(pred = pred_StructTS$pred,
  lwr = pred_StructTS$pred - qnorm(0.975)*pred_StructTS$se,
 upr = pred_StructTS$pred + qnorm(0.975)*pred_StructTS$se)

set.seed(123)
pred &lt;- struct_pi(Nile, type = "level", n_ahead = 10)

ts.plot(ts.union(Nile,pred_StructTS, pred[,1:3]), col = c(1,2,2,2,3,3,3),
  lty = c(1,1,2,2,1,2,2))


</code></pre>


</div>