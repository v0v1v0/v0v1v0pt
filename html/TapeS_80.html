<div class="container">

<table style="width: 100%;"><tr>
<td>tprVolume</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Functions to calculate stem volume from taper curve</h2>

<h3>Description</h3>

<p>Function calculates stem volume from taper curve for given
trees, depending definition of segment and on bark indicator. It is possible
to request confidence or prediction intervals.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tprVolume(
  obj,
  AB = NULL,
  iAB = NULL,
  bark = NULL,
  interval = "none",
  mono = TRUE,
  Rfn = NULL
)

## S4 method for signature 'tprTrees'
tprVolume(
  obj,
  AB = list(A = 0, B = 7, sl = 2),
  iAB = c("h", "dob"),
  bark = TRUE,
  interval = "none",
  mono = TRUE,
  Rfn = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>object of class 'tprTrees'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AB</code></td>
<td>
<p>list with heights or diameters A and B of section for which volume
over or under bark should be calculated. Additionally, add in <code>sl</code> for
the segment length over which the integral should be calculated. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iAB</code></td>
<td>
<p>character indicating how to interpret given A and B values. Either
"H" (the default), "Dob" (diameter over bark) or "Dub" (diameter under bark).
Could be of length one or two, depending on whether A and B are both height
or diameter variables or not. See examples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bark</code></td>
<td>
<p>should volume be returned including (<code>TRUE</code>) or excluding
bark (<code>FALSE</code>)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interval</code></td>
<td>
<p>character to indicate whether and which type of interval is
required; one of <code>none</code>, <code>confidence</code> or <code>prediction</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mono</code></td>
<td>
<p>logical, defaults to true. If calibrated taper curve is
non-monotonic at stem base, a support diameter is added.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rfn</code></td>
<td>
<p>Rfn setting for residuals error matrix, defaults to
<code>list(fn="sig2")</code>, see <code>resVar</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function returns total solid wood w/ bark (i.e. from H=0 to
D=7cm) by default. Using <code>AB</code>, one can specify lower <code>A</code> and upper
<code>B</code> end of segments for which volume is required, w/ or w/o bark.
</p>
<p><code>iAB</code> can be a vector of length two, indicating how to interpret A and
B. Hence, one can calculate volume between a given height and a given
diameter, either over or under bark. If of length one, it is assumed that the
indicator applies to both A and B.
</p>
<p>Defining interval <code>'confidence'</code> or <code>'prediction'</code> returns
lower (lwr) and upper (upr) interval bounds on confidence level
<code class="reqn">\alpha</code> = <code>qt(0.025, ...)</code>. NB: The volume confidence bounds only
incorporate the uncertainty of diameter estimation at a pre-fixed position
(e.g. H=1.3m). If the position is given as diameter (e.g. <code>iAB="Dob"</code>),
the absolute height position is calculated using the *estimated* diameter,
hence, the uncertainty of the estimated absolute height is not (yet)
included. Neither is the uncertainty of the models for bark reduction.
</p>
<p>In contrast to the underlying R-package TapeR, which uses
<code>E_VOL_AB_HmDm_HT.f</code> for volume calculation, this function
calculates volume based on stem-section (default: 2m, see parameter
<code>AB</code>). Additionally, with that approach, bark reduction is easily
possible.
</p>


<h3>Value</h3>

<p>if <code>interval='none'</code> a vector else a matrix.
</p>


<h3>Methods (by class)</h3>


<ul><li> <p><code>tprVolume(tprTrees)</code>: method for class 'tprTrees'
</p>
</li></ul>
<h3>See Also</h3>

<p><code>E_DHx_HmDm_HT.f</code> for the underlying diameter
calculation.
</p>


<h3>Examples</h3>

<pre><code class="language-R">obj &lt;- simTrees() # default is: simulate 10 Norway spruce with mean dbh of 40
A &lt;- 1
B &lt;- 10
tprVolume(obj) # default is: coarse wood volume w/ bark
tprVolume(obj, AB = list(A=A, B=B, sl=2), iAB = "H", bark=FALSE)
tprVolume(obj, AB = list(A=A, B=B, sl=0.01), iAB = "H", bark=FALSE)
tprVolume(obj, AB = list(A=A, B=B, sl=0.01), iAB = "H", bark=TRUE)

## compare against integrated taper curve volume via package TapeR
## TapeR integrates over the taper curve, while TapeS uses segments of length 'sl'
TapeR::E_VOL_AB_HmDm_HT.f(Hm=obj@Hm[[1]], Dm = obj@Dm[[1]], iDH = "H",
                          mHt = obj@Ht[1], sHt = 0, A = A, B = B,
                          par.lme=SKPar[[1]])$E_VOL

## returning intervals
tprVolume(obj, interval="none")
tprVolume(obj, interval="confidence")
tprVolume(obj, interval="prediction")
tprVolume(obj, interval="prediction", bark=FALSE)
tprVolume(obj, interval="prediction", AB=list(A=0.1, B=5.1, sl=0.1), iAB="H")
</code></pre>


</div>