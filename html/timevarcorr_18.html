<div class="container">

<table style="width: 100%;"><tr>
<td>test_ref</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Test difference between correlation coefficient estimates and a value of reference</h2>

<h3>Description</h3>

<p>This function tests whether smoothed correlation values are equal (H0) or not to a reference value (default = <code>0</code>).
The test is not described in Choi &amp; Shin, 2021, but it is based on the idea behind <code>test_equality()</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">test_ref(
  tcor_obj,
  t = tcor_obj$t,
  r_ref = 0,
  test = c("student", "chi2"),
  p.adjust.methods = c("none", "bonferroni", "holm", "hochberg", "hommel", "BH", "BY",
    "fdr")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tcor_obj</code></td>
<td>
<p>the output of a call to <code>tcor()</code> with <code>CI = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>a vector of time point(s) used by the test (by default, all time points are considered).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r_ref</code></td>
<td>
<p>a scalar indicating the reference value for the correlation coefficient to be used in the test (default = <code>0</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>a character string indicating which test to use ("student", the default; or "chi2").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.adjust.methods</code></td>
<td>
<p>a character string indicating the method used to adjust p-values for multiple testing (see <code>p.adjust()</code>; default = "none").</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Two different test statistics can be used, one is asymptotically Student-t distributed under H0 and one is chi-square distributed.
In practice, it seems to give very similar results.
</p>


<h3>Value</h3>

<p>a data.frame with the result of the test, including the effect size (<code>delta_r = r[t] - r_ref</code>).
</p>


<h3>See Also</h3>

<p><code>test_equality()</code>, <code>tcor()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Comparison of all correlation values to reference of 0.5

res &lt;- with(stockprice, tcor(x = SP500, y = FTSE100, t = DateID, h = 300, CI = TRUE))
ref &lt;- 0.5
test_against_ref &lt;- test_ref(res, r_ref = ref)
head(test_against_ref)


## Plot to illustrate the correspondance with confidence intervals

plot(res$r ~ res$t, type = "l", ylim = c(0, 1), col = NULL)
abline(v = test_against_ref$t[test_against_ref$p &gt; 0.05], col = "lightgreen")
abline(v = test_against_ref$t[test_against_ref$p &lt; 0.05], col = "red")
points(res$r ~ res$t, type = "l")
points(res$upr ~ res$t, type = "l", lty = 2)
points(res$lwr ~ res$t, type = "l", lty = 2)
abline(h = ref, col = "blue")


## Test correlation of 0 a specific time points (using index or dates)

test_ref(res, t = c(100, 150))
test_ref(res, t = c("2000-08-18", "2000-10-27"))

</code></pre>


</div>