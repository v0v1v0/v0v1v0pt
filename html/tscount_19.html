<div class="container">

<table style="width: 100%;"><tr>
<td>interv_test.tsglm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Testing for Interventions in Count Time Series Following Generalised Linear Models
</h2>

<h3>Description</h3>

<p>Test for one or more interventions of given type at given time as proposed by Fokianos and Fried (2010, 2012).
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'tsglm'
interv_test(fit, tau, delta, external, 
            info=c("score"), est_interv=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>

<p>an object of class <code>"tsglm"</code>. Usually the result of a call to <code>tsglm</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>

<p>integer vector of times at which the interventions occur which are tested for.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>

<p>numeric vector that determines the types of the interventions (see Details). Must be of the same length as <code>tau</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>external</code></td>
<td>

<p>logical vector of length <code>length(tau)</code> specifying for each intervention wether its effect is external or not (see Details). If this is only a scalar this choice will be used for all interventions. If this is only a scalar this choice will be used for all interventions. If omitted all interventions will have an internal effect (i.e. <code>external=FALSE</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>info</code></td>
<td>

<p>character value that determines how to calculate the information matrix, see <code>tsglm</code>. Currently <code>"score"</code> is the only possible choice.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est_interv</code></td>
<td>

<p>logical value. If <code>est_interv=TRUE</code> a fit for the model with all specified interventions is computed and additionally returned.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>additional arguments passed to the fitting function <code>tsglm</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A score test on the null hypothesis of no interventions is done. The null hypothesis is that the data are generated from the model specified in the argument <code>model</code>, see definition in <code>tsglm</code>. Under the alternative there are one or more intervention effects occuring at times <code>tau</code>. The types of the intervention effects are specified by <code>delta</code> as defined in <code>interv_covariate</code>. The interventions are included as additional covariates according to the definition in <code>tsglm</code>. It can have an internal (the default) or external (<code>external=TRUE</code>) effect (see Liboschik et al., 2014).
</p>
<p>Under the null hypothesis the test statistic has asymptotically a chi-square distribution with <code>length(tau)</code> (i.e. the number of breaks) degrees of freedom. The returned p-value is based on this and approximately valid for long time series, i.e. when <code>length(ts)</code> large.
</p>


<h3>Value</h3>

<p>An object of class <code>"interv_test"</code>, which is a list with at least the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>test_statistic</code></td>
<td>

<p>value of the test statistic.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>

<p>degrees of freedom of the chi-squared distribution the test statistic is compared with.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_value</code></td>
<td>

<p>p-value of the test.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit_H0</code></td>
<td>

<p>object of class <code>"tsglm"</code> with the fitted model under the null hypothesis of no intervention, see <code>tsglm</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model_interv</code></td>
<td>

<p>model specification of the model with the specified interventions.
</p>
</td>
</tr>
</table>
<p>If argument <code>est_interv=TRUE</code>, the following component is additionally returned:
</p>
<table><tr style="vertical-align: top;">
<td><code>fit_interv</code></td>
<td>

<p>object of class <code>"tsglm"</code> with the fitted model with the specified interventions, see <code>tsglm</code>.
</p>
</td>
</tr></table>
<h3>Author(s)</h3>

<p>Tobias Liboschik, Philipp Probst, Konstantinos Fokianos and Roland Fried
</p>


<h3>References</h3>

<p>Fokianos, K. and Fried, R. (2010) Interventions in INGARCH processes. <em>Journal of Time Series Analysis</em> <b>31(3)</b>, 210–225, <a href="http://dx.doi.org/10.1111/j.1467-9892.2010.00657.x">http://dx.doi.org/10.1111/j.1467-9892.2010.00657.x</a>.
</p>
<p>Fokianos, K., and Fried, R. (2012) Interventions in log-linear Poisson autoregression. <em>Statistical Modelling</em> <b>12(4)</b>, 299–322. <a href="http://dx.doi.org/10.1177/1471082X1201200401">http://dx.doi.org/10.1177/1471082X1201200401</a>.
</p>
<p>Liboschik, T. (2016) Modelling count time series following generalized linear models. <em>PhD Thesis TU Dortmund University</em>, <a href="http://dx.doi.org/10.17877/DE290R-17191">http://dx.doi.org/10.17877/DE290R-17191</a>.
</p>
<p>Liboschik, T., Kerschke, P., Fokianos, K. and Fried, R. (2016) Modelling interventions in INGARCH processes. <em>International Journal of Computer Mathematics</em> <b>93(4)</b>, 640–657, <a href="http://dx.doi.org/10.1080/00207160.2014.949250">http://dx.doi.org/10.1080/00207160.2014.949250</a>.
</p>


<h3>See Also</h3>

<p>S3 method <code>print</code>.
</p>
<p><code>tsglm</code> for fitting a GLM for time series of counts.
<code>interv_detect</code> for detection of single interventions of given type and <code>interv_multiple</code> for iterative detection of multiple interventions of unknown types. <code>interv_covariate</code> for generation of deterministic covariates describing intervention effects.
</p>


<h3>Examples</h3>

<pre><code class="language-R">###Campylobacter infections in Canada (see help("campy"))
#Test for the intervention effects which were found in Fokianos und Fried (2010):
campyfit &lt;- tsglm(ts=campy, model=list(past_obs=1, past_mean=c(7,13)))
campyfit_intervtest &lt;- interv_test(fit=campyfit, tau=c(84,100), delta=c(1,0))
campyfit_intervtest
</code></pre>


</div>