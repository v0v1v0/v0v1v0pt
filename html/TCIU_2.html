<div class="container">

<table style="width: 100%;"><tr>
<td>fmri_3dvisual</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>visualization of the 3D brain with the activated areas</h2>

<h3>Description</h3>

<p>a visualization method, using <code>plotly</code> to draw the 3D plot of the brain 
with the activated areas determined by p-values, which is generated from fMRI data
</p>


<h3>Usage</h3>

<pre><code class="language-R">fmri_3dvisual(
  pval,
  mask,
  p_threshold = 0.05,
  method = "scale_p",
  color_pal = "YlOrRd",
  multi_pranges = TRUE,
  title = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pval</code></td>
<td>
<p>a 3D array of p-values used to plot activated area of the brain</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mask</code></td>
<td>
<p>a 3D nifti or 3D array of data to show the shell of the brain</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_threshold</code></td>
<td>
<p>NULL or a numeric value that can be selected randomly below 0.05 to 
drop all p-values above the threshold. If 'low5_percent' method is used, 
make 'p_threshold' as NULL. The default is 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a string that represents method for the plot.
There are 2 options: 'scale_p' and 'low5_percent'. The default is 'scale_p'. 
'scale_p' is to draw the plot with fixed color scale for fixed range of p value.
'low5_percent' is to draw the plot for the smallest 5 percent of p value when all the p values are not significant.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color_pal</code></td>
<td>
<p>the name of the color palettes provided by <code>RColorBrewer</code>. The default is "YlOrRd".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>multi_pranges</code></td>
<td>
<p>an option under 'scale_p' method to decide whether there are at most 9 colors 
in the legend for the ranges of p value, or at most 4 colors. 
The default is TRUE, choosing the larger number of colors for the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>the title of the plot. The default is NULL.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>fmri_3dvisual</code> is used to visualize the 3D plot of the brain 
with its activated parts based on provided p values. The p values are generated by
applying statistical test on fMRI data. When providing input of a 3D p-values data, 
a 3D interactive plot will be generated with surface for the brain shell 
and scatter points in different colors and size representing different stimulated levels.
</p>


<h3>Value</h3>

<p>a list of two elements
</p>

<ul>
<li>
<p> plot - the 3d plot of the fMRI data drawn by <code>plotly</code>
</p>
</li>
<li>
<p> pval_df - data.frame with the p value for each voxel and the specified color for it
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>SOCR team &lt;<a href="http://socr.umich.edu/people/">http://socr.umich.edu/people/</a>&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R"># sample 3D data of mask provided by the package
dim(mask)
# sample 3D p value provided by the package
dim(phase2_pval)

# make the 3D plot
fmri_3dvisual(phase2_pval, mask, p_threshold = 0.05, method="scale_p")$plot

</code></pre>


</div>