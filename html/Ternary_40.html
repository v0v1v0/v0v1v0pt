<div class="container">

<table style="width: 100%;"><tr>
<td>TernaryContour</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Add contours to a ternary plot</h2>

<h3>Description</h3>

<p>Draws contour lines to depict the value of a function in ternary space.
</p>


<h3>Usage</h3>

<pre><code class="language-R">TernaryContour(
  Func,
  resolution = 96L,
  direction = getOption("ternDirection", 1L),
  region = getOption("ternRegion", ternRegionDefault),
  within = NULL,
  filled = FALSE,
  legend,
  legend... = list(),
  nlevels = 10,
  levels = pretty(zlim, nlevels),
  zlim,
  color.palette = function(n) hcl.colors(n, palette = "viridis", alpha = 0.6),
  fill.col = color.palette(length(levels) - 1),
  func... = list(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Func</code></td>
<td>
<p>Function taking vectors of coordinates <code>a</code>, <code>b</code> and <code>c</code>, which
returns a numeric vector whose value at each coordinate will be depicted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resolution</code></td>
<td>
<p>The number of triangles whose base should lie on the longest
axis of the triangle.  Higher numbers will result in smaller subdivisions and smoother
colour gradients, but at a computational cost.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>direction</code></td>
<td>
<p>(optional) Integer specifying the direction that the
current ternary plot should point: 1, up; 2, right; 3, down; 4, left.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>region</code></td>
<td>
<p>(optional) Named list of length two specifying the the
<code>min</code>imum and <code>max</code>imum values of each ternary axis to be drawn
(e.g. <code style="white-space: pre;">⁠list(min = c(40, 0, 0), max = c(100, 60, 60)⁠</code>);
or a set of coordinates in a format accepted by <code>TernaryPoints()</code>.
The plotted region will correspond to the smallest equilateral triangle
that encompasses the specified ranges or coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>within</code></td>
<td>
<p>List or matrix of <em>x, y</em> coordinates within which contours
should be evaluated, in any format supported by
<code>xy.coords(x = within)</code>.
If <code>NULL</code>, defaults to a region slightly smaller than the ternary plot.
The <code style="white-space: pre;">⁠$hull⁠</code> entry generated by <code>TriangleInHull()</code> may also be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filled</code></td>
<td>
<p>Logical; if <code>TRUE</code>, contours will be filled
(using <code>.filled.contour()</code>.).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>
<p>Character vector specifying annotations for colour scale.
If not provided, no colour legend is displayed.
Specify <code>TRUE</code> to generate automatically, or a single integer to generate
<code>legend</code> annotations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend...</code></td>
<td>
<p>List of additional parameters to send to
<code>SpectrumLegend()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlevels, levels, zlim, ...</code></td>
<td>
<p>parameters to pass to
<code>contour()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color.palette</code></td>
<td>
<p>parameters to pass to
<code>.filled.contour()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fill.col</code></td>
<td>
<p>Sent as <code>col</code> parameter to
<code>.filled.contour()</code>.
Computed from <code>color.palette</code> if not specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>func...</code></td>
<td>
<p>List of additional parameters to send to <code>Func()</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>TernaryContour()</code>  invisibly returns a list containing:
</p>

<ul>
<li> <p><code>x</code>,<code>y</code>: the Cartesian coordinates of each evaluated point;
</p>
</li>
<li> <p><code>z</code>: The value of <code>Func()</code> at each coordinate.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p><a href="https://orcid.org/0000-0001-5660-1727">Martin R. Smith</a>
(<a href="mailto:martin.smith@durham.ac.uk">martin.smith@durham.ac.uk</a>)
</p>


<h3>See Also</h3>

<p>Other contour plotting functions: 
<code>ColourTernary()</code>,
<code>TernaryDensityContour()</code>,
<code>TernaryPointValues()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">FunctionToContour &lt;- function (a, b, c) {
  a - c + (4 * a * b) + (27 * a * b * c)
}

# Set up plot
originalPar &lt;- par(mar = rep(0, 4))
TernaryPlot(alab = "a", blab = "b", clab = "c")
values &lt;- TernaryPointValues(FunctionToContour, resolution = 24L)
ColourTernary(
  values,
  legend = signif(seq(max(values), min(values), length.out = 4), 2),
  bty = "n"
)
TernaryContour(FunctionToContour, resolution = 36L)

# Note that FunctionToContour is sent a vector.
# Instead of
BadMax &lt;- function (a, b, c) {
  max(a, b, c)
}

# Use
GoodMax &lt;- function (a, b, c) {
  pmax(a, b, c)
}
TernaryPlot(alab = "a", blab = "b", clab = "c")
ColourTernary(TernaryPointValues(GoodMax))
TernaryContour(GoodMax)

# Or, for a generalizable example,
GeneralMax &lt;- function (a, b, c) {
  apply(rbind(a, b, c), 2, max)
}
TernaryPlot(alab = "a", blab = "b", clab = "c")
# Fill the contour areas, rather than using tiles
TernaryContour(GeneralMax, filled = TRUE,
               legend = c("Max", "...", "Min"), legend... = list(bty = "n"),
               fill.col =  hcl.colors(14, palette = "viridis", alpha = 0.6))
# Re-draw edges of plot triangle over fill
TernaryPolygon(diag(3))

# Restore plotting parameters
par(originalPar)
</code></pre>


</div>