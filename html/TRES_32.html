<div class="container">

<table style="width: 100%;"><tr>
<td>TRRsim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate simulation data for tensor response regression (TRR)</h2>

<h3>Description</h3>

<p>This function is used to generate simulation data used in tensor response regression.
</p>


<h3>Usage</h3>

<pre><code class="language-R">TRRsim(r, p, u, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>The dimension of response, a vector with length larger than 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>The dimension of predictor, a scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>The structural dimension of envelopes at each mode, a vector with the same length as <code>r</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The sample size.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The tensor response regression model is of the form,
</p>
<p style="text-align: center;"><code class="reqn">Y = B \bar{\times}_{(m+1)} X + \epsilon</code>
</p>

<p>where predictor <code class="reqn">X \in R^{p}</code>, response <code class="reqn">Y \in R^{r_1\times \cdots\times r_m}</code>, <code class="reqn">B \in R^{r_1\times \cdots\times r_m \times p}</code> and the error term is tensor normal distributed as follows,
</p>
<p style="text-align: center;"><code class="reqn">\epsilon \sim TN(0;\Sigma_1,\dots,\Sigma_m).</code>
</p>

<p>According to the tensor envelope structure, we have
</p>
<p style="text-align: center;"><code class="reqn">B = [\Theta;\Gamma_1,\ldots,\Gamma_m, I_p],</code>
</p>

<p style="text-align: center;"><code class="reqn">\Sigma_k = \Gamma_k \Omega_k \Gamma_k^{T} + \Gamma_{0k} \Omega_{0k} \Gamma_{0k}^T,</code>
</p>

<p>for some <code class="reqn">\Theta \in R^{u_1\times\cdots\times u_m \times p}</code>, <code class="reqn">\Omega_k \in R^{u_k \times u_k}</code> and <code class="reqn">\Omega_{0k} \in \in R^{(p_k - u_k) \times (p_k - u_k)}</code>, <code class="reqn">k=1,\ldots,m</code>.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The predictor of dimension <code class="reqn">p\times n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The response of dimension <code class="reqn">r_1\times \cdots\times r_m \times n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gamma</code></td>
<td>
<p>The envelope subspace basis of dimension <code class="reqn">r_k \times u_k, \ k=1,\ldots,m</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>The tensor coefficients of dimension <code class="reqn">r_1\times \cdots\times r_m \times p</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>A lists of estimated covariance matrices at each mode for the error term, i.e., <code class="reqn">\Sigma_1,\dots,\Sigma_m</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p, r, u</code></td>
<td>
<p>The input <code>p,r,u</code>.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The length of <code>r</code> must match that of <code>u</code>, and each element of <code>u</code> must be less than the corresponding element in <code>r</code>.
</p>


<h3>References</h3>

<p>Li, L. and Zhang, X., 2017. Parsimonious tensor response regression. Journal of the American Statistical Association, 112(519), pp.1131-1146.
</p>


<h3>See Also</h3>

<p><code>TPR.fit, TPRsim</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">r &lt;- c(10, 10, 10)
u &lt;- c(2, 2, 2)
p &lt;- 5
n &lt;- 100
dat &lt;- TRRsim(r = r, p = p, u = u, n = n)
x &lt;- dat$x
y &lt;- dat$y
fit_std &lt;- TRR.fit(x, y, method="standard")

</code></pre>


</div>