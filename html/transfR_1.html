<div class="container">

<table style="width: 100%;"><tr>
<td>transfR-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Transfer of Hydrograph from Gauged to Ungauged Catchments</h2>

<h3>Description</h3>

<p>This R package aims to propose a geomorphology-based hydrological modelling to transfer streamflow measurements from gauged catchments to ungauged catchments, i.e. where there is no station monitoring the streamflow. It follows a runoff-runoff approach, i.e. it directly combines the observed streamflow series available at monitoring stations to estimate the streamflow series anywhere else in the surroundings rivers and without the need to implement a full rainfall-runoff model. The package itself and theoretical aspects of the approach are presented in detail and discussed by de Lavenne et al. (2023). <br><br></p>
<p>## — Short description of the modelling approach
</p>
<p>The hydrological modelling is based on a description of the hydro-geomorphometry of the river network which can be easily observed for any given outlet. An inversion of this model for a gauged catchment allows the observed streamflow series being deconvoluted in order to estimate an almost scale-independent signal, namely the net rainfall (Boudhraâ et al. 2018). Transferring this estimate of the net rainfall series to a targeted ungauged catchment then allows simulating the streamflow there. The use of streamflow observations from several gauged catchments of the neighbourhood increases the robustness of the simulation (de Lavenne et al. 2016). The methodology has first been implemented on a few catchments in semiarid Tunisia at the event time scale (Boudhraâ et al. 2009), then in dense configurations of neighbouring and nesting catchments in France with mainly temperate oceanic climate (de Lavenne et al. 2015; de Lavenne et al. 2016; de Lavenne and Cudennec 2019) and in snow-influenced Québec, Canada (Ecrepont et al. 2019). <br><br></p>
<p>## — Functions and objects
</p>
<p>To implement the method, it is advised to explore the following functions in this order:
</p>

<ul>
<li> <p><code>as_transfr</code> create a “transfR” database from a “stars” object and morphometric description of the catchments (hydraulic lengths)
</p>
</li>
<li> <p><code>velocity</code> estimates the main model parameter, i.e. the streamflow velocity, from different regionalisation strategies
</p>
</li>
<li> <p><code>uh</code> estimates a simple linear model, i.e. the unit hydrograph, based on the analysis of catchment geomorphology and streamflow velocity
</p>
</li>
<li> <p><code>rapriori</code> provides an a priori on the net rainfall, as needed for the model's inversion
</p>
</li>
<li> <p><code>inversion</code> estimates the net rainfall by an inverse modelling
</p>
</li>
<li> <p><code>hdist</code> computes hydrological distances between catchments, such as the rescaled Ghosh distances
</p>
</li>
<li> <p><code>mixr</code> estimates the net rainfall of one catchment by averaging the net rainfall of neighbouring gauged catchments and according to hydrological distances
</p>
</li>
<li> <p><code>convolution</code> computes the convolution of the net rainfall by the unit hydrograph to estimate streamflow
</p>
</li>
</ul>
<p>## — How to get started
</p>
<p>This package comes with two datasets (Blavet and Oudon) that contains all the necessary inputs to test the package and perform discharge prediction. Users are advised to check the 'Get started with transfR' vignette (<code>vignette("V01_get_started", package = "transfR")</code>) that provides a complete implementation of the method with the Oudon dataset. Two additional vignettes are proposed to help the preparation of input data: a spatiotemporal array of observed discharge (<code>vignette("V02_inputs_preparation_stars", package = "transfR")</code>) and a morphometric description of the catchments (<code>vignette("V03_inputs_preparation_whitebox", package = "transfR")</code>). In addition, each function comes with different examples.
</p>
<p>A detailed description of the modelling approach and the package has been published by de Lavenne et al. (2023): the theoretical aspects of each modelling step are described in more detail, arguments justifying the default values used in the functions are presented, and limitations of the approach are discussed for a consistent implementation of the approach.
</p>
<p>For the French region of Brittany, a <a href="https://geosas.fr/simfen/">web service</a> using this package was developed to facilitate the implementation of the method without the need for the user to have programming skills in R or to collect the necessary input data (Dallery et al. 2020).
</p>


<h3>References</h3>

<p>Boudhraâ H, Cudennec C, Slimani M, Andrieu H (2009).
“Hydrograph transposition between basins through a geomorphology-based deconvolution-reconvolution approach.”
<em>IAHS publication</em>, <b>333</b>, 76.
</p>
<p>Boudhraâ H, Cudennec C, Andrieu H, Slimani M (2018).
“Net rainfall estimation by the inversion of a geomorphology-based transfer function and discharge deconvolution.”
<em>Hydrological Sciences Journal</em>, <b>63</b>(2), 285–301.
<a href="https://doi.org/10.1080/02626667.2018.1425801">doi:10.1080/02626667.2018.1425801</a>.
</p>
<p>Ecrepont S, Cudennec C, Anctil F, Jaffrézic A (2019).
“PUB in Québec: A robust geomorphology-based deconvolution-reconvolution framework for the spatial transposition of hydrographs.”
<em>Journal of Hydrology</em>, <b>570</b>, 378–392.
<a href="https://doi.org/10.1016/j.jhydrol.2018.12.052">doi:10.1016/j.jhydrol.2018.12.052</a>.
</p>
<p>Dallery D, Squividant H, de Lavenne A, Launay J, Cudennec C (2020).
“An end-user-friendly hydrological Web Service for hydrograph prediction in ungauged basins.”
<em>Hydrological Sciences Journal</em>, 1–9.
<a href="https://doi.org/10.1080/02626667.2020.1797045">doi:10.1080/02626667.2020.1797045</a>.
</p>
<p>de Lavenne A, Boudhraâ H, Cudennec C (2015).
“Streamflow prediction in ungauged basins through geomorphology-based hydrograph transposition.”
<em>Hydrology Research</em>, <b>46</b>(2), 291–302.
<a href="https://doi.org/10.2166/nh.2013.099">doi:10.2166/nh.2013.099</a>.
</p>
<p>de Lavenne A, Skøien JO, Cudennec C, Curie F, Moatar F (2016).
“Transferring measured discharge time series: Large-scale comparison of Top-kriging to geomorphology-based inverse modeling.”
<em>Water Resources Research</em>, <b>52</b>(7), 5555–5576.
<a href="https://doi.org/10.1002/2016WR018716">doi:10.1002/2016WR018716</a>.
</p>
<p>de Lavenne A, Cudennec C (2019).
“Assessment of freshwater discharge into a coastal bay through multi-basin ensemble hydrological modelling.”
<em>Science of The Total Environment</em>, <b>669</b>, 812 - 820.
ISSN 0048-9697, <a href="https://doi.org/10.1016/j.scitotenv.2019.02.387">doi:10.1016/j.scitotenv.2019.02.387</a>.
</p>
<p>de Lavenne A, Loree T, Squividant H, Cudennec C (2023).
“The transfR toolbox for transferring observed streamflow series to ungauged basins based on their hydrogeomorphology.”
<em>Environmental Modelling &amp; Software</em>, <b>159</b>, 105562.
ISSN 1364-8152, <a href="https://doi.org/10.1016/j.envsoft.2022.105562">doi:10.1016/j.envsoft.2022.105562</a>.
</p>


</div>