<div class="container">

<table style="width: 100%;"><tr>
<td>sts_one_step_predictive</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute one-step-ahead predictive distributions for all timesteps</h2>

<h3>Description</h3>

<p>Given samples from the posterior over parameters, return the predictive
distribution over observations at each time <code>T</code>, given observations up
through time <code>T-1</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sts_one_step_predictive(
  observed_time_series,
  model,
  parameter_samples,
  timesteps_are_event_shape = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>observed_time_series</code></td>
<td>
<p><code>float</code> <code>tensor</code> of shape
<code style="white-space: pre;">⁠concat([sample_shape, model.batch_shape, [num_timesteps, 1]])⁠</code> where
<code>sample_shape</code> corresponds to i.i.d. observations, and the trailing <code style="white-space: pre;">⁠[1]⁠</code>
dimension may (optionally) be omitted if <code>num_timesteps &gt; 1</code>. May
optionally be an instance of <code>sts_masked_time_series</code>, which includes
a mask <code>tensor</code> to specify timesteps with missing observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>An instance of <code>StructuralTimeSeries</code> representing a
time-series model. This represents a joint distribution over
time-series and their parameters with batch shape <code style="white-space: pre;">⁠[b1, ..., bN]⁠</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameter_samples</code></td>
<td>
<p><code>list</code> of <code>tensors</code> representing posterior samples
of model parameters, with shapes
<code style="white-space: pre;">⁠list(tf$concat(list(list(num_posterior_draws), param&lt;1&gt;$prior$batch_shape, param&lt;1&gt;$prior$event_shape), list(list(num_posterior_draws), param&lt;2&gt;$prior$batch_shape, param&lt;2&gt;$prior$event_shape), ... ) )⁠</code>
for all model parameters.
This may optionally also be a named list mapping parameter names to <code>tensor</code> values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timesteps_are_event_shape</code></td>
<td>
<p>Deprecated, for backwards compatibility only. If False, the predictive distribution will return per-timestep probabilities Default value: TRUE.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>forecast_dist a <code>tfd_mixture_same_family</code> instance with event shape
<code>list(num_timesteps)</code> and batch shape <code>tf$concat(list(sample_shape, model$batch_shape))</code>, with
<code>num_posterior_draws</code> mixture components. The <code>t</code>th step represents the
forecast distribution <code>p(observed_time_series[t] | observed_time_series[0:t-1], parameter_samples)</code>.
</p>


<h3>See Also</h3>

<p>Other sts-functions: 
<code>sts_build_factored_surrogate_posterior()</code>,
<code>sts_build_factored_variational_loss()</code>,
<code>sts_decompose_by_component()</code>,
<code>sts_decompose_forecast_by_component()</code>,
<code>sts_fit_with_hmc()</code>,
<code>sts_forecast()</code>,
<code>sts_sample_uniform_initial_state()</code>
</p>


</div>