<div class="container">

<table style="width: 100%;"><tr>
<td>msl.trend</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Isolate trend component from mean sea level records.</h2>

<h3>Description</h3>

<p>Isolate trend component from mean sea level records.
</p>


<h3>Usage</h3>

<pre><code class="language-R">msl.trend(object, station_name = " ", fillgaps = 1, iter = 10000,
  vlm = " ", plot = TRUE, wdir = " ", save_summary = "TRUE")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an annual average mean sea level time series (refer <code>ts</code>)
with water levels (in millimetres). Missing data and maximum missing data gap
are limited to 15% and 5%, respectively, of the data record.<br></p>
<p><strong>Warning: </strong> If input data files do not conform to these pre-conditions,
the analysis will be terminated. It should be further noted that the existence
of long period oscillations in global mean sea level have been well recognised
in the literature (eg. Chambers et al. (2012); Minobe (1999)). Therefore, in
order to be effective for climate change and sea level research, time series
input files are recommended to have a minimum length of at least 80 years
in order that the package can identify and isloate such signals. Time series
less than 80 years in length will be analysed but a warning will be displayed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>station_name</code></td>
<td>
<p>character string, providing the name of the data record.
</p>
<p><strong>Note: </strong>This field can be left blank, however, it is retained for use
in banner labelling of plotting and associated outputs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fillgaps</code></td>
<td>
<p>numeric, provides 5 alternative gap filling procedures for
missing data. The following options are available:
</p>

<ul>
<li>
<p> 1: The default procedure is based on iterative gap filling using Singular Spectrum Analysis (refer <code>igapfill</code>);
</p>
</li>
<li>
<p> 2: linear interpolation (refer <code>na.approx</code>);
</p>
</li>
<li>
<p> 3: Cubic spline interpolation (refer <code>na.approx</code>);
</p>
</li>
<li>
<p> 4: Stineman's interpolation (refer <code>na.interpolation</code>); and
</p>
</li>
<li>
<p> 5: Weighted moving average (refer <code>na.ma</code>).
</p>
</li>
</ul>
<p><strong>Note: </strong>Gap filled portions of the time series are denoted in red on
the default screen plot. This is done specifically to provide ready visual
observation to discern if the selected gap filling method provides an
appropriate estimate within the gaps in keeping with the remainder of the
historical record. Depending on the nature of the record and extent of gaps,
some trial and error between alternatives might be necessary to optimise gap
filling. This is best achieved via the <code>gap.fillview</code> function
which permits visual screen checking of various gap-filling options prior to
undertaking the full trend analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>numeric, enables a user defined number of iterations for
bootstrapping to determine error margins. The user range is [500 to 10000]
where 10000 is the default setting.<br></p>
<p><strong>Warning: </strong>Although the default setting provides a more accurate basis
for estimating error margins, the degree of iterations slows the analysis and
can take several minutes to run.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vlm</code></td>
<td>
<p>numeric, enables a user defined quantum for vertical land motion
in mm/year within the range [-20 to 20]. This rate is used to convert the rate
of relative sea level rise to an estimate of geocentric sea level rise. Positive
rates of vlm are associated with land uplift, while conversely negative rates
of vlm are associated with subsidence. This can be left blank in which case
only estimates of relative mean sea level will be determined.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical, if “TRUE” then the original time series is
plotted to the screen along with the trend component and the result of gap
filling (where necessary). 95% confidence intervals have also been applied.
Default = “TRUE”.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wdir</code></td>
<td>
<p>character string, providing the name of the directory to send
output files (e.g., “C:/myproject/”) when the save_summary argument is set to "TRUE".
If this field is left blank the save_summary argument is switched off and a message
will be sent to the console.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save_summary</code></td>
<td>
<p>logical, if “TRUE” the object$Summary portion
of the returned value is exported direct to the defined  directory (wdir) and
saved as "detailed_summary_output.csv". Default = “FALSE”.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function deconstructs annual average time series data into a trend
and associated velocities and accelerations, filling necessary internal structures
to facilitate all other functions in this package. The trend is isloated using
Singular Spectrum Analysis, in particular, aggregating components whose low
frequency band [0 to 0.01] exceed a threshold contribution of 75%. Associated
velocities and accelerations are determined through the fitting of a cubic
smoothing spline to the trend with 1 degree of freedom per every 8 years of
record length. The fixed settings built into this function are based on the
detailed research and development summarised in Watson (2016a,b; 2018).
</p>


<h3>Value</h3>

<p>An object of class “msl.trend” is returned with the following
elements:
</p>

<dl>
<dt><strong>$Station.Name: </strong></dt>
<dd>
<p>the name of the data record.</p>
</dd>
<dt><strong>$Summary: </strong></dt>
<dd>
<p>a summary data frame of the relevant attributes
relating to the trend and
the inputted annual average data set, including:</p>
</dd>
</dl>
<ul>
<li>
<p>$Year: input data; 
</p>
</li>
<li>
<p>$MSL: input data; 
</p>
</li>
<li>
<p>$Trend: mean sea level trend; 
</p>
</li>
<li>
<p>$TrendSD: standard deviation of the determined mean sea level
trend; 
</p>
</li>
<li>
<p>$Vel: relative velocity (or first derivative) of mean sea level trend
(mm/year); 
</p>
</li>
<li>
<p>$VelSD: standard deviation of the velocity of the mean sea level
trend; 
</p>
</li>
<li>
<p>$Acc: acceleration (or second derivative) of mean sea level trend
(mm/year/year); 
</p>
</li>
<li>
<p>$AccSD: standard deviation of the acceleration of the mean sea level
trend; 
</p>
</li>
<li>
<p>$Resids: time series of uncorrelated residuals; and 
</p>
</li>
<li>
<p>$FilledTS: gap-filled time series (where necessary). 
</p>
</li>
<li>
<p>$VelGeo: geocentric velocity (or first derivative) of mean sea level
trend (mm/year)(only where vertical land motion has been supplied). 
</p>
</li>
</ul>
<dl>
<dt><strong>$Relative.Velocity: </strong></dt>
<dd>
<p>outputs the peak relative velocity
and the year in which it occurred.</p>
</dd>
<dt><strong>$Vertical.Land.Motion: </strong></dt>
<dd>
<p>outputs the vertical land motion
used to convert relative to geocentric velocity (user supplied input).</p>
</dd>
<dt><strong>$Geocentric.Velocity: </strong></dt>
<dd>
<p>outputs the peak geocentric velocity
and the year in which it occurred (if vertical land motion supplied).</p>
</dd>
<dt><strong>$Acceleration: </strong></dt>
<dd>
<p>outputs the peak acceleration and the
year in which it occurred.</p>
</dd>
<dt><strong>$Record.Length: </strong></dt>
<dd>
<p>outputs details of the start, end and
length of the input data set.</p>
</dd>
<dt><strong>$Fillgaps: </strong></dt>
<dd>
<p>outputs the extent of missing data (years) in
the original record and the gap filling method used (where necessary).</p>
</dd>
<dt><strong>$Bootstrapping.Iterations: </strong></dt>
<dd>
<p>outputs the number of iterations
used to generate the respective standard deviations for error margins.</p>
</dd>
<dt><strong>$Changepoints: </strong></dt>
<dd>
<p>outputs the number and time at which
changepoints in the variance of the uncorrelated residuals occur (if any).
Where changepoints are identified, block bootstrapping procedures are used
with residuals quarantined between changepoints.</p>
</dd>
</dl>
<h3>References</h3>

<p>Chambers, D.P., Merrifield, M.A., and Nerem, R.S., 2012. Is there
a 60 year oscillation in global mean sea level? <em>Geophysical Research Letters</em>, 39(18).
</p>
<p>Minobe, S., 1999. Resonance in bidecadal and pentadecadal climate oscillations
over the North Pacific: Role in climatic regime shifts. <em>Geophysical Research Letters</em>,
26(7), pp.855-858.
</p>
<p>Watson, P.J., 2016a. Identifying the best performing time series
analytics for sea-level research. In: <em>Time Series Analysis and
Forecasting, Contributions to Statistics</em>, pp. 261-278, ISBN 978-3-319-28725-6.
Springer International Publishing.
</p>
<p>Watson, P.J., 2016b. How to improve estimates of real-time acceleration in
the mean sea level signal. In: Vila-Concejo, A., Bruce, E., Kennedy, D.M.,
and McCarroll, R.J. (eds.), Proceedings of the 14th International Coastal
Symposium (Sydney, Australia). <em>Journal of Coastal Research</em>,
Special Issue, No. 75, pp. 780-785. Coconut Creek (Florida), ISSN 0749-0208.
</p>
<p>Watson, P.J., 2018. <em>Improved Techniques to Estimate Mean Sea Level,
Velocity and Acceleration from Long Ocean Water Level Time Series to Augment
Sea Level (and Climate Change) Research.</em> PhD Thesis, University of New South
Wales, Sydney, Australia.
</p>


<h3>See Also</h3>

<p><code>custom.trend</code>, <code>gap.fillview</code>, <code>check.decomp</code>,
<code>s</code>, <code>ts</code>, <code>msl.fileplot</code>,
<code>msl.screenplot</code>, <code>summary</code>, <code>Balt</code>,
<code>na.approx</code>, <code>na.interpolation</code>,
<code>na.ma</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(Balt) # Baltimore mean sea level record
ts1 &lt;- ts(Balt[2], start = Balt[1, 1]) # create time series input object
s &lt;- msl.trend(ts1, fillgaps = 3, iter = 500, 'BALTIMORE, USA')

data(s)
str(s) # check structure of object
msl.screenplot(s) # check screen output

</code></pre>


</div>