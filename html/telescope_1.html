<div class="container">

<table style="width: 100%;"><tr>
<td>identifyMixture</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Solve label switching and identify mixture.</h2>

<h3>Description</h3>

<p>Clustering of the draws in the point process representation (PPR) using
<code class="reqn">k</code>-means clustering.
</p>


<h3>Usage</h3>

<pre><code class="language-R">identifyMixture(Func, Mu, Eta, S, centers)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Func</code></td>
<td>
<p>A numeric array of dimension <code class="reqn">M \times d \times K</code>; data for clustering in the PPR.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Mu</code></td>
<td>
<p>A numeric array of dimension <code class="reqn">M \times r \times K</code>; draws of cluster means.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Eta</code></td>
<td>
<p>A numeric array of dimension <code class="reqn">M \times K</code>; draws of cluster sizes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>A numeric matrix of dimension <code class="reqn">M \times N</code>; draws of cluster assignments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>centers</code></td>
<td>
<p>An integer or a numeric matrix of dimension <code class="reqn">K \times d</code>; used to initialize <code>stats::kmeans()</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The following steps are implemented:
</p>

<ul>
<li>
<p> A functional of the draws of the component-specific
parameters (<code>Func</code>) is passed to the function.  The functionals
of each component and iteration are stacked on top of each other in
order to obtain a matrix where each row corresponds to the
functional of one component.
</p>
</li>
<li>
<p> The functionals are clustered into <code class="reqn">K_+</code> clusters using <code class="reqn">k</code>-means
clustering. For each functional a group label is obtained.
</p>
</li>
<li>
<p> The obtained labels of the functionals are used to construct
a classification for each MCMC iteration.  Those classifications
which are a permutation of <code class="reqn">(1,\ldots,K_+)</code> are used to reorder
the Mu and Eta draws and the assignment matrix S. This results in an
identified mixture model.
</p>
</li>
<li>
<p> Note that only iterations resulting in permutations
are used for parameter estimation and deriving the final
partition. Those MCMC iterations where the obtained
classifications of the functionals are not a permutation of
<code class="reqn">(1,\ldots,K_+)</code> are discarded as no unique assignment of functionals
to components can be made.  If the non-permutation rate, i.e. the
proportion of MCMC iterations where the obtained classifications
of the functionals are not a permutation, is high, this is an
indication of a poor clustering solution, as the
functionals are not clearly separated.
</p>
</li>
</ul>
<h3>Value</h3>

<p>A named list containing:
</p>

<ul>
<li> <p><code>"S"</code>: reordered assignments.
</p>
</li>
<li> <p><code>"Mu"</code>: reordered Mu matrix.
</p>
</li>
<li> <p><code>"Eta"</code>: reordered weights.
</p>
</li>
<li> <p><code>"non_perm_rate"</code>: proportion of draws where the clustering did not
result in a permutation and hence no relabeling could be
performed; this is the proportion of draws discarded.
</p>
</li>
</ul>
</div>