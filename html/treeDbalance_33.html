<div class="container">

<table style="width: 100%;"><tr>
<td>all3DImbalIndices</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculation of integral-based distance- and angle-based 3D imbalance indices</h2>

<h3>Description</h3>

<p><code>all3DImbalIndices</code> - This serves as a wrapper function to calculate 
a 3D imbalance index value of a 3D tree in phylo3D format according to the 
specified imbalance measurement and weighting scheme.<br>
If problems occur with the estimation of the integrals, try to increase 
the optional parameters  <br><code>rel.tolerance</code> and <code>max.subdiv</code>.
</p>
<p><code>A_Index</code> - Calculates the 3D imbalance index "weighted integral-based 
centroid angle" of a 3D tree in phylo3D format using either the 
edge weights or the edge lengths as weights.<br>
If problems occur with the estimation of the integrals, try to increase 
the optional parameters  <br><code>rel.tolerance</code> and <code>max.subdiv</code>.
</p>
<p><code>alpha_Index</code> - Calculates the 3D imbalance index "weighted 
integral-based minimal centroid angle" of a 3D tree in phylo3D format using 
either the edge weights or the edge lengths as weights.<br>
If problems occur with the estimation of the integrals, try to increase 
the optional parameters  <br><code>rel.tolerance</code> and <code>max.subdiv</code>.
</p>
<p><code>M_Index</code> - Calculates the 3D imbalance index "weighted integral-based 
expanded relative centroid distance" of a 3D tree in phylo3D format using 
either the edge weights or the edge lengths as weights.<br>
If problems occur with the estimation of the integrals, try to increase 
the optional parameters  <br><code>rel.tolerance</code> and <code>max.subdiv</code>.
</p>
<p><code>mu_Int</code> - Calculates the 3D imbalance index "weighted integral-based 
relative centroid distance" of a 3D tree in phylo3D format using either the 
edge weights or the edge lengths as weights.<br>
If problems occur with the estimation of the integrals, try to increase 
the optional parameters  <br><code>rel.tolerance</code> and <code>max.subdiv</code>.
</p>
<p><code>imbalInt_e</code> - Calculates the integral of the node imbalance values
over all possible subdividing nodes on an edge.
</p>
<p><code>imbalProfile_e</code> - Calculates the node imbalance values
for a given set of subdivisions of an edge.
</p>


<h3>Usage</h3>

<pre><code class="language-R">all3DImbalIndices(
  tree,
  imbal_type,
  weight = "edge_weight",
  rel.tolerance = 1e-10,
  max.subdiv = 200L
)

A_Index(tree, weight = "edge_weight", rel.tolerance = 1e-10, max.subdiv = 200L)

alpha_Index(
  tree,
  weight = "edge_weight",
  rel.tolerance = 1e-10,
  max.subdiv = 200L
)

M_Index(tree, weight = "edge_weight", rel.tolerance = 1e-10, max.subdiv = 200L)

mu_Index(
  tree,
  weight = "edge_weight",
  rel.tolerance = 1e-10,
  max.subdiv = 200L
)

imbalInt_e(
  p,
  v,
  centr_v,
  centr_v_weight,
  edge_weight,
  imbal_type,
  rel.tolerance = 1e-08,
  max.subdiv = 200L
)

imbalProfile_e(xs, p, v, centr_v, centr_v_weight, edge_weight, imbal_type)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>A rooted tree in phylo3D format (no special node enumeration 
required, except that nodes are numbered from 1 to |V| = the total number of
nodes). There must be at least 2 nodes, i.e., one edge. The attributes 
'node.coord' and 'edge.weight' are strictly required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>imbal_type</code></td>
<td>
<p>Specifies which node imbalance measurement should be used.
Available are:<br>
"A"     - centroid angle<br>
"alpha" - minimal centroid angle<br>
"M"     - expanded relative centroid distance<br>
"mu"    - relative centroid distance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>
<p>Specifies how the node imbalance values should be weighted.
Available weighting methods are: <br>
"edge_weight" (default) -&gt; Imbalance with regards to the total edge 
weight.<br>
"edge_length" -&gt; Imbalance with regards to the total edge length.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rel.tolerance</code></td>
<td>
<p>(Optional) Numeric value which specifies the relative 
tolerance which should be used for estimating the integral using 
stats::integrate. Set to 1e-10 by default (the stats::integrate default 
value is approx 3e-16).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.subdiv</code></td>
<td>
<p>(Optional) Integer value which specifies the maximal number 
of interval subdivisions for estimating the integral using stats::integrate. 
Set to 200 by default (stats::integrate default value 100).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Numeric vector of size 3 (3D coordinates of parent node <code class="reqn">p</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>Numeric vector of size 3 (3D coordinates of node <code class="reqn">v</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>centr_v</code></td>
<td>
<p>Numeric vector of size 3 (3D coordinates of the centroid of
the pending subtree of node <code class="reqn">v</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>centr_v_weight</code></td>
<td>
<p>Numeric value &gt;=0 (weight of the pending subtree of 
node <code class="reqn">v</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edge_weight</code></td>
<td>
<p>Numeric value &gt;=0 (weight of the edge <code class="reqn">(p,v)</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xs</code></td>
<td>
<p>Numeric vector with values between 0 (included) and 1 (excluded).
Set of edge subdivisions.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>all3DImbalIndices</code> Numeric value indicating the internal 3D
imbalance according to the chosen method.
</p>
<p><code>A_Index</code> Numeric value in the interval 
between 0 (included) and <code class="reqn">\pi</code> (excluded). A value near <code class="reqn">\pi</code> 
indicates a higher degree and near 0 a lower degree of asymmetry.
</p>
<p><code>alpha_Index</code> Numeric value in the interval 
between 0 (included) and <code class="reqn">\pi/2</code> (excluded). A value near <code class="reqn">\pi/2</code> 
indicates a higher degree and near 0 a lower degree of asymmetry.
</p>
<p><code>M_Index</code> Numeric value in the interval 
between 0 (included) and 1 (excluded). A value near 1 indicates a higher 
degree and near 0 a lower degree of asymmetry.
</p>
<p><code>mu_Index</code> Numeric value in the interval between 0 (included) 
and 1 (excluded). A value near 1 indicates a higher degree and near 0 a 
lower degree of asymmetry.
</p>
<p><code>imbalInt_e</code> Numeric value (0 minimal value, higher values
indicate a higher degree of asymmetry).
</p>
<p><code>imbalProfile_e</code> Numeric vector of imbalance values (0 minimal 
value, higher values indicate a higher degree of asymmetry) for the edge
subdivisions indicated by input <code>xs</code>.
</p>


<h3>Author(s)</h3>

<p>Sophie Kersting
</p>


<h3>Examples</h3>

<pre><code class="language-R">tree &lt;- treeDbalance::extendPhylo(treeDbalance::example3Dtrees$bean09)
all3DImbalIndices(tree, imbal_type = "A", weight="edge_length")
A_Index(tree, weight="edge_weight")
alpha_Index(tree)
M_Index(tree, weight="edge_length")
mu_Index(tree, weight="edge_length")
imbalInt_e(p=c(0,0,1),v=c(0,0,0),centr_v=c(0.5,0,0),
    centr_v_weight=1,edge_weight=1,imbal_type="mu")
imbalProfile_e(xs=c(0,0.2,0.4),p=c(1,1,0),v=c(0,0,0),centr_v=c(0.5,0,0),
    centr_v_weight=1,edge_weight=1,imbal_type="A")
</code></pre>


</div>