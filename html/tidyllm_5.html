<div class="container">

<table style="width: 100%;"><tr>
<td>generate_callback_function</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate API-Specific Callback Function for Streaming Responses</h2>

<h3>Description</h3>

<p>This function generates a callback function that processes streaming responses
from different language model APIs. The callback function is specific to the
API provided (<code>claude</code>, <code>ollama</code>, or <code>chatgpt</code>) and processes incoming data streams,
printing the content to the console and updating a global environment for further use.
</p>


<h3>Usage</h3>

<pre><code class="language-R">generate_callback_function(.api)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>.api</code></td>
<td>
<p>A character string indicating the API type. Supported values are
<code>"claude"</code>, <code>"ollama"</code>, and <code>"chatgpt"</code>.</p>
</td>
</tr></table>
<h3>Details</h3>


<ul>
<li> <p><strong>For Claude API</strong>: The function processes event and data lines, and handles the <code>message_start</code>
and <code>message_stop</code> events to control streaming flow.
</p>
</li>
<li> <p><strong>For Ollama API</strong>: The function directly parses the stream content as JSON and extracts the
<code>message$content</code> field.
</p>
</li>
<li> <p><strong>For ChatGPT API</strong>: The function handles JSON data streams and processes content deltas.
It stops processing when the <code style="white-space: pre;">⁠[DONE]⁠</code> message is encountered.
</p>
</li>
</ul>
<h3>Value</h3>

<p>A function that serves as a callback to handle streaming responses
from the specified API. The callback function processes the raw data, updates
the <code>.tidyllm_stream_env$stream</code> object, and prints the streamed content to the console.
The function returns <code>TRUE</code> if streaming should continue, and <code>FALSE</code> when
streaming is finished.
</p>


</div>