<div class="container">

<table style="width: 100%;"><tr>
<td>OptM1D</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate the envelope subspace (<span class="pkg">OptM</span> 1D)</h2>

<h3>Description</h3>

<p>The 1D algorithm to estimate the envelope subspace based on the line search algorithm for optimization on manifold. The line search algorithm is developed by Wen and Yin (2013) and the Matlab version is implemented in the Matlab package <span class="pkg">OptM</span>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">OptM1D(M, U, u, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>The <code class="reqn">p</code>-by-<code class="reqn">p</code> positive definite matrix <code class="reqn">M</code> in the envelope objective function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>U</code></td>
<td>
<p>The <code class="reqn">p</code>-by-<code class="reqn">p</code> positive semi-definite matrix <code class="reqn">U</code> in the envelope objective function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>An integer between 0 and <code class="reqn">n</code> representing the envelope dimension.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional user-defined arguments for the line search algorithm:
</p>

<ul>
<li> <p><code>maxiter</code>: The maximal number of iterations.
</p>
</li>
<li> <p><code>xtol</code>: The convergence tolerance for the relative changes of the consecutive iterates <code class="reqn">w</code>, e.g., <code class="reqn">||w^{(k)} - w^{(k-1)}||_F/\sqrt{p}</code>
</p>
</li>
<li> <p><code>gtol</code>: The convergence tolerance for the gradient of Lagrangian, e.g., <code class="reqn">||G^{(k)} - w^{(k)} (G^{(t)})^T w^{(t)}||_F</code>
</p>
</li>
<li> <p><code>ftol</code>: The convergence tolerance for relative changes of the consecutive objective function values <code class="reqn">F</code>, e.g., <code class="reqn">|F^{(k)} - F^{(k-1)}|/(1+|F^{(k-1)}|)</code>. Usually, <code>max{xtol, gtol} &gt; ftol</code>
</p>
</li>
</ul>
<p>The default values are: <code>maxiter=500; xtol=1e-08; gtol=1e-08; ftol=1e-12.</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The objective function <code class="reqn">F(w)</code> and its gradient <code class="reqn">G(w)</code> in line search algorithm are:
</p>
<p style="text-align: center;"><code class="reqn">F(w)=\log|w^T M_k w|+\log|w^T(M_k+U_k)^{-1}w|</code>
</p>

<p style="text-align: center;"><code class="reqn">G(w) = dF/dw = 2 (w^T M_k w)^{-1} M_k w + 2 (w^T (M_k + U_k)^{-1} w)^{-1}(M_k + U_k)^{-1} w</code>
</p>

<p>See Cook, R. D., &amp; Zhang, X. (2016) for more details of the 1D algorithm.
</p>


<h3>Value</h3>

<p>Return the estimated orthogonal basis of the envelope subspace.
</p>


<h3>References</h3>

<p>Cook, R.D. and Zhang, X., 2016. Algorithms for envelope estimation. Journal of Computational and Graphical Statistics, 25(1), pp.284-300.
</p>
<p>Wen, Z. and Yin, W., 2013. A feasible method for optimization with orthogonality constraints. Mathematical Programming, 142(1-2), pp.397-434.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Simulate two matrices M and U with an envelope structure
data &lt;- MenvU_sim(p = 20, u = 5, wishart = TRUE, n = 200)
M &lt;- data$M
U &lt;- data$U
G &lt;- data$Gamma
Gamma_1D &lt;- OptM1D(M, U, u = 5)
subspace(Gamma_1D, G)

</code></pre>


</div>