<div class="container">

<table style="width: 100%;"><tr>
<td>fortify.Spat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fortify <code style="white-space: pre;">⁠Spat*⁠</code> Objects</h2>

<h3>Description</h3>

<p>Fortify <code>SpatRaster</code> and <code>SpatVector</code> objects to data frames. This provide
native compatibility with <code>ggplot2::ggplot()</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'SpatRaster'
fortify(
  model,
  data,
  ...,
  .name_repair = "unique",
  maxcell = terra::ncell(model) * 1.1,
  pivot = FALSE
)

## S3 method for class 'SpatVector'
fortify(model, data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>A <code>SpatRaster</code> created with <code>terra::rast()</code> or a <code>SpatVector</code>
created with <code>terra::vect()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Not used by this method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments passed on to <code>layer()</code>'s <code>params</code> argument. These
arguments broadly fall into one of 4 categories below. Notably, further
arguments to the <code>position</code> argument, or aesthetics that are required
can <em>not</em> be passed through <code>...</code>. Unknown arguments that are not part
of the 4 categories below are ignored.
</p>

<ul>
<li>
<p> Static aesthetics that are not mapped to a scale, but are at a fixed
value and apply to the layer as a whole. For example, <code>colour = "red"</code>
or <code>linewidth = 3</code>. The geom's documentation has an <strong>Aesthetics</strong>
section that lists the available options. The 'required' aesthetics
cannot be passed on to the <code>params</code>. Please note that while passing
unmapped aesthetics as vectors is technically possible, the order and
required length is not guaranteed to be parallel to the input data.
</p>
</li>
<li>
<p> When constructing a layer using
a <code style="white-space: pre;">⁠stat_*()⁠</code> function, the <code>...</code> argument can be used to pass on
parameters to the <code>geom</code> part of the layer. An example of this is
<code>stat_density(geom = "area", outline.type = "both")</code>. The geom's
documentation lists which parameters it can accept.
</p>
</li>
<li>
<p> Inversely, when constructing a layer using a
<code style="white-space: pre;">⁠geom_*()⁠</code> function, the <code>...</code> argument can be used to pass on parameters
to the <code>stat</code> part of the layer. An example of this is
<code>geom_area(stat = "density", adjust = 0.5)</code>. The stat's documentation
lists which parameters it can accept.
</p>
</li>
<li>
<p> The <code>key_glyph</code> argument of <code>layer()</code> may also be passed on through
<code>...</code>. This can be one of the functions described as
key glyphs, to change the display of the layer in the legend.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.name_repair</code></td>
<td>
<p>Treatment of problematic column names:
</p>

<ul>
<li> <p><code>"minimal"</code>: No name repair or checks, beyond basic existence.
</p>
</li>
<li> <p><code>"unique"</code>: Make sure names are unique and not empty.
</p>
</li>
<li> <p><code>"check_unique"</code>: (default value), no name repair, but check they are
<code>unique</code>.
</p>
</li>
<li> <p><code>"universal"</code>: Make the names <code>unique</code> and syntactic.
</p>
</li>
<li>
<p> a function: apply custom name repair (e.g., <code>.name_repair = make.names</code>
for names in the style of base <strong>R</strong>).
</p>
</li>
<li>
<p> A purrr-style anonymous function, see <code>rlang::as_function()</code>.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxcell</code></td>
<td>
<p>positive integer. Maximum number of cells to use for
the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pivot</code></td>
<td>
<p>Logical. When <code>TRUE</code> the <code>SpatRaster</code> would be fortified on
long format. When <code>FALSE</code> (the default) it would
be fortified as a data frame with a column for each layer. See <strong>Details</strong>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>fortify.SpatVector()</code> returns a <code>sf</code> object and
<code>fortify.SpatRaster()</code> returns a <code>tibble</code>. See <strong>Methods</strong>.
</p>


<h3>Methods</h3>

<p>Implementation of the <strong>generic</strong> <code>ggplot2::fortify()</code> method.
</p>


<h4><code>SpatRaster</code></h4>

<p>Return a tibble than can be used with <code style="white-space: pre;">⁠ggplot2::geom_*⁠</code> like
<code>ggplot2::geom_point()</code>, <code>ggplot2::geom_raster()</code>, etc.
</p>
<p>The resulting tibble includes the coordinates on the columns <code style="white-space: pre;">⁠x, y⁠</code>. The
values of each layer are included as additional columns named as per the
name of the layer on the <code>SpatRaster</code>.
</p>
<p>The CRS of the <code>SpatRaster</code> can be retrieved with
<code>attr(fortifiedSpatRaster, "crs")</code>.
</p>
<p>It is possible to convert the fortified object onto a <code>SpatRaster</code> again with
<code>as_spatraster()</code>.
</p>
<p>When <code>pivot = TRUE</code> the <code>SpatRaster</code> is fortified in a "long" format (see
<code>tidyr::pivot_longer()</code>). The fortified object would have the following
columns:
</p>

<ul>
<li> <p><code style="white-space: pre;">⁠x,y⁠</code>: Coordinates (center) of the cell on the corresponding CRS.
</p>
</li>
<li> <p><code>lyr</code>: Indicating the name of the <code>SpatRaster</code> layer of <code>value</code>.
</p>
</li>
<li> <p><code>value</code>: The value of the <code>SpatRaster</code> in the corresponding <code>lyr</code>.
</p>
</li>
</ul>
<p>This option may be useful when using several <code style="white-space: pre;">⁠geom_*⁠</code> and for faceting, see
<strong>Examples</strong>.
</p>



<h4><code>SpatVector</code></h4>

<p>Return a <code>sf</code> object than can be used with <code>ggplot2::geom_sf()</code>.
</p>



<h3>See Also</h3>

<p><code>sf::st_as_sf()</code>, <code>as_tibble.Spat</code>, <code>as_spatraster()</code>,
<code>ggplot2::fortify()</code>.
</p>
<p>Other <a href="https://CRAN.R-project.org/package=ggplot2"><span class="pkg">ggplot2</span></a> utils:
<code>autoplot.Spat</code>,
<code>geom_spat_contour</code>,
<code>geom_spatraster()</code>,
<code>geom_spatraster_rgb()</code>,
<code>ggspatvector</code>,
<code>stat_spat_coordinates()</code>
</p>
<p>Other <a href="https://CRAN.R-project.org/package=ggplot2"><span class="pkg">ggplot2</span></a> methods:
<code>autoplot.Spat</code>
</p>
<p>Coercing objects:
<code>as_coordinates()</code>,
<code>as_sf()</code>,
<code>as_spatraster()</code>,
<code>as_spatvector()</code>,
<code>as_tibble.Spat</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">

# Get a SpatRaster
r &lt;- system.file("extdata/volcano2.tif", package = "tidyterra") %&gt;%
  terra::rast() %&gt;%
  terra::project("EPSG:4326")

fortified &lt;- ggplot2::fortify(r)

fortified

# The crs is an attribute of the fortified SpatRaster

attr(fortified, "crs")

# Back to a SpatRaster with
as_spatraster(fortified)

# You can now use a SpatRaster with any geom
library(ggplot2)

ggplot(r) +
  geom_histogram(aes(x = elevation),
    bins = 20, fill = "lightblue",
    color = "black"
  )

# ... and other packages
# Use metR with facets
library(metR)
temp &lt;- terra::rast(system.file("extdata/cyl_temp.tif",
  package = "tidyterra"
))
brks &lt;- seq(0, 21, 3) # Fix breaks!

# Pivot option for faceting
ggplot(temp, aes(x, y), pivot = TRUE) +
  # tidyterra, don't inherit aes
  geom_spatraster_contour_filled(
    data = temp, inherit.aes = FALSE,
    breaks = brks
  ) +
  # metR
  geom_contour_tanaka(aes(z = value), breaks = brks) +
  facet_wrap(~lyr, nrow = 1) +
  scale_fill_whitebox_d(palette = "muted") +
  theme_minimal() +
  labs(
    title = "tidyterra + metR", subtitle = "Facets",
    fill = "temp (°C)", x = "", y = ""
  )

# Create a SpatVector
extfile &lt;- system.file("extdata/cyl.gpkg", package = "tidyterra")
cyl &lt;- terra::vect(extfile)

cyl

# To sf
ggplot2::fortify(cyl)

# Now you can use geom_sf() straight away thanks to fortify::SpatVector()

library(ggplot2)

ggplot(cyl) +
  geom_sf()


</code></pre>


</div>