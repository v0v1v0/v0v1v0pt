<div class="container">

<table style="width: 100%;"><tr>
<td>TLSWlacf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute Localised Autocovariance Estimate of a TLSW Object</h2>

<h3>Description</h3>

<p>Computes the local autocovariance and autocorrelation estimates, given an
input of an object of class TLSW containing the estimated spectrum. Provides the same functionality as the
function <code>lacf</code> from the <code>locits</code> package, but user provides an object of
class <code>TLSW</code> as the main argument.
</p>


<h3>Usage</h3>

<pre><code class="language-R">TLSWlacf(x.TLSW, lag.max = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x.TLSW</code></td>
<td>
<p>a <code>TLSW</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lag.max</code></td>
<td>
<p>The maximum lag of acf required. If NULL then the same
default as in the regular acf function is used.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>lacf</code> which contains the following components:
</p>

<ul>
<li> <p><code>lacf</code>: a matrix containing the estimate of the local autocovariance. Columns represent lags
(beginning at lag 0), and rows represent time points.
</p>
</li>
<li> <p><code>lacr</code>: a matrix containing the estimate of the local autocorrelation. Columns represent lags
(beginning at lag 0), and rows represent time points.
</p>
</li>
<li> <p><code>name</code>: the name of the time series (if applicable).
</p>
</li>
<li> <p><code>date</code>: the date the function was executed.
</p>
</li>
<li> <p><code>SmoothWP</code>: The smoothed, un-corrected raw
wavelet periodogram of the input data.
</p>
</li>
<li> <p><code>S</code>: the spectral estimate used to compute the local autocovariance.
</p>
</li>
<li> <p><code>J</code>: the number of total wavelet scales.
</p>
</li>
</ul>
<h3>References</h3>

<p>McGonigle, E. T., Killick, R., and Nunes, M. (2022). Trend
locally stationary wavelet processes. <em>Journal of Time Series
Analysis</em>, 43(6), 895-917.
</p>
<p>Nason, G. P. (2013). A test for second-order stationarity and approximate
confidence intervals for localized autocovariances for locally stationary
time series. <em>Journal of the Royal Statistical Society: Series B
(Statistical Methodology)</em>, <b>75(5)</b>, 879â€“904.
</p>
<p>Nason, G. P. (2016). locits: Tests of stationarity and localized autocovariance.
R package version 1.7.3.
</p>


<h3>See Also</h3>

<p><code>lacf</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## ---- computes estimate of local autocovariance function


spec &lt;- matrix(0, nrow = 9, ncol = 512)
spec[2, ] &lt;- 1 + sin(seq(from = 0, to = 2 * pi, length = 512))^2

trend &lt;- seq(from = 0, to = 10, length = 512)

set.seed(123)

x &lt;- TLSWsim(trend = trend, spec = spec)

## ---- first estimate the spectrum:

x.TLSW &lt;- TLSW(x)

#---- estimate the lacf:

lacf.est &lt;- TLSWlacf(x.TLSW)

#---- plot the variance (lag 0 lacf) over time:

plot.ts(lacf.est$lacf[, 1], ylab = "Variance")
</code></pre>


</div>