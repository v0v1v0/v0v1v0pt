<div class="container">

<table style="width: 100%;"><tr>
<td>fit_meanshift</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fast implementation of meanshift model</h2>

<h3>Description</h3>

<p>Fast implementation of meanshift model
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit_meanshift(x, tau, distribution = "norm", ...)

fit_meanshift_norm(x, tau, ...)

fit_meanshift_lnorm(x, tau, ...)

fit_meanshift_norm_ar1(x, tau, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A time series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>a set of indices representing a changepoint set</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distribution</code></td>
<td>
<p>A character indicating the distribution of the data.
Should match R distribution function naming conventions
(e.g., "norm" for the Normal distribution, etc.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments passed to <code>stats::lm()</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>fit_meanshift_norm()</code> returns the same model as <code>fit_lmshift()</code> with the
<code>deg_poly</code> argument set to 0.
However, it is faster on large changepoint sets.
</p>
<p><code>fit_meanshift_lnorm()</code> fit the meanshift model with the assumption of
log-normally distributed data.
</p>
<p><code>fit_meanshift_norm_ar1()</code> applies autoregressive errors.
</p>


<h3>Value</h3>

<p>A mod_cpt object.
</p>


<h3>Author(s)</h3>

<p>Xueheng Shi, Ben Baumer
</p>


<h3>See Also</h3>

<p>Other model-fitting: 
<code>fit_lmshift()</code>,
<code>fit_meanvar()</code>,
<code>fit_nhpp()</code>,
<code>model_args()</code>,
<code>model_name()</code>,
<code>new_fun_cpt()</code>,
<code>whomademe()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Manually specify a changepoint set
tau &lt;- c(365, 826)

# Fit the model
mod &lt;- fit_meanshift_norm_ar1(DataCPSim, tau)

# View model parameters
logLik(mod)
deg_free(mod)

# Manually specify a changepoint set
cpts &lt;- c(1700, 1739, 1988)
ids &lt;- time2tau(cpts, as_year(time(CET)))

# Fit the model
mod &lt;- fit_meanshift_norm(CET, tau = ids)

# Review model parameters
glance(mod)

# Fit an autoregressive model
mod &lt;- fit_meanshift_norm_ar1(CET, tau = ids)

# Review model parameters
glance(mod)

</code></pre>


</div>