<div class="container">

<table style="width: 100%;"><tr>
<td>TVAR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multivariate Threshold Vector Autoregressive model</h2>

<h3>Description</h3>

<p>Estimate a multivariate Threshold VAR (TVAR), either using lags as transition variable (default),
or specifying an external variable.
</p>


<h3>Usage</h3>

<pre><code class="language-R">TVAR(
  data,
  lag,
  include = c("const", "trend", "none", "both"),
  model = c("TAR", "MTAR"),
  commonInter = FALSE,
  nthresh = 1,
  thDelay = 1,
  mTh = 1,
  thVar,
  trim = 0.1,
  ngrid,
  gamma = NULL,
  around,
  plot = FALSE,
  dummyToBothRegimes = TRUE,
  trace = TRUE,
  trick = "for",
  max.iter = 2
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>time series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lag</code></td>
<td>
<p>Number of lags to include in each regime</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include</code></td>
<td>
<p>Type of deterministic regressors to include</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Whether the transition variable is taken in levels (TAR) or
difference (MTAR)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>commonInter</code></td>
<td>
<p>Whether the deterministic regressors are regime specific
(<code>commonInter</code>=FALSE) or not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nthresh</code></td>
<td>
<p>Number of thresholds</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thDelay</code></td>
<td>
<p>'time delay' for the threshold variable (as multiple of
embedding time delay d) PLEASE NOTE that the notation is currently different
to univariate models in tsDyn. The left side variable is taken at time t, and
not t+1 as in univariate cases.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mTh</code></td>
<td>
<p>combination of variables with same lag order for the transition
variable. Either a single value (indicating which variable to take) or a
combination</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thVar</code></td>
<td>
<p>Optional. External transition variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trim</code></td>
<td>
<p>trimming parameter indicating the minimal percentage of
observations in each regime</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ngrid</code></td>
<td>
<p>number of elements of the grid, especially for <code>nthresh=3</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>prespecified threshold values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>around</code></td>
<td>
<p>The grid search is restricted to <var>ngrid</var> values around this
point. Especially useful for <code>nthresh=3</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>Whether a plot showing the results of the grid search should be
printed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dummyToBothRegimes</code></td>
<td>
<p>Whether the dummy in the one threshold model is
applied to each regime or not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>should additional infos be printed out?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trick</code></td>
<td>
<p>type of R function called: <code>for</code> or <code>mapply</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.iter</code></td>
<td>
<p>Number of iterations for the algorithm</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For fixed <code>th</code> and threshold variable, the model is linear, so
estimation can be done directly by CLS (Conditional Least Squares). The
search of the parameters values is made upon a grid of potential values. So
it is pretty slow.
</p>
<p>nthresh=1: estimation of one threshold model (two regimes) upon a grid of
<var>ngrid</var> values (default to ALL) possible thresholds and delays values.
</p>
<p>nthresh=2: estimation of two thresholds model (three regimes) Conditional on
the threshold found in model where nthresh=1, the second threshold is
searched. When both are found, a second grid search is made with 30 values
around each threshold.
</p>
<p>nthresh=3: DOES NOT estimate a 3 thresholds model, but a 2 thresholds model
with a whole grid over the thresholds parameters (so is really slow) with a
given delay, is there rather to check the consistency of the method nthresh=2
</p>


<h3>Value</h3>

<p>An object of class TVAR, with standard methods.
</p>


<h3>Author(s)</h3>

<p>Matthieu Stigler
</p>


<h3>References</h3>

<p>Lo and Zivot (2001) "Threshold Cointegration and Nonlinear
Adjustment to the Law of One Price," Macroeconomic Dynamics, Cambridge
University Press, vol. 5(4), pages 533-76, September.
</p>


<h3>See Also</h3>

<p><code>lineVar</code> for the linear VAR/VECM,
<code>TVAR.LRtest</code> to test for TVAR, <code>TVAR.sim</code> to
simulate/bootstrap a TVAR.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(zeroyld)

tv &lt;- TVAR(zeroyld, lag=2, nthresh=2, thDelay=1, trim=0.1, mTh=1, plot=FALSE)

print(tv)
summary(tv)

# a few useful methods:
plot(tv)
predict(tv)
c(AIC(tv), BIC(tv), logLik(tv))
</code></pre>


</div>