<div class="container">

<table style="width: 100%;"><tr>
<td>gsspFactorm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>High Dimensional Sparse  Factor Model</h2>

<h3>Description</h3>

<p>sparse factor analysis to extract latent linear factor and estimate row-sparse and entry-wise-sparse loading matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  gsspFactorm(X, q=NULL, lambda1=nrow(X)^(1/4), lambda2=nrow(X)^(1/4))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a <code>n</code>-by-<code>p</code> matrix, the observed data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>an integer between 1 and <code>p</code> or <code>NULL</code>, default as <code>NULL</code> and automatically choose q by the eigenvalue ratio method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda1</code></td>
<td>
<p>a non-negative number, the row-sparse penalty parameter, default as <code>n</code>^(1/4).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda2</code></td>
<td>
<p>a non-negative number, the entry-sparse penalty parameter, default as <code>n</code>^(1/4).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>return a list with class named <code>fac</code>, including following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>hH</code></td>
<td>
<p>a <code>n</code>-by-<code>q</code> matrix, the extracted lantent factor matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sphB</code></td>
<td>
<p>a <code>p</code>-by-<code>q</code> matrix, the estimated row-sparseloading matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hB</code></td>
<td>
<p>a <code>p</code>-by-<code>q</code> matrix, the estimated loading matrix without penalty.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>an integer between 1 and <code>p</code>, the number of factor extracted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>propvar</code></td>
<td>
<p>a positive number between 0 and 1, the explained propotion of cummulative variance by the <code>q</code> factors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>egvalues</code></td>
<td>
<p>a n-dimensional(n&lt;=p) or p-dimensional(p&lt;n) vector, the eigenvalues of sample covariance matrix.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>nothing
</p>


<h3>Author(s)</h3>

<p>Liu Wei
</p>


<h3>References</h3>

<p>Liu, W., Lin, H., Liu, J., &amp; Zheng, S. (2020). Two-directional simultaneous inference for high-dimensional models. arXiv preprint arXiv:2012.11100.
</p>


<h3>See Also</h3>

<p><code>factor</code>, <code>Factorm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  dat &lt;- gendata_Fac(n = 300, p = 500)
  res &lt;- gsspFactorm(dat$X)
  ccorFun(res$hH, dat$H0) # the smallest canonical correlation
  ## comparison of l2 norm
  oldpar &lt;- par(mar = c(5, 5, 2, 2), mfrow = c(1, 2))
  plot(rowSums(dat$B0^2), type='o', ylab='l2B', main='True')
  l2B &lt;- rowSums(res$sphB^2)
  plot(l2B, type='o', main='Est.')

  Bind &lt;- ifelse(dat$B0==0, 0, 1)
  hBind &lt;- ifelse(res$sphB==0, 0, 1)

  ## Select good penalty parameters
  dat &lt;- gendata_Fac(n = 300, p = 200)
  res &lt;- gsspFactorm(dat$X, lambda1=0.04*nrow(dat$X)^(1/4) ,lambda2=1*nrow(dat$X)^(1/4))
  ccorFun(res$hH, dat$H0) # the smallest canonical correlation

  ## comparison of l2 norm
  plot(rowSums(dat$B0^2), type='o', ylab='l2B', main='True')
  l2B &lt;- rowSums(res$sphB^2)
  plot(l2B, type='o', main='Est.')

  ## comparison of structure of loading matrix
  Bind &lt;- ifelse(dat$B0==0, 0, 1)
  hBind &lt;- ifelse(res$sphB==0, 0, 1)
  par(oldpar)


</code></pre>


</div>