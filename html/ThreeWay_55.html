<div class="container">

<table style="width: 100%;"><tr>
<td>varimcoco</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Varimax Rotation for Tucker3 and Tucker2</h2>

<h3>Description</h3>

<p>Performs varimax rotation of the core and component matrix rotations to simple structure.
</p>


<h3>Usage</h3>

<pre><code class="language-R">varimcoco(A, B, C, H, wa_rel, wb_rel, wc_rel, rot1, rot2, rot3, nanal)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>Columnwise orthomornal component matrix for the <code>A</code>-mode</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>Columnwise orthomornal component matrix for the <code>B</code>-mode</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>Columnwise orthomornal component matrix for the <code>C</code>-mode</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>
<p>Matricized core array (frontal slices)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wa_rel</code></td>
<td>
<p>relative weight (&gt;=0) for the simplicity of <code>A</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wb_rel</code></td>
<td>
<p>relative weight (&gt;=0) for the simplicity of <code>B</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wc_rel</code></td>
<td>
<p>relative weight (&gt;=0) for the simplicity of <code>C</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rot1</code></td>
<td>
<p>binary indicator (1 if the <code>A</code>-mode is rotated, 0 otherwise, default 1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rot2</code></td>
<td>
<p>binary indicator (1 if the <code>B</code>-mode is rotated, 0 otherwise, default 1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rot3</code></td>
<td>
<p>binary indicator (1 if the <code>C</code>-mode is rotated, 0 otherwise, default 1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nanal</code></td>
<td>
<p>Number of random starts, default 5</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list including the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>AS</code></td>
<td>
<p>Rotated component matrix for the <code>A</code>-mode</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BT</code></td>
<td>
<p>Rotated component matrix for the <code>B</code>-mode</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CU</code></td>
<td>
<p>Rotated component matrix for the <code>C</code>-mode</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>Rotated matricized core array (frontal slices)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>Rotation matrix for the <code>A</code>-mode</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T</code></td>
<td>
<p>Rotation matrix for the <code>B</code>-mode</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>U</code></td>
<td>
<p>Rotation matrix for the <code>C</code>-mode</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>Best solution for three-way orthomax function value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f1</code></td>
<td>
<p>Varimax value of <code>H</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f2a</code></td>
<td>
<p>Varimax value of <code>AS</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f2b</code></td>
<td>
<p>Varimax value of <code>BT</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f2c</code></td>
<td>
<p>Varimax value of <code>CU</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>func</code></td>
<td>
<p>Function values upon convergence for all the runs of the orthomax algorithm</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The simplicity values <code>f1</code>, <code>f2a</code>, <code>f2b</code>, <code>f2c</code> are based on ‘natural’ 
weigths and therefore comparable across matrices. When multiplied by the relative weights, 
they give the contribution to the overall simplicity value (they are <code>I^2/p</code>, <code>J^2/q</code> or <code>K^2/r</code>, 
respectively, times the sum of the variances of squared values).</p>


<h3>Author(s)</h3>

<p>Maria Antonietta Del Ferraro <a href="mailto:mariaantonietta.delferraro@yahoo.it">mariaantonietta.delferraro@yahoo.it</a> <br> Henk A.L. Kiers <a href="mailto:h.a.l.kiers@rug.nl">h.a.l.kiers@rug.nl</a> <br> Paolo Giordani <a href="mailto:paolo.giordani@uniroma1.it">paolo.giordani@uniroma1.it</a></p>


<h3>References</h3>

<p>H.A.L. Kiers (1998). Joint orthomax rotation of the core and component matrices resulting from three-mode principal components analysis. <em>Journal of Classification  15:245–263</em>.</p>


<h3>See Also</h3>

<p><code>orthmax2</code>, <code>varim</code></p>


<h3>Examples</h3>

<pre><code class="language-R">data(Bus)
# T3 solution
BusT3 &lt;- T3funcrep(Bus, 7, 5, 37, 2, 2, 2, 0, 1e-6)
# Simplicity of A (with weight = 2.5), B (with weight = 2) and C (with weight = 1.5)
T3vmABC &lt;- varimcoco(BusT3$A, BusT3$B, BusT3$C, BusT3$H, 2.5, 2, 1.5)
# Simplicity of only A (with weight = 2.5) and B (with weight = 2)
# rot3=0; the value of wc_rel (= 0) does not play an active role
T3vmAB &lt;- varimcoco(BusT3$A, BusT3$B, BusT3$C, BusT3$H, 2.5, 2, 0, 1, 1, 0)
# simplicity repeatedly with different relative weights for A, B and C
T3vm &lt;- list()
weight.a &lt;- c(1, 3, 6)
weight.b &lt;- c(0, 2, 5)
weight.c &lt;- c(1, 4)
i &lt;- 1
for (wa_rel in weight.a){
 for (wb_rel in weight.b){
  for (wc_rel in weight.c){
   T3vm[[i]] &lt;- varimcoco(BusT3$A, BusT3$B, BusT3$C, 
    BusT3$H, wa_rel, wb_rel, wc_rel)
   i &lt;- i+1
  }
 }
}
</code></pre>


</div>