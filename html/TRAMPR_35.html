<div class="container">

<table style="width: 100%;"><tr>
<td>TRAMP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>TRFLP Analysis and Matching Program</h2>

<h3>Description</h3>

<p>Determine if TRFLP profiles may match those in a database
of knowns.  The resulting object can be used to produce a
presence/absence matrix of known profiles in environmental samples.
</p>
<p>The <code>TRAMPR</code> package contains a vignette, which includes a worked
example; type <code>vignette("TRAMPRdemo")</code> to view it.
</p>


<h3>Usage</h3>

<pre><code class="language-R">TRAMP(samples, knowns, accept.error=1.5, min.comb=4, method="maximum")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>samples</code></td>
<td>
<p>A <code>TRAMPsamples</code> object, containing
unidentified samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knowns</code></td>
<td>
<p>A <code>TRAMPknowns</code> object, containing
identified TRFLP patterns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>accept.error</code></td>
<td>
<p>The largest acceptable difference (in base pairs)
between any peak in the sample data and the knowns database (see
Details; interpretation will depend on the value of <code>method</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.comb</code></td>
<td>
<p>Minimum number of enzyme/primer combinations required
before presence will be tested.  The default (4) should be
reasonable in most cases.  Setting <code>min.comb</code> to <code>NA</code> will
require that all enzyme/primer combinations in the knowns database
are present in the samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Method used in calculating the difference between
samples and knowns; may be one of <code>"maximum"</code>,
<code>"euclidian"</code> or <code>"manhattan"</code> (or any unambiguous
abbreviation).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>TRAMP</code> attempts to determine which species in the
‘knowns’ database <em>may</em> be present in a collection of
samples.
</p>
<p>A sample matches a known if it has a peak that is “close
enough” to every peak in the known for every enzyme/primer
combination that they share.  The default is to accept matches where
the largest distance between a peak in the knowns database and the
sample is less than <code>accept.error</code> base pairs (default 2), and
where at least <code>min.comb</code> enzyme/primer combinations are shared
between a sample and a known (default 4).
</p>
<p>The three-dimensional matrix of match errors is generated by
<code>create.diffsmatrix</code>.  In the resulting array,
<code>m[i,j,k]</code> is the difference (in base pairs) between the
<code>i</code>th sample and the <code>j</code>th known for the <code>k</code>th
enzyme/primer combination.
</p>
<p>If <code class="reqn">p_k</code> and <code class="reqn">q_k</code> are the sizes of peaks for the <code class="reqn">k</code>th
enzyme/primer combination for a sample and known (respectively), then
maximum distance is defined as
</p>
<p style="text-align: center;"><code class="reqn">\max(|p_k - q_k|)</code>
</p>

<p>Euclidian distance is defined as
</p>
<p style="text-align: center;"><code class="reqn">\frac{1}{n}\sqrt{\sum (p_k - q_k)^2}</code>
</p>

<p>and Manhattan distance is defined as
</p>
<p style="text-align: center;"><code class="reqn">\frac{1}{n}\sum{|p_k - q_k|}</code>
</p>

<p>where <code class="reqn">n</code> is the number of shared enzyme/primer combinations,
since this may vary across sample/known combinations.  For Euclidian
and Manhattan distances, <code>accept.error</code> then becomes the
<em>mean</em> distance, rather than the total distance.
</p>


<h3>Value</h3>

<p>A <code>TRAMP</code> object, with elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>presence</code></td>
<td>
<p>Presence/absence matrix.  Rows are different samples
(with rownames from <code>labels(samples)</code>) and columns are
different knowns (with colnames from <code>labels(knowns)</code>).  Do not
access the presence/absence matrix directly, but use
<code>summary.TRAMP</code>, which provides options for labelling
knowns, grouping knowns, and excluding “ignored” matches.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>error</code></td>
<td>
<p>Matrix of distances between the samples and known,
calculated by one of the methods described above.  Rows correspond
to different samples, and columns correspond to different knowns.
The matrix dimension names are set to the values <code>sample.pk</code>
and <code>knowns.pk</code> for the samples and knowns, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>A two-dimensional matrix (same dimensions as <code>error</code>),
recording the number of enzyme/primer combinations present for each
combination of samples and knowns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diffsmatrix</code></td>
<td>
<p>Three-dimensional array of output from
<code>create.diffsmatrix</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>enzyme.primer</code></td>
<td>
<p>Different enzyme/primer combinations present in
the data, in the order of the third dimension of <code>diffsmatrix</code>
(see <code>create.diffsmatrix</code> for details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samples, knowns, accept.error, min.comb, method</code></td>
<td>
<p>The input data
objects and arguments, unmodified.</p>
</td>
</tr>
</table>
<p>In addition, an element <code>presence.ign</code> is included to allow
matches to be ignored.  However, this interface is experimental and
its current format should not be relied on - use
<code>remove.TRAMP.match</code> rather than interacting directly with
<code>presence.ign</code>.
</p>
<p>Matching is based only on peak size (in base pairs), and does not
consider peak heights.
</p>


<h3>See Also</h3>

<p>See <code>create.diffsmatrix</code> for discussion of how differences
between sample and known profiles are generated.
</p>
<p><code>plot.TRAMP</code>, which displays TRAMP fits graphically.
</p>
<p><code>summary.TRAMP</code>, which creates a presence/absence matrix.
</p>
<p><code>remove.TRAMP.match</code>, which marks TRAMP matches as
ignored.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(demo.knowns)
data(demo.samples)

res &lt;- TRAMP(demo.samples, demo.knowns)

## The resulting object can be interrogated with methods:

## The goodness of fit of the sample with sample.pk=101 (see
## ?\link{plot.TRAMP}).
plot(res, 101)

## Not run: 
## To see all plots (this produces many figures), one after another.
op &lt;- par(ask=TRUE)
plot(res)
par(op)

## End(Not run)

## Produce a presence/absence matrix (see ?\link{summary.TRAMP}).
m &lt;- summary(res)
head(m)
</code></pre>


</div>