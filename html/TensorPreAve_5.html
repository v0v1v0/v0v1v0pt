<div class="container">

<table style="width: 100%;"><tr>
<td>pre_est</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Pre-Averaging Estimator</h2>

<h3>Description</h3>

<p>Function for the initial Pre-Averaging Procedure.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pre_est(X, z = rep(1, X@num_modes - 1), M0 = 200, M = 5, eigen_j = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A 'Tensor' object defined in package <span class="pkg">rTensor</span> with <code class="reqn">K+1</code> modes. Mode-1 should correspond to the time mode.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>(Estimated) Rank of the core tensor, written as a vector of length <code class="reqn">K</code>. For iterative projection purpose, we only need this to be 1's. Default is 1's.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M0</code></td>
<td>
<p>Number of random samples to generate, should be a positive integer. Default is 200.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>Number of chosen samples for pre-averaging, should be a positive integer. Usually can be set as constants (5 or 10) or 2.5 percents of <code>M0</code>. Default is 5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eigen_j</code></td>
<td>
<p>The j-th eigenvalue to calculate eigenvalue-ratio for a randomly chosen sample, written as a vector of length <code class="reqn">K</code>. Default is <code class="reqn">d_k/2</code> for all modes. Can be manually tuned using function <code>pre_eigenplot</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Input a tensor time series and return the estimated factor loading matrices (or directions) using pre-averaging method.
</p>


<h3>Value</h3>

<p>A list of <code class="reqn">K</code> estimated factor loading matrices.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Example of a real data set
set.seed(10)
Q_PRE = pre_est(value_weight_tensor)
Q_PRE

set.seed(10)
Q_PRE_2 = pre_est(value_weight_tensor, z = c(2,2))
Q_PRE_2


# Example using generated data
K = 2
T = 100
d = c(40,40)
r = c(2,2)
re = c(2,2)
eta = list(c(0,0),c(0,0))
u = list(c(-2,2),c(-2,2))
set.seed(10)
Data_test = tensor_data_gen(K,T,d,r,re,eta,u)
X = Data_test$X
Q_PRE = pre_est(X, z = r)
Q_PRE

</code></pre>


</div>