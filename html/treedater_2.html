<div class="container">

<table style="width: 100%;"><tr>
<td>boot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate of confidence intervals of molecular clock parameters with user-supplied set of bootstrap trees</h2>

<h3>Description</h3>

<p>If the original treedater fit estimated the root position, root
position will also be estimated for each simulation, so the
returned trees may have different root positions. Some replicates
may converge to a strict clock or a relaxed clock, so the
parameter estimates in each replicate may not be directly
comparable. It is possible to compute confidence intervals for the
times of particular nodes or for estimated sample times by
inspecting the output from each fitted treedater object, which is
contained in the $trees attribute.
</p>


<h3>Usage</h3>

<pre><code class="language-R">boot(td, tres, ncpu = 1, searchRoot = 1,
  overrideTempConstraint = TRUE, overrideClock = NULL, quiet = TRUE,
  normalApproxTMRCA = FALSE, parallel_foreach = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>td</code></td>
<td>
<p>A fitted treedater object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tres</code></td>
<td>
<p>A list or multiPhylo with bootstrap trees with branches in units of substitutions per site</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncpu</code></td>
<td>
<p>Number of threads to use for parallel computation. Recommended.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>searchRoot</code></td>
<td>
<p>See *dater*</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overrideTempConstraint</code></td>
<td>
<p>If TRUE (default) will not enforce positive branch lengths in simualtion replicates. Will speed up execution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overrideClock</code></td>
<td>
<p>May be 'strict' or 'additive' or 'relaxed' in which case will force simulations to fit the corresponding model. If ommitted, will inherit the clock model from td</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>
<p>If TRUE will minimize output printed to screen</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalApproxTMRCA</code></td>
<td>
<p>If TRUE will use estimate standard deviation from simulation replicates and report confidence interval based on normal distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel_foreach</code></td>
<td>
<p>If TRUE will use the foreach package for parallelization. May work better on HPC systems.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with elements 
</p>

<ul>
<li>
<p> trees: The fitted treedater objects corresponding to each simulation
</p>
</li>
<li>
<p> meanRates: Vector of estimated rates for each simulation
</p>
</li>
<li>
<p> meanRate_CI: Confidence interval for substitution rate
</p>
</li>
<li>
<p> coef_of_variation_CI: Confidence interval for rate variation
</p>
</li>
<li>
<p> timeOfMRCA_CI: Confidence interval for time of common ancestor
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Erik M Volz &lt;erik.volz@gmail.com&gt;
</p>


<h3>See Also</h3>

<p>dater
parboot
</p>


<h3>Examples</h3>

<pre><code class="language-R"># simulate a tree 
tre &lt;- ape::rtree(25)
# sample times based on distance from root to tip:
sts &lt;- setNames( ape::node.depth.edgelength( tre )[1:ape::Ntip(tre)], tre$tip.label)
# make a list of trees that simulate outcome of bootstrap using nonparametric phylogeny estimation
# also modify edge length to represent evolutionary distance with rate 1e-3:
bootTrees &lt;- lapply( 1:25, function(i) {
	.tre &lt;- tre
	.tre$edge.length &lt;- tre$edge.length * pmax(rnorm( length(tre$edge.length), 1e-3, 1e-4 ), 0 )
	.tre 
})
tre$edge.length &lt;- tre$edge.length * 1e-3
# run treedater
td &lt;- dater( tre, sts, s= 1000, clock='strict', omega0=.0015  )
# bootstrap: 
( tdboot &lt;- boot( td, bootTrees ) )
# plot lineages through time :
plot( tdboot )


</code></pre>


</div>