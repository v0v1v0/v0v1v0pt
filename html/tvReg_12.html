<div class="container">

<table style="width: 100%;"><tr>
<td>bw</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bandwidth Selection by Cross-Validation</h2>

<h3>Description</h3>

<p>Calculate bandwidth(s) by cross-validation for functions tvSURE, tvVAR and tvLM.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bw(x, ...)

## Default S3 method:
bw(
  x,
  y,
  z = NULL,
  cv.block = 0,
  est = c("lc", "ll"),
  tkernel = c("Triweight", "Epa", "Gaussian"),
  singular.ok = TRUE,
  ...
)

## S3 method for class 'list'
bw(
  x,
  y,
  z = NULL,
  cv.block = 0,
  est = c("lc", "ll"),
  tkernel = c("Triweight", "Epa", "Gaussian"),
  singular.ok = TRUE,
  ...
)

## S3 method for class 'tvlm'
bw(x, ...)

## S3 method for class 'tvar'
bw(x, ...)

## S3 method for class 'tvvar'
bw(x, ...)

## S3 method for class 'tvsure'
bw(x, ...)

## S3 method for class 'tvplm'
bw(x, ...)

## S3 method for class 'pdata.frame'
bw(
  x,
  z = NULL,
  method,
  cv.block = 0,
  est = c("lc", "ll"),
  tkernel = c("Triweight", "Epa", "Gaussian"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object used to select a method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other parameters passed to specific methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A matrix or vector with the dependent variable(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>A vector with the variable over which coefficients are smooth over.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv.block</code></td>
<td>
<p>A positive scalar with the size of the block in leave-one block-out cross-validation.
By default 'cv.block=0' meaning leave-one-out cross-validation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est</code></td>
<td>
<p>The nonparametric estimation method, one of "lc" (default) for linear constant
or "ll" for local linear.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tkernel</code></td>
<td>
<p>A character, either "Triweight" (default), "Epa" or "Gaussian" kernel function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>singular.ok</code></td>
<td>
<p>Logical. If FALSE, a singular model is an error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>A character with the choice of panel model/estimation method:
If method = <code>tvPOLS</code> (default) then the data is pooled estimated with time-varying OLS. 
No individual or time effects are estimated
If method = <code>tvFE</code> then individual effects which might be correlated with 
the regressors are estimated.
If method = <code>tvRE</code> then individual effects are considered random and independent
of the regressors.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>bw</code> returns a vector or a scalar with the bandwith to estimate the mean or the covariance
residuals, fitted values.
</p>
<p>A scalar or a vector of scalars.
</p>
<p>A scalar.
</p>


<h3>Examples</h3>

<pre><code class="language-R">##Generate data
tau &lt;- seq(1:200)/200
beta &lt;- data.frame(beta1 = sin(2*pi*tau), beta2 =  2*tau)
X &lt;- data.frame(X1 = rnorm(200), X2 =  rchisq(200, df = 4))
error &lt;- rt(200, df = 10)
y &lt;- apply(X*beta, 1, sum) + error

##Select bandwidth by cross-validation
bw &lt;- bw(X, y, est = "ll", tkernel = "Gaussian")

data( Kmenta, package = "systemfit" )

## x is a list of matrices containing the regressors, one matrix for each equation
x &lt;- list()
x[[1]] &lt;- Kmenta[, c("price", "income")]
x[[2]] &lt;- Kmenta[, c("price", "farmPrice", "trend")]

## 'y' is a matrix with one column for each equation
y &lt;- cbind(Kmenta$consump, Kmenta$consump)

## Select bandwidth by cross-validation
bw &lt;- bw(x = x, y = y)

##One bandwidth per equation
print(bw)

</code></pre>


</div>