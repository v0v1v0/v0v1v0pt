<div class="container">

<table style="width: 100%;"><tr>
<td>thetaruns</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Runs estimator
</h2>

<h3>Description</h3>

<p>Compute the empirical estimator of the extremal index using the runs method (Smith &amp; Weissman, 1994, JRSSB).
</p>


<h3>Usage</h3>

<pre><code class="language-R">thetaruns(ts, lapl = FALSE, nlag = 1,
          u.mar = 0, probs = seq(u.mar, 0.995, length.out = 30),
          method.mar = c("mle", "mom", "pwm"),
          R.boot = 0, block.length = (nlag+1) * 5, levels = c(0.025, 0.975))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ts</code></td>
<td>

<p>a vector, the time series for which to estimate the threshold-based extremal index <code class="reqn">\theta(x,m)</code>, with <code class="reqn">x</code> a probability level and <code class="reqn">m</code> a run-length (see details).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lapl</code></td>
<td>

<p>logical; is <code>ts</code> on the Laplace scale already? The default (FALSE) assumes unknown marginal distribution. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlag</code></td>
<td>

<p>the run-length; an integer larger or equal to 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u.mar</code></td>
<td>

<p>marginal threshold (probability); used when transforming the time series to Laplace scale if <code>lapl</code> is FALSE; if <code>lapl</code> is TRUE, it is nevertheless used when bootstrapping, since the bootstrapped series generally do not have Laplace marginal distributions.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probs</code></td>
<td>

<p>vector of probabilities; the values of <code class="reqn">x</code> for which to evaluate <code class="reqn">\theta(x,m)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method.mar</code></td>
<td>

<p>a character string defining the method used to estimate the marginal GPD; either <code>"mle"</code> for maximum likelihood or <code>"mom"</code> for method of moments or <code>"pwm"</code> for probability weighted moments methods. Defaults to <code>"mle"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>block.length</code></td>
<td>

<p>integer; the block length used for the block-bootstrapped confidence intervals.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R.boot</code></td>
<td>

<p>integer; the number of samples used for the block bootstrap.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>levels</code></td>
<td>

<p>vector of probabilites; the quantiles of the posterior distribution of the extremal index <code class="reqn">\theta(x,m)</code> to output.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Consider a stationary time series <code class="reqn">(X_t)</code>. A characterisation of the extremal index is
</p>
<p style="text-align: center;"><code class="reqn">\theta(x,m) = Pr(X_1\le x,\ldots,X_m\le x \mid X_0\ge x).</code>
</p>

<p>In the limit when <code class="reqn">x</code> and <code class="reqn">m</code> tend to <code class="reqn">\infty</code> appropriately, <code class="reqn">\theta</code> corresponds to the asymptotic inverse mean cluster size. It also links the generalised extreme value distribution of the independent series <code class="reqn">(Y_t)</code>, with the same marginal distribution as <code class="reqn">(X_t)</code>,
</p>
<p style="text-align: center;"><code class="reqn">G_Y(z)=G_X^\theta(z),</code>
</p>

<p>with <code class="reqn">G_X</code> and <code class="reqn">G_Y</code> the extreme value distributions of <code class="reqn">(X_t)</code> and <code class="reqn">(Y_t)</code> respectively.
</p>
<p><code>nlag</code> corresponds to the <em>run-length</em> <code class="reqn">m</code> and <code>probs</code> is a set of values for <code class="reqn">x</code>.
The <em>runs</em> estimator is computed, which consists of counting the proportion of clusters to the number of exceedances of a threshold <code class="reqn">x</code>; two exceedances of the threshold belong to different clusters if there are at least <code class="reqn">m+1</code> non-exceedances inbetween.
</p>


<h3>Value</h3>

<p>An object of class '<code>depmeasure</code>' containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>theta </code></td>
<td>
<p>matrix; estimates of the extremal index <code class="reqn">\theta(x,m)</code> with rows corresponding to the <code>probs</code> values of <code class="reqn">x</code> and the columns to the runs estimate and the chosen <code>levels</code>-quantiles of the bootstrap distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbr.exc </code></td>
<td>
<p>numeric vector; number of exceedances for each threshold corresponding to the elements in <code>probs</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probs </code></td>
<td>
<p><code>probs</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>levels </code></td>
<td>
<p>numeric vector; <code>probs</code> converted to the original scale of <code>ts</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlag </code></td>
<td>
<p><code>nlag</code>.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>theta2fit</code>, <code>thetafit</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## generate data from an AR(1)
## with Gaussian marginal distribution
n   &lt;- 10000
dep &lt;- 0.5
ar    &lt;- numeric(n)
ar[1] &lt;- rnorm(1)
for(i in 2:n)
  ar[i] &lt;- rnorm(1, mean=dep*ar[i-1], sd=1-dep^2)
## transform to Laplace scale
ar &lt;- qlapl(pnorm(ar))
## compute empirical estimate
theta &lt;- thetaruns(ts=ar, u.mar=.95, probs=c(.95,.98,.99))
## output
plot(theta, ylim=c(.2,1))
abline(h=1, lty="dotted")
</code></pre>


</div>