<div class="container">

<table style="width: 100%;"><tr>
<td>tune_lamb</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Parameter tuning in enhanced E-step in DEEM</h2>

<h3>Description</h3>

<p>Perform parameter tuning through BIC in DEEM.</p>


<h3>Usage</h3>

<pre><code class="language-R">tune_lamb(X, K, seqlamb, initial = TRUE, vec_x = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Input tensor (or matrix) list of length <code class="reqn">n</code>, where <code class="reqn">n</code> is the number of observations. Each element of the list is a tensor or matrix. The order of tensor can be any positive integer not less than 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>Number of clusters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seqlamb</code></td>
<td>
<p>A sequence of user-specified <code>lambda</code> values. <code>lambda</code> is the weight of L1 penalty and a smaller <code>lambda</code> allows more variables to be nonzero</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial</code></td>
<td>
<p>Whether to initialize algorithm with K-means clustering. Default value is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vec_x</code></td>
<td>
<p>Vectorized tensor data. Default value is <code>NULL</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>tune_lamb</code> function adopts a BIC-type criterion to select the tuning parameter <code class="reqn">\lambda</code> in the enhanced E-step. Let <code class="reqn">\widehat{\bm{\theta}}^{\lambda}</code> be the output of <code>DEEM</code> with the tuning parameter fixed at <code class="reqn">\lambda</code>, <code>tune_lamb</code> looks for the value of <code class="reqn">\lambda</code> that minimizes
</p>
<p style="text-align: center;"><code class="reqn">\mathrm{BIC}(\lambda)=-2\sum_{i=1}^n\log(\sum_{k=1}^K\widehat{\pi}^{\lambda}_kf_k(\mathbf{X}_i;\widehat{\bm{\theta}}_k^{\lambda}))+\log(n)\cdot |\widehat{\mathcal{D}}^{\lambda}|,</code>
</p>

<p>where <code class="reqn">\widehat{\mathcal{D}}^{\lambda}=\{(k, {\mathcal{J}}): \widehat b_{k,{\mathcal{J}}}^{\lambda} \neq 0 \}</code> is the set of nonzero elements in <code class="reqn">\widehat{\bm{B}}_2^{\lambda},\ldots,\widehat{\bm{B}}_K^{\lambda}</code>. The <code>tune_lamb</code> function intrinsically selects the initial point and return the optimal estimated labels.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>opt_lamb</code></td>
<td>
<p>Tuned <code>lambda</code> that leads to optimal BIC.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opt_bic</code></td>
<td>
<p>BIC value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opt_y</code></td>
<td>
<p>Estimated labels fitted by DEEM with tuned <code>lambda</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Kai Deng, Yuqing Pan, Xin Zhang and Qing Mai</p>


<h3>References</h3>

<p>Mai, Q., Zhang, X., Pan, Y. and Deng, K. (2021). A Doubly-Enhanced EM Algorithm for Model-Based Tensor Clustering. <em>Journal of the American Statistical Association</em>.</p>


<h3>See Also</h3>

<p><code>DEEM</code>, <code>tune_K</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
dimen = c(5,5,5)
nvars = prod(dimen)
K = 2
n = 100
sigma = array(list(),3)

sigma[[1]] = sigma[[2]] = sigma[[3]] = diag(5)

B2=array(0,dim=dimen)
B2[1:3,1,1]=2

y = c(rep(1,50),rep(2,50))
M = array(list(),K)
M[[1]] = array(0,dim=dimen)
M[[2]] = B2

vec_x=matrix(rnorm(n*prod(dimen)),ncol=n)
X=array(list(),n)
for (i in 1:n){
  X[[i]] = array(vec_x[,i],dim=dimen)
  X[[i]] = M[[y[i]]] + X[[i]]
}

mytune = tune_lamb(X, K=2, seqlamb=seq(0.01,0.1,by=0.01))

</code></pre>


</div>