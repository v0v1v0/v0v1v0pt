<div class="container">

<table style="width: 100%;"><tr>
<td>h_logistic_regression</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Helper functions for multivariate logistic regression</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt="[Stable]"></a>
</p>
<p>Helper functions used in calculations for logistic regression.
</p>


<h3>Usage</h3>

<pre><code class="language-R">h_get_interaction_vars(fit_glm)

h_interaction_coef_name(
  interaction_vars,
  first_var_with_level,
  second_var_with_level
)

h_or_cat_interaction(
  odds_ratio_var,
  interaction_var,
  fit_glm,
  conf_level = 0.95
)

h_or_cont_interaction(
  odds_ratio_var,
  interaction_var,
  fit_glm,
  at = NULL,
  conf_level = 0.95
)

h_or_interaction(
  odds_ratio_var,
  interaction_var,
  fit_glm,
  at = NULL,
  conf_level = 0.95
)

h_simple_term_labels(terms, table)

h_interaction_term_labels(terms1, terms2, table, any = FALSE)

h_glm_simple_term_extract(x, fit_glm)

h_glm_interaction_extract(x, fit_glm)

h_glm_inter_term_extract(odds_ratio_var, interaction_var, fit_glm, ...)

h_logistic_simple_terms(x, fit_glm, conf_level = 0.95)

h_logistic_inter_terms(x, fit_glm, conf_level = 0.95, at = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fit_glm</code></td>
<td>
<p>(<code>glm</code>)<br> logistic regression model fitted by <code>stats::glm()</code> with "binomial" family.
Limited functionality is also available for conditional logistic regression models fitted by
<code>survival::clogit()</code>, currently this is used only by <code>extract_rsp_biomarkers()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interaction_vars</code></td>
<td>
<p>(<code>character(2)</code>)<br> interaction variable names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>first_var_with_level</code></td>
<td>
<p>(<code>character(2)</code>)<br> the first variable name with the interaction level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>second_var_with_level</code></td>
<td>
<p>(<code>character(2)</code>)<br> the second variable name with the interaction level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>odds_ratio_var</code></td>
<td>
<p>(<code>string</code>)<br> the odds ratio variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interaction_var</code></td>
<td>
<p>(<code>string</code>)<br> the interaction variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf_level</code></td>
<td>
<p>(<code>proportion</code>)<br> confidence level of the interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>at</code></td>
<td>
<p>(<code>numeric</code> or <code>NULL</code>)<br> optional values for the interaction variable. Otherwise
the median is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>terms</code></td>
<td>
<p>(<code>character</code>)<br> simple terms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>table</code></td>
<td>
<p>(<code>table</code>)<br> table containing numbers for terms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>terms1</code></td>
<td>
<p>(<code>character</code>)<br> terms for first dimension (rows).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>terms2</code></td>
<td>
<p>(<code>character</code>)<br> terms for second dimension (rows).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>any</code></td>
<td>
<p>(<code>flag</code>)<br> whether any of <code>term1</code> and <code>term2</code> can be fulfilled to count the
number of patients. In that case they can only be scalar (strings).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>(<code>character</code>)<br> a variable or interaction term in <code>fit_glm</code> (depending on the helper function used).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments for the lower level functions.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Vector of names of interaction variables.
</p>
<p>Name of coefficient.
</p>
<p>Odds ratio.
</p>
<p>Odds ratio.
</p>
<p>Odds ratio.
</p>
<p>Term labels containing numbers of patients.
</p>
<p>Term labels containing numbers of patients.
</p>
<p>Tabulated main effect results from a logistic regression model.
</p>
<p>Tabulated interaction term results from a logistic regression model.
</p>
<p>A <code>data.frame</code> of tabulated interaction term results from a logistic regression model.
</p>
<p>Tabulated statistics for the given variable(s) from the logistic regression model.
</p>
<p>Tabulated statistics for the given variable(s) from the logistic regression model.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>h_get_interaction_vars()</code>: Helper function to extract interaction variable names from a fitted
model assuming only one interaction term.
</p>
</li>
<li> <p><code>h_interaction_coef_name()</code>: Helper function to get the right coefficient name from the
interaction variable names and the given levels. The main value here is that the order
of first and second variable is checked in the <code>interaction_vars</code> input.
</p>
</li>
<li> <p><code>h_or_cat_interaction()</code>: Helper function to calculate the odds ratio estimates
for the case when both the odds ratio and the interaction variable are categorical.
</p>
</li>
<li> <p><code>h_or_cont_interaction()</code>: Helper function to calculate the odds ratio estimates
for the case when either the odds ratio or the interaction variable is continuous.
</p>
</li>
<li> <p><code>h_or_interaction()</code>: Helper function to calculate the odds ratio estimates
in case of an interaction. This is a wrapper for <code>h_or_cont_interaction()</code> and
<code>h_or_cat_interaction()</code>.
</p>
</li>
<li> <p><code>h_simple_term_labels()</code>: Helper function to construct term labels from simple terms and the table
of numbers of patients.
</p>
</li>
<li> <p><code>h_interaction_term_labels()</code>: Helper function to construct term labels from interaction terms and the table
of numbers of patients.
</p>
</li>
<li> <p><code>h_glm_simple_term_extract()</code>: Helper function to tabulate the main effect
results of a (conditional) logistic regression model.
</p>
</li>
<li> <p><code>h_glm_interaction_extract()</code>: Helper function to tabulate the interaction term
results of a logistic regression model.
</p>
</li>
<li> <p><code>h_glm_inter_term_extract()</code>: Helper function to tabulate the interaction
results of a logistic regression model. This basically is a wrapper for
<code>h_or_interaction()</code> and <code>h_glm_simple_term_extract()</code> which puts the results
in the right data frame format.
</p>
</li>
<li> <p><code>h_logistic_simple_terms()</code>: Helper function to tabulate the results including
odds ratios and confidence intervals of simple terms.
</p>
</li>
<li> <p><code>h_logistic_inter_terms()</code>: Helper function to tabulate the results including
odds ratios and confidence intervals of interaction terms.
</p>
</li>
</ul>
<h3>Note</h3>

<p>We don't provide a function for the case when both variables are continuous because
this does not arise in this table, as the treatment arm variable will always be involved
and categorical.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(dplyr)
library(broom)

adrs_f &lt;- tern_ex_adrs %&gt;%
  filter(PARAMCD == "BESRSPI") %&gt;%
  filter(RACE %in% c("ASIAN", "WHITE", "BLACK OR AFRICAN AMERICAN")) %&gt;%
  mutate(
    Response = case_when(AVALC %in% c("PR", "CR") ~ 1, TRUE ~ 0),
    RACE = factor(RACE),
    SEX = factor(SEX)
  )
formatters::var_labels(adrs_f) &lt;- c(formatters::var_labels(tern_ex_adrs), Response = "Response")
mod1 &lt;- fit_logistic(
  data = adrs_f,
  variables = list(
    response = "Response",
    arm = "ARMCD",
    covariates = c("AGE", "RACE")
  )
)
mod2 &lt;- fit_logistic(
  data = adrs_f,
  variables = list(
    response = "Response",
    arm = "ARMCD",
    covariates = c("AGE", "RACE"),
    interaction = "AGE"
  )
)

h_glm_simple_term_extract("AGE", mod1)
h_glm_simple_term_extract("ARMCD", mod1)

h_glm_interaction_extract("ARMCD:AGE", mod2)

h_glm_inter_term_extract("AGE", "ARMCD", mod2)

h_logistic_simple_terms("AGE", mod1)

h_logistic_inter_terms(c("RACE", "AGE", "ARMCD", "AGE:ARMCD"), mod2)

</code></pre>


</div>