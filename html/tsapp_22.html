<div class="container">

<table style="width: 100%;"><tr>
<td>HAC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>HAC Covariance Matrix Estimation
<code>HAC</code>  computes the central quantity (the meat) in the HAC covariance matrix estimator, also called
sandwich estimator. HAC is the abbreviation for "heteroskedasticity and autocorrelation consistent".</h2>

<h3>Description</h3>

<p>HAC Covariance Matrix Estimation
<code>HAC</code>  computes the central quantity (the meat) in the HAC covariance matrix estimator, also called
sandwich estimator. HAC is the abbreviation for "heteroskedasticity and autocorrelation consistent".
</p>


<h3>Usage</h3>

<pre><code class="language-R">HAC(mcond, method = "Bartlett", bw)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mcond</code></td>
<td>
<p>a q-dimensional multivariate time series. In the case of OLS regression with q regressors mcond 
contains the series of the form regressor*residual (see example below).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>kernel function, choose between "Truncated", "Bartlett", "Parzen", "Tukey-Hanning", "Quadratic Spectral".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw</code></td>
<td>
<p>bandwidth parameter, controls the number of lags considered in the estimation.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>mat      a (q,q)-matrix
</p>


<h3>Source</h3>

<p>Heberle, J. and Sattarhoff, C. (2017) &lt;doi:10.3390/econometrics5010009&gt;  "A Fast Algorithm for the Computation of HAC
Covariance Matrix Estimators"
</p>


<h3>Examples</h3>

<pre><code class="language-R"> 
data(MUSKRAT)
y &lt;- ts(log10(MUSKRAT))
n &lt;- length(y)
t &lt;- c(1:n)
t2 &lt;- t^2
out2 &lt;- lm(y ~ t +t2)
mat_xu &lt;- matrix(c(out2$residuals,t*out2$residuals, t2*out2$residuals),nrow=62,ncol=3)
hac &lt;- HAC(mat_xu, method="Bartlett", 4)

mat_regr&lt;- matrix(c(rep(1,62),t,t2),nrow=62,ncol=3)
mat_q &lt;- t(mat_regr)%*%mat_regr/62
vcov_HAC &lt;- solve(mat_q)%*%hac%*%solve(mat_q)/62
# vcov_HAC is the HAC covariance matrix estimation for the OLS coefficients. 
</code></pre>


</div>