<div class="container">

<table style="width: 100%;"><tr>
<td>clusterTree</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Density clustering: the cluster tree
</h2>

<h3>Description</h3>

<p>Given a point cloud, or a matrix of distances, the function <code>clusterTree</code> computes a density estimator and returns the corresponding cluster tree of superlevel sets (lambda tree and kappa tree; see references).
</p>


<h3>Usage</h3>

<pre><code class="language-R">clusterTree(
    X, k, h = NULL, density = "knn", dist = "euclidean", d = NULL,
    Nlambda = 100, printProgress = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>If <code>dist="euclidean"</code>, then <code>X</code> is an <code class="reqn">n</code> by <code class="reqn">d</code> matrix of coordinates, where <code class="reqn">n</code> is the number of points stored in <code>X</code> and <code class="reqn">d</code> is the dimension of the space.
If <code>dist="arbitrary"</code>, then <code>X</code> is an <code class="reqn">n</code> by <code class="reqn">n</code> matrix of distances.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>

<p>an integer value specifying the parameter of the underlying k-nearest neighbor similarity graph, used to determine connected components. If <code>density="knn"</code>, then <code>k</code> is also used to compute the k-nearest neighbor density estimator.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>

<p>real value: if <code>density = "kde"</code>, then <code>h</code> is used to compute the kernel density estimator with bandwidth <code>h</code>. The default value is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>density</code></td>
<td>

<p>string: if <code>"knn"</code> then the k-nearest neighbor density estimator is used to compute the cluster tree;
if <code>"kde"</code> then the kernel density estimator is used to compute the cluster tree.
The default value is <code>"knn"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>

<p>string: can be <code>"euclidean"</code>, when <code>X</code> is a point cloud or <code>"arbitrary"</code>, when <code>X</code> is a matrix of distances. The default value is <code>"euclidean"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>

<p>integer: if <code>dist="arbitrary"</code>, then <code>d</code> is the dimension of the underlying space. The default value is <code>"NULL"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nlambda</code></td>
<td>

<p>integer: size of the grid of values of the density estimator, used to compute the cluster tree. High <code>Nlambda</code> (i.e. a fine grid) means a more accurate cluster Tree. The default value is <code>100</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>printProgress</code></td>
<td>

<p>logical: if <code>TRUE</code>, a progress bar is printed. The default value is <code>FALSE</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>clusterTree</code> is an implementation of Algorithm 1 in the first reference.
</p>


<h3>Value</h3>

<p>The function <code>clusterTree</code> returns an object of class <code>clusterTree</code>, a list with the following components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>density</code></td>
<td>

<p>Vector of length <code>n</code>: the values of the density estimator evaluated at each of the points stored in <code>X</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DataPoints</code></td>
<td>

<p>A list whose elements are the points of <code>X</code> corresponding to each branch, in the same order of <code>id</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>The number of points stored in the input matrix <code>X</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>

<p>Vector: the IDs associated to the branches of the cluster tree
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>children</code></td>
<td>

<p>A list whose elements are the IDs of the children of each branch, in the same order of <code>id</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parent</code></td>
<td>

<p>Vector: the IDs of the parents of each branch, in the same order of <code>id</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silo</code></td>
<td>

<p>A list whose elements are the horizontal coordinates of the silo of each branch, in the same order of <code>id</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xbase</code></td>
<td>

<p>Vector: the horiontal coordinates of the branches of the cluster tree, in the same order of <code>id</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambdaBottom</code></td>
<td>

<p>Vector: the vertical bottom coordinates of the branches of the lambda tree, in the same order of <code>id</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambdaTop</code></td>
<td>

<p>Vector: the vertical top coordinates of the branches of the lambda tree, in the same order of <code>id</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rBottom</code></td>
<td>

<p>(only if <code>density="knn"</code>) Vector: the vertical bottom coordinates of the branches of the r tree, in the same order of <code>id</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rTop</code></td>
<td>

<p>(only if <code>density="knn"</code>) Vector: the vertical top coordinates of the branches of the r tree, in the same order of <code>id</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alphaBottom</code></td>
<td>

<p>Vector: the vertical bottom coordinates of the branches of the alpha tree, in the same order of <code>id</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alphaTop</code></td>
<td>

<p>Vector: the vertical top coordinates of the branches of the alpha tree, in the same order of <code>id</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Kbottom</code></td>
<td>

<p>Vector: the vertical bottom coordinates of the branches of the kappa tree, in the same order of <code>id</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ktop</code></td>
<td>

<p>Vector: the vertical top coordinates of the branches of the kappa tree, in the same order of <code>id</code>
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Fabrizio Lecci
</p>


<h3>References</h3>

<p>Kent BP, Rinaldo A, Verstynen T (2013). "DeBaCl: A Python Package for Interactive DEnsity-BAsed CLustering." arXiv:1307.8136 
</p>
<p>Lecci F, Rinaldo A, Wasserman L (2014). "Metric Embeddings for Cluster Trees"
</p>


<h3>See Also</h3>

<p><code>plot.clusterTree</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Generate data: 3 clusters
n &lt;- 1200    #sample size
Neach &lt;- floor(n / 4) 
X1 &lt;- cbind(rnorm(Neach, 1, .8), rnorm(Neach, 5, 0.8))
X2 &lt;- cbind(rnorm(Neach, 3.5, .8), rnorm(Neach, 5, 0.8))
X3 &lt;- cbind(rnorm(Neach, 6, 1), rnorm(Neach, 1, 1))
X &lt;- rbind(X1, X2, X3)

k &lt;- 100     #parameter of knn

## Density clustering using knn and kde
Tree &lt;- clusterTree(X, k, density = "knn")
TreeKDE &lt;- clusterTree(X, k, h = 0.3, density = "kde")

par(mfrow = c(2, 3))
plot(X, pch = 19, cex = 0.6)
# plot lambda trees
plot(Tree, type = "lambda", main = "lambda Tree (knn)")
plot(TreeKDE, type = "lambda", main = "lambda Tree (kde)")
# plot clusters
plot(X, pch = 19, cex = 0.6, main = "cluster labels")
for (i in Tree[["id"]]){
  points(matrix(X[Tree[["DataPoints"]][[i]],],ncol = 2), col = i, pch = 19,
         cex = 0.6)
}
#plot kappa trees
plot(Tree, type = "kappa", main = "kappa Tree (knn)")
plot(TreeKDE, type = "kappa", main = "kappa Tree (kde)")
</code></pre>


</div>