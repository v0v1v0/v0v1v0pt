<div class="container">

<table style="width: 100%;"><tr>
<td>IPFP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Iterative Proportional Fitting Procedure</h2>

<h3>Description</h3>

<p>Adjustment of a table on the margins</p>


<h3>Usage</h3>

<pre><code class="language-R">IPFP(Table, Col.knw, Row.knw, tol=0.0001)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Table</code></td>
<td>
<p>A contingency table</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Col.knw</code></td>
<td>
<p>A vector containing the true totals of the columns</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Row.knw</code></td>
<td>
<p>A vector containing the true totals of the Rows</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>The control value, by default equal to 0.0001</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Adjust a contingency table on the know margins of the population with the Raking Ratio method</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hagutierrezro@gmail.com">hagutierrezro@gmail.com</a></p>


<h3>References</h3>

<p>Deming, W. &amp; Stephan, F. (1940), On a least squares adjustment of a sampled frequency 
table when the expected marginal totals are known. <em>Annals of Mathematical Statistics</em>, 11, 427-444.<br>
Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas.
</p>


<h3>Examples</h3>

<pre><code class="language-R">############
## Example 1
############
# Some example of Ardilly and Tille 
Table &lt;- matrix(c(80,90,10,170,80,80,150,210,130),3,3)
rownames(Table) &lt;- c("a1", "a2","a3")
colnames(Table) &lt;- c("b1", "b2","b3")
# The table with labels
Table
# The known and true margins
Col.knw &lt;- c(150,300,550)
Row.knw &lt;- c(430,360,210)
# The adjusted table
IPFP(Table,Col.knw,Row.knw,tol=0.0001)

############
## Example 2
############
# Draws a simple random sample
data(Lucy)
attach(Lucy)

N&lt;-dim(Lucy)[1]
n&lt;-400
sam&lt;-sample(N,n)
data&lt;-Lucy[sam,]
attach(data)
dim(data)
# Two domains of interest
Doma1&lt;-Domains(Level)
Doma2&lt;-Domains(SPAM)
# Cross tabulate of domains
SPAM.no&lt;-Doma2[,1]*Doma1
SPAM.yes&lt;-Doma2[,2]*Doma1
# Estimation
E.SI(N,n,Doma1)
E.SI(N,n,Doma2)
est1 &lt;-E.SI(N,n,SPAM.no)[,2:4]
est2 &lt;-E.SI(N,n,SPAM.yes)[,2:4]
est1;est2
# The contingency table estimated from above
Table &lt;- cbind(est1[1,],est2[1,])
rownames(Table) &lt;- c("Big", "Medium","Small")
colnames(Table) &lt;- c("SPAM.no", "SPAM.yes")
# The known and true margins
Col.knw &lt;- colSums(Domains(Lucy$SPAM))
Row.knw&lt;- colSums(Domains(Lucy$Level))
# The adjusted table
IPFP(Table,Col.knw,Row.knw,tol=0.0001)
</code></pre>


</div>