<div class="container">

<table style="width: 100%;"><tr>
<td>mrl</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Mean residual life plot</h2>

<h3>Description</h3>

<p>Calculate mean residual life and plot it to aid the identification of a
threshold over which to fit a generalized Pareto distribution
</p>


<h3>Usage</h3>

<pre><code class="language-R">mrl(data, umin = min(data), umax = max(data) - 0.1, nint = 100,
alpha=.050)
## S3 method for class 'mrl'
print(x, ...)
## S3 method for class 'summary.mrl'
print(x, ...)
## S3 method for class 'mrl'
summary(object, ...)
## S3 method for class 'mrl'
plot(x, xlab="Threshold", ylab="Mean excess", ...)
## S3 method for class 'mrl'
ggplot(data, mapping, xlab = "Threshold",
  ylab = "Mean excess", main=NULL,fill="orange", col="blue",
  rug=TRUE, addNexcesses=TRUE, textsize=4, ..., environment)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A numeric vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>umin</code></td>
<td>
<p>The minimum value over which to threshold the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>umax</code></td>
<td>
<p>The maximum value over which to threshold the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nint</code></td>
<td>
<p>The number of points at which to compute the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Used to determine coverage of confidence interval to plot.
Defaults to plotting a 95% interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x, object</code></td>
<td>
<p>Arguments to print, summary and plot functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>Label for the x-axis. Defaults to <code>xlab="Threshold"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>Label for the y-axis. Defaults to <code>ylab="Mean excess"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Optional arguments to <code>plot</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>Colour of the line on the MRL plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rug</code></td>
<td>
<p>Whether to add raw data as a rug along axis of plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fill</code></td>
<td>
<p>Colour of the pointwise confidence region on the MRL plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>Main title.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>addNexcesses</code></td>
<td>
<p>Whether to annotate the plot with the numbers of
excesses over increasing thresholds. Defaults to <code>addNexcesses=TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>textsize</code></td>
<td>
<p>Size of text on the plot (ggplot). Defaults to
<code>textsize=4</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mapping, environment</code></td>
<td>
<p>Not used.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Threshold choice for the fitting of the GPD is guided by the shape of the
Mean Residual Life plot.  A threshold which is suitably high will have a
corresponding mrl plot which is approximately linear in shape above the
threshold (up to sampling variation).
</p>


<h3>Value</h3>

<p>A list with two components. <code>data</code> is the original data,
<code>mrl</code> is a matrix containing information to produce the mean residual
life plot.
</p>


<h3>Note</h3>

<p>The function was originally written by Stuart Coles and appears in the
<code>ismev</code> package. This version modified by Harry Southworth to allow
more control over the appearance of the plot.
</p>


<h3>Author(s)</h3>

<p>Janet E. Heffernan, Harry Southworth
</p>


<h3>References</h3>

<p>S. Coles, An Introduction to Statistical Modeling of Extreme
Values, Springer, 2001
</p>


</div>