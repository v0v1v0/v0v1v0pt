<div class="container">

<table style="width: 100%;"><tr>
<td>treediff</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Perform the treediff test</h2>

<h3>Description</h3>

<p>Perform the treediff test to compare two sets of trees.
</p>


<h3>Usage</h3>

<pre><code class="language-R">treediff(trees1, trees2, replicates, scale = FALSE, order_labels = FALSE)

## S3 method for class 'treeTest'
print(x, ...)

## S3 method for class 'treeTest'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>trees1</code></td>
<td>
<p>A list of trees corresponding to the first condition (set).
Trees are structured into groups (or clusters) with the same number of
replicates in each group. Trees are ordered by groups and then by replicates:
{group1+rep1, group1+rep2, ...}. One test is performed for each group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trees2</code></td>
<td>
<p>A list of trees corresponding to the second condition. Trees
are also structured in groups (or clusters) that are exactly the same than
for the first condition. The number of replicates in each group can be
different from that of <code>trees1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>replicates</code></td>
<td>
<p>A numeric vector of length 2 with the number of replicates
for each condition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the trees are all rescaled to have a
minimum height equal to 0 and a maximum height equal to 1. Default to
<code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order_labels</code></td>
<td>
<p>Logical. If <code>TRUE</code>, align leaves ordering in all
trees (required if your trees don't have their leaves ordered identically).
Default to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a <code>treeTest</code> object to print</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>not used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>a <code>treeTest</code> object to print</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function compares two sets of trees using a p-value aggregation
method. The p-values are obtained by the treediff method, as described in
(Neuvial <em>et al.</em>, 2023).
</p>


<h3>Value</h3>

<p>An object of class <code>treeTest</code> with the following entries:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p> the p-value for the treediff test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p> the value of the Student's statistic of each leaf pair of
the tree test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value.indiv</code></td>
<td>
<p> the p-value of the Student's test for each leaf pair of
the tree test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p> a character string indicating what type of test was 
performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>
<p> a character string giving the names of the tree 
conditions.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Gwendaëlle Cardenas<br>
Marie Chavent <a href="mailto:marie.chavent@u-bordeaux.fr">marie.chavent@u-bordeaux.fr</a><br>
Sylvain Foissac <a href="mailto:sylvain.foissac@inrae.fr">sylvain.foissac@inrae.fr</a><br>
Pierre Neuvial <a href="mailto:pierre.neuvial@math.univ-toulouse.fr">pierre.neuvial@math.univ-toulouse.fr</a><br>
Nathanaël Randriamihamison<br>
Nathalie Vialaneix <a href="mailto:nathalie.vialaneix@inrae.fr">nathalie.vialaneix@inrae.fr</a>
</p>


<h3>References</h3>

<p>Neuvial Pierre, Randriamihamison Nathanaël, Chavent Marie,
Foissac Sylvain and Vialaneix Nathalie (2024) A two-sample tree-based test 
for hierarchically organized genomic signals. <em>Journal of the Royal
Statistical Society, Series C</em>, <em>Forthcoming</em>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">leaves &lt;- c(100, 120, 50, 80)

trees &lt;- sapply(leaves, FUN = function(leaf) {
  base_data &lt;- matrix(rnorm(2000), nrow = leaf, ncol = 200)

## generates two sets of trees with 4 clusters with 100, 120, 50 and 80
## leaves respectively
## 4 replicates in the first condition and 6 in the second condition

  set1 &lt;- replicate(4, sample(1:100, 50, replace = FALSE))
  set2 &lt;- replicate(6, sample(101:200, 50, replace = FALSE))

  trees1 &lt;- apply(set1, 2, function(asample) {
    samples &lt;- base_data[, asample]
    out &lt;- hclust(dist(samples), method = "ward.D2")
    return(out)
  })

  trees2 &lt;- apply(set2, 2, function(asample) {
    samples &lt;- base_data[, asample]
    out &lt;- hclust(dist(samples), method = "ward.D2")
    return(out)
  })
  return(list("trees1" = trees1, "trees2" = trees2))
})

trees1 &lt;- unlist(trees[1, ], recursive = FALSE)
trees2 &lt;- unlist(trees[2, ], recursive = FALSE)
replicates &lt;- c(4, 6)

tree_pvals &lt;- treediff(trees1, trees2, replicates)
## 4 p-values, one for each cluster
tree_pvals$p.value
</code></pre>


</div>