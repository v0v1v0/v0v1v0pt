<div class="container">

<table style="width: 100%;"><tr>
<td>tandem</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fits a TANDEM model by performing a two-stage regression</h2>

<h3>Description</h3>

<p>Fits a TANDEM model by performing a two-stage regression. In the first stage, all upstream features (x[,upstream]) are regressed
on the output y. In the second stage, the downstream features (x[,!upstream]) are regressed on the residuals of the first stage.
In both stages Elastic Net regression (as implemented in cv.glmnet() from the glmnet package) is used to perform the regression.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tandem(
  x,
  y,
  upstream,
  family = "gaussian",
  nfolds = 10,
  foldid = NULL,
  lambda_upstream = "lambda.1se",
  lambda_downstream = "lambda.1se",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A feature matrix, where the rows correspond to samples and the columns to features.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A vector containing the response.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upstream</code></td>
<td>
<p>A boolean vector that indicates for each feature whether it's upstream (TRUE) or downstream (FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>The family parameter that's passed to cv.glmnet(). Currently, only family='gaussian' is supported.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nfolds</code></td>
<td>
<p>Number of cross-validation folds (default is 10) used to determine the optimal lambda in cv.glmnet().</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>foldid</code></td>
<td>
<p>An optional vector indicating in which cross-validation fold each sample should be. Overrides nfolds when used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda_upstream</code></td>
<td>
<p>For the first stage (using the upstream features), should glmnet use lambda.min or lambda.1se? Default is lambda.1se.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda_downstream</code></td>
<td>
<p>For the second stage (using the downstream features), should glmnet use lambda.min or lambda.1se? Default is lambda.1se.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other parameters that are passed to cv.glmnet().</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A tandem-object.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># unpack example data
x = example_data$x
y = example_data$y
upstream = example_data$upstream

# fit a tandem model, determine the coefficients and create a prediction
fit = tandem(x, y, upstream, alpha=0.5)
beta = coef(fit)
y_hat = predict(fit, newx=x)
</code></pre>


</div>