<div class="container">

<table style="width: 100%;"><tr>
<td>spmle</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>function to compute the semiparametric maximum likelihood estimator</h2>

<h3>Description</h3>

<p>This function computes the semiparametric maximum likelihood estimator (SPMLE) of 
regression parameters, which assess treatment-biomarker interactions in studies 
with two-phase sampling  in randomized clinical trials. The function has an option 
to incorporate the independence between a randomized treatment and the baseline 
markers.
</p>


<h3>Usage</h3>

<pre><code class="language-R">spmle(data, response, treatment, BaselineMarker, extra = NULL, phase, 
ind = TRUE, difffactor = 0.001, maxit = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>A data frame used to access the following data. Each row contains the response and 
predictors of a study participant. All variables are numerical.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>response</code></td>
<td>

<p>A character string of column name, corresponds to one column of the data frame, which 
is used to store a numeric vector of response. 
The response variable should be coded as 1 for cases and 0 for controls.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>treatment</code></td>
<td>

<p>A character string of column name, corresponds to one column of the data frame, which 
is used to store a binary vector of the treatment . The treatment variable should be 
coded as 1 for treatment and 0 for placebo.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BaselineMarker</code></td>
<td>

<p>A character string of column name, corresponds to one column of the data frame, which 
is used to store a vector of biomarker that is assessed for interaction with the 
treatment. The BaselineMarker variable is missing for those who are not sampled 
in the second phase.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extra</code></td>
<td>

<p>A string vector of column name(s), corresponds to one or more column(s) of the data 
frame, which are used to store the extra covariate(s) to be adjusted for in addition 
to treatment and biomarker. All extra variables are missing for those who are not 
sampled in the second phase.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phase</code></td>
<td>

<p>A character string of column name, correspond to one column of the data frame, which 
is used to store the  indicator of two-phase sampling (1: not being sampled for 
measuring biomarker; 2: being sampled for measuring biomarker).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ind</code></td>
<td>

<p>A logical flag. TRUE indicates incorporating the independence between the randomized 
treatment and the baseline markers.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>difffactor</code></td>
<td>

<p>A decimal number of the differentiation factor, used to control the step of 
numerical differentiation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>

<p>A integer number of the maximal number of numerical differentiation iteration.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function returns estimates, standard errors, and p values for SPMLE for parameters 
of a regression model for treatment-biomarker interaction studies with two-phase 
sampling in randomized trials, response ~ treatment + biomarker + treatment*biomarker 
+ other covariates. Treatment and response are available for all the samples, while 
biomarker data are available for a subset of samples. The SPMLE can incorporate the 
independence between the treatment and baseline biomarkers ascertained in the phase-two 
sample. A profile likelihood based Newton-Raphson algorithm is used to compute SPMLE.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>Estimated parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stder</code></td>
<td>
<p>Standard error</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pVal</code></td>
<td>
<p>p value</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>James Y. Dai
</p>


<h3>References</h3>

<p>J. Y. Dai, M. LeBlanc, and C. Kooperberg. Semiparametric estimation exploiting 
covariate independence in two-phase randomized trials. Biometrics, 
65(1):178-187, 2009.
</p>


<h3>See Also</h3>

<p><code>mele</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Load the example data
data(whiBioMarker)
## Here is an example of SPMLE with exploiting independent and with confounding factors:
spmleIndExtra &lt;- spmle(data=whiBioMarker,  ## dataset
                       response="stroke",  ## response variable
                       treatment="hrtdisp",  ## treatment variable
                       BaselineMarker="papbl",	## environment variable
                       extra=c(
                         "age" 	## age
                         , "dias"	## diabetes
                         , "hyp" ## hypertension
                         , "syst" ## systolic
                         , "diabtrt"	## diastolic BP
                         , "lmsepi" ## waist:hip ratio
                       ),	## extra variable(s)
                       phase="phase", ## phase indicator
                       ind=TRUE ## independent or non-independent
)

</code></pre>


</div>