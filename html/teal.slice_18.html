<div class="container">

<table style="width: 100%;"><tr>
<td>DateFilterState</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
<code>FilterState</code> object for <code>Date</code> data</h2>

<h3>Description</h3>

<p>Manages choosing a range of <code>Date</code>s.
</p>


<h3>Super class</h3>

<p><code>teal.slice::FilterState</code> -&gt; <code>DateFilterState</code>
</p>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-DateFilterState-new"><code>DateFilterState$new()</code></a>
</p>
</li>
<li> <p><a href="#method-DateFilterState-get_call"><code>DateFilterState$get_call()</code></a>
</p>
</li>
<li> <p><a href="#method-DateFilterState-clone"><code>DateFilterState$clone()</code></a>
</p>
</li>
</ul>
<details><summary>Inherited methods</summary><ul>
<li><span class="pkg-link" data-pkg="teal.slice" data-topic="FilterState" data-id="destroy_observers"><a href="../../teal.slice/html/FilterState.html#method-FilterState-destroy_observers"><code>teal.slice::FilterState$destroy_observers()</code></a></span></li>
<li><span class="pkg-link" data-pkg="teal.slice" data-topic="FilterState" data-id="format"><a href="../../teal.slice/html/FilterState.html#method-FilterState-format"><code>teal.slice::FilterState$format()</code></a></span></li>
<li><span class="pkg-link" data-pkg="teal.slice" data-topic="FilterState" data-id="get_state"><a href="../../teal.slice/html/FilterState.html#method-FilterState-get_state"><code>teal.slice::FilterState$get_state()</code></a></span></li>
<li><span class="pkg-link" data-pkg="teal.slice" data-topic="FilterState" data-id="print"><a href="../../teal.slice/html/FilterState.html#method-FilterState-print"><code>teal.slice::FilterState$print()</code></a></span></li>
<li><span class="pkg-link" data-pkg="teal.slice" data-topic="FilterState" data-id="server"><a href="../../teal.slice/html/FilterState.html#method-FilterState-server"><code>teal.slice::FilterState$server()</code></a></span></li>
<li><span class="pkg-link" data-pkg="teal.slice" data-topic="FilterState" data-id="set_state"><a href="../../teal.slice/html/FilterState.html#method-FilterState-set_state"><code>teal.slice::FilterState$set_state()</code></a></span></li>
<li><span class="pkg-link" data-pkg="teal.slice" data-topic="FilterState" data-id="ui"><a href="../../teal.slice/html/FilterState.html#method-FilterState-ui"><code>teal.slice::FilterState$ui()</code></a></span></li>
</ul></details><hr>
<a id="method-DateFilterState-new"></a>



<h4>Method <code>new()</code>
</h4>

<p>Initialize a <code>FilterState</code> object.
</p>


<h5>Usage</h5>

<div class="r"><pre>DateFilterState$new(
  x,
  x_reactive = reactive(NULL),
  slice,
  extract_type = character(0)
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>x</code></dt>
<dd>
<p>(<code>Date</code>)
variable to be filtered.</p>
</dd>
<dt><code>x_reactive</code></dt>
<dd>
<p>(<code>reactive</code>)
returning vector of the same type as <code>x</code>. Is used to update
counts following the change in values of the filtered dataset.
If it is set to <code>reactive(NULL)</code> then counts based on filtered
dataset are not shown.</p>
</dd>
<dt><code>slice</code></dt>
<dd>
<p>(<code>teal_slice</code>)
specification of this filter state.
<code>teal_slice</code> is stored in the object and <code>set_state</code> directly manipulates values within <code>teal_slice</code>.
<code>get_state</code> returns <code>teal_slice</code> object which can be reused in other places.
Note that <code>teal_slice</code> is a <code>reactiveValues</code>, which means it has reference semantics, i.e.
changes made to an object are automatically reflected in all places that refer to the same <code>teal_slice</code>.</p>
</dd>
<dt><code>extract_type</code></dt>
<dd>
<p>(<code>character</code>)
specifying whether condition calls should be prefixed by <code>dataname</code>. Possible values:
</p>

<ul>
<li> <p><code>character(0)</code> (default) <code>varname</code> in the condition call will not be prefixed
</p>
</li>
<li> <p><code>"list"</code> <code>varname</code> in the condition call will be returned as <code style="white-space: pre;">⁠&lt;dataname&gt;$&lt;varname&gt;⁠</code>
</p>
</li>
<li> <p><code>"matrix"</code> <code>varname</code> in the condition call will be returned as <code style="white-space: pre;">⁠&lt;dataname&gt;[, &lt;varname&gt;]⁠</code>
</p>
</li>
</ul>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>Object of class <code>DateFilterState</code>, invisibly.
</p>


<hr>
<a id="method-DateFilterState-get_call"></a>



<h4>Method <code>get_call()</code>
</h4>

<p>Returns reproducible condition call for current selection.
For this class returned call looks like
<code style="white-space: pre;">⁠&lt;varname&gt; &gt;= &lt;min value&gt; &amp; &lt;varname&gt; &lt;= &lt;max value&gt;⁠</code> with optional <code style="white-space: pre;">⁠is.na(&lt;varname&gt;)⁠</code>.
</p>


<h5>Usage</h5>

<div class="r"><pre>DateFilterState$get_call(dataname)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>dataname</code></dt>
<dd>
<p>(<code>character(1)</code>) containing possibly prefixed name of data set</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p><code>call</code> or <code>NULL</code>
</p>


<hr>
<a id="method-DateFilterState-clone"></a>



<h4>Method <code>clone()</code>
</h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>DateFilterState$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt>
<dd>
<p>Whether to make a deep clone.</p>
</dd>
</dl>
</div>




<h3>Examples</h3>

<pre><code class="language-R"># use non-exported function from teal.slice
include_css_files &lt;- getFromNamespace("include_css_files", "teal.slice")
include_js_files &lt;- getFromNamespace("include_js_files", "teal.slice")
DateFilterState &lt;- getFromNamespace("DateFilterState", "teal.slice")

library(shiny)

filter_state &lt;- DateFilterState$new(
  x = c(Sys.Date() + seq(1:10), NA),
  slice = teal_slice(varname = "x", dataname = "data"),
  extract_type = character(0)
)
isolate(filter_state$get_call())
filter_state$set_state(
  teal_slice(
    dataname = "data",
    varname = "x",
    selected = c(Sys.Date() + 3L, Sys.Date() + 8L),
    keep_na = TRUE
  )
)
isolate(filter_state$get_call())

# working filter in an app
library(shinyjs)

dates &lt;- c(Sys.Date() - 100, Sys.Date())
data_date &lt;- c(seq(from = dates[1], to = dates[2], length.out = 100), NA)
fs &lt;- DateFilterState$new(
  x = data_date,
  slice = teal_slice(
    dataname = "data", varname = "x", selected = data_date[c(47, 98)], keep_na = TRUE
  )
)

ui &lt;- fluidPage(
  useShinyjs(),
  include_css_files(pattern = "filter-panel"),
  include_js_files(pattern = "count-bar-labels"),
  column(4, tags$div(
    tags$h4("DateFilterState"),
    fs$ui("fs")
  )),
  column(4, tags$div(
    id = "outputs", # div id is needed for toggling the element
    tags$h4("Condition (i.e. call)"), # display the condition call generated by this FilterState
    textOutput("condition_date"), tags$br(),
    tags$h4("Unformatted state"), # display raw filter state
    textOutput("unformatted_date"), tags$br(),
    tags$h4("Formatted state"), # display human readable filter state
    textOutput("formatted_date"), tags$br()
  )),
  column(4, tags$div(
    tags$h4("Programmatic filter control"),
    actionButton("button1_date", "set drop NA", width = "100%"), tags$br(),
    actionButton("button2_date", "set keep NA", width = "100%"), tags$br(),
    actionButton("button3_date", "set a range", width = "100%"), tags$br(),
    actionButton("button4_date", "set full range", width = "100%"), tags$br(),
    actionButton("button0_date", "set initial state", width = "100%"), tags$br()
  ))
)

server &lt;- function(input, output, session) {
  fs$server("fs")
  output$condition_date &lt;- renderPrint(fs$get_call())
  output$formatted_date &lt;- renderText(fs$format())
  output$unformatted_date &lt;- renderPrint(fs$get_state())
  # modify filter state programmatically
  observeEvent(
    input$button1_date,
    fs$set_state(teal_slice(dataname = "data", varname = "x", keep_na = FALSE))
  )
  observeEvent(
    input$button2_date,
    fs$set_state(teal_slice(dataname = "data", varname = "x", keep_na = TRUE))
  )
  observeEvent(
    input$button3_date,
    fs$set_state(teal_slice(dataname = "data", varname = "x", selected = data_date[c(34, 56)]))
  )
  observeEvent(
    input$button4_date,
    fs$set_state(teal_slice(dataname = "data", varname = "x", selected = dates))
  )
  observeEvent(
    input$button0_date,
    fs$set_state(
      teal_slice("data", "variable", selected = data_date[c(47, 98)], keep_na = TRUE)
    )
  )
}

if (interactive()) {
  shinyApp(ui, server)
}

</code></pre>


</div>