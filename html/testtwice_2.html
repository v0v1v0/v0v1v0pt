<div class="container">

<table style="width: 100%;"><tr>
<td>bmhranks</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
One-step and Two-step Signed Ranks.
</h2>

<h3>Description</h3>

<p>Calculates either one-step or two-step signed ranks as proposed
by Noether (1973), Brown (1981) and Markowski and Hettmansperger (1982).
</p>


<h3>Usage</h3>

<pre><code class="language-R">bmhranks(y, q1 = 1/3, q2 = 2/3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>A vector of matched pair differences.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q1</code></td>
<td>

<p>Quantile at which step-ranks rise from 0 to 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q2</code></td>
<td>

<p>Quantile at which step-ranks rise from 1 to 2.
If q1=q2, then there is only one step, from 0 to 1.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A vector with the same length as y containing the step-ranks.
</p>


<h3>Note</h3>

<p>The use of step-ranks in observational studies is discussed in Rosenbaum (1999, 2012, 2015).  They can have larger
design sensitivity than Wilcoxon ranks and higher Bahadur efficiency in a sensitivity analysis.
</p>


<h3>Author(s)</h3>

<p>Paul R. Rosenbaum
</p>


<h3>References</h3>

<p>Brown, B. M. (1981) &lt;doi:10.1093/biomet/68.1.235&gt; Symmetric quantile averages and related estimators. Biometrika, 68(1), 235-242.
</p>
<p>Markowski, E. P. and Hettmansperger, T. P. (1982) &lt;doi:10.2307/2287325&gt; Inference based on simple rank step score statistics for the location model. Journal of the American Statistical Association, 77(380), 901-907.
</p>
<p>Noether, G. E. (1973) &lt;doi:10.2307/2284805&gt; Some simple distribution-free confidence intervals for the center of a symmetric distribution. Journal of the American Statistical Association, 68(343), 716-719.
</p>
<p>Rosenbaum, P. R. (1999) &lt;doi:10.1111/1467-9876.00140&gt; Using quantile averages in matched observational studies. Journal of the Royal Statistical Society: Series C (Applied Statistics), 48(1), 63-78.
</p>
<p>Rosenbaum, P. R. (2012) &lt;doi:10.1214/11-AOAS508&gt; An exact adaptive test with superior design sensitivity in an observational study of treatments for ovarian cancer. The Annals of Applied Statistics, 6(1), 83-105.
</p>
<p>Rosenbaum, P. R. (2015) &lt;doi:10.1080/01621459.2014.960968&gt; Bahadur efficiency of sensitivity analyses in observational studies. Journal of the American Statistical Association, 110(509), 205-217.
</p>


<h3>See Also</h3>

<p>The function multrnk() computes an alternative family of signed ranks.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(smokerlead)
attach(smokerlead)

w&lt;-rank(abs(llead)) # Wilcoxon ranks
o&lt;-order(w)
brn&lt;-bmhranks(llead) # Brown (1981) ranks
plot(w[o],brn[o],type="n",xlab="Wilcoxon ranks",ylab="Step Ranks",
    main="Comparison of 3 Step Ranks")
lines(w[o],brn[o],col="black")

# The following two-step ranks were best for Normal data in
# Table 2 of Markowski-Hettmansperger (1982).
mhn&lt;-bmhranks(llead,q1=.4,q2=.8)
lines(w[o],mhn[o],col="blue")

# Noether (1973) ranks take a single step.  The case of a step
# at q1=q2=2/3 was evaluated in Rosenbaum (2015, Table 2).
noe&lt;-bmhranks(llead,q1=2/3,q2=2/3)
lines(w[o],noe[o],col="red")
legend(20,1.75,c("Brown","MH","Noether"),
    lty=c(1,1,1),col=c("black","blue","red"))

# Adaptive choice of Brown or Noether ranks was considered in
# Rosenbaum (2012).  In this case, an exact distribution
# is available, but function tt() uses a limiting Normal
# distribution instead.
H&lt;-cbind(brn,noe)
tt(llead,H,gamma=1)
tt(llead,H,gamma=3.7)

rm(w,brn,mhn,noe,H)
detach(smokerlead)
</code></pre>


</div>