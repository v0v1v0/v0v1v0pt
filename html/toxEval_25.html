<div class="container">

<table style="width: 100%;"><tr>
<td>plot_tox_heatmap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot EAR heat maps</h2>

<h3>Description</h3>

<p>The <code>plot_tox_heatmap</code> function creates a heat (tile) map with sites on the x-axis,
a specified grouping on the y-axis (defined by the category argument), and color shading
defining the mean or maximum EAR. See "Summarizing the data" in the Introduction vignette:
<a href="../doc/Introduction.html#summarize_data"><code>vignette("Introduction", package = "toxEval")</code></a> for a description on how the
EAR values are computed, aggregated, and summarized. The y-axis grouping can be "Biological",
"Chemical Class", or "Chemical". When specifying the "Chemical" option, a secondary y-axis
is automatically included to group chemicals into chemical class. The function computes
default breaks for the color scale to match the spread of the data, but breaks can also
be customized with the breaks argument.
This is a function where it may be ideal to create a custom order to the sites
(for example, west-to-east). See the above section "Custom configuration"
<a href="../doc/Introduction.html#custom_config"><code>vignette("Introduction", package = "toxEval")</code></a> for instructions on how to convert
the character vector sites to a factor with ordered levels.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_tox_heatmap(
  chemical_summary,
  chem_site,
  category = "Biological",
  breaks = c(1e-05, 1e-04, 0.001, 0.01, 0.1, 1, 10),
  manual_remove = NULL,
  mean_logic = FALSE,
  sum_logic = TRUE,
  plot_ND = TRUE,
  font_size = NA,
  title = NA,
  legend_lab = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>chemical_summary</code></td>
<td>
<p>Data frame from <code>get_chemical_summary</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chem_site</code></td>
<td>
<p>Data frame with columns SiteID, site_grouping, and Short Name.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>category</code></td>
<td>
<p>Either "Biological", "Chemical Class", or "Chemical".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>
<p>Numerical vector to define data bins and legend breaks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>manual_remove</code></td>
<td>
<p>Vector of categories to remove.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean_logic</code></td>
<td>
<p>Logical.  <code>TRUE</code> displays the mean sample from each site,
<code>FALSE</code> displays the maximum sample from each site.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sum_logic</code></td>
<td>
<p>Logical. <code>TRUE</code> sums the EARs in a specified grouping,
<code>FALSE</code> does not. <code>FALSE</code> may be better for traditional benchmarks as
opposed to ToxCast benchmarks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_ND</code></td>
<td>
<p>Logical. Whether or not to plot "Biological" groupings,
"Chemical Class" groupings, or "Chemical" that do not have any detections.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>font_size</code></td>
<td>
<p>Numeric value to adjust the axis font size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>Character title for plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend_lab</code></td>
<td>
<p>Character label for legend. Default is NA which produces an automatic label.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If there are site/parameters (chemical/chemical class/biological grouping) combinations that
don't have data, those areas are represented by an "X". If there are 0 values,
they are considered "non-detects", and represented with a distinct color.
</p>


<h3>Examples</h3>

<pre><code class="language-R">path_to_tox &lt;- system.file("extdata", package = "toxEval")
file_name &lt;- "OWC_data_fromSup.xlsx"
full_path &lt;- file.path(path_to_tox, file_name)

tox_list &lt;- create_toxEval(full_path)

ACC &lt;- get_ACC(tox_list$chem_info$CAS)
ACC &lt;- remove_flags(ACC)

cleaned_ep &lt;- clean_endPoint_info(end_point_info)
filtered_ep &lt;- filter_groups(cleaned_ep)

chemical_summary &lt;- get_chemical_summary(tox_list, ACC, filtered_ep)

# Order the site_groupings:
tox_list$chem_site$site_grouping &lt;- factor(tox_list$chem_site$site_grouping,
  levels = c(
    "Lake Superior",
    "Lake Michigan",
    "Lake Huron",
    "Lake Erie",
    "Lake Ontario"
  )
)

# Order sites:
sitesOrdered &lt;- c(
  "StLouis", "Nemadji", "WhiteWI", "Bad", "Montreal",
  "PresqueIsle", "Ontonagon", "Sturgeon", "Tahquamenon", "Burns",
  "IndianaHC", "StJoseph", "PawPaw", "Kalamazoo", "GrandMI",
  "Milwaukee", "Muskegon", "WhiteMI", "PereMarquette", "Manitowoc",
  "Manistee", "Fox", "Oconto", "Peshtigo", "Menominee",
  "Indian", "Cheboygan", "Ford", "Escanaba", "Manistique",
  "ThunderBay", "AuSable", "Rifle", "Saginaw", "BlackMI",
  "Clinton", "Rouge", "HuronMI", "Raisin", "Maumee",
  "Portage", "Sandusky", "HuronOH", "Vermilion", "BlackOH",
  "Rocky", "Cuyahoga", "GrandOH", "Cattaraugus", "Tonawanda",
  "Genesee", "Oswego", "BlackNY", "Oswegatchie", "Grass",
  "Raquette", "StRegis"
)

tox_list$chem_site$`Short Name` &lt;- factor(tox_list$chem_site$`Short Name`,
  levels = sitesOrdered
)

plot_tox_heatmap(chemical_summary, 
                 tox_list$chem_site,
                 category = "Chemical Class")
              
plot_tox_heatmap(chemical_summary,
                 tox_list$chem_site,
                 category = "Chemical",
                 legend_lab = "EAR"
)

single_site &lt;- dplyr::filter(chemical_summary, site == "USGS-04024000")

plot_tox_heatmap(
  chemical_summary = single_site,
  chem_site = dplyr::filter(tox_list$chem_site, 
                            SiteID == "USGS-04024000"),
  category = "Chemical Class"
)
plot_tox_heatmap(
  chemical_summary = single_site,
  chem_site = dplyr::filter(tox_list$chem_site, SiteID == "USGS-04024000"),
  category = "Chemical"
)

</code></pre>


</div>