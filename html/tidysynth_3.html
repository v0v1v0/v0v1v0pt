<div class="container">

<table style="width: 100%;"><tr>
<td>generate_predictor</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>generate_predictor</h2>

<h3>Description</h3>

<p>Create one or more scalar variables summarizing covariate data across a
specified time window. These predictor variables are used to fit the
synthetic control.
</p>


<h3>Usage</h3>

<pre><code class="language-R">generate_predictor(data, time_window = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>nested data of type <code>tbl_df</code> generated from
<code>synthetic_control()</code>. See <code>synthetic_control()</code> documentation for more
information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time_window</code></td>
<td>
<p>set time window from the pre-intervention period that the
data should be aggregated across to generate the specific predictor.
Default is to use the entire pre-intervention period.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Name-value pairs of summary functions. The name will be the name
of the variable in the result. The value should be an expression that
returns a single value like min(x), n(), or sum(is.na(y)). Note that for
all summary functions <code>na.rm = TRUE</code> argument should be specified as
aggregating across units with missing values is a common occurrence.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>matrices of aggregate-level covariates to be used in the following
minimization task.
</p>
<p style="text-align: center;"><code class="reqn">W^*(V) =  min \sum^M_{m=1} v_m (X_{1m} - \sum^{J+1}_{j=2}w_j X_{jm})^2</code>
</p>

<p>The importance of the generate predictors are determine by vector <code class="reqn">V</code>,
and the weights that determine unit-level importance are determined by vector
<code class="reqn">W</code>. The nested optimation task seeks to find optimal values of <code class="reqn">V</code>
and <code class="reqn">W</code>. Note also that <code class="reqn">V</code> can be provided by the user. See
<code>?generate_weights()</code>.
</p>


<h3>Value</h3>

<p><code>tbl_df</code> with nested fields containing the following:
</p>

<ul>
<li> <p><code>.id</code>: unit id for the intervention case (this will differ when a placebo
unit).
</p>
</li>
<li> <p><code>.placebo</code>: indicator field taking on the value of 1 if a unit is a
placebo unit, 0 if it's the specified treated unit.
</p>
</li>
<li> <p><code>.type</code>: type of the nested data construct: <code>treated</code> or <code>controls</code>.
Keeps tract of which data construct is located in <code>.outcome</code> field.
</p>
</li>
<li> <p><code>.outcome</code>: nested data construct containing the outcome variable
configured for the sythnetic control method. Data is configured into a wide
format for the optimization task.
</p>
</li>
<li> <p><code>.predictors</code>: nested data construct containing the covariate matrices
for the treated and control (donor) units. Data is configured into a wide
format for the optimization task.
</p>
</li>
<li> <p><code>.original_data</code>: original impute data filtered by treated or control
units. This allows for easy processing down stream when generating
predictors.
</p>
</li>
<li> <p><code>.meta</code>: stores information regarding the unit and time index, the
treated unit and time and the name of the outcome variable. Used downstream
in subsequent functions.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">


# Smoking example data
data(smoking)

smoking_out &lt;-
smoking %&gt;%

# initial the synthetic control object
synthetic_control(outcome = cigsale,
                  unit = state,
                  time = year,
                  i_unit = "California",
                  i_time = 1988,
                  generate_placebos= FALSE) %&gt;%

# Generate the aggregate predictors used to generate the weights
  generate_predictor(time_window=1980:1988,
                     lnincome = mean(lnincome, na.rm = TRUE),
                     retprice = mean(retprice, na.rm = TRUE),
                     age15to24 = mean(age15to24, na.rm = TRUE))

# Extract respective predictor matrices
smoking_out %&gt;% grab_predictors(type = "treated")
smoking_out %&gt;% grab_predictors(type = "controls")



</code></pre>


</div>