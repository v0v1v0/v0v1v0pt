<div class="container">

<table style="width: 100%;"><tr>
<td>wasserstein1d</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Compute the Wasserstein Distance Between Two Univariate Samples
</h2>

<h3>Description</h3>

<p>Given two vectors <code>a</code> and <code>b</code>, compute the Wasserstein distance of
order <code>p</code> between their empirical distributions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">wasserstein1d(a, b, p = 1, wa = NULL, wb = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>a, b</code></td>
<td>

<p>two vectors.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>

<p>a positive number. The order of the Wasserstein distance.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wa, wb</code></td>
<td>

<p>optional vectors of non-negative weights for <code>a</code> and <code>b</code>. 
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Wasserstein distance of order <code>p</code> is defined as the <code>p</code>-th root of the total cost incurred when transporting a pile of mass into another pile of mass in an optimal way, where the cost of transporting a unit of mass from <code class="reqn">x</code> to <code class="reqn">y</code> is given as the <code>p</code>-th power <code class="reqn">\|x-y\|^p</code> of the Euclidean distance. 
</p>
<p>In the present function the vector <code>a</code> represents the locations on the real line of <code class="reqn">m</code> deposits of mass <code class="reqn">1/m</code> and the vector <code>b</code> the locations of <code class="reqn">n</code> deposits of mass <code class="reqn">1/n</code>. If the user specifies weights <code>wa</code> and <code>wb</code>, these default masses are replaced by <code>wa/sum(wa)</code> and <code>wb/sum(wb)</code>, respectively.
</p>
<p>In terms of the empirical distribution function <code class="reqn">F(t) = \sum_{i=1}^m w^{(a)}_i 1\{a_i \leq t\}</code> of locations <code class="reqn">a_i</code> with normalized weights <code class="reqn">w^{(a)}_i</code>, and the corresponding function <code class="reqn">G(t) = \sum_{j=1}^n w^{(b)}_j 1\{b_j \leq t\}</code> for <code>b</code>, the Wasserstein distance in 1-d is given as
</p>
<p style="text-align: center;"><code class="reqn">W_p(F,G) = \left(\int_0^1 |F^{-1}(u)-G^{-1}(u)|^p \; du \right)^{1/p},</code>
</p>

<p>where <code class="reqn">F^{-1}</code> and <code class="reqn">G^{-1}</code> are generalized inverses. If <code class="reqn">p=1</code>, we also have </p>
<p style="text-align: center;"><code class="reqn">W_1(F,G) = \int_{-\infty}^{\infty} |F(x)-G(x)| \; dx.</code>
</p>



<h3>Value</h3>

<p>A single number, the Wasserstein distance for the specified data.
</p>


<h3>Author(s)</h3>

<p>Dominic Schuhmacher <a href="mailto:dschuhm1@uni-goettingen.de">dschuhm1@uni-goettingen.de</a>
</p>


<h3>See Also</h3>

<p><code>wasserstein</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  x &lt;- rnorm(200)
  y &lt;- rnorm(150,2)
  wasserstein1d(x,y)
</code></pre>


</div>